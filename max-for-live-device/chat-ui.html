<!--
# The MIT License (MIT)

Copyright (c) 2026 Adam Murray (https://adammurray.link)

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the “Software”), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

This file includes bundled dependencies:
- Preact (MIT License)
- Marked (MIT License)
- Tailwind CSS (MIT License)
- @modelcontextprotocol/sdk (MIT License)
- @google/genai (Apache License 2.0)

See https://github.com/adamjmurray/producer-pal/tree/main/licenses for third-party licenses.
-->

<!doctype html>
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Producer Pal Chat</title>
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5'><g transform='matrix(0.842627,0,0,1.32775,4.47817,59.9172)'><rect x='66.686' y='60.333' width='176.012' height='90.541' style='fill:white;stroke:white;stroke-width:0.9px'/></g><g transform='matrix(0.842627,0,0,1.32775,225.603,55.9177)'><rect x='66.686' y='60.333' width='176.012' height='90.541' style='fill:white;stroke:white;stroke-width:0.9px'/></g><g transform='matrix(1.54355,0,0,1.54355,-236.357,-173.377)'><path d='M306.222,384C306.222,384 305.449,351.224 304.431,311.737C302.9,252.333 291.904,177.855 334.136,177.844C361.374,177.836 373.019,177.844 373.019,177.844C398.331,177.844 414.831,178.875 422.519,180.938C434.331,184.031 444.222,190.758 452.19,201.117C460.159,211.477 464.144,224.859 464.144,241.266C464.144,253.922 461.847,264.563 457.253,273.188C452.659,281.813 446.823,288.586 439.745,293.508C432.667,298.43 425.472,301.688 418.159,303.281C408.222,305.25 393.831,306.234 374.987,306.234L347.847,306.234C347.847,306.234 343.22,354.692 336.283,367.653C329.735,379.886 306.222,384 306.222,384ZM421.253,212.719L401.144,212.719C386.144,212.719 376.159,213.188 371.19,214.125C364.44,215.344 358.862,218.391 354.456,223.266C350.05,228.141 347.847,234.328 347.847,241.828C347.847,247.922 349.417,253.266 352.558,257.859C355.698,262.453 360.034,265.828 365.565,267.984C371.097,270.141 382.065,271.219 398.472,271.219L421.253,271.219L421.253,212.719Z' style='stroke:white;stroke-width:5.51px;stroke-linecap:butt;stroke-miterlimit:2'/></g><g transform='matrix(1.54355,0,0,1.54355,-190.001,-132.702)'><path d='M143.922,336.333C134.777,319.997 132.926,189.348 143.392,171.905C154.849,152.812 201.68,151.492 201.68,151.492C226.992,151.492 243.492,152.523 251.18,154.586C262.992,157.679 272.883,164.406 280.852,174.765C288.82,185.125 292.805,198.508 292.805,214.914C292.805,227.57 290.508,238.211 285.914,246.836C281.32,255.461 275.484,262.234 268.406,267.156C261.328,272.078 254.133,275.336 246.82,276.929C236.883,278.898 222.492,279.883 203.648,279.883L176.508,279.883L176.508,357.648C176.508,357.648 150.997,348.972 143.922,336.333ZM176.508,186.367L176.508,244.867L199.289,244.867C215.695,244.867 226.664,243.789 232.195,241.633C237.727,239.476 242.062,236.101 245.203,231.508C248.344,226.914 249.914,221.57 249.914,215.476C249.914,207.976 247.711,201.789 243.305,196.914C238.898,192.039 233.32,188.992 226.57,187.773C221.602,186.836 211.617,186.367 196.617,186.367L176.508,186.367Z' style='fill-rule:nonzero;stroke:white;stroke-width:5.18px;stroke-linecap:butt;stroke-miterlimit:2'/></g><g transform='matrix(0.928279,0,0,1.4205,-49.905,24.9033)'><path d='M203.878,117.764L203.878,127.469C203.878,130.147 200.551,132.321 196.453,132.321L178.898,132.321C174.8,132.321 171.473,130.147 171.473,127.469L171.473,117.764C171.473,115.086 174.8,112.912 178.898,112.912L196.453,112.912C200.551,112.912 203.878,115.086 203.878,117.764Z'/></g><g transform='matrix(0.928279,0,0,1.4205,153.545,24.9033)'><path d='M203.878,117.764L203.878,127.469C203.878,130.147 200.551,132.321 196.453,132.321L178.898,132.321C174.8,132.321 171.473,130.147 171.473,127.469L171.473,117.764C171.473,115.086 174.8,112.912 178.898,112.912L196.453,112.912C200.551,112.912 203.878,115.086 203.878,117.764Z'/></g><g transform='matrix(0.928279,0,0,1.4205,-4.51372,24.9033)'><path d='M203.878,117.764L203.878,127.469C203.878,130.147 200.551,132.321 196.453,132.321L178.898,132.321C174.8,132.321 171.473,130.147 171.473,127.469L171.473,117.764C171.473,115.086 174.8,112.912 178.898,112.912L196.453,112.912C200.551,112.912 203.878,115.086 203.878,117.764Z'/></g><g transform='matrix(0.928279,0,0,1.4205,198.937,24.9033)'><path d='M203.878,117.764L203.878,127.469C203.878,130.147 200.551,132.321 196.453,132.321L178.898,132.321C174.8,132.321 171.473,130.147 171.473,127.469L171.473,117.764C171.473,115.086 174.8,112.912 178.898,112.912L196.453,112.912C200.551,112.912 203.878,115.086 203.878,117.764Z'/></g></svg>"
    />
    <script>
      // Set theme before page renders to avoid flash
      const theme = localStorage.getItem("theme") || "system";
      if (
        theme === "dark" ||
        (theme === "system" &&
          window.matchMedia("(prefers-color-scheme: dark)").matches)
      ) {
        document.documentElement.classList.add("dark");
      }
    </script>
    <script type="module">var fa,Ue,Wg,Jn,yd,Zg,Yg,Xg,Hc,Vl,zl,fo={},Qg=[],Jw=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ha=Array.isArray;function dn(t,e){for(var n in e)t[n]=e[n];return t}function Gc(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Kw(t,e,n){var r,o,s,i={};for(s in e)s=="key"?r=e[s]:s=="ref"?o=e[s]:i[s]=e[s];if(arguments.length>2&&(i.children=arguments.length>3?fa.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(s in t.defaultProps)i[s]===void 0&&(i[s]=t.defaultProps[s]);return yi(t,i,r,o,null)}function yi(t,e,n,r,o){var s={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++Wg,__i:-1,__u:0};return o==null&&Ue.vnode!=null&&Ue.vnode(s),s}function en(t){return t.children}function vi(t,e){this.props=t,this.context=e}function Tr(t,e){if(e==null)return t.__?Tr(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?Tr(t):null}function jg(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return jg(t)}}function vd(t){(!t.__d&&(t.__d=!0)&&Jn.push(t)&&!Mi.__r++||yd!=Ue.debounceRendering)&&((yd=Ue.debounceRendering)||Zg)(Mi)}function Mi(){for(var t,e,n,r,o,s,i,a=1;Jn.length;)Jn.length>a&&Jn.sort(Yg),t=Jn.shift(),a=Jn.length,t.__d&&(n=void 0,r=void 0,o=(r=(e=t).__v).__e,s=[],i=[],e.__P&&((n=dn({},r)).__v=r.__v+1,Ue.vnode&&Ue.vnode(n),Bc(e.__P,n,r,e.__n,e.__P.namespaceURI,32&r.__u?[o]:null,s,o??Tr(r),!!(32&r.__u),i),n.__v=r.__v,n.__.__k[n.__i]=n,n_(s,n,i),r.__e=r.__=null,n.__e!=o&&jg(n)));Mi.__r=0}function e_(t,e,n,r,o,s,i,a,l,c,u){var h,p,m,w,E,_,v,g=r&&r.__k||Qg,S=e.length;for(l=Ww(n,e,g,l,S),h=0;h<S;h++)(m=n.__k[h])!=null&&(p=m.__i==-1?fo:g[m.__i]||fo,m.__i=h,_=Bc(t,m,p,o,s,i,a,l,c,u),w=m.__e,m.ref&&p.ref!=m.ref&&(p.ref&&Jc(p.ref,null,m),u.push(m.ref,m.__c||w,m)),E==null&&w!=null&&(E=w),(v=!!(4&m.__u))||p.__k===m.__k?l=t_(m,l,t,v):typeof m.type=="function"&&_!==void 0?l=_:w&&(l=w.nextSibling),m.__u&=-7);return n.__e=E,l}function Ww(t,e,n,r,o){var s,i,a,l,c,u=n.length,h=u,p=0;for(t.__k=new Array(o),s=0;s<o;s++)(i=e[s])!=null&&typeof i!="boolean"&&typeof i!="function"?(typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?i=t.__k[s]=yi(null,i,null,null,null):ha(i)?i=t.__k[s]=yi(en,{children:i},null,null,null):i.constructor===void 0&&i.__b>0?i=t.__k[s]=yi(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):t.__k[s]=i,l=s+p,i.__=t,i.__b=t.__b+1,a=null,(c=i.__i=Zw(i,n,l,h))!=-1&&(h--,(a=n[c])&&(a.__u|=2)),a==null||a.__v==null?(c==-1&&(o>u?p--:o<u&&p++),typeof i.type!="function"&&(i.__u|=4)):c!=l&&(c==l-1?p--:c==l+1?p++:(c>l?p--:p++,i.__u|=4))):t.__k[s]=null;if(h)for(s=0;s<u;s++)(a=n[s])!=null&&(2&a.__u)==0&&(a.__e==r&&(r=Tr(a)),o_(a,a));return r}function t_(t,e,n,r){var o,s;if(typeof t.type=="function"){for(o=t.__k,s=0;o&&s<o.length;s++)o[s]&&(o[s].__=t,e=t_(o[s],e,n,r));return e}t.__e!=e&&(r&&(e&&t.type&&!e.parentNode&&(e=Tr(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Zw(t,e,n,r){var o,s,i,a=t.key,l=t.type,c=e[n],u=c!=null&&(2&c.__u)==0;if(c===null&&a==null||u&&a==c.key&&l==c.type)return n;if(r>(u?1:0)){for(o=n-1,s=n+1;o>=0||s<e.length;)if((c=e[i=o>=0?o--:s++])!=null&&(2&c.__u)==0&&a==c.key&&l==c.type)return i}return-1}function wd(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Jw.test(e)?n:n+"px"}function Po(t,e,n,r,o){var s,i;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||wd(t.style,e,"");if(n)for(e in n)r&&n[e]==r[e]||wd(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(Xg,"$1")),i=e.toLowerCase(),e=i in t||e=="onFocusOut"||e=="onFocusIn"?i.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+s]=n,n?r?n.u=r.u:(n.u=Hc,t.addEventListener(e,s?zl:Vl,s)):t.removeEventListener(e,s?zl:Vl,s);else{if(o=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function Sd(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=Hc++;else if(e.t<n.u)return;return n(Ue.event?Ue.event(e):e)}}}function Bc(t,e,n,r,o,s,i,a,l,c){var u,h,p,m,w,E,_,v,g,S,b,y,C,k,P,M,q,D=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(l=!!(32&n.__u),s=[a=e.__e=n.__e]),(u=Ue.__b)&&u(e);e:if(typeof D=="function")try{if(v=e.props,g="prototype"in D&&D.prototype.render,S=(u=D.contextType)&&r[u.__c],b=u?S?S.props.value:u.__:r,n.__c?_=(h=e.__c=n.__c).__=h.__E:(g?e.__c=h=new D(v,b):(e.__c=h=new vi(v,b),h.constructor=D,h.render=Xw),S&&S.sub(h),h.state||(h.state={}),h.__n=r,p=h.__d=!0,h.__h=[],h._sb=[]),g&&h.__s==null&&(h.__s=h.state),g&&D.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=dn({},h.__s)),dn(h.__s,D.getDerivedStateFromProps(v,h.__s))),m=h.props,w=h.state,h.__v=e,p)g&&D.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),g&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(g&&D.getDerivedStateFromProps==null&&v!==m&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(v,b),e.__v==n.__v||!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(v,h.__s,b)===!1){for(e.__v!=n.__v&&(h.props=v,h.state=h.__s,h.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(G){G&&(G.__=e)}),y=0;y<h._sb.length;y++)h.__h.push(h._sb[y]);h._sb=[],h.__h.length&&i.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(v,h.__s,b),g&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(m,w,E)})}if(h.context=b,h.props=v,h.__P=t,h.__e=!1,C=Ue.__r,k=0,g){for(h.state=h.__s,h.__d=!1,C&&C(e),u=h.render(h.props,h.state,h.context),P=0;P<h._sb.length;P++)h.__h.push(h._sb[P]);h._sb=[]}else do h.__d=!1,C&&C(e),u=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++k<25);h.state=h.__s,h.getChildContext!=null&&(r=dn(dn({},r),h.getChildContext())),g&&!p&&h.getSnapshotBeforeUpdate!=null&&(E=h.getSnapshotBeforeUpdate(m,w)),M=u,u!=null&&u.type===en&&u.key==null&&(M=r_(u.props.children)),a=e_(t,ha(M)?M:[M],e,n,r,o,s,i,a,l,c),h.base=e.__e,e.__u&=-161,h.__h.length&&i.push(h),_&&(h.__E=h.__=null)}catch(G){if(e.__v=null,l||s!=null)if(G.then){for(e.__u|=l?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;s[s.indexOf(a)]=null,e.__e=a}else{for(q=s.length;q--;)Gc(s[q]);Hl(e)}else e.__e=n.__e,e.__k=n.__k,G.then||Hl(e);Ue.__e(G,e,n)}else s==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):a=e.__e=Yw(n.__e,e,n,r,o,s,i,l,c);return(u=Ue.diffed)&&u(e),128&e.__u?void 0:a}function Hl(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(Hl)}function n_(t,e,n){for(var r=0;r<n.length;r++)Jc(n[r],n[++r],n[++r]);Ue.__c&&Ue.__c(e,t),t.some(function(o){try{t=o.__h,o.__h=[],t.some(function(s){s.call(o)})}catch(s){Ue.__e(s,o.__v)}})}function r_(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:ha(t)?t.map(r_):dn({},t)}function Yw(t,e,n,r,o,s,i,a,l){var c,u,h,p,m,w,E,_=n.props||fo,v=e.props,g=e.type;if(g=="svg"?o="http://www.w3.org/2000/svg":g=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),s!=null){for(c=0;c<s.length;c++)if((m=s[c])&&"setAttribute"in m==!!g&&(g?m.localName==g:m.nodeType==3)){t=m,s[c]=null;break}}if(t==null){if(g==null)return document.createTextNode(v);t=document.createElementNS(o,g,v.is&&v),a&&(Ue.__m&&Ue.__m(e,s),a=!1),s=null}if(g==null)_===v||a&&t.data==v||(t.data=v);else{if(s=s&&fa.call(t.childNodes),!a&&s!=null)for(_={},c=0;c<t.attributes.length;c++)_[(m=t.attributes[c]).name]=m.value;for(c in _)if(m=_[c],c!="children"){if(c=="dangerouslySetInnerHTML")h=m;else if(!(c in v)){if(c=="value"&&"defaultValue"in v||c=="checked"&&"defaultChecked"in v)continue;Po(t,c,null,m,o)}}for(c in v)m=v[c],c=="children"?p=m:c=="dangerouslySetInnerHTML"?u=m:c=="value"?w=m:c=="checked"?E=m:a&&typeof m!="function"||_[c]===m||Po(t,c,m,_[c],o);if(u)a||h&&(u.__html==h.__html||u.__html==t.innerHTML)||(t.innerHTML=u.__html),e.__k=[];else if(h&&(t.innerHTML=""),e_(e.type=="template"?t.content:t,ha(p)?p:[p],e,n,r,g=="foreignObject"?"http://www.w3.org/1999/xhtml":o,s,i,s?s[0]:n.__k&&Tr(n,0),a,l),s!=null)for(c=s.length;c--;)Gc(s[c]);a||(c="value",g=="progress"&&w==null?t.removeAttribute("value"):w!=null&&(w!==t[c]||g=="progress"&&!w||g=="option"&&w!=_[c])&&Po(t,c,w,_[c],o),c="checked",E!=null&&E!=t[c]&&Po(t,c,E,_[c],o))}return t}function Jc(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(o){Ue.__e(o,n)}}function o_(t,e,n){var r,o;if(Ue.unmount&&Ue.unmount(t),(r=t.ref)&&(r.current&&r.current!=t.__e||Jc(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(s){Ue.__e(s,e)}r.base=r.__P=null}if(r=t.__k)for(o=0;o<r.length;o++)r[o]&&o_(r[o],e,n||typeof t.type!="function");n||Gc(t.__e),t.__c=t.__=t.__e=void 0}function Xw(t,e,n){return this.constructor(t,n)}function Qw(t,e,n){var r,o,s,i;e==document&&(e=document.documentElement),Ue.__&&Ue.__(t,e),o=(r=!1)?null:e.__k,s=[],i=[],Bc(e,t=e.__k=Kw(en,null,[t]),o||fo,fo,e.namespaceURI,o?null:e.firstChild?fa.call(e.childNodes):null,s,o?o.__e:e.firstChild,r,i),n_(s,t,i)}fa=Qg.slice,Ue={__e:function(t,e,n,r){for(var o,s,i;e=e.__;)if((o=e.__c)&&!o.__)try{if((s=o.constructor)&&s.getDerivedStateFromError!=null&&(o.setState(s.getDerivedStateFromError(t)),i=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(t,r||{}),i=o.__d),i)return o.__E=o}catch(a){t=a}throw t}},Wg=0,vi.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=dn({},this.state),typeof t=="function"&&(t=t(dn({},n),this.props)),t&&dn(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),vd(this))},vi.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),vd(this))},vi.prototype.render=en,Jn=[],Zg=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Yg=function(t,e){return t.__v.__b-e.__v.__b},Mi.__r=0,Xg=/(PointerCapture)$|Capture$/i,Hc=0,Vl=Sd(!1),zl=Sd(!0);var jw=0;function U(t,e,n,r,o,s){e||(e={});var i,a,l=e;if("ref"in l)for(a in l={},e)a=="ref"?i=e[a]:l[a]=e[a];var c={type:t,props:l,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--jw,__i:-1,__u:0,__source:o,__self:s};if(typeof t=="function"&&(i=t.defaultProps))for(a in i)l[a]===void 0&&(l[a]=i[a]);return Ue.vnode&&Ue.vnode(c),c}var ho,Ze,Qa,Ed,po=0,s_=[],Ye=Ue,Td=Ye.__b,bd=Ye.__r,Cd=Ye.diffed,kd=Ye.__c,Id=Ye.unmount,Rd=Ye.__;function Kc(t,e){Ye.__h&&Ye.__h(Ze,t,po||e),po=0;var n=Ze.__H||(Ze.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function Ae(t){return po=1,eS(a_,t)}function eS(t,e,n){var r=Kc(ho++,2);if(r.t=t,!r.__c&&(r.__=[a_(void 0,e),function(a){var l=r.__N?r.__N[0]:r.__[0],c=r.t(l,a);l!==c&&(r.__N=[c,r.__[1]],r.__c.setState({}))}],r.__c=Ze,!Ze.__f)){var o=function(a,l,c){if(!r.__c.__H)return!0;var u=r.__c.__H.__.filter(function(p){return!!p.__c});if(u.every(function(p){return!p.__N}))return!s||s.call(this,a,l,c);var h=r.__c.props!==a;return u.forEach(function(p){if(p.__N){var m=p.__[0];p.__=p.__N,p.__N=void 0,m!==p.__[0]&&(h=!0)}}),s&&s.call(this,a,l,c)||h};Ze.__f=!0;var s=Ze.shouldComponentUpdate,i=Ze.componentWillUpdate;Ze.componentWillUpdate=function(a,l,c){if(this.__e){var u=s;s=void 0,o(a,l,c),s=u}i&&i.call(this,a,l,c)},Ze.shouldComponentUpdate=o}return r.__N||r.__}function fn(t,e){var n=Kc(ho++,3);!Ye.__s&&i_(n.__H,e)&&(n.__=t,n.u=e,Ze.__H.__h.push(n))}function En(t){return po=5,vr(function(){return{current:t}},[])}function vr(t,e){var n=Kc(ho++,7);return i_(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Et(t,e){return po=8,vr(function(){return t},e)}function tS(){for(var t;t=s_.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(wi),t.__H.__h.forEach(Gl),t.__H.__h=[]}catch(e){t.__H.__h=[],Ye.__e(e,t.__v)}}Ye.__b=function(t){Ze=null,Td&&Td(t)},Ye.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Rd&&Rd(t,e)},Ye.__r=function(t){bd&&bd(t),ho=0;var e=(Ze=t.__c).__H;e&&(Qa===Ze?(e.__h=[],Ze.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(wi),e.__h.forEach(Gl),e.__h=[],ho=0)),Qa=Ze},Ye.diffed=function(t){Cd&&Cd(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(s_.push(e)!==1&&Ed===Ye.requestAnimationFrame||((Ed=Ye.requestAnimationFrame)||nS)(tS)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Qa=Ze=null},Ye.__c=function(t,e){e.some(function(n){try{n.__h.forEach(wi),n.__h=n.__h.filter(function(r){return!r.__||Gl(r)})}catch(r){e.some(function(o){o.__h&&(o.__h=[])}),e=[],Ye.__e(r,n.__v)}}),kd&&kd(t,e)},Ye.unmount=function(t){Id&&Id(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{wi(r)}catch(o){e=o}}),n.__H=void 0,e&&Ye.__e(e,n.__v))};var $d=typeof requestAnimationFrame=="function";function nS(t){var e,n=function(){clearTimeout(r),$d&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,35);$d&&(e=requestAnimationFrame(n))}function wi(t){var e=Ze,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),Ze=e}function Gl(t){var e=Ze;t.__c=t.__(),Ze=e}function i_(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function a_(t,e){return typeof e=="function"?e(t):e}var rS={};let oS,sS;function iS(){return{geminiUrl:oS,vertexUrl:sS}}function aS(t,e,n,r){var o,s;if(!t?.baseUrl){const i=iS();return e?(o=i.vertexUrl)!==null&&o!==void 0?o:n:(s=i.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}class pn{}function ne(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const s=e[o];return s!=null?String(s):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function f(t,e,n){for(let s=0;s<e.length-1;s++){const i=e[s];if(i.endsWith("[]")){const a=i.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${i}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let c=0;c<l.length;c++){const u=l[c];f(u,e.slice(s+1),n[c])}else for(const c of l)f(c,e.slice(s+1),n)}return}else if(i.endsWith("[0]")){const a=i.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];f(l[0],e.slice(s+1),n);return}(!t[i]||typeof t[i]!="object")&&(t[i]={}),t=t[i]}const r=e[e.length-1],o=t[r];if(o!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===o)return;if(typeof o=="object"&&typeof n=="object"&&o!==null&&n!==null)Object.assign(o,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function d(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const o=e[r];if(o.endsWith("[]")){const s=o.slice(0,-2);if(s in t){const i=t[s];return Array.isArray(i)?i.map(a=>d(a,e.slice(r+1),n)):n}else return n}else t=t[o]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function lS(t,e){for(const[n,r]of Object.entries(e)){const o=n.split("."),s=r.split("."),i=new Set;let a=-1;for(let l=0;l<o.length;l++)if(o[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const c=s[l];c!=="*"&&!c.endsWith("[]")&&!c.endsWith("[0]")&&i.add(c)}Bl(t,o,s,0,i)}}function Bl(t,e,n,r,o){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const i=s.slice(0,-2),a=t;if(i in a&&Array.isArray(a[i]))for(const l of a[i])Bl(l,e,n,r+1,o)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const i=t,a=Object.keys(i).filter(c=>!c.startsWith("_")&&!o.has(c)),l={};for(const c of a)l[c]=i[c];for(const[c,u]of Object.entries(l)){const h=[];for(const p of n.slice(r))p==="*"?h.push(c):h.push(p);f(i,h,u)}for(const c of a)delete i[c]}}else{const i=t;s in i&&Bl(i[s],e,n,r+1,o)}}function Wc(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function cS(t){const e={},n=d(t,["operationName"]);n!=null&&f(e,["operationName"],n);const r=d(t,["resourceName"]);return r!=null&&f(e,["_url","resourceName"],r),e}function uS(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const o=d(t,["done"]);o!=null&&f(e,["done"],o);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const i=d(t,["response","generateVideoResponse"]);return i!=null&&f(e,["response"],fS(i)),e}function dS(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const o=d(t,["done"]);o!=null&&f(e,["done"],o);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const i=d(t,["response"]);return i!=null&&f(e,["response"],hS(i)),e}function fS(t){const e={},n=d(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>pS(i))),f(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const o=d(t,["raiMediaFilteredReasons"]);return o!=null&&f(e,["raiMediaFilteredReasons"],o),e}function hS(t){const e={},n=d(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>mS(i))),f(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const o=d(t,["raiMediaFilteredReasons"]);return o!=null&&f(e,["raiMediaFilteredReasons"],o),e}function pS(t){const e={},n=d(t,["video"]);return n!=null&&f(e,["video"],SS(n)),e}function mS(t){const e={},n=d(t,["_self"]);return n!=null&&f(e,["video"],ES(n)),e}function gS(t){const e={},n=d(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function _S(t){const e={},n=d(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function yS(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const o=d(t,["done"]);o!=null&&f(e,["done"],o);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const i=d(t,["response"]);return i!=null&&f(e,["response"],vS(i)),e}function vS(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["parent"]);r!=null&&f(e,["parent"],r);const o=d(t,["documentName"]);return o!=null&&f(e,["documentName"],o),e}function l_(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const o=d(t,["done"]);o!=null&&f(e,["done"],o);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const i=d(t,["response"]);return i!=null&&f(e,["response"],wS(i)),e}function wS(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["parent"]);r!=null&&f(e,["parent"],r);const o=d(t,["documentName"]);return o!=null&&f(e,["documentName"],o),e}function SS(t){const e={},n=d(t,["uri"]);n!=null&&f(e,["uri"],n);const r=d(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],Wc(r));const o=d(t,["encoding"]);return o!=null&&f(e,["mimeType"],o),e}function ES(t){const e={},n=d(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],Wc(r));const o=d(t,["mimeType"]);return o!=null&&f(e,["mimeType"],o),e}var Ad;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Ad||(Ad={}));var Pd;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Pd||(Pd={}));var Nd;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Nd||(Nd={}));var Sn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Sn||(Sn={}));var Md;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Md||(Md={}));var xd;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(xd||(xd={}));var Dd;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Dd||(Dd={}));var Od;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Od||(Od={}));var Ud;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Ud||(Ud={}));var Ld;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Ld||(Ld={}));var Jl;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(Jl||(Jl={}));var qd;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(qd||(qd={}));var Fd;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Fd||(Fd={}));var Vd;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Vd||(Vd={}));var zd;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(zd||(zd={}));var Hd;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(Hd||(Hd={}));var Gd;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Gd||(Gd={}));var Bd;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Bd||(Bd={}));var Jd;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Jd||(Jd={}));var Kd;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(Kd||(Kd={}));var Wd;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Wd||(Wd={}));var xi;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(xi||(xi={}));var Zd;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Zd||(Zd={}));var Yd;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Yd||(Yd={}));var Xd;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Xd||(Xd={}));var Kl;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Kl||(Kl={}));var Qd;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Qd||(Qd={}));var jd;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(jd||(jd={}));var Wl;(function(t){t.COLLECTION="COLLECTION"})(Wl||(Wl={}));var ef;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(ef||(ef={}));var tf;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(tf||(tf={}));var nf;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(nf||(nf={}));var rf;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(rf||(rf={}));var of;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(of||(of={}));var sf;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(sf||(sf={}));var af;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(af||(af={}));var lf;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(lf||(lf={}));var cf;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(cf||(cf={}));var uf;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(uf||(uf={}));var df;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(df||(df={}));var ff;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(ff||(ff={}));var hf;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(hf||(hf={}));var pf;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING",t.DISTILLATION="DISTILLATION"})(pf||(pf={}));var mf;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(mf||(mf={}));var gf;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(gf||(gf={}));var _f;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED",t.REGISTERED="REGISTERED"})(_f||(_f={}));var yf;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(yf||(yf={}));var vf;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(vf||(vf={}));var wf;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(wf||(wf={}));var Sf;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.ACTIVITY_START="ACTIVITY_START",t.ACTIVITY_END="ACTIVITY_END"})(Sf||(Sf={}));var Ef;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ef||(Ef={}));var Tf;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Tf||(Tf={}));var bf;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(bf||(bf={}));var Cf;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Cf||(Cf={}));var kf;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(kf||(kf={}));var If;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(If||(If={}));var pr;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(pr||(pr={}));class Zl{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Ur{get text(){var e,n,r,o,s,i,a,l;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",u=!1;const h=[];for(const p of(l=(a=(i=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[m,w]of Object.entries(p))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(w!==null||w!==void 0)&&h.push(m);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;u=!0,c+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?c:void 0}get data(){var e,n,r,o,s,i,a,l;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const u=[];for(const h of(l=(a=(i=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[p,m]of Object.entries(h))p!=="inlineData"&&(m!==null||m!==void 0)&&u.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(c+=atob(h.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,n,r,o,s,i,a,l;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(l=(a=(i=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(u=>u.functionCall).map(u=>u.functionCall).filter(u=>u!==void 0);if(c?.length!==0)return c}get executableCode(){var e,n,r,o,s,i,a,l,c;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const u=(l=(a=(i=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if(u?.length!==0)return(c=u?.[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,n,r,o,s,i,a,l,c;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const u=(l=(a=(i=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if(u?.length!==0)return(c=u?.[0])===null||c===void 0?void 0:c.output}}class Rf{}class $f{}class TS{}class bS{}class CS{}class kS{}class Af{}class Pf{}class Nf{}class IS{}class Di{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Di;let o;const s=e;return n?o=dS(s):o=uS(s),Object.assign(r,o),r}}class Mf{}class xf{}class Df{}class Of{}class RS{}class $S{}class AS{}class Zc{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Zc,s=yS(e);return Object.assign(r,s),r}}class PS{}class NS{}class MS{}class xS{}class Uf{}class DS{get text(){var e,n,r;let o="",s=!1;const i=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(a))l!=="text"&&l!=="thought"&&c!==null&&i.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,o+=a.text}}return i.length>0&&console.warn(`there are non-text parts ${i} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?o:void 0}get data(){var e,n,r;let o="";const s=[];for(const i of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(i))a!=="inlineData"&&l!==null&&s.push(a);i.inlineData&&typeof i.inlineData.data=="string"&&(o+=atob(i.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class OS{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Yc{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Yc,s=l_(e);return Object.assign(r,s),r}}function ke(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function c_(t,e){const n=ke(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function u_(t){return Array.isArray(t)?t.map(e=>Oi(e)):[Oi(t)]}function Oi(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function d_(t){const e=Oi(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function f_(t){const e=Oi(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Lf(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function h_(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Lf(e)):[Lf(t)]}function Yl(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function qf(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Ff(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function pt(t){if(t==null)throw new Error("ContentUnion is required");return Yl(t)?t:{role:"user",parts:h_(t)}}function Xc(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=pt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=pt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>pt(n)):[pt(e)]}function Mt(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(qf(t)||Ff(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[pt(t)]}const e=[],n=[],r=Yl(t[0]);for(const o of t){const s=Yl(o);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(o);else{if(qf(o)||Ff(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(o)}}return r||e.push({role:"user",parts:h_(n)}),e}function US(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Sn).includes(n[0].toUpperCase())?n[0].toUpperCase():Sn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Sn).includes(r.toUpperCase())?r.toUpperCase():Sn.TYPE_UNSPECIFIED})}}function wr(t){const e={},n=["items"],r=["anyOf"],o=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&US(t.type,e);for(const[i,a]of Object.entries(t))if(a!=null)if(i=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(Sn).includes(a.toUpperCase())?a.toUpperCase():Sn.TYPE_UNSPECIFIED}else if(n.includes(i))e[i]=wr(a);else if(r.includes(i)){const l=[];for(const c of a){if(c.type=="null"){e.nullable=!0;continue}l.push(wr(c))}e[i]=l}else if(o.includes(i)){const l={};for(const[c,u]of Object.entries(a))l[c]=wr(u);e[i]=l}else{if(i==="additionalProperties")continue;e[i]=a}return e}function Qc(t){return wr(t)}function jc(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function eu(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Rr(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=wr(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=wr(e.response));return t}function $r(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function LS(t,e,n,r=1){const o=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:o?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:o?`${n}/${e}`:e}function mn(t,e){if(typeof e!="string")throw new Error("name must be a string");return LS(t,e,"cachedContents")}function p_(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Cn(t){return Wc(t)}function qS(t){return t!=null&&typeof t=="object"&&"name"in t}function FS(t){return t!=null&&typeof t=="object"&&"video"in t}function VS(t){return t!=null&&typeof t=="object"&&"uri"in t}function m_(t){var e;let n;if(qS(t)&&(n=t.name),!(VS(t)&&(n=t.uri,n===void 0))&&!(FS(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const o=n.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${n}`);n=o[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function g_(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function __(t){for(const e of["models","tunedModels","publisherModels"])if(zS(t,e))return t[e];return[]}function zS(t,e){return t!==null&&typeof t=="object"&&e in t}function HS(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function GS(t,e={}){const n=[],r=new Set;for(const o of t){const s=o.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const i=HS(o,e);i.functionDeclarations&&n.push(...i.functionDeclarations)}return{functionDeclarations:n}}function y_(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,o=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(o>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function BS(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function v_(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const o=n.inlinedResponses;if(!Array.isArray(o)||o.length===0)return t;let s=!1;for(const i of o){if(typeof i!="object"||i===null)continue;const l=i.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Ar(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function w_(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function JS(t){const e={},n=d(t,["responsesFile"]);n!=null&&f(e,["fileName"],n);const r=d(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>kE(i))),f(e,["inlinedResponses"],s)}const o=d(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>i)),f(e,["inlinedEmbedContentResponses"],s)}return e}function KS(t){const e={},n=d(t,["predictionsFormat"]);n!=null&&f(e,["format"],n);const r=d(t,["gcsDestination","outputUriPrefix"]);r!=null&&f(e,["gcsUri"],r);const o=d(t,["bigqueryDestination","outputUri"]);return o!=null&&f(e,["bigqueryUri"],o),e}function WS(t){const e={},n=d(t,["format"]);n!=null&&f(e,["predictionsFormat"],n);const r=d(t,["gcsUri"]);r!=null&&f(e,["gcsDestination","outputUriPrefix"],r);const o=d(t,["bigqueryUri"]);if(o!=null&&f(e,["bigqueryDestination","outputUri"],o),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Si(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata","displayName"]);r!=null&&f(e,["displayName"],r);const o=d(t,["metadata","state"]);o!=null&&f(e,["state"],w_(o));const s=d(t,["metadata","createTime"]);s!=null&&f(e,["createTime"],s);const i=d(t,["metadata","endTime"]);i!=null&&f(e,["endTime"],i);const a=d(t,["metadata","updateTime"]);a!=null&&f(e,["updateTime"],a);const l=d(t,["metadata","model"]);l!=null&&f(e,["model"],l);const c=d(t,["metadata","output"]);return c!=null&&f(e,["dest"],JS(v_(c))),e}function Xl(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["displayName"]);r!=null&&f(e,["displayName"],r);const o=d(t,["state"]);o!=null&&f(e,["state"],w_(o));const s=d(t,["error"]);s!=null&&f(e,["error"],s);const i=d(t,["createTime"]);i!=null&&f(e,["createTime"],i);const a=d(t,["startTime"]);a!=null&&f(e,["startTime"],a);const l=d(t,["endTime"]);l!=null&&f(e,["endTime"],l);const c=d(t,["updateTime"]);c!=null&&f(e,["updateTime"],c);const u=d(t,["model"]);u!=null&&f(e,["model"],u);const h=d(t,["inputConfig"]);h!=null&&f(e,["src"],ZS(h));const p=d(t,["outputConfig"]);p!=null&&f(e,["dest"],KS(v_(p)));const m=d(t,["completionStats"]);return m!=null&&f(e,["completionStats"],m),e}function ZS(t){const e={},n=d(t,["instancesFormat"]);n!=null&&f(e,["format"],n);const r=d(t,["gcsSource","uris"]);r!=null&&f(e,["gcsUri"],r);const o=d(t,["bigquerySource","inputUri"]);return o!=null&&f(e,["bigqueryUri"],o),e}function YS(t,e){const n={};if(d(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=d(e,["fileName"]);r!=null&&f(n,["fileName"],r);const o=d(e,["inlinedRequests"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>CE(t,i))),f(n,["requests","requests"],s)}return n}function XS(t){const e={},n=d(t,["format"]);n!=null&&f(e,["instancesFormat"],n);const r=d(t,["gcsUri"]);r!=null&&f(e,["gcsSource","uris"],r);const o=d(t,["bigqueryUri"]);if(o!=null&&f(e,["bigquerySource","inputUri"],o),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function QS(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function jS(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ar(t,r)),n}function eE(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ar(t,r)),n}function tE(t){const e={},n=d(t,["content"]);n!=null&&f(e,["content"],n);const r=d(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],nE(r));const o=d(t,["tokenCount"]);o!=null&&f(e,["tokenCount"],o);const s=d(t,["finishReason"]);s!=null&&f(e,["finishReason"],s);const i=d(t,["avgLogprobs"]);i!=null&&f(e,["avgLogprobs"],i);const a=d(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=d(t,["index"]);l!=null&&f(e,["index"],l);const c=d(t,["logprobsResult"]);c!=null&&f(e,["logprobsResult"],c);const u=d(t,["safetyRatings"]);if(u!=null){let p=u;Array.isArray(p)&&(p=p.map(m=>m)),f(e,["safetyRatings"],p)}const h=d(t,["urlContextMetadata"]);return h!=null&&f(e,["urlContextMetadata"],h),e}function nE(t){const e={},n=d(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["citations"],r)}return e}function S_(t){const e={},n=d(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>ME(s))),f(e,["parts"],o)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function rE(t,e){const n={},r=d(t,["displayName"]);if(e!==void 0&&r!=null&&f(e,["batch","displayName"],r),d(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function oE(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const o=d(t,["dest"]);return e!==void 0&&o!=null&&f(e,["outputConfig"],WS(BS(o))),n}function Vf(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],ke(t,r));const o=d(e,["src"]);o!=null&&f(n,["batch","inputConfig"],YS(t,y_(t,o)));const s=d(e,["config"]);return s!=null&&rE(s,n),n}function sE(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],ke(t,r));const o=d(e,["src"]);o!=null&&f(n,["inputConfig"],XS(y_(t,o)));const s=d(e,["config"]);return s!=null&&oE(s,n),n}function iE(t,e){const n={},r=d(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["batch","displayName"],r),n}function aE(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],ke(t,r));const o=d(e,["src"]);o!=null&&f(n,["batch","inputConfig"],pE(t,o));const s=d(e,["config"]);return s!=null&&iE(s,n),n}function lE(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ar(t,r)),n}function cE(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ar(t,r)),n}function uE(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const o=d(t,["done"]);o!=null&&f(e,["done"],o);const s=d(t,["error"]);return s!=null&&f(e,["error"],s),e}function dE(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const o=d(t,["done"]);o!=null&&f(e,["done"],o);const s=d(t,["error"]);return s!=null&&f(e,["error"],s),e}function fE(t,e){const n={},r=d(e,["contents"]);if(r!=null){let s=Xc(t,r);Array.isArray(s)&&(s=s.map(i=>i)),f(n,["requests[]","request","content"],s)}const o=d(e,["config"]);return o!=null&&(f(n,["_self"],hE(o,n)),lS(n,{"requests[].*":"requests[].request.*"})),n}function hE(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const o=d(t,["title"]);e!==void 0&&o!=null&&f(e,["requests[]","title"],o);const s=d(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&f(e,["requests[]","outputDimensionality"],s),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function pE(t,e){const n={},r=d(e,["fileName"]);r!=null&&f(n,["file_name"],r);const o=d(e,["inlinedRequests"]);return o!=null&&f(n,["requests"],fE(t,o)),n}function mE(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function gE(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const o=d(t,["name"]);if(o!=null&&f(e,["name"],o),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function _E(t){const e={},n=d(t,["allowedFunctionNames"]);n!=null&&f(e,["allowedFunctionNames"],n);const r=d(t,["mode"]);if(r!=null&&f(e,["mode"],r),d(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function yE(t,e,n){const r={},o=d(e,["systemInstruction"]);n!==void 0&&o!=null&&f(n,["systemInstruction"],S_(pt(o)));const s=d(e,["temperature"]);s!=null&&f(r,["temperature"],s);const i=d(e,["topP"]);i!=null&&f(r,["topP"],i);const a=d(e,["topK"]);a!=null&&f(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const c=d(e,["maxOutputTokens"]);c!=null&&f(r,["maxOutputTokens"],c);const u=d(e,["stopSequences"]);u!=null&&f(r,["stopSequences"],u);const h=d(e,["responseLogprobs"]);h!=null&&f(r,["responseLogprobs"],h);const p=d(e,["logprobs"]);p!=null&&f(r,["logprobs"],p);const m=d(e,["presencePenalty"]);m!=null&&f(r,["presencePenalty"],m);const w=d(e,["frequencyPenalty"]);w!=null&&f(r,["frequencyPenalty"],w);const E=d(e,["seed"]);E!=null&&f(r,["seed"],E);const _=d(e,["responseMimeType"]);_!=null&&f(r,["responseMimeType"],_);const v=d(e,["responseSchema"]);v!=null&&f(r,["responseSchema"],Qc(v));const g=d(e,["responseJsonSchema"]);if(g!=null&&f(r,["responseJsonSchema"],g),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=d(e,["safetySettings"]);if(n!==void 0&&S!=null){let B=S;Array.isArray(B)&&(B=B.map(K=>xE(K))),f(n,["safetySettings"],B)}const b=d(e,["tools"]);if(n!==void 0&&b!=null){let B=$r(b);Array.isArray(B)&&(B=B.map(K=>OE(Rr(K)))),f(n,["tools"],B)}const y=d(e,["toolConfig"]);if(n!==void 0&&y!=null&&f(n,["toolConfig"],DE(y)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const C=d(e,["cachedContent"]);n!==void 0&&C!=null&&f(n,["cachedContent"],mn(t,C));const k=d(e,["responseModalities"]);k!=null&&f(r,["responseModalities"],k);const P=d(e,["mediaResolution"]);P!=null&&f(r,["mediaResolution"],P);const M=d(e,["speechConfig"]);if(M!=null&&f(r,["speechConfig"],jc(M)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const q=d(e,["thinkingConfig"]);q!=null&&f(r,["thinkingConfig"],q);const D=d(e,["imageConfig"]);D!=null&&f(r,["imageConfig"],bE(D));const G=d(e,["enableEnhancedCivicAnswers"]);if(G!=null&&f(r,["enableEnhancedCivicAnswers"],G),d(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function vE(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>tE(c))),f(e,["candidates"],l)}const o=d(t,["modelVersion"]);o!=null&&f(e,["modelVersion"],o);const s=d(t,["promptFeedback"]);s!=null&&f(e,["promptFeedback"],s);const i=d(t,["responseId"]);i!=null&&f(e,["responseId"],i);const a=d(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function wE(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ar(t,r)),n}function SE(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ar(t,r)),n}function EE(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function TE(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function bE(t){const e={},n=d(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=d(t,["imageSize"]);if(r!=null&&f(e,["imageSize"],r),d(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(d(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function CE(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["request","model"],ke(t,r));const o=d(e,["contents"]);if(o!=null){let a=Mt(o);Array.isArray(a)&&(a=a.map(l=>S_(l))),f(n,["request","contents"],a)}const s=d(e,["metadata"]);s!=null&&f(n,["metadata"],s);const i=d(e,["config"]);return i!=null&&f(n,["request","generationConfig"],yE(t,i,d(n,["request"],{}))),n}function kE(t){const e={},n=d(t,["response"]);n!=null&&f(e,["response"],vE(n));const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const o=d(t,["error"]);return o!=null&&f(e,["error"],o),e}function IE(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const o=d(t,["pageToken"]);if(e!==void 0&&o!=null&&f(e,["_query","pageToken"],o),d(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function RE(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const o=d(t,["pageToken"]);e!==void 0&&o!=null&&f(e,["_query","pageToken"],o);const s=d(t,["filter"]);return e!==void 0&&s!=null&&f(e,["_query","filter"],s),n}function $E(t){const e={},n=d(t,["config"]);return n!=null&&IE(n,e),e}function AE(t){const e={},n=d(t,["config"]);return n!=null&&RE(n,e),e}function PE(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const o=d(t,["operations"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>Si(i))),f(e,["batchJobs"],s)}return e}function NE(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const o=d(t,["batchPredictionJobs"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>Xl(i))),f(e,["batchJobs"],s)}return e}function ME(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const o=d(t,["executableCode"]);o!=null&&f(e,["executableCode"],o);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],mE(s));const i=d(t,["functionCall"]);i!=null&&f(e,["functionCall"],gE(i));const a=d(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(t,["inlineData"]);l!=null&&f(e,["inlineData"],QS(l));const c=d(t,["text"]);c!=null&&f(e,["text"],c);const u=d(t,["thought"]);u!=null&&f(e,["thought"],u);const h=d(t,["thoughtSignature"]);h!=null&&f(e,["thoughtSignature"],h);const p=d(t,["videoMetadata"]);return p!=null&&f(e,["videoMetadata"],p),e}function xE(t){const e={},n=d(t,["category"]);if(n!=null&&f(e,["category"],n),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function DE(t){const e={},n=d(t,["retrievalConfig"]);n!=null&&f(e,["retrievalConfig"],n);const r=d(t,["functionCallingConfig"]);return r!=null&&f(e,["functionCallingConfig"],_E(r)),e}function OE(t){const e={};if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=d(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=d(t,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(h=>h)),f(e,["functionDeclarations"],u)}const i=d(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],EE(i));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],TE(a));const l=d(t,["googleSearchRetrieval"]);l!=null&&f(e,["googleSearchRetrieval"],l);const c=d(t,["urlContext"]);return c!=null&&f(e,["urlContext"],c),e}var hn;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(hn||(hn={}));class Qn{constructor(e,n,r,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,o)}init(e,n,r){var o,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n?.sdkHttpResponse,this.idxInternal=0;let i={config:{}};!r||Object.keys(r).length===0?i={config:{}}:typeof r=="object"?i=Object.assign({},r):i=r,i.config&&(i.config.pageToken=n.nextPageToken),this.paramsInternal=i,this.pageInternalSize=(s=(o=i.config)===null||o===void 0?void 0:o.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}let UE=class extends pn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Qn(hn.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=Vf(this.apiClient,e),r=n._url,o=ne("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,c=[];for(const u of l){const h=Object.assign({},u);if(h.systemInstruction){const p=h.systemInstruction;delete h.systemInstruction;const m=h.request;m.systemInstruction=p,h.request=m}c.push(h)}return a.requests=c,delete n.config,delete n._url,delete n._query,{path:o,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},o=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${o}`),r.dest===void 0){const s=this.getGcsUri(e),i=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${o}`;else if(i)r.dest=`${i}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=sE(this.apiClient,e);return a=ne("batchPredictionJobs",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>Xl(u))}else{const c=Vf(this.apiClient,e);return a=ne("{model}:batchGenerateContent",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),i.then(u=>Si(u))}}async createEmbeddingsInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=aE(this.apiClient,e);return s=ne("{model}:asyncBatchEmbedContent",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>Si(l))}}async get(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=SE(this.apiClient,e);return a=ne("batchPredictionJobs/{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>Xl(u))}else{const c=wE(this.apiClient,e);return a=ne("batches/{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),i.then(u=>Si(u))}}async cancel(e){var n,r,o,s;let i="",a={};if(this.apiClient.isVertexAI()){const l=eE(this.apiClient,e);i=ne("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=jS(this.apiClient,e);i=ne("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=AE(e);return a=ne("batchPredictionJobs",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=NE(u),p=new Uf;return Object.assign(p,h),p})}else{const c=$E(e);return a=ne("batches",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=PE(u),p=new Uf;return Object.assign(p,h),p})}}async delete(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=cE(this.apiClient,e);return a=ne("batchPredictionJobs/{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>dE(u))}else{const c=lE(this.apiClient,e);return a=ne("batches/{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>uE(u))}}};function LE(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function zf(t){const e={},n=d(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>aT(s))),f(e,["parts"],o)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function qE(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const o=d(t,["expireTime"]);e!==void 0&&o!=null&&f(e,["expireTime"],o);const s=d(t,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const i=d(t,["contents"]);if(e!==void 0&&i!=null){let u=Mt(i);Array.isArray(u)&&(u=u.map(h=>zf(h))),f(e,["contents"],u)}const a=d(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],zf(pt(a)));const l=d(t,["tools"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(h=>cT(h))),f(e,["tools"],u)}const c=d(t,["toolConfig"]);if(e!==void 0&&c!=null&&f(e,["toolConfig"],lT(c)),d(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function FE(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const o=d(t,["expireTime"]);e!==void 0&&o!=null&&f(e,["expireTime"],o);const s=d(t,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const i=d(t,["contents"]);if(e!==void 0&&i!=null){let h=Mt(i);Array.isArray(h)&&(h=h.map(p=>p)),f(e,["contents"],h)}const a=d(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],pt(a));const l=d(t,["tools"]);if(e!==void 0&&l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>uT(p))),f(e,["tools"],h)}const c=d(t,["toolConfig"]);e!==void 0&&c!=null&&f(e,["toolConfig"],c);const u=d(t,["kmsKeyName"]);return e!==void 0&&u!=null&&f(e,["encryption_spec","kmsKeyName"],u),n}function VE(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],c_(t,r));const o=d(e,["config"]);return o!=null&&qE(o,n),n}function zE(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],c_(t,r));const o=d(e,["config"]);return o!=null&&FE(o,n),n}function HE(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],mn(t,r)),n}function GE(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],mn(t,r)),n}function BE(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function JE(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function KE(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function WE(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const o=d(t,["name"]);if(o!=null&&f(e,["name"],o),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function ZE(t){const e={},n=d(t,["allowedFunctionNames"]);n!=null&&f(e,["allowedFunctionNames"],n);const r=d(t,["mode"]);if(r!=null&&f(e,["mode"],r),d(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function YE(t){const e={},n=d(t,["description"]);n!=null&&f(e,["description"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const o=d(t,["parameters"]);o!=null&&f(e,["parameters"],o);const s=d(t,["parametersJsonSchema"]);s!=null&&f(e,["parametersJsonSchema"],s);const i=d(t,["response"]);i!=null&&f(e,["response"],i);const a=d(t,["responseJsonSchema"]);if(a!=null&&f(e,["responseJsonSchema"],a),d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function XE(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],mn(t,r)),n}function QE(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],mn(t,r)),n}function jE(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function eT(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function tT(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const o=d(t,["pageToken"]);return e!==void 0&&o!=null&&f(e,["_query","pageToken"],o),n}function nT(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const o=d(t,["pageToken"]);return e!==void 0&&o!=null&&f(e,["_query","pageToken"],o),n}function rT(t){const e={},n=d(t,["config"]);return n!=null&&tT(n,e),e}function oT(t){const e={},n=d(t,["config"]);return n!=null&&nT(n,e),e}function sT(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const o=d(t,["cachedContents"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>i)),f(e,["cachedContents"],s)}return e}function iT(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const o=d(t,["cachedContents"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>i)),f(e,["cachedContents"],s)}return e}function aT(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const o=d(t,["executableCode"]);o!=null&&f(e,["executableCode"],o);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],KE(s));const i=d(t,["functionCall"]);i!=null&&f(e,["functionCall"],WE(i));const a=d(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(t,["inlineData"]);l!=null&&f(e,["inlineData"],LE(l));const c=d(t,["text"]);c!=null&&f(e,["text"],c);const u=d(t,["thought"]);u!=null&&f(e,["thought"],u);const h=d(t,["thoughtSignature"]);h!=null&&f(e,["thoughtSignature"],h);const p=d(t,["videoMetadata"]);return p!=null&&f(e,["videoMetadata"],p),e}function lT(t){const e={},n=d(t,["retrievalConfig"]);n!=null&&f(e,["retrievalConfig"],n);const r=d(t,["functionCallingConfig"]);return r!=null&&f(e,["functionCallingConfig"],ZE(r)),e}function cT(t){const e={};if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=d(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=d(t,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(h=>h)),f(e,["functionDeclarations"],u)}const i=d(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],jE(i));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],eT(a));const l=d(t,["googleSearchRetrieval"]);l!=null&&f(e,["googleSearchRetrieval"],l);const c=d(t,["urlContext"]);return c!=null&&f(e,["urlContext"],c),e}function uT(t){const e={},n=d(t,["retrieval"]);n!=null&&f(e,["retrieval"],n);const r=d(t,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),d(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=d(t,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const s=d(t,["enterpriseWebSearch"]);s!=null&&f(e,["enterpriseWebSearch"],s);const i=d(t,["functionDeclarations"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(p=>YE(p))),f(e,["functionDeclarations"],h)}const a=d(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const l=d(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],l);const c=d(t,["googleSearchRetrieval"]);c!=null&&f(e,["googleSearchRetrieval"],c);const u=d(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function dT(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const o=d(t,["expireTime"]);return e!==void 0&&o!=null&&f(e,["expireTime"],o),n}function fT(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const o=d(t,["expireTime"]);return e!==void 0&&o!=null&&f(e,["expireTime"],o),n}function hT(t,e){const n={},r=d(e,["name"]);r!=null&&f(n,["_url","name"],mn(t,r));const o=d(e,["config"]);return o!=null&&dT(o,n),n}function pT(t,e){const n={},r=d(e,["name"]);r!=null&&f(n,["_url","name"],mn(t,r));const o=d(e,["config"]);return o!=null&&fT(o,n),n}class mT extends pn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Qn(hn.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=zE(this.apiClient,e);return a=ne("cachedContents",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}else{const c=VE(this.apiClient,e);return a=ne("cachedContents",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async get(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=QE(this.apiClient,e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}else{const c=XE(this.apiClient,e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async delete(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=GE(this.apiClient,e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=JE(u),p=new Df;return Object.assign(p,h),p})}else{const c=HE(this.apiClient,e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=BE(u),p=new Df;return Object.assign(p,h),p})}}async update(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=pT(this.apiClient,e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}else{const c=hT(this.apiClient,e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async listInternal(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=oT(e);return a=ne("cachedContents",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=iT(u),p=new Of;return Object.assign(p,h),p})}else{const c=rT(e);return a=ne("cachedContents",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=sT(u),p=new Of;return Object.assign(p,h),p})}}}function Ui(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function Hf(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function he(t){return this instanceof he?(this.v=t,this):new he(t)}function Jt(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),o,s=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",i),o[Symbol.asyncIterator]=function(){return this},o;function i(m){return function(w){return Promise.resolve(w).then(m,h)}}function a(m,w){r[m]&&(o[m]=function(E){return new Promise(function(_,v){s.push([m,E,_,v])>1||l(m,E)})},w&&(o[m]=w(o[m])))}function l(m,w){try{c(r[m](w))}catch(E){p(s[0][3],E)}}function c(m){m.value instanceof he?Promise.resolve(m.value.v).then(u,h):p(s[0][2],m)}function u(m){l("next",m)}function h(m){l("throw",m)}function p(m,w){m(w),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Kt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Hf=="function"?Hf(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(i){return new Promise(function(a,l){i=t[s](i),o(a,l,i.done,i.value)})}}function o(s,i,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},i)}}function gT(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:E_(n)}function E_(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function _T(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Gf(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const o=[];let s=!0;for(;r<n&&t[r].role==="model";)o.push(t[r]),s&&!E_(t[r])&&(s=!1),r++;s?e.push(...o):e.pop()}return e}class yT{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new vT(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}let vT=class{constructor(e,n,r,o={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=o,this.history=s,this.sendPromise=Promise.resolve(),_T(s)}async sendMessage(e){var n;await this.sendPromise;const r=pt(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,i,a;const l=await o,c=(i=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content,u=l.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let p=[];u!=null&&(p=(a=u.slice(h))!==null&&a!==void 0?a:[]);const m=c?[c]:[];this.recordHistory(r,m,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var n;await this.sendPromise;const r=pt(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const s=await o;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?Gf(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return Jt(this,arguments,function*(){var o,s,i,a,l,c;const u=[];try{for(var h=!0,p=Kt(e),m;m=yield he(p.next()),o=m.done,!o;h=!0){a=m.value,h=!1;const w=a;if(gT(w)){const E=(c=(l=w.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content;E!==void 0&&u.push(E)}yield yield he(w)}}catch(w){s={error:w}}finally{try{!h&&!o&&(i=p.return)&&(yield he(i.call(p)))}finally{if(s)throw s.error}}this.recordHistory(n,u)})}recordHistory(e,n,r){let o=[];n.length>0&&n.every(s=>s.role!==void 0)?o=n:o.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...Gf(r)):this.history.push(e),this.history.push(...o)}};class mo extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,mo.prototype)}}function wT(t){const e={},n=d(t,["file"]);return n!=null&&f(e,["file"],n),e}function ST(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function ET(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","file"],m_(n)),e}function TT(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function bT(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","file"],m_(n)),e}function CT(t){const e={},n=d(t,["uris"]);return n!=null&&f(e,["uris"],n),e}function kT(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const o=d(t,["pageToken"]);return e!==void 0&&o!=null&&f(e,["_query","pageToken"],o),n}function IT(t){const e={},n=d(t,["config"]);return n!=null&&kT(n,e),e}function RT(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const o=d(t,["files"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>i)),f(e,["files"],s)}return e}function $T(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["files"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),f(e,["files"],o)}return e}let AT=class extends pn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Qn(hn.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async registerFiles(e){throw new Error("registerFiles is only supported in Node.js environments.")}async _registerFiles(e){return this.registerFilesInternal(e)}async listInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=IT(e);return s=ne("files",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),o.then(l=>{const c=RT(l),u=new PS;return Object.assign(u,c),u})}}async createInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=wT(e);return s=ne("upload/v1beta/files",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{const c=ST(l),u=new NS;return Object.assign(u,c),u})}}async get(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=bT(e);return s=ne("files/{file}",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>l)}}async delete(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=ET(e);return s=ne("files/{file}",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),o.then(l=>{const c=TT(l),u=new MS;return Object.assign(u,c),u})}}async registerFilesInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=CT(e);return s=ne("files:register",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{const c=$T(l),u=new xS;return Object.assign(u,c),u})}}};function Ei(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function PT(t){const e={},n=d(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>KT(s))),f(e,["parts"],o)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function NT(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function MT(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const o=d(t,["name"]);if(o!=null&&f(e,["name"],o),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function xT(t){const e={},n=d(t,["description"]);n!=null&&f(e,["description"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const o=d(t,["parameters"]);o!=null&&f(e,["parameters"],o);const s=d(t,["parametersJsonSchema"]);s!=null&&f(e,["parametersJsonSchema"],s);const i=d(t,["response"]);i!=null&&f(e,["response"],i);const a=d(t,["responseJsonSchema"]);if(a!=null&&f(e,["responseJsonSchema"],a),d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function DT(t){const e={},n=d(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=d(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const o=d(t,["audioTimestamp"]);o!=null&&f(e,["audioTimestamp"],o);const s=d(t,["candidateCount"]);s!=null&&f(e,["candidateCount"],s);const i=d(t,["enableAffectiveDialog"]);i!=null&&f(e,["enableAffectiveDialog"],i);const a=d(t,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const l=d(t,["logprobs"]);l!=null&&f(e,["logprobs"],l);const c=d(t,["maxOutputTokens"]);c!=null&&f(e,["maxOutputTokens"],c);const u=d(t,["mediaResolution"]);u!=null&&f(e,["mediaResolution"],u);const h=d(t,["presencePenalty"]);h!=null&&f(e,["presencePenalty"],h);const p=d(t,["responseLogprobs"]);p!=null&&f(e,["responseLogprobs"],p);const m=d(t,["responseMimeType"]);m!=null&&f(e,["responseMimeType"],m);const w=d(t,["responseModalities"]);w!=null&&f(e,["responseModalities"],w);const E=d(t,["responseSchema"]);E!=null&&f(e,["responseSchema"],E);const _=d(t,["routingConfig"]);_!=null&&f(e,["routingConfig"],_);const v=d(t,["seed"]);v!=null&&f(e,["seed"],v);const g=d(t,["speechConfig"]);g!=null&&f(e,["speechConfig"],g);const S=d(t,["stopSequences"]);S!=null&&f(e,["stopSequences"],S);const b=d(t,["temperature"]);b!=null&&f(e,["temperature"],b);const y=d(t,["thinkingConfig"]);y!=null&&f(e,["thinkingConfig"],y);const C=d(t,["topK"]);C!=null&&f(e,["topK"],C);const k=d(t,["topP"]);if(k!=null&&f(e,["topP"],k),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function OT(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function UT(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function LT(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const o=d(t,["responseModalities"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","responseModalities"],o);const s=d(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const i=d(t,["topP"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","topP"],i);const a=d(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const c=d(t,["mediaResolution"]);e!==void 0&&c!=null&&f(e,["setup","generationConfig","mediaResolution"],c);const u=d(t,["seed"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","seed"],u);const h=d(t,["speechConfig"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","speechConfig"],eu(h));const p=d(t,["thinkingConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","thinkingConfig"],p);const m=d(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],m);const w=d(t,["systemInstruction"]);e!==void 0&&w!=null&&f(e,["setup","systemInstruction"],PT(pt(w)));const E=d(t,["tools"]);if(e!==void 0&&E!=null){let C=$r(E);Array.isArray(C)&&(C=C.map(k=>ZT(Rr(k)))),f(e,["setup","tools"],C)}const _=d(t,["sessionResumption"]);e!==void 0&&_!=null&&f(e,["setup","sessionResumption"],WT(_));const v=d(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","inputAudioTranscription"],v);const g=d(t,["outputAudioTranscription"]);e!==void 0&&g!=null&&f(e,["setup","outputAudioTranscription"],g);const S=d(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&f(e,["setup","realtimeInputConfig"],S);const b=d(t,["contextWindowCompression"]);e!==void 0&&b!=null&&f(e,["setup","contextWindowCompression"],b);const y=d(t,["proactivity"]);if(e!==void 0&&y!=null&&f(e,["setup","proactivity"],y),d(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function qT(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],DT(r));const o=d(t,["responseModalities"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","responseModalities"],o);const s=d(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const i=d(t,["topP"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","topP"],i);const a=d(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const c=d(t,["mediaResolution"]);e!==void 0&&c!=null&&f(e,["setup","generationConfig","mediaResolution"],c);const u=d(t,["seed"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","seed"],u);const h=d(t,["speechConfig"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","speechConfig"],eu(h));const p=d(t,["thinkingConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","thinkingConfig"],p);const m=d(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],m);const w=d(t,["systemInstruction"]);e!==void 0&&w!=null&&f(e,["setup","systemInstruction"],pt(w));const E=d(t,["tools"]);if(e!==void 0&&E!=null){let k=$r(E);Array.isArray(k)&&(k=k.map(P=>YT(Rr(P)))),f(e,["setup","tools"],k)}const _=d(t,["sessionResumption"]);e!==void 0&&_!=null&&f(e,["setup","sessionResumption"],_);const v=d(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","inputAudioTranscription"],v);const g=d(t,["outputAudioTranscription"]);e!==void 0&&g!=null&&f(e,["setup","outputAudioTranscription"],g);const S=d(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&f(e,["setup","realtimeInputConfig"],S);const b=d(t,["contextWindowCompression"]);e!==void 0&&b!=null&&f(e,["setup","contextWindowCompression"],b);const y=d(t,["proactivity"]);e!==void 0&&y!=null&&f(e,["setup","proactivity"],y);const C=d(t,["explicitVadSignal"]);return e!==void 0&&C!=null&&f(e,["setup","explicitVadSignal"],C),n}function FT(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],ke(t,r));const o=d(e,["config"]);return o!=null&&f(n,["config"],LT(o,n)),n}function VT(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],ke(t,r));const o=d(e,["config"]);return o!=null&&f(n,["config"],qT(o,n)),n}function zT(t){const e={},n=d(t,["musicGenerationConfig"]);return n!=null&&f(e,["musicGenerationConfig"],n),e}function HT(t){const e={},n=d(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["weightedPrompts"],r)}return e}function GT(t){const e={},n=d(t,["media"]);if(n!=null){let c=u_(n);Array.isArray(c)&&(c=c.map(u=>Ei(u))),f(e,["mediaChunks"],c)}const r=d(t,["audio"]);r!=null&&f(e,["audio"],Ei(f_(r)));const o=d(t,["audioStreamEnd"]);o!=null&&f(e,["audioStreamEnd"],o);const s=d(t,["video"]);s!=null&&f(e,["video"],Ei(d_(s)));const i=d(t,["text"]);i!=null&&f(e,["text"],i);const a=d(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=d(t,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function BT(t){const e={},n=d(t,["media"]);if(n!=null){let c=u_(n);Array.isArray(c)&&(c=c.map(u=>u)),f(e,["mediaChunks"],c)}const r=d(t,["audio"]);r!=null&&f(e,["audio"],f_(r));const o=d(t,["audioStreamEnd"]);o!=null&&f(e,["audioStreamEnd"],o);const s=d(t,["video"]);s!=null&&f(e,["video"],d_(s));const i=d(t,["text"]);i!=null&&f(e,["text"],i);const a=d(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=d(t,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function JT(t){const e={},n=d(t,["setupComplete"]);n!=null&&f(e,["setupComplete"],n);const r=d(t,["serverContent"]);r!=null&&f(e,["serverContent"],r);const o=d(t,["toolCall"]);o!=null&&f(e,["toolCall"],o);const s=d(t,["toolCallCancellation"]);s!=null&&f(e,["toolCallCancellation"],s);const i=d(t,["usageMetadata"]);i!=null&&f(e,["usageMetadata"],XT(i));const a=d(t,["goAway"]);a!=null&&f(e,["goAway"],a);const l=d(t,["sessionResumptionUpdate"]);l!=null&&f(e,["sessionResumptionUpdate"],l);const c=d(t,["voiceActivityDetectionSignal"]);c!=null&&f(e,["voiceActivityDetectionSignal"],c);const u=d(t,["voiceActivity"]);return u!=null&&f(e,["voiceActivity"],QT(u)),e}function KT(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const o=d(t,["executableCode"]);o!=null&&f(e,["executableCode"],o);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],NT(s));const i=d(t,["functionCall"]);i!=null&&f(e,["functionCall"],MT(i));const a=d(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(t,["inlineData"]);l!=null&&f(e,["inlineData"],Ei(l));const c=d(t,["text"]);c!=null&&f(e,["text"],c);const u=d(t,["thought"]);u!=null&&f(e,["thought"],u);const h=d(t,["thoughtSignature"]);h!=null&&f(e,["thoughtSignature"],h);const p=d(t,["videoMetadata"]);return p!=null&&f(e,["videoMetadata"],p),e}function WT(t){const e={},n=d(t,["handle"]);if(n!=null&&f(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function ZT(t){const e={};if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=d(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=d(t,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(h=>h)),f(e,["functionDeclarations"],u)}const i=d(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],OT(i));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],UT(a));const l=d(t,["googleSearchRetrieval"]);l!=null&&f(e,["googleSearchRetrieval"],l);const c=d(t,["urlContext"]);return c!=null&&f(e,["urlContext"],c),e}function YT(t){const e={},n=d(t,["retrieval"]);n!=null&&f(e,["retrieval"],n);const r=d(t,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),d(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=d(t,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const s=d(t,["enterpriseWebSearch"]);s!=null&&f(e,["enterpriseWebSearch"],s);const i=d(t,["functionDeclarations"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(p=>xT(p))),f(e,["functionDeclarations"],h)}const a=d(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const l=d(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],l);const c=d(t,["googleSearchRetrieval"]);c!=null&&f(e,["googleSearchRetrieval"],c);const u=d(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function XT(t){const e={},n=d(t,["promptTokenCount"]);n!=null&&f(e,["promptTokenCount"],n);const r=d(t,["cachedContentTokenCount"]);r!=null&&f(e,["cachedContentTokenCount"],r);const o=d(t,["candidatesTokenCount"]);o!=null&&f(e,["responseTokenCount"],o);const s=d(t,["toolUsePromptTokenCount"]);s!=null&&f(e,["toolUsePromptTokenCount"],s);const i=d(t,["thoughtsTokenCount"]);i!=null&&f(e,["thoughtsTokenCount"],i);const a=d(t,["totalTokenCount"]);a!=null&&f(e,["totalTokenCount"],a);const l=d(t,["promptTokensDetails"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(w=>w)),f(e,["promptTokensDetails"],m)}const c=d(t,["cacheTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(w=>w)),f(e,["cacheTokensDetails"],m)}const u=d(t,["candidatesTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(w=>w)),f(e,["responseTokensDetails"],m)}const h=d(t,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(w=>w)),f(e,["toolUsePromptTokensDetails"],m)}const p=d(t,["trafficType"]);return p!=null&&f(e,["trafficType"],p),e}function QT(t){const e={},n=d(t,["type"]);return n!=null&&f(e,["voiceActivityType"],n),e}function jT(t,e){const n={},r=d(t,["data"]);if(r!=null&&f(n,["data"],r),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=d(t,["mimeType"]);return o!=null&&f(n,["mimeType"],o),n}function eb(t,e){const n={},r=d(t,["content"]);r!=null&&f(n,["content"],r);const o=d(t,["citationMetadata"]);o!=null&&f(n,["citationMetadata"],tb(o));const s=d(t,["tokenCount"]);s!=null&&f(n,["tokenCount"],s);const i=d(t,["finishReason"]);i!=null&&f(n,["finishReason"],i);const a=d(t,["avgLogprobs"]);a!=null&&f(n,["avgLogprobs"],a);const l=d(t,["groundingMetadata"]);l!=null&&f(n,["groundingMetadata"],l);const c=d(t,["index"]);c!=null&&f(n,["index"],c);const u=d(t,["logprobsResult"]);u!=null&&f(n,["logprobsResult"],u);const h=d(t,["safetyRatings"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(w=>w)),f(n,["safetyRatings"],m)}const p=d(t,["urlContextMetadata"]);return p!=null&&f(n,["urlContextMetadata"],p),n}function tb(t,e){const n={},r=d(t,["citationSources"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),f(n,["citations"],o)}return n}function nb(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["contents"]);if(s!=null){let i=Mt(s);Array.isArray(i)&&(i=i.map(a=>a)),f(r,["contents"],i)}return r}function rb(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["tokensInfo"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>i)),f(n,["tokensInfo"],s)}return n}function ob(t,e){const n={},r=d(t,["values"]);r!=null&&f(n,["values"],r);const o=d(t,["statistics"]);return o!=null&&f(n,["statistics"],sb(o)),n}function sb(t,e){const n={},r=d(t,["truncated"]);r!=null&&f(n,["truncated"],r);const o=d(t,["token_count"]);return o!=null&&f(n,["tokenCount"],o),n}function pa(t,e){const n={},r=d(t,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>pC(i))),f(n,["parts"],s)}const o=d(t,["role"]);return o!=null&&f(n,["role"],o),n}function ib(t,e){const n={},r=d(t,["controlType"]);r!=null&&f(n,["controlType"],r);const o=d(t,["enableControlImageComputation"]);return o!=null&&f(n,["computeControl"],o),n}function ab(t,e){const n={};if(d(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return n}function lb(t,e,n){const r={},o=d(t,["systemInstruction"]);e!==void 0&&o!=null&&f(e,["systemInstruction"],pt(o));const s=d(t,["tools"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>k_(l))),f(e,["tools"],a)}const i=d(t,["generationConfig"]);return e!==void 0&&i!=null&&f(e,["generationConfig"],jb(i)),r}function cb(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["contents"]);if(s!=null){let a=Mt(s);Array.isArray(a)&&(a=a.map(l=>pa(l))),f(r,["contents"],a)}const i=d(e,["config"]);return i!=null&&ab(i),r}function ub(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["contents"]);if(s!=null){let a=Mt(s);Array.isArray(a)&&(a=a.map(l=>l)),f(r,["contents"],a)}const i=d(e,["config"]);return i!=null&&lb(i,r),r}function db(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["totalTokens"]);o!=null&&f(n,["totalTokens"],o);const s=d(t,["cachedContentTokenCount"]);return s!=null&&f(n,["cachedContentTokenCount"],s),n}function fb(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["totalTokens"]);return o!=null&&f(n,["totalTokens"],o),n}function hb(t,e,n){const r={},o=d(e,["model"]);return o!=null&&f(r,["_url","name"],ke(t,o)),r}function pb(t,e,n){const r={},o=d(e,["model"]);return o!=null&&f(r,["_url","name"],ke(t,o)),r}function mb(t,e){const n={},r=d(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function gb(t,e){const n={},r=d(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function _b(t,e,n){const r={},o=d(t,["outputGcsUri"]);e!==void 0&&o!=null&&f(e,["parameters","storageUri"],o);const s=d(t,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const i=d(t,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const a=d(t,["aspectRatio"]);e!==void 0&&a!=null&&f(e,["parameters","aspectRatio"],a);const l=d(t,["guidanceScale"]);e!==void 0&&l!=null&&f(e,["parameters","guidanceScale"],l);const c=d(t,["seed"]);e!==void 0&&c!=null&&f(e,["parameters","seed"],c);const u=d(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const h=d(t,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=d(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const m=d(t,["includeRaiReason"]);e!==void 0&&m!=null&&f(e,["parameters","includeRaiReason"],m);const w=d(t,["language"]);e!==void 0&&w!=null&&f(e,["parameters","language"],w);const E=d(t,["outputMimeType"]);e!==void 0&&E!=null&&f(e,["parameters","outputOptions","mimeType"],E);const _=d(t,["outputCompressionQuality"]);e!==void 0&&_!=null&&f(e,["parameters","outputOptions","compressionQuality"],_);const v=d(t,["addWatermark"]);e!==void 0&&v!=null&&f(e,["parameters","addWatermark"],v);const g=d(t,["labels"]);e!==void 0&&g!=null&&f(e,["labels"],g);const S=d(t,["editMode"]);e!==void 0&&S!=null&&f(e,["parameters","editMode"],S);const b=d(t,["baseSteps"]);return e!==void 0&&b!=null&&f(e,["parameters","editConfig","baseSteps"],b),r}function yb(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["prompt"]);s!=null&&f(r,["instances[0]","prompt"],s);const i=d(e,["referenceImages"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>wC(c))),f(r,["instances[0]","referenceImages"],l)}const a=d(e,["config"]);return a!=null&&_b(a,r),r}function vb(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["predictions"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>ma(i))),f(n,["generatedImages"],s)}return n}function wb(t,e,n){const r={},o=d(t,["taskType"]);e!==void 0&&o!=null&&f(e,["requests[]","taskType"],o);const s=d(t,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const i=d(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&f(e,["requests[]","outputDimensionality"],i),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function Sb(t,e,n){const r={},o=d(t,["taskType"]);e!==void 0&&o!=null&&f(e,["instances[]","task_type"],o);const s=d(t,["title"]);e!==void 0&&s!=null&&f(e,["instances[]","title"],s);const i=d(t,["outputDimensionality"]);e!==void 0&&i!=null&&f(e,["parameters","outputDimensionality"],i);const a=d(t,["mimeType"]);e!==void 0&&a!=null&&f(e,["instances[]","mimeType"],a);const l=d(t,["autoTruncate"]);return e!==void 0&&l!=null&&f(e,["parameters","autoTruncate"],l),r}function Eb(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["contents"]);if(s!=null){let l=Xc(t,s);Array.isArray(l)&&(l=l.map(c=>c)),f(r,["requests[]","content"],l)}const i=d(e,["config"]);i!=null&&wb(i,r);const a=d(e,["model"]);return a!==void 0&&f(r,["requests[]","model"],ke(t,a)),r}function Tb(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["contents"]);if(s!=null){let a=Xc(t,s);Array.isArray(a)&&(a=a.map(l=>l)),f(r,["instances[]","content"],a)}const i=d(e,["config"]);return i!=null&&Sb(i,r),r}function bb(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["embeddings"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>a)),f(n,["embeddings"],i)}const s=d(t,["metadata"]);return s!=null&&f(n,["metadata"],s),n}function Cb(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["predictions[]","embeddings"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>ob(a))),f(n,["embeddings"],i)}const s=d(t,["metadata"]);return s!=null&&f(n,["metadata"],s),n}function kb(t,e){const n={},r=d(t,["endpoint"]);r!=null&&f(n,["name"],r);const o=d(t,["deployedModelId"]);return o!=null&&f(n,["deployedModelId"],o),n}function Ib(t,e){const n={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["fileUri"]);r!=null&&f(n,["fileUri"],r);const o=d(t,["mimeType"]);return o!=null&&f(n,["mimeType"],o),n}function Rb(t,e){const n={},r=d(t,["id"]);r!=null&&f(n,["id"],r);const o=d(t,["args"]);o!=null&&f(n,["args"],o);const s=d(t,["name"]);if(s!=null&&f(n,["name"],s),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return n}function $b(t,e){const n={},r=d(t,["allowedFunctionNames"]);r!=null&&f(n,["allowedFunctionNames"],r);const o=d(t,["mode"]);if(o!=null&&f(n,["mode"],o),d(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return n}function Ab(t,e){const n={},r=d(t,["description"]);r!=null&&f(n,["description"],r);const o=d(t,["name"]);o!=null&&f(n,["name"],o);const s=d(t,["parameters"]);s!=null&&f(n,["parameters"],s);const i=d(t,["parametersJsonSchema"]);i!=null&&f(n,["parametersJsonSchema"],i);const a=d(t,["response"]);a!=null&&f(n,["response"],a);const l=d(t,["responseJsonSchema"]);if(l!=null&&f(n,["responseJsonSchema"],l),d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return n}function Pb(t,e,n,r){const o={},s=d(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],pa(pt(s)));const i=d(e,["temperature"]);i!=null&&f(o,["temperature"],i);const a=d(e,["topP"]);a!=null&&f(o,["topP"],a);const l=d(e,["topK"]);l!=null&&f(o,["topK"],l);const c=d(e,["candidateCount"]);c!=null&&f(o,["candidateCount"],c);const u=d(e,["maxOutputTokens"]);u!=null&&f(o,["maxOutputTokens"],u);const h=d(e,["stopSequences"]);h!=null&&f(o,["stopSequences"],h);const p=d(e,["responseLogprobs"]);p!=null&&f(o,["responseLogprobs"],p);const m=d(e,["logprobs"]);m!=null&&f(o,["logprobs"],m);const w=d(e,["presencePenalty"]);w!=null&&f(o,["presencePenalty"],w);const E=d(e,["frequencyPenalty"]);E!=null&&f(o,["frequencyPenalty"],E);const _=d(e,["seed"]);_!=null&&f(o,["seed"],_);const v=d(e,["responseMimeType"]);v!=null&&f(o,["responseMimeType"],v);const g=d(e,["responseSchema"]);g!=null&&f(o,["responseSchema"],Qc(g));const S=d(e,["responseJsonSchema"]);if(S!=null&&f(o,["responseJsonSchema"],S),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=d(e,["safetySettings"]);if(n!==void 0&&b!=null){let K=b;Array.isArray(K)&&(K=K.map(oe=>SC(oe))),f(n,["safetySettings"],K)}const y=d(e,["tools"]);if(n!==void 0&&y!=null){let K=$r(y);Array.isArray(K)&&(K=K.map(oe=>RC(Rr(oe)))),f(n,["tools"],K)}const C=d(e,["toolConfig"]);if(n!==void 0&&C!=null&&f(n,["toolConfig"],IC(C)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=d(e,["cachedContent"]);n!==void 0&&k!=null&&f(n,["cachedContent"],mn(t,k));const P=d(e,["responseModalities"]);P!=null&&f(o,["responseModalities"],P);const M=d(e,["mediaResolution"]);M!=null&&f(o,["mediaResolution"],M);const q=d(e,["speechConfig"]);if(q!=null&&f(o,["speechConfig"],jc(q)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const D=d(e,["thinkingConfig"]);D!=null&&f(o,["thinkingConfig"],D);const G=d(e,["imageConfig"]);G!=null&&f(o,["imageConfig"],oC(G));const B=d(e,["enableEnhancedCivicAnswers"]);if(B!=null&&f(o,["enableEnhancedCivicAnswers"],B),d(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return o}function Nb(t,e,n,r){const o={},s=d(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],pt(s));const i=d(e,["temperature"]);i!=null&&f(o,["temperature"],i);const a=d(e,["topP"]);a!=null&&f(o,["topP"],a);const l=d(e,["topK"]);l!=null&&f(o,["topK"],l);const c=d(e,["candidateCount"]);c!=null&&f(o,["candidateCount"],c);const u=d(e,["maxOutputTokens"]);u!=null&&f(o,["maxOutputTokens"],u);const h=d(e,["stopSequences"]);h!=null&&f(o,["stopSequences"],h);const p=d(e,["responseLogprobs"]);p!=null&&f(o,["responseLogprobs"],p);const m=d(e,["logprobs"]);m!=null&&f(o,["logprobs"],m);const w=d(e,["presencePenalty"]);w!=null&&f(o,["presencePenalty"],w);const E=d(e,["frequencyPenalty"]);E!=null&&f(o,["frequencyPenalty"],E);const _=d(e,["seed"]);_!=null&&f(o,["seed"],_);const v=d(e,["responseMimeType"]);v!=null&&f(o,["responseMimeType"],v);const g=d(e,["responseSchema"]);g!=null&&f(o,["responseSchema"],Qc(g));const S=d(e,["responseJsonSchema"]);S!=null&&f(o,["responseJsonSchema"],S);const b=d(e,["routingConfig"]);b!=null&&f(o,["routingConfig"],b);const y=d(e,["modelSelectionConfig"]);y!=null&&f(o,["modelConfig"],y);const C=d(e,["safetySettings"]);if(n!==void 0&&C!=null){let ee=C;Array.isArray(ee)&&(ee=ee.map(ge=>ge)),f(n,["safetySettings"],ee)}const k=d(e,["tools"]);if(n!==void 0&&k!=null){let ee=$r(k);Array.isArray(ee)&&(ee=ee.map(ge=>k_(Rr(ge)))),f(n,["tools"],ee)}const P=d(e,["toolConfig"]);n!==void 0&&P!=null&&f(n,["toolConfig"],P);const M=d(e,["labels"]);n!==void 0&&M!=null&&f(n,["labels"],M);const q=d(e,["cachedContent"]);n!==void 0&&q!=null&&f(n,["cachedContent"],mn(t,q));const D=d(e,["responseModalities"]);D!=null&&f(o,["responseModalities"],D);const G=d(e,["mediaResolution"]);G!=null&&f(o,["mediaResolution"],G);const B=d(e,["speechConfig"]);B!=null&&f(o,["speechConfig"],jc(B));const K=d(e,["audioTimestamp"]);K!=null&&f(o,["audioTimestamp"],K);const oe=d(e,["thinkingConfig"]);oe!=null&&f(o,["thinkingConfig"],oe);const Se=d(e,["imageConfig"]);if(Se!=null&&f(o,["imageConfig"],sC(Se)),d(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const be=d(e,["modelArmorConfig"]);return n!==void 0&&be!=null&&f(n,["modelArmorConfig"],be),o}function Bf(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["contents"]);if(s!=null){let a=Mt(s);Array.isArray(a)&&(a=a.map(l=>pa(l))),f(r,["contents"],a)}const i=d(e,["config"]);return i!=null&&f(r,["generationConfig"],Pb(t,i,r)),r}function Jf(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["contents"]);if(s!=null){let a=Mt(s);Array.isArray(a)&&(a=a.map(l=>l)),f(r,["contents"],a)}const i=d(e,["config"]);return i!=null&&f(r,["generationConfig"],Nb(t,i,r)),r}function Kf(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["candidates"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(u=>eb(u))),f(n,["candidates"],c)}const s=d(t,["modelVersion"]);s!=null&&f(n,["modelVersion"],s);const i=d(t,["promptFeedback"]);i!=null&&f(n,["promptFeedback"],i);const a=d(t,["responseId"]);a!=null&&f(n,["responseId"],a);const l=d(t,["usageMetadata"]);return l!=null&&f(n,["usageMetadata"],l),n}function Wf(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["candidates"]);if(o!=null){let u=o;Array.isArray(u)&&(u=u.map(h=>h)),f(n,["candidates"],u)}const s=d(t,["createTime"]);s!=null&&f(n,["createTime"],s);const i=d(t,["modelVersion"]);i!=null&&f(n,["modelVersion"],i);const a=d(t,["promptFeedback"]);a!=null&&f(n,["promptFeedback"],a);const l=d(t,["responseId"]);l!=null&&f(n,["responseId"],l);const c=d(t,["usageMetadata"]);return c!=null&&f(n,["usageMetadata"],c),n}function Mb(t,e,n){const r={};if(d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=d(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const s=d(t,["aspectRatio"]);e!==void 0&&s!=null&&f(e,["parameters","aspectRatio"],s);const i=d(t,["guidanceScale"]);if(e!==void 0&&i!=null&&f(e,["parameters","guidanceScale"],i),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=d(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&f(e,["parameters","safetySetting"],a);const l=d(t,["personGeneration"]);e!==void 0&&l!=null&&f(e,["parameters","personGeneration"],l);const c=d(t,["includeSafetyAttributes"]);e!==void 0&&c!=null&&f(e,["parameters","includeSafetyAttributes"],c);const u=d(t,["includeRaiReason"]);e!==void 0&&u!=null&&f(e,["parameters","includeRaiReason"],u);const h=d(t,["language"]);e!==void 0&&h!=null&&f(e,["parameters","language"],h);const p=d(t,["outputMimeType"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","mimeType"],p);const m=d(t,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&f(e,["parameters","outputOptions","compressionQuality"],m),d(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const w=d(t,["imageSize"]);if(e!==void 0&&w!=null&&f(e,["parameters","sampleImageSize"],w),d(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function xb(t,e,n){const r={},o=d(t,["outputGcsUri"]);e!==void 0&&o!=null&&f(e,["parameters","storageUri"],o);const s=d(t,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const i=d(t,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const a=d(t,["aspectRatio"]);e!==void 0&&a!=null&&f(e,["parameters","aspectRatio"],a);const l=d(t,["guidanceScale"]);e!==void 0&&l!=null&&f(e,["parameters","guidanceScale"],l);const c=d(t,["seed"]);e!==void 0&&c!=null&&f(e,["parameters","seed"],c);const u=d(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const h=d(t,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=d(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const m=d(t,["includeRaiReason"]);e!==void 0&&m!=null&&f(e,["parameters","includeRaiReason"],m);const w=d(t,["language"]);e!==void 0&&w!=null&&f(e,["parameters","language"],w);const E=d(t,["outputMimeType"]);e!==void 0&&E!=null&&f(e,["parameters","outputOptions","mimeType"],E);const _=d(t,["outputCompressionQuality"]);e!==void 0&&_!=null&&f(e,["parameters","outputOptions","compressionQuality"],_);const v=d(t,["addWatermark"]);e!==void 0&&v!=null&&f(e,["parameters","addWatermark"],v);const g=d(t,["labels"]);e!==void 0&&g!=null&&f(e,["labels"],g);const S=d(t,["imageSize"]);e!==void 0&&S!=null&&f(e,["parameters","sampleImageSize"],S);const b=d(t,["enhancePrompt"]);return e!==void 0&&b!=null&&f(e,["parameters","enhancePrompt"],b),r}function Db(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["prompt"]);s!=null&&f(r,["instances[0]","prompt"],s);const i=d(e,["config"]);return i!=null&&Mb(i,r),r}function Ob(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["prompt"]);s!=null&&f(r,["instances[0]","prompt"],s);const i=d(e,["config"]);return i!=null&&xb(i,r),r}function Ub(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["predictions"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>Zb(a))),f(n,["generatedImages"],i)}const s=d(t,["positivePromptSafetyAttributes"]);return s!=null&&f(n,["positivePromptSafetyAttributes"],b_(s)),n}function Lb(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["predictions"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>ma(a))),f(n,["generatedImages"],i)}const s=d(t,["positivePromptSafetyAttributes"]);return s!=null&&f(n,["positivePromptSafetyAttributes"],C_(s)),n}function qb(t,e,n){const r={},o=d(t,["numberOfVideos"]);if(e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o),d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=d(t,["durationSeconds"]);if(e!==void 0&&s!=null&&f(e,["parameters","durationSeconds"],s),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=d(t,["aspectRatio"]);e!==void 0&&i!=null&&f(e,["parameters","aspectRatio"],i);const a=d(t,["resolution"]);e!==void 0&&a!=null&&f(e,["parameters","resolution"],a);const l=d(t,["personGeneration"]);if(e!==void 0&&l!=null&&f(e,["parameters","personGeneration"],l),d(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=d(t,["negativePrompt"]);e!==void 0&&c!=null&&f(e,["parameters","negativePrompt"],c);const u=d(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&f(e,["parameters","enhancePrompt"],u),d(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const h=d(t,["lastFrame"]);e!==void 0&&h!=null&&f(e,["instances[0]","lastFrame"],ga(h));const p=d(t,["referenceImages"]);if(e!==void 0&&p!=null){let m=p;Array.isArray(m)&&(m=m.map(w=>VC(w))),f(e,["instances[0]","referenceImages"],m)}if(d(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return r}function Fb(t,e,n){const r={},o=d(t,["numberOfVideos"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const s=d(t,["outputGcsUri"]);e!==void 0&&s!=null&&f(e,["parameters","storageUri"],s);const i=d(t,["fps"]);e!==void 0&&i!=null&&f(e,["parameters","fps"],i);const a=d(t,["durationSeconds"]);e!==void 0&&a!=null&&f(e,["parameters","durationSeconds"],a);const l=d(t,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const c=d(t,["aspectRatio"]);e!==void 0&&c!=null&&f(e,["parameters","aspectRatio"],c);const u=d(t,["resolution"]);e!==void 0&&u!=null&&f(e,["parameters","resolution"],u);const h=d(t,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=d(t,["pubsubTopic"]);e!==void 0&&p!=null&&f(e,["parameters","pubsubTopic"],p);const m=d(t,["negativePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","negativePrompt"],m);const w=d(t,["enhancePrompt"]);e!==void 0&&w!=null&&f(e,["parameters","enhancePrompt"],w);const E=d(t,["generateAudio"]);e!==void 0&&E!=null&&f(e,["parameters","generateAudio"],E);const _=d(t,["lastFrame"]);e!==void 0&&_!=null&&f(e,["instances[0]","lastFrame"],Wt(_));const v=d(t,["referenceImages"]);if(e!==void 0&&v!=null){let b=v;Array.isArray(b)&&(b=b.map(y=>zC(y))),f(e,["instances[0]","referenceImages"],b)}const g=d(t,["mask"]);e!==void 0&&g!=null&&f(e,["instances[0]","mask"],FC(g));const S=d(t,["compressionQuality"]);return e!==void 0&&S!=null&&f(e,["parameters","compressionQuality"],S),r}function Vb(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["name"],r);const o=d(t,["metadata"]);o!=null&&f(n,["metadata"],o);const s=d(t,["done"]);s!=null&&f(n,["done"],s);const i=d(t,["error"]);i!=null&&f(n,["error"],i);const a=d(t,["response","generateVideoResponse"]);return a!=null&&f(n,["response"],Bb(a)),n}function zb(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["name"],r);const o=d(t,["metadata"]);o!=null&&f(n,["metadata"],o);const s=d(t,["done"]);s!=null&&f(n,["done"],s);const i=d(t,["error"]);i!=null&&f(n,["error"],i);const a=d(t,["response"]);return a!=null&&f(n,["response"],Jb(a)),n}function Hb(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["prompt"]);s!=null&&f(r,["instances[0]","prompt"],s);const i=d(e,["image"]);i!=null&&f(r,["instances[0]","image"],ga(i));const a=d(e,["video"]);a!=null&&f(r,["instances[0]","video"],I_(a));const l=d(e,["source"]);l!=null&&Kb(l,r);const c=d(e,["config"]);return c!=null&&qb(c,r),r}function Gb(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["prompt"]);s!=null&&f(r,["instances[0]","prompt"],s);const i=d(e,["image"]);i!=null&&f(r,["instances[0]","image"],Wt(i));const a=d(e,["video"]);a!=null&&f(r,["instances[0]","video"],R_(a));const l=d(e,["source"]);l!=null&&Wb(l,r);const c=d(e,["config"]);return c!=null&&Fb(c,r),r}function Bb(t,e){const n={},r=d(t,["generatedSamples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(a=>Xb(a))),f(n,["generatedVideos"],i)}const o=d(t,["raiMediaFilteredCount"]);o!=null&&f(n,["raiMediaFilteredCount"],o);const s=d(t,["raiMediaFilteredReasons"]);return s!=null&&f(n,["raiMediaFilteredReasons"],s),n}function Jb(t,e){const n={},r=d(t,["videos"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(a=>Qb(a))),f(n,["generatedVideos"],i)}const o=d(t,["raiMediaFilteredCount"]);o!=null&&f(n,["raiMediaFilteredCount"],o);const s=d(t,["raiMediaFilteredReasons"]);return s!=null&&f(n,["raiMediaFilteredReasons"],s),n}function Kb(t,e,n){const r={},o=d(t,["prompt"]);e!==void 0&&o!=null&&f(e,["instances[0]","prompt"],o);const s=d(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],ga(s));const i=d(t,["video"]);return e!==void 0&&i!=null&&f(e,["instances[0]","video"],I_(i)),r}function Wb(t,e,n){const r={},o=d(t,["prompt"]);e!==void 0&&o!=null&&f(e,["instances[0]","prompt"],o);const s=d(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Wt(s));const i=d(t,["video"]);return e!==void 0&&i!=null&&f(e,["instances[0]","video"],R_(i)),r}function Zb(t,e){const n={},r=d(t,["_self"]);r!=null&&f(n,["image"],iC(r));const o=d(t,["raiFilteredReason"]);o!=null&&f(n,["raiFilteredReason"],o);const s=d(t,["_self"]);return s!=null&&f(n,["safetyAttributes"],b_(s)),n}function ma(t,e){const n={},r=d(t,["_self"]);r!=null&&f(n,["image"],T_(r));const o=d(t,["raiFilteredReason"]);o!=null&&f(n,["raiFilteredReason"],o);const s=d(t,["_self"]);s!=null&&f(n,["safetyAttributes"],C_(s));const i=d(t,["prompt"]);return i!=null&&f(n,["enhancedPrompt"],i),n}function Yb(t,e){const n={},r=d(t,["_self"]);r!=null&&f(n,["mask"],T_(r));const o=d(t,["labels"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>i)),f(n,["labels"],s)}return n}function Xb(t,e){const n={},r=d(t,["video"]);return r!=null&&f(n,["video"],LC(r)),n}function Qb(t,e){const n={},r=d(t,["_self"]);return r!=null&&f(n,["video"],qC(r)),n}function jb(t,e){const n={},r=d(t,["modelSelectionConfig"]);r!=null&&f(n,["modelConfig"],r);const o=d(t,["responseJsonSchema"]);o!=null&&f(n,["responseJsonSchema"],o);const s=d(t,["audioTimestamp"]);s!=null&&f(n,["audioTimestamp"],s);const i=d(t,["candidateCount"]);i!=null&&f(n,["candidateCount"],i);const a=d(t,["enableAffectiveDialog"]);a!=null&&f(n,["enableAffectiveDialog"],a);const l=d(t,["frequencyPenalty"]);l!=null&&f(n,["frequencyPenalty"],l);const c=d(t,["logprobs"]);c!=null&&f(n,["logprobs"],c);const u=d(t,["maxOutputTokens"]);u!=null&&f(n,["maxOutputTokens"],u);const h=d(t,["mediaResolution"]);h!=null&&f(n,["mediaResolution"],h);const p=d(t,["presencePenalty"]);p!=null&&f(n,["presencePenalty"],p);const m=d(t,["responseLogprobs"]);m!=null&&f(n,["responseLogprobs"],m);const w=d(t,["responseMimeType"]);w!=null&&f(n,["responseMimeType"],w);const E=d(t,["responseModalities"]);E!=null&&f(n,["responseModalities"],E);const _=d(t,["responseSchema"]);_!=null&&f(n,["responseSchema"],_);const v=d(t,["routingConfig"]);v!=null&&f(n,["routingConfig"],v);const g=d(t,["seed"]);g!=null&&f(n,["seed"],g);const S=d(t,["speechConfig"]);S!=null&&f(n,["speechConfig"],S);const b=d(t,["stopSequences"]);b!=null&&f(n,["stopSequences"],b);const y=d(t,["temperature"]);y!=null&&f(n,["temperature"],y);const C=d(t,["thinkingConfig"]);C!=null&&f(n,["thinkingConfig"],C);const k=d(t,["topK"]);k!=null&&f(n,["topK"],k);const P=d(t,["topP"]);if(P!=null&&f(n,["topP"],P),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}function eC(t,e,n){const r={},o=d(e,["model"]);return o!=null&&f(r,["_url","name"],ke(t,o)),r}function tC(t,e,n){const r={},o=d(e,["model"]);return o!=null&&f(r,["_url","name"],ke(t,o)),r}function nC(t,e){const n={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=d(t,["enableWidget"]);return r!=null&&f(n,["enableWidget"],r),n}function rC(t,e){const n={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=d(t,["timeRangeFilter"]);return r!=null&&f(n,["timeRangeFilter"],r),n}function oC(t,e){const n={},r=d(t,["aspectRatio"]);r!=null&&f(n,["aspectRatio"],r);const o=d(t,["imageSize"]);if(o!=null&&f(n,["imageSize"],o),d(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(d(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return n}function sC(t,e){const n={},r=d(t,["aspectRatio"]);r!=null&&f(n,["aspectRatio"],r);const o=d(t,["imageSize"]);o!=null&&f(n,["imageSize"],o);const s=d(t,["personGeneration"]);s!=null&&f(n,["personGeneration"],s);const i=d(t,["outputMimeType"]);i!=null&&f(n,["imageOutputOptions","mimeType"],i);const a=d(t,["outputCompressionQuality"]);return a!=null&&f(n,["imageOutputOptions","compressionQuality"],a),n}function iC(t,e){const n={},r=d(t,["bytesBase64Encoded"]);r!=null&&f(n,["imageBytes"],Cn(r));const o=d(t,["mimeType"]);return o!=null&&f(n,["mimeType"],o),n}function T_(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&f(n,["gcsUri"],r);const o=d(t,["bytesBase64Encoded"]);o!=null&&f(n,["imageBytes"],Cn(o));const s=d(t,["mimeType"]);return s!=null&&f(n,["mimeType"],s),n}function ga(t,e){const n={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=d(t,["imageBytes"]);r!=null&&f(n,["bytesBase64Encoded"],Cn(r));const o=d(t,["mimeType"]);return o!=null&&f(n,["mimeType"],o),n}function Wt(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&f(n,["gcsUri"],r);const o=d(t,["imageBytes"]);o!=null&&f(n,["bytesBase64Encoded"],Cn(o));const s=d(t,["mimeType"]);return s!=null&&f(n,["mimeType"],s),n}function aC(t,e,n,r){const o={},s=d(e,["pageSize"]);n!==void 0&&s!=null&&f(n,["_query","pageSize"],s);const i=d(e,["pageToken"]);n!==void 0&&i!=null&&f(n,["_query","pageToken"],i);const a=d(e,["filter"]);n!==void 0&&a!=null&&f(n,["_query","filter"],a);const l=d(e,["queryBase"]);return n!==void 0&&l!=null&&f(n,["_url","models_url"],g_(t,l)),o}function lC(t,e,n,r){const o={},s=d(e,["pageSize"]);n!==void 0&&s!=null&&f(n,["_query","pageSize"],s);const i=d(e,["pageToken"]);n!==void 0&&i!=null&&f(n,["_query","pageToken"],i);const a=d(e,["filter"]);n!==void 0&&a!=null&&f(n,["_query","filter"],a);const l=d(e,["queryBase"]);return n!==void 0&&l!=null&&f(n,["_url","models_url"],g_(t,l)),o}function cC(t,e,n){const r={},o=d(e,["config"]);return o!=null&&aC(t,o,r),r}function uC(t,e,n){const r={},o=d(e,["config"]);return o!=null&&lC(t,o,r),r}function dC(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["nextPageToken"]);o!=null&&f(n,["nextPageToken"],o);const s=d(t,["_self"]);if(s!=null){let i=__(s);Array.isArray(i)&&(i=i.map(a=>Ql(a))),f(n,["models"],i)}return n}function fC(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["nextPageToken"]);o!=null&&f(n,["nextPageToken"],o);const s=d(t,["_self"]);if(s!=null){let i=__(s);Array.isArray(i)&&(i=i.map(a=>jl(a))),f(n,["models"],i)}return n}function hC(t,e){const n={},r=d(t,["maskMode"]);r!=null&&f(n,["maskMode"],r);const o=d(t,["segmentationClasses"]);o!=null&&f(n,["maskClasses"],o);const s=d(t,["maskDilation"]);return s!=null&&f(n,["dilation"],s),n}function Ql(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["name"],r);const o=d(t,["displayName"]);o!=null&&f(n,["displayName"],o);const s=d(t,["description"]);s!=null&&f(n,["description"],s);const i=d(t,["version"]);i!=null&&f(n,["version"],i);const a=d(t,["_self"]);a!=null&&f(n,["tunedModelInfo"],$C(a));const l=d(t,["inputTokenLimit"]);l!=null&&f(n,["inputTokenLimit"],l);const c=d(t,["outputTokenLimit"]);c!=null&&f(n,["outputTokenLimit"],c);const u=d(t,["supportedGenerationMethods"]);u!=null&&f(n,["supportedActions"],u);const h=d(t,["temperature"]);h!=null&&f(n,["temperature"],h);const p=d(t,["maxTemperature"]);p!=null&&f(n,["maxTemperature"],p);const m=d(t,["topP"]);m!=null&&f(n,["topP"],m);const w=d(t,["topK"]);w!=null&&f(n,["topK"],w);const E=d(t,["thinking"]);return E!=null&&f(n,["thinking"],E),n}function jl(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["name"],r);const o=d(t,["displayName"]);o!=null&&f(n,["displayName"],o);const s=d(t,["description"]);s!=null&&f(n,["description"],s);const i=d(t,["versionId"]);i!=null&&f(n,["version"],i);const a=d(t,["deployedModels"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(m=>kb(m))),f(n,["endpoints"],p)}const l=d(t,["labels"]);l!=null&&f(n,["labels"],l);const c=d(t,["_self"]);c!=null&&f(n,["tunedModelInfo"],AC(c));const u=d(t,["defaultCheckpointId"]);u!=null&&f(n,["defaultCheckpointId"],u);const h=d(t,["checkpoints"]);if(h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>m)),f(n,["checkpoints"],p)}return n}function pC(t,e){const n={},r=d(t,["mediaResolution"]);r!=null&&f(n,["mediaResolution"],r);const o=d(t,["codeExecutionResult"]);o!=null&&f(n,["codeExecutionResult"],o);const s=d(t,["executableCode"]);s!=null&&f(n,["executableCode"],s);const i=d(t,["fileData"]);i!=null&&f(n,["fileData"],Ib(i));const a=d(t,["functionCall"]);a!=null&&f(n,["functionCall"],Rb(a));const l=d(t,["functionResponse"]);l!=null&&f(n,["functionResponse"],l);const c=d(t,["inlineData"]);c!=null&&f(n,["inlineData"],jT(c));const u=d(t,["text"]);u!=null&&f(n,["text"],u);const h=d(t,["thought"]);h!=null&&f(n,["thought"],h);const p=d(t,["thoughtSignature"]);p!=null&&f(n,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(n,["videoMetadata"],m),n}function mC(t,e){const n={},r=d(t,["productImage"]);return r!=null&&f(n,["image"],Wt(r)),n}function gC(t,e,n){const r={},o=d(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const s=d(t,["baseSteps"]);e!==void 0&&s!=null&&f(e,["parameters","baseSteps"],s);const i=d(t,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const a=d(t,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const l=d(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&f(e,["parameters","safetySetting"],l);const c=d(t,["personGeneration"]);e!==void 0&&c!=null&&f(e,["parameters","personGeneration"],c);const u=d(t,["addWatermark"]);e!==void 0&&u!=null&&f(e,["parameters","addWatermark"],u);const h=d(t,["outputMimeType"]);e!==void 0&&h!=null&&f(e,["parameters","outputOptions","mimeType"],h);const p=d(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","compressionQuality"],p);const m=d(t,["enhancePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","enhancePrompt"],m);const w=d(t,["labels"]);return e!==void 0&&w!=null&&f(e,["labels"],w),r}function _C(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["source"]);s!=null&&vC(s,r);const i=d(e,["config"]);return i!=null&&gC(i,r),r}function yC(t,e){const n={},r=d(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>ma(s))),f(n,["generatedImages"],o)}return n}function vC(t,e,n){const r={},o=d(t,["prompt"]);e!==void 0&&o!=null&&f(e,["instances[0]","prompt"],o);const s=d(t,["personImage"]);e!==void 0&&s!=null&&f(e,["instances[0]","personImage","image"],Wt(s));const i=d(t,["productImages"]);if(e!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>mC(l))),f(e,["instances[0]","productImages"],a)}return r}function wC(t,e){const n={},r=d(t,["referenceImage"]);r!=null&&f(n,["referenceImage"],Wt(r));const o=d(t,["referenceId"]);o!=null&&f(n,["referenceId"],o);const s=d(t,["referenceType"]);s!=null&&f(n,["referenceType"],s);const i=d(t,["maskImageConfig"]);i!=null&&f(n,["maskImageConfig"],hC(i));const a=d(t,["controlImageConfig"]);a!=null&&f(n,["controlImageConfig"],ib(a));const l=d(t,["styleImageConfig"]);l!=null&&f(n,["styleImageConfig"],l);const c=d(t,["subjectImageConfig"]);return c!=null&&f(n,["subjectImageConfig"],c),n}function b_(t,e){const n={},r=d(t,["safetyAttributes","categories"]);r!=null&&f(n,["categories"],r);const o=d(t,["safetyAttributes","scores"]);o!=null&&f(n,["scores"],o);const s=d(t,["contentType"]);return s!=null&&f(n,["contentType"],s),n}function C_(t,e){const n={},r=d(t,["safetyAttributes","categories"]);r!=null&&f(n,["categories"],r);const o=d(t,["safetyAttributes","scores"]);o!=null&&f(n,["scores"],o);const s=d(t,["contentType"]);return s!=null&&f(n,["contentType"],s),n}function SC(t,e){const n={},r=d(t,["category"]);if(r!=null&&f(n,["category"],r),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=d(t,["threshold"]);return o!=null&&f(n,["threshold"],o),n}function EC(t,e){const n={},r=d(t,["image"]);return r!=null&&f(n,["image"],Wt(r)),n}function TC(t,e,n){const r={},o=d(t,["mode"]);e!==void 0&&o!=null&&f(e,["parameters","mode"],o);const s=d(t,["maxPredictions"]);e!==void 0&&s!=null&&f(e,["parameters","maxPredictions"],s);const i=d(t,["confidenceThreshold"]);e!==void 0&&i!=null&&f(e,["parameters","confidenceThreshold"],i);const a=d(t,["maskDilation"]);e!==void 0&&a!=null&&f(e,["parameters","maskDilation"],a);const l=d(t,["binaryColorThreshold"]);e!==void 0&&l!=null&&f(e,["parameters","binaryColorThreshold"],l);const c=d(t,["labels"]);return e!==void 0&&c!=null&&f(e,["labels"],c),r}function bC(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["source"]);s!=null&&kC(s,r);const i=d(e,["config"]);return i!=null&&TC(i,r),r}function CC(t,e){const n={},r=d(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Yb(s))),f(n,["generatedMasks"],o)}return n}function kC(t,e,n){const r={},o=d(t,["prompt"]);e!==void 0&&o!=null&&f(e,["instances[0]","prompt"],o);const s=d(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Wt(s));const i=d(t,["scribbleImage"]);return e!==void 0&&i!=null&&f(e,["instances[0]","scribble"],EC(i)),r}function IC(t,e){const n={},r=d(t,["retrievalConfig"]);r!=null&&f(n,["retrievalConfig"],r);const o=d(t,["functionCallingConfig"]);return o!=null&&f(n,["functionCallingConfig"],$b(o)),n}function RC(t,e){const n={};if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["computerUse"]);r!=null&&f(n,["computerUse"],r);const o=d(t,["fileSearch"]);o!=null&&f(n,["fileSearch"],o);const s=d(t,["codeExecution"]);if(s!=null&&f(n,["codeExecution"],s),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const i=d(t,["functionDeclarations"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(p=>p)),f(n,["functionDeclarations"],h)}const a=d(t,["googleMaps"]);a!=null&&f(n,["googleMaps"],nC(a));const l=d(t,["googleSearch"]);l!=null&&f(n,["googleSearch"],rC(l));const c=d(t,["googleSearchRetrieval"]);c!=null&&f(n,["googleSearchRetrieval"],c);const u=d(t,["urlContext"]);return u!=null&&f(n,["urlContext"],u),n}function k_(t,e){const n={},r=d(t,["retrieval"]);r!=null&&f(n,["retrieval"],r);const o=d(t,["computerUse"]);if(o!=null&&f(n,["computerUse"],o),d(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=d(t,["codeExecution"]);s!=null&&f(n,["codeExecution"],s);const i=d(t,["enterpriseWebSearch"]);i!=null&&f(n,["enterpriseWebSearch"],i);const a=d(t,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(m=>Ab(m))),f(n,["functionDeclarations"],p)}const l=d(t,["googleMaps"]);l!=null&&f(n,["googleMaps"],l);const c=d(t,["googleSearch"]);c!=null&&f(n,["googleSearch"],c);const u=d(t,["googleSearchRetrieval"]);u!=null&&f(n,["googleSearchRetrieval"],u);const h=d(t,["urlContext"]);return h!=null&&f(n,["urlContext"],h),n}function $C(t,e){const n={},r=d(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const o=d(t,["createTime"]);o!=null&&f(n,["createTime"],o);const s=d(t,["updateTime"]);return s!=null&&f(n,["updateTime"],s),n}function AC(t,e){const n={},r=d(t,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&f(n,["baseModel"],r);const o=d(t,["createTime"]);o!=null&&f(n,["createTime"],o);const s=d(t,["updateTime"]);return s!=null&&f(n,["updateTime"],s),n}function PC(t,e,n){const r={},o=d(t,["displayName"]);e!==void 0&&o!=null&&f(e,["displayName"],o);const s=d(t,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const i=d(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&f(e,["defaultCheckpointId"],i),r}function NC(t,e,n){const r={},o=d(t,["displayName"]);e!==void 0&&o!=null&&f(e,["displayName"],o);const s=d(t,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const i=d(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&f(e,["defaultCheckpointId"],i),r}function MC(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","name"],ke(t,o));const s=d(e,["config"]);return s!=null&&PC(s,r),r}function xC(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["config"]);return s!=null&&NC(s,r),r}function DC(t,e,n){const r={},o=d(t,["outputGcsUri"]);e!==void 0&&o!=null&&f(e,["parameters","storageUri"],o);const s=d(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&f(e,["parameters","safetySetting"],s);const i=d(t,["personGeneration"]);e!==void 0&&i!=null&&f(e,["parameters","personGeneration"],i);const a=d(t,["includeRaiReason"]);e!==void 0&&a!=null&&f(e,["parameters","includeRaiReason"],a);const l=d(t,["outputMimeType"]);e!==void 0&&l!=null&&f(e,["parameters","outputOptions","mimeType"],l);const c=d(t,["outputCompressionQuality"]);e!==void 0&&c!=null&&f(e,["parameters","outputOptions","compressionQuality"],c);const u=d(t,["enhanceInputImage"]);e!==void 0&&u!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],u);const h=d(t,["imagePreservationFactor"]);e!==void 0&&h!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],h);const p=d(t,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const m=d(t,["numberOfImages"]);e!==void 0&&m!=null&&f(e,["parameters","sampleCount"],m);const w=d(t,["mode"]);return e!==void 0&&w!=null&&f(e,["parameters","mode"],w),r}function OC(t,e,n){const r={},o=d(e,["model"]);o!=null&&f(r,["_url","model"],ke(t,o));const s=d(e,["image"]);s!=null&&f(r,["instances[0]","image"],Wt(s));const i=d(e,["upscaleFactor"]);i!=null&&f(r,["parameters","upscaleConfig","upscaleFactor"],i);const a=d(e,["config"]);return a!=null&&DC(a,r),r}function UC(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["predictions"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>ma(i))),f(n,["generatedImages"],s)}return n}function LC(t,e){const n={},r=d(t,["uri"]);r!=null&&f(n,["uri"],r);const o=d(t,["encodedVideo"]);o!=null&&f(n,["videoBytes"],Cn(o));const s=d(t,["encoding"]);return s!=null&&f(n,["mimeType"],s),n}function qC(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&f(n,["uri"],r);const o=d(t,["bytesBase64Encoded"]);o!=null&&f(n,["videoBytes"],Cn(o));const s=d(t,["mimeType"]);return s!=null&&f(n,["mimeType"],s),n}function FC(t,e){const n={},r=d(t,["image"]);r!=null&&f(n,["_self"],Wt(r));const o=d(t,["maskMode"]);return o!=null&&f(n,["maskMode"],o),n}function VC(t,e){const n={},r=d(t,["image"]);r!=null&&f(n,["image"],ga(r));const o=d(t,["referenceType"]);return o!=null&&f(n,["referenceType"],o),n}function zC(t,e){const n={},r=d(t,["image"]);r!=null&&f(n,["image"],Wt(r));const o=d(t,["referenceType"]);return o!=null&&f(n,["referenceType"],o),n}function I_(t,e){const n={},r=d(t,["uri"]);r!=null&&f(n,["uri"],r);const o=d(t,["videoBytes"]);o!=null&&f(n,["encodedVideo"],Cn(o));const s=d(t,["mimeType"]);return s!=null&&f(n,["encoding"],s),n}function R_(t,e){const n={},r=d(t,["uri"]);r!=null&&f(n,["gcsUri"],r);const o=d(t,["videoBytes"]);o!=null&&f(n,["bytesBase64Encoded"],Cn(o));const s=d(t,["mimeType"]);return s!=null&&f(n,["mimeType"],s),n}function HC(t,e){const n={},r=d(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["displayName"],r),n}function GC(t){const e={},n=d(t,["config"]);return n!=null&&HC(n,e),e}function BC(t,e){const n={},r=d(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function JC(t){const e={},n=d(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=d(t,["config"]);return r!=null&&BC(r,e),e}function KC(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function WC(t,e){const n={},r=d(t,["customMetadata"]);if(e!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>i)),f(e,["customMetadata"],s)}const o=d(t,["chunkingConfig"]);return e!==void 0&&o!=null&&f(e,["chunkingConfig"],o),n}function ZC(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const o=d(t,["done"]);o!=null&&f(e,["done"],o);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const i=d(t,["response"]);return i!=null&&f(e,["response"],XC(i)),e}function YC(t){const e={},n=d(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=d(t,["fileName"]);r!=null&&f(e,["fileName"],r);const o=d(t,["config"]);return o!=null&&WC(o,e),e}function XC(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["parent"]);r!=null&&f(e,["parent"],r);const o=d(t,["documentName"]);return o!=null&&f(e,["documentName"],o),e}function QC(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const o=d(t,["pageToken"]);return e!==void 0&&o!=null&&f(e,["_query","pageToken"],o),n}function jC(t){const e={},n=d(t,["config"]);return n!=null&&QC(n,e),e}function ek(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const o=d(t,["fileSearchStores"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>i)),f(e,["fileSearchStores"],s)}return e}function $_(t,e){const n={},r=d(t,["mimeType"]);e!==void 0&&r!=null&&f(e,["mimeType"],r);const o=d(t,["displayName"]);e!==void 0&&o!=null&&f(e,["displayName"],o);const s=d(t,["customMetadata"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),f(e,["customMetadata"],a)}const i=d(t,["chunkingConfig"]);return e!==void 0&&i!=null&&f(e,["chunkingConfig"],i),n}function tk(t){const e={},n=d(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=d(t,["config"]);return r!=null&&$_(r,e),e}function nk(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}const rk="Content-Type",ok="X-Server-Timeout",sk="User-Agent",ec="x-goog-api-client",ik="1.39.0",ak=`google-genai-sdk/${ik}`,lk="v1beta1",ck="v1beta";class uk{constructor(e){var n,r,o;this.clientOptions=Object.assign({},e),this.customBaseUrl=(n=e.httpOptions)===null||n===void 0?void 0:n.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const s={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const a=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!a?(s.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?s.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(s.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:lk}else{if(!this.clientOptions.apiKey)throw new mo({message:"API key must be set when using the Gemini API.",status:403});s.apiVersion=(o=this.clientOptions.apiVersion)!==null&&o!==void 0?o:ck,s.baseUrl="https://generativelanguage.googleapis.com/"}s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const o=[this.getRequestUrlInternal(n)];return r&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e,n){return!(n.baseUrl&&n.baseUrlResourceScope===Wl.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e,n),o=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[i,a]of Object.entries(e.queryParams))o.searchParams.append(i,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,o.toString(),e.abortSignal),this.unaryApiCall(o,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[o,s]of Object.entries(n))typeof s=="object"?r[o]=Object.assign(Object.assign({},r[o]),s):s!==void 0&&(r[o]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e,n),o=this.constructUrl(e.path,n,r);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,o.toString(),e.abortSignal),this.streamApiCall(o,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,o){if(n&&n.timeout||o){const s=new AbortController,i=s.signal;if(n.timeout&&n?.timeout>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}o&&o.addEventListener("abort",()=>{s.abort()}),e.signal=i}return n&&n.extraBody!==null&&dk(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async o=>(await Zf(o),new Zl(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async o=>(await Zf(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){return Jt(this,arguments,function*(){var r;const o=(r=e?.body)===null||r===void 0?void 0:r.getReader(),s=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let i="";const a="data:",l=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:c,value:u}=yield he(o.read());if(c){if(i.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=s.decode(u,{stream:!0});try{const w=JSON.parse(h);if("error"in w){const E=JSON.parse(JSON.stringify(w.error)),_=E.status,v=E.code,g=`got status: ${_}. ${JSON.stringify(w)}`;if(v>=400&&v<600)throw new mo({message:g,status:v})}}catch(w){if(w.name==="ApiError")throw w}i+=h;let p=-1,m=0;for(;;){p=-1,m=0;for(const _ of l){const v=i.indexOf(_);v!==-1&&(p===-1||v<p)&&(p=v,m=_.length)}if(p===-1)break;const w=i.substring(0,p);i=i.substring(p+m);const E=w.trim();if(E.startsWith(a)){const _=E.substring(a.length).trim();try{const v=new Response(_,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield he(new Zl(v))}catch(v){throw new Error(`exception parsing stream chunk ${_}. ${v}`)}}}}}finally{o.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=ak+" "+this.clientOptions.userAgentExtra;return e[sk]=n,e[ec]=n,e[rk]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[o,s]of Object.entries(e.headers))r.append(o,s);e.timeout&&e.timeout>0&&r.append(ok,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(e){var n;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(e,n){var r;const o={};n!=null&&(o.mimeType=n.mimeType,o.name=n.name,o.displayName=n.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const s=this.clientOptions.uploader,i=await s.stat(e);o.sizeBytes=String(i.size);const a=(r=n?.mimeType)!==null&&r!==void 0?r:i.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=a;const l={file:o},c=this.getFileName(e),u=ne("upload/v1beta/files",l._url),h=await this.fetchUploadUrl(u,o.sizeBytes,o.mimeType,c,l,n?.httpOptions);return s.upload(e,h,this)}async uploadFileToFileSearchStore(e,n,r){var o;const s=this.clientOptions.uploader,i=await s.stat(n),a=String(i.size),l=(o=r?.mimeType)!==null&&o!==void 0?o:i.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const c=`upload/v1beta/${e}:uploadToFileSearchStore`,u=this.getFileName(n),h={};r!=null&&$_(r,h);const p=await this.fetchUploadUrl(c,a,l,u,h,r?.httpOptions);return s.uploadToFileSearchStore(n,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r,o,s,i){var a;let l={};i?l=i:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},o?{"X-Goog-Upload-File-Name":o}:{})};const c=await this.request({path:e,body:JSON.stringify(s),httpMethod:"POST",httpOptions:l});if(!c||!c?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(a=c?.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function Zf(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const o=JSON.stringify(r);throw n>=400&&n<600?new mo({message:o,status:n}):new Error(o)}}function dk(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,i){const a=Object.assign({},s);for(const l in i)if(Object.prototype.hasOwnProperty.call(i,l)){const c=i[l],u=a[l];c&&typeof c=="object"&&!Array.isArray(c)&&u&&typeof u=="object"&&!Array.isArray(u)?a[l]=r(u,c):(u&&c&&typeof u!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof u}, New type: ${typeof c}. Overwriting.`),a[l]=c)}return a}const o=r(n,e);t.body=JSON.stringify(o)}const fk="mcp_used/unknown";let hk=!1;function A_(t){for(const e of t)if(pk(e)||typeof e=="object"&&"inputSchema"in e)return!0;return hk}function P_(t){var e;const n=(e=t[ec])!==null&&e!==void 0?e:"";t[ec]=(n+` ${fk}`).trimStart()}function pk(t){return t!==null&&typeof t=="object"&&t instanceof tu}function mk(t){return Jt(this,arguments,function*(n,r=100){let o,s=0;for(;s<r;){const i=yield he(n.listTools({cursor:o}));for(const a of i.tools)yield yield he(a),s++;if(!i.nextCursor)break;o=i.nextCursor}})}class tu{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new tu(e,n)}async initialize(){var e,n,r,o;if(this.mcpTools.length>0)return;const s={},i=[];for(const u of this.mcpClients)try{for(var a=!0,l=(n=void 0,Kt(mk(u))),c;c=await l.next(),e=c.done,!e;a=!0){o=c.value,a=!1;const h=o;i.push(h);const p=h.name;if(s[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);s[p]=u}}catch(h){n={error:h}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=i,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),GS(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const i=await o.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:i.isError?{error:i}:i}})}return n}}async function gk(t,e,n){const r=new OS;let o;n.data instanceof Blob?o=JSON.parse(await n.data.text()):o=JSON.parse(n.data),Object.assign(r,o),e(r)}class _k{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),i=wk(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${o}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let c=()=>{};const u=new Promise(S=>{c=S}),h=e.callbacks,p=function(){c({})},m=this.apiClient,w={onopen:p,onmessage:S=>{gk(m,h.onmessage,S)},onerror:(n=h?.onerror)!==null&&n!==void 0?n:function(S){},onclose:(r=h?.onclose)!==null&&r!==void 0?r:function(S){}},E=this.webSocketFactory.create(l,vk(i),w);E.connect(),await u;const g={setup:{model:ke(this.apiClient,e.model)}};return E.send(JSON.stringify(g)),new yk(E,this.apiClient)}}class yk{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=HT(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=zT(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(pr.PLAY)}pause(){this.sendPlaybackControl(pr.PAUSE)}stop(){this.sendPlaybackControl(pr.STOP)}resetContext(){this.sendPlaybackControl(pr.RESET_CONTEXT)}close(){this.conn.close()}}function vk(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function wk(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}const Sk="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Ek(t,e,n){const r=new DS;let o;n.data instanceof Blob?o=await n.data.text():n.data instanceof ArrayBuffer?o=new TextDecoder().decode(n.data):o=n.data;const s=JSON.parse(o);if(t.isVertexAI()){const i=JT(s);Object.assign(r,i)}else Object.assign(r,s);e(r)}class Tk{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new _k(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,o,s,i,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let u;const h=this.apiClient.getHeaders();e.config&&e.config.tools&&A_(e.config.tools)&&P_(h);const p=Ik(h);if(this.apiClient.isVertexAI()){const M=this.apiClient.getProject(),q=this.apiClient.getLocation(),D=this.apiClient.getApiKey(),G=!!M&&!!q||!!D;this.apiClient.getCustomBaseUrl()&&!G?u=l:(u=`${l}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,u))}else{const M=this.apiClient.getApiKey();let q="BidiGenerateContent",D="key";M?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),c!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),q="BidiGenerateContentConstrained",D="access_token"),u=`${l}/ws/google.ai.generativelanguage.${c}.GenerativeService.${q}?${D}=${M}`}let m=()=>{};const w=new Promise(M=>{m=M}),E=e.callbacks,_=function(){var M;(M=E?.onopen)===null||M===void 0||M.call(E),m({})},v=this.apiClient,g={onopen:_,onmessage:M=>{Ek(v,E.onmessage,M)},onerror:(n=E?.onerror)!==null&&n!==void 0?n:function(M){},onclose:(r=E?.onclose)!==null&&r!==void 0?r:function(M){}},S=this.webSocketFactory.create(u,kk(p),g);S.connect(),await w;let b=ke(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&b.startsWith("publishers/")){const M=this.apiClient.getProject(),q=this.apiClient.getLocation();M&&q&&(b=`projects/${M}/locations/${q}/`+b)}let y={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[xi.AUDIO]}:e.config.responseModalities=[xi.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const C=(a=(i=e.config)===null||i===void 0?void 0:i.tools)!==null&&a!==void 0?a:[],k=[];for(const M of C)if(this.isCallableTool(M)){const q=M;k.push(await q.tool())}else k.push(M);k.length>0&&(e.config.tools=k);const P={model:b,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?y=VT(this.apiClient,P):y=FT(this.apiClient,P),delete y.config,S.send(JSON.stringify(y)),new Ck(S,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const bk={turnComplete:!0};class Ck{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Mt(n.turns),e.isVertexAI()||(r=r.map(o=>pa(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(Sk)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},bk),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:BT(e)}:n={realtimeInput:GT(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function kk(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function Ik(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}const Yf=10;function Xf(t){var e,n,r;if(!((e=t?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const i of(n=t?.tools)!==null&&n!==void 0?n:[])if(Sr(i)){o=!0;break}if(!o)return!0;const s=(r=t?.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Sr(t){return"callTool"in t&&typeof t.callTool=="function"}function Rk(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(o=>Sr(o)))!==null&&r!==void 0?r:!1}function Qf(t){var e;const n=[];return!((e=t?.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((r,o)=>{if(Sr(r))return;const s=r;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(o)}),n}function jf(t){var e;return!(!((e=t?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}let $k=class extends pn{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,o,s,i,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!Rk(n)||Xf(n.config))return await this.generateContentInternal(l);const c=Qf(n);if(c.length>0){const E=c.map(_=>`tools[${_}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${E}.`)}let u,h;const p=Mt(l.contents),m=(s=(o=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&s!==void 0?s:Yf;let w=0;for(;w<m&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const E=u.candidates[0].content,_=[];for(const v of(a=(i=n.config)===null||i===void 0?void 0:i.tools)!==null&&a!==void 0?a:[])if(Sr(v)){const S=await v.callTool(u.functionCalls);_.push(...S)}w++,h={role:"user",parts:_},l.contents=Mt(l.contents),l.contents.push(E),l.contents.push(h),jf(l.config)&&(p.push(E),p.push(h))}return jf(l.config)&&(u.automaticFunctionCallingHistory=p),u},this.generateContentStream=async n=>{var r,o,s,i,a;if(this.maybeMoveToResponseJsonSchem(n),Xf(n.config)){const h=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(h)}const l=Qf(n);if(l.length>0){const h=l.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const c=(s=(o=(r=n?.config)===null||r===void 0?void 0:r.toolConfig)===null||o===void 0?void 0:o.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,u=(a=(i=n?.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(c&&!u)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var o;let s;const i=[];if(r?.generatedImages)for(const l of r.generatedImages)l&&l?.safetyAttributes&&((o=l?.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?s=l?.safetyAttributes:i.push(l);let a;return s?a={generatedImages:i,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:i,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const i={config:Object.assign(Object.assign({},{queryBase:!0}),n?.config)};if(this.apiClient.isVertexAI()&&!i.config.queryBase){if(!((r=i.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");i.config.filter="labels.tune-type:*"}return new Qn(hn.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(i),i)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const o={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(o)},this.generateVideos=async n=>{var r,o,s,i,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((o=n.video)===null||o===void 0)&&o.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((i=(s=n.source)===null||s===void 0?void 0:s.video)===null||i===void 0)&&i.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,o;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const i=await Promise.all(s.map(async l=>Sr(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:i})};if(a.config.tools=i,e.config&&e.config.tools&&A_(e.config.tools)){const l=(o=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&o!==void 0?o:{};let c=Object.assign({},l);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),P_(c),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:c})}return a}async initAfcToolsMap(e){var n,r,o;const s=new Map;for(const i of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Sr(i)){const a=i,l=await a.tool();for(const c of(o=l.functionDeclarations)!==null&&o!==void 0?o:[]){if(!c.name)throw new Error("Function declaration name is required.");if(s.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);s.set(c.name,a)}}return s}async processAfcStream(e){var n,r,o;const s=(o=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&o!==void 0?o:Yf;let i=!1,a=0;const l=await this.initAfcToolsMap(e);return(function(c,u,h){return Jt(this,arguments,function*(){for(var p,m,w,E,_,v;a<s;){i&&(a++,i=!1);const y=yield he(c.processParamsMaybeAddMcpUsage(h)),C=yield he(c.generateContentStreamInternal(y)),k=[],P=[];try{for(var g=!0,S=(m=void 0,Kt(C)),b;b=yield he(S.next()),p=b.done,!p;g=!0){E=b.value,g=!1;const M=E;if(yield yield he(M),M.candidates&&(!((_=M.candidates[0])===null||_===void 0)&&_.content)){P.push(M.candidates[0].content);for(const q of(v=M.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(a<s&&q.functionCall){if(!q.functionCall.name)throw new Error("Function call name was not returned by the model.");if(u.has(q.functionCall.name)){const D=yield he(u.get(q.functionCall.name).callTool([q.functionCall]));k.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${u.keys()}, mising tool: ${q.functionCall.name}`)}}}}catch(M){m={error:M}}finally{try{!g&&!p&&(w=S.return)&&(yield he(w.call(S)))}finally{if(m)throw m.error}}if(k.length>0){i=!0;const M=new Ur;M.candidates=[{content:{role:"user",parts:k}}],yield yield he(M);const q=[];q.push(...P),q.push({role:"user",parts:k});const D=Mt(h.contents).concat(q);h.contents=D}else break}})})(this,l,e)}async generateContentInternal(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=Jf(this.apiClient,e);return a=ne("{model}:generateContent",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=Wf(u),p=new Ur;return Object.assign(p,h),p})}else{const c=Bf(this.apiClient,e);return a=ne("{model}:generateContent",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=Kf(u),p=new Ur;return Object.assign(p,h),p})}}async generateContentStreamInternal(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=Jf(this.apiClient,e);return a=ne("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),i.then(function(h){return Jt(this,arguments,function*(){var p,m,w,E;try{for(var _=!0,v=Kt(h),g;g=yield he(v.next()),p=g.done,!p;_=!0){E=g.value,_=!1;const S=E,b=Wf(yield he(S.json()),e);b.sdkHttpResponse={headers:S.headers};const y=new Ur;Object.assign(y,b),yield yield he(y)}}catch(S){m={error:S}}finally{try{!_&&!p&&(w=v.return)&&(yield he(w.call(v)))}finally{if(m)throw m.error}}})})}else{const c=Bf(this.apiClient,e);return a=ne("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),i.then(function(h){return Jt(this,arguments,function*(){var p,m,w,E;try{for(var _=!0,v=Kt(h),g;g=yield he(v.next()),p=g.done,!p;_=!0){E=g.value,_=!1;const S=E,b=Kf(yield he(S.json()),e);b.sdkHttpResponse={headers:S.headers};const y=new Ur;Object.assign(y,b),yield yield he(y)}}catch(S){m={error:S}}finally{try{!_&&!p&&(w=v.return)&&(yield he(w.call(v)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=Tb(this.apiClient,e);return a=ne("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=Cb(u),p=new Rf;return Object.assign(p,h),p})}else{const c=Eb(this.apiClient,e);return a=ne("{model}:batchEmbedContents",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=bb(u),p=new Rf;return Object.assign(p,h),p})}}async generateImagesInternal(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=Ob(this.apiClient,e);return a=ne("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=Lb(u),p=new $f;return Object.assign(p,h),p})}else{const c=Db(this.apiClient,e);return a=ne("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=Ub(u),p=new $f;return Object.assign(p,h),p})}}async editImageInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI()){const a=yb(this.apiClient,e);return s=ne("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),o.then(l=>{const c=vb(l),u=new TS;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI()){const a=OC(this.apiClient,e);return s=ne("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),o.then(l=>{const c=UC(l),u=new bS;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI()){const a=_C(this.apiClient,e);return s=ne("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{const c=yC(l),u=new CS;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI()){const a=bC(this.apiClient,e);return s=ne("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{const c=CC(l),u=new kS;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=tC(this.apiClient,e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>jl(u))}else{const c=eC(this.apiClient,e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),i.then(u=>Ql(u))}}async listInternal(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=uC(this.apiClient,e);return a=ne("{models_url}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=fC(u),p=new Af;return Object.assign(p,h),p})}else{const c=cC(this.apiClient,e);return a=ne("{models_url}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=dC(u),p=new Af;return Object.assign(p,h),p})}}async update(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=xC(this.apiClient,e);return a=ne("{model}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>jl(u))}else{const c=MC(this.apiClient,e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),i.then(u=>Ql(u))}}async delete(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=pb(this.apiClient,e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=gb(u),p=new Pf;return Object.assign(p,h),p})}else{const c=hb(this.apiClient,e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=mb(u),p=new Pf;return Object.assign(p,h),p})}}async countTokens(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=ub(this.apiClient,e);return a=ne("{model}:countTokens",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=fb(u),p=new Nf;return Object.assign(p,h),p})}else{const c=cb(this.apiClient,e);return a=ne("{model}:countTokens",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=db(u),p=new Nf;return Object.assign(p,h),p})}}async computeTokens(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI()){const a=nb(this.apiClient,e);return s=ne("{model}:computeTokens",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),o.then(l=>{const c=rb(l),u=new IS;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=Gb(this.apiClient,e);return a=ne("{model}:predictLongRunning",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const h=zb(u),p=new Di;return Object.assign(p,h),p})}else{const c=Hb(this.apiClient,e);return a=ne("{model}:predictLongRunning",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),i.then(u=>{const h=Vb(u),p=new Di;return Object.assign(p,h),p})}}};class Ak extends pn{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=_S(e);return a=ne("{operationName}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i}else{const c=gS(e);return a=ne("{operationName}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),i}}async fetchPredictVideosOperationInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI()){const a=cS(e);return s=ne("{resourceName}:fetchPredictOperation",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}}function Pk(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Nk(t){const e={},n=d(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>Vk(s))),f(e,["parts"],o)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function Mk(t,e,n){const r={},o=d(e,["expireTime"]);n!==void 0&&o!=null&&f(n,["expireTime"],o);const s=d(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&f(n,["newSessionExpireTime"],s);const i=d(e,["uses"]);n!==void 0&&i!=null&&f(n,["uses"],i);const a=d(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&f(n,["bidiGenerateContentSetup"],Fk(t,a));const l=d(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&f(n,["fieldMask"],l),r}function xk(t,e){const n={},r=d(e,["config"]);return r!=null&&f(n,["config"],Mk(t,r,n)),n}function Dk(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Ok(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const o=d(t,["name"]);if(o!=null&&f(e,["name"],o),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Uk(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function Lk(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function qk(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const o=d(t,["responseModalities"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","responseModalities"],o);const s=d(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const i=d(t,["topP"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","topP"],i);const a=d(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const c=d(t,["mediaResolution"]);e!==void 0&&c!=null&&f(e,["setup","generationConfig","mediaResolution"],c);const u=d(t,["seed"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","seed"],u);const h=d(t,["speechConfig"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","speechConfig"],eu(h));const p=d(t,["thinkingConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","thinkingConfig"],p);const m=d(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],m);const w=d(t,["systemInstruction"]);e!==void 0&&w!=null&&f(e,["setup","systemInstruction"],Nk(pt(w)));const E=d(t,["tools"]);if(e!==void 0&&E!=null){let C=$r(E);Array.isArray(C)&&(C=C.map(k=>Hk(Rr(k)))),f(e,["setup","tools"],C)}const _=d(t,["sessionResumption"]);e!==void 0&&_!=null&&f(e,["setup","sessionResumption"],zk(_));const v=d(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","inputAudioTranscription"],v);const g=d(t,["outputAudioTranscription"]);e!==void 0&&g!=null&&f(e,["setup","outputAudioTranscription"],g);const S=d(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&f(e,["setup","realtimeInputConfig"],S);const b=d(t,["contextWindowCompression"]);e!==void 0&&b!=null&&f(e,["setup","contextWindowCompression"],b);const y=d(t,["proactivity"]);if(e!==void 0&&y!=null&&f(e,["setup","proactivity"],y),d(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function Fk(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],ke(t,r));const o=d(e,["config"]);return o!=null&&f(n,["config"],qk(o,n)),n}function Vk(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const o=d(t,["executableCode"]);o!=null&&f(e,["executableCode"],o);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],Dk(s));const i=d(t,["functionCall"]);i!=null&&f(e,["functionCall"],Ok(i));const a=d(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(t,["inlineData"]);l!=null&&f(e,["inlineData"],Pk(l));const c=d(t,["text"]);c!=null&&f(e,["text"],c);const u=d(t,["thought"]);u!=null&&f(e,["thought"],u);const h=d(t,["thoughtSignature"]);h!=null&&f(e,["thoughtSignature"],h);const p=d(t,["videoMetadata"]);return p!=null&&f(e,["videoMetadata"],p),e}function zk(t){const e={},n=d(t,["handle"]);if(n!=null&&f(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Hk(t){const e={};if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=d(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=d(t,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(h=>h)),f(e,["functionDeclarations"],u)}const i=d(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],Uk(i));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],Lk(a));const l=d(t,["googleSearchRetrieval"]);l!=null&&f(e,["googleSearchRetrieval"],l);const c=d(t,["urlContext"]);return c!=null&&f(e,["urlContext"],c),e}function Gk(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const o=Object.keys(r).map(s=>`${n}.${s}`);e.push(...o)}else e.push(n)}return e.join(",")}function Bk(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const o=t.fieldMask;if(n){const s=Gk(n);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)s?t.fieldMask=s:delete t.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const i=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];o.length>0&&(a=o.map(c=>i.includes(c)?`generationConfig.${c}`:c));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?t.fieldMask=o.join(","):delete t.fieldMask;return t}class Jk extends pn{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=xk(this.apiClient,e);s=ne("auth_tokens",a._url),i=a._query,delete a.config,delete a._url,delete a._query;const l=Bk(a,e.config);return o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o.then(c=>c)}}}function Kk(t,e){const n={},r=d(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function Wk(t){const e={},n=d(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=d(t,["config"]);return r!=null&&Kk(r,e),e}function Zk(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function Yk(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const o=d(t,["pageToken"]);return e!==void 0&&o!=null&&f(e,["_query","pageToken"],o),n}function Xk(t){const e={},n=d(t,["parent"]);n!=null&&f(e,["_url","parent"],n);const r=d(t,["config"]);return r!=null&&Yk(r,e),e}function Qk(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const o=d(t,["documents"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(i=>i)),f(e,["documents"],s)}return e}class jk extends pn{constructor(e){super(),this.apiClient=e,this.list=async n=>new Qn(hn.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Zk(e);return s=ne("{name}",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>l)}}async delete(e){var n,r;let o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=Wk(e);o=ne("{name}",i._url),s=i._query,delete i._url,delete i._query,await this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Xk(e);return s=ne("{parent}/documents",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{const c=Qk(l),u=new RS;return Object.assign(u,c),u})}}}class eI extends pn{constructor(e,n=new jk(e)){super(),this.apiClient=e,this.documents=n,this.list=async(r={})=>new Qn(hn.PAGED_ITEM_FILE_SEARCH_STORES,o=>this.listInternal(o),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=GC(e);return s=ne("fileSearchStores",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>l)}}async get(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=KC(e);return s=ne("{name}",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>l)}}async delete(e){var n,r;let o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=JC(e);o=ne("{name}",i._url),s=i._query,delete i._url,delete i._query,await this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=jC(e);return s=ne("fileSearchStores",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{const c=ek(l),u=new $S;return Object.assign(u,c),u})}}async uploadToFileSearchStoreInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=tk(e);return s=ne("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{const c=nk(l),u=new AS;return Object.assign(u,c),u})}}async importFile(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=YC(e);return s=ne("{file_search_store_name}:importFile",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),o.then(l=>{const c=ZC(l),u=new Zc;return Object.assign(u,c),u})}}}let N_=function(){const{crypto:t}=globalThis;if(t?.randomUUID)return N_=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};const tI=()=>N_();function tc(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const nc=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class xt extends Error{}let Dt=class rc extends xt{constructor(e,n,r,o){super(`${rc.makeMessage(e,n,r)}`),this.status=e,this.headers=o,this.error=n}static makeMessage(e,n,r){const o=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,n,r,o){if(!e||!o)return new _a({message:r,cause:nc(n)});const s=n;return e===400?new x_(e,s,r,o):e===401?new D_(e,s,r,o):e===403?new O_(e,s,r,o):e===404?new U_(e,s,r,o):e===409?new L_(e,s,r,o):e===422?new q_(e,s,r,o):e===429?new F_(e,s,r,o):e>=500?new V_(e,s,r,o):new rc(e,s,r,o)}},oc=class extends Dt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},_a=class extends Dt{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}},M_=class extends _a{constructor({message:e}={}){super({message:e??"Request timed out."})}},x_=class extends Dt{},D_=class extends Dt{},O_=class extends Dt{},U_=class extends Dt{},L_=class extends Dt{},q_=class extends Dt{},F_=class extends Dt{},V_=class extends Dt{};const nI=/^[a-z][a-z0-9+.-]*:/i,rI=t=>nI.test(t);let sc=t=>(sc=Array.isArray,sc(t));const oI=sc;let sI=oI;const eh=sI;function iI(t){if(!t)return!0;for(const e in t)return!1;return!0}function aI(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const lI=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new xt(`${t} must be an integer`);if(e<0)throw new xt(`${t} must be a positive integer`);return e},cI=t=>{try{return JSON.parse(t)}catch{return}};const uI=t=>new Promise(e=>setTimeout(e,t));const ur="0.0.1";function dI(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const fI=()=>{var t,e,n,r,o;const s=dI();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ur,"X-Stainless-OS":nh(Deno.build.os),"X-Stainless-Arch":th(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ur,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ur,"X-Stainless-OS":nh((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":th((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(o=globalThis.process.version)!==null&&o!==void 0?o:"unknown"};const i=hI();return i?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ur,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${i.browser}`,"X-Stainless-Runtime-Version":i.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ur,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function hI(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const o=r[1]||0,s=r[2]||0,i=r[3]||0;return{browser:e,version:`${o}.${s}.${i}`}}}return null}const th=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",nh=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let No;const pI=()=>No??(No=fI());function mI(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function z_(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function gI(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return z_({start(){},async pull(n){const{done:r,value:o}=await e.next();r?n.close():n.enqueue(o)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function H_(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n?.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function _I(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const r=t.getReader(),o=r.cancel();r.releaseLock(),await o}const yI=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});const G_=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e?.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function ja(t,e,n){return G_(),new File(t,e??"unknown_file",n)}function vI(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const wI=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";const B_=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",SI=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&B_(t),EI=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function TI(t,e,n){if(G_(),t=await t,SI(t))return t instanceof File?t:ja([await t.arrayBuffer()],t.name);if(EI(t)){const o=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),ja(await ic(o),e,n)}const r=await ic(t);if(e||(e=vI(t)),!n?.type){const o=r.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof o=="string"&&(n=Object.assign(Object.assign({},n),{type:o}))}return ja(r,e,n)}async function ic(t){var e,n,r,o,s;let i=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)i.push(t);else if(B_(t))i.push(t instanceof Blob?t:await t.arrayBuffer());else if(wI(t))try{for(var a=!0,l=Kt(t),c;c=await l.next(),e=c.done,!e;a=!0){o=c.value,a=!1;const u=o;i.push(...await ic(u))}}catch(u){n={error:u}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}else{const u=(s=t?.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof t}${u?`; constructor: ${u}`:""}${bI(t)}`)}return i}function bI(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}let J_=class{constructor(e){this._client=e}};J_._key=[];function K_(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const rh=Object.freeze(Object.create(null)),CI=(t=K_)=>(function(n,...r){if(n.length===1)return n[0];let o=!1;const s=[],i=n.reduce((u,h,p)=>{var m,w,E;/[?#]/.test(h)&&(o=!0);const _=r[p];let v=(o?encodeURIComponent:t)(""+_);return p!==r.length&&(_==null||typeof _=="object"&&_.toString===((E=Object.getPrototypeOf((w=Object.getPrototypeOf((m=_.hasOwnProperty)!==null&&m!==void 0?m:rh))!==null&&w!==void 0?w:rh))===null||E===void 0?void 0:E.toString))&&(v=_+"",s.push({start:u.length+h.length,length:v.length,error:`Value of type ${Object.prototype.toString.call(_).slice(8,-1)} is not a valid path parameter`})),u+h+(p===r.length?"":v)},""),a=i.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=l.exec(a))!==null;)s.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(s.sort((u,h)=>u.start-h.start),s.length>0){let u=0;const h=s.reduce((p,m)=>{const w=" ".repeat(m.start-u),E="^".repeat(m.length);return u=m.start+m.length,p+w+E},"");throw new xt(`Path parameters result in path with invalid segments:
${s.map(p=>p.error).join(`
`)}
${i}
${h}`)}return i}),Mo=CI(K_);class W_ extends J_{create(e,n){var r;const{api_version:o=this._client.apiVersion}=e,s=Ui(e,["api_version"]);if("model"in s&&"agent_config"in s)throw new xt("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new xt("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Mo`/${o}/interactions`,Object.assign(Object.assign({body:s},n),{stream:(r=e.stream)!==null&&r!==void 0?r:!1}))}delete(e,n={},r){const{api_version:o=this._client.apiVersion}=n??{};return this._client.delete(Mo`/${o}/interactions/${e}`,r)}cancel(e,n={},r){const{api_version:o=this._client.apiVersion}=n??{};return this._client.post(Mo`/${o}/interactions/${e}/cancel`,r)}get(e,n={},r){var o;const s=n??{},{api_version:i=this._client.apiVersion}=s,a=Ui(s,["api_version"]);return this._client.get(Mo`/${i}/interactions/${e}`,Object.assign(Object.assign({query:a},r),{stream:(o=n?.stream)!==null&&o!==void 0?o:!1}))}}W_._key=Object.freeze(["interactions"]);class Z_ extends W_{}function kI(t){let e=0;for(const o of t)e+=o.length;const n=new Uint8Array(e);let r=0;for(const o of t)n.set(o,r),r+=o.length;return n}let xo;function nu(t){let e;return(xo??(e=new globalThis.TextEncoder,xo=e.encode.bind(e)))(t)}let Do;function oh(t){let e;return(Do??(e=new globalThis.TextDecoder,Do=e.decode.bind(e)))(t)}let ya=class{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?nu(e):e;this.buffer=kI([this.buffer,n]);const r=[];let o;for(;(o=II(this.buffer,this.carriageReturnIndex))!=null;){if(o.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=o.index;continue}if(this.carriageReturnIndex!=null&&(o.index!==this.carriageReturnIndex+1||o.carriage)){r.push(oh(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?o.preceding-1:o.preceding,i=oh(this.buffer.subarray(0,s));r.push(i),this.buffer=this.buffer.subarray(o.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}};ya.NEWLINE_CHARS=new Set([`
`,"\r"]);ya.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function II(t,e){for(let o=e??0;o<t.length;o++){if(t[o]===10)return{preceding:o,index:o+1,carriage:!1};if(t[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function RI(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}const Li={off:0,error:200,warn:300,info:400,debug:500},sh=(t,e,n)=>{if(t){if(aI(Li,t))return t;vt(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Li))}`)}};function Kr(){}function Oo(t,e,n){return!e||Li[t]>Li[n]?Kr:e[t].bind(e)}const $I={error:Kr,warn:Kr,info:Kr,debug:Kr};let ih=new WeakMap;function vt(t){var e;const n=t.logger,r=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return $I;const o=ih.get(n);if(o&&o[0]===r)return o[1];const s={error:Oo("error",n,r),warn:Oo("warn",n,r),info:Oo("info",n,r),debug:Oo("debug",n,r)};return ih.set(n,[r,s]),s}const Hn=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);let AI=class Wr{constructor(e,n,r){this.iterator=e,this.controller=n,this.client=r}static fromSSEResponse(e,n,r){let o=!1;const s=r?vt(r):console;function i(){return Jt(this,arguments,function*(){var l,c,u,h;if(o)throw new xt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let p=!1;try{try{for(var m=!0,w=Kt(PI(e,n)),E;E=yield he(w.next()),l=E.done,!l;m=!0){h=E.value,m=!1;const _=h;if(!p)if(_.data.startsWith("[DONE]")){p=!0;continue}else try{yield yield he(JSON.parse(_.data))}catch(v){throw s.error("Could not parse message into JSON:",_.data),s.error("From chunk:",_.raw),v}}}catch(_){c={error:_}}finally{try{!m&&!l&&(u=w.return)&&(yield he(u.call(w)))}finally{if(c)throw c.error}}p=!0}catch(_){if(tc(_))return yield he(void 0);throw _}finally{p||n.abort()}})}return new Wr(i,n,r)}static fromReadableStream(e,n,r){let o=!1;function s(){return Jt(this,arguments,function*(){var l,c,u,h;const p=new ya,m=H_(e);try{for(var w=!0,E=Kt(m),_;_=yield he(E.next()),l=_.done,!l;w=!0){h=_.value,w=!1;const v=h;for(const g of p.decode(v))yield yield he(g)}}catch(v){c={error:v}}finally{try{!w&&!l&&(u=E.return)&&(yield he(u.call(E)))}finally{if(c)throw c.error}}for(const v of p.flush())yield yield he(v)})}function i(){return Jt(this,arguments,function*(){var l,c,u,h;if(o)throw new xt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let p=!1;try{try{for(var m=!0,w=Kt(s()),E;E=yield he(w.next()),l=E.done,!l;m=!0){h=E.value,m=!1;const _=h;p||_&&(yield yield he(JSON.parse(_)))}}catch(_){c={error:_}}finally{try{!m&&!l&&(u=w.return)&&(yield he(u.call(w)))}finally{if(c)throw c.error}}p=!0}catch(_){if(tc(_))return yield he(void 0);throw _}finally{p||n.abort()}})}return new Wr(i,n,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),o=s=>({next:()=>{if(s.length===0){const i=r.next();e.push(i),n.push(i)}return s.shift()}});return[new Wr(()=>o(e),this.controller,this.client),new Wr(()=>o(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return z_({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:o,done:s}=await n.next();if(s)return r.close();const i=nu(JSON.stringify(o)+`
`);r.enqueue(i)}catch(o){r.error(o)}},async cancel(){var r;await((r=n.return)===null||r===void 0?void 0:r.call(n))}})}};function PI(t,e){return Jt(this,arguments,function*(){var r,o,s,i;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new xt("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new xt("Attempted to iterate over a response with no body");const a=new MI,l=new ya,c=H_(t.body);try{for(var u=!0,h=Kt(NI(c)),p;p=yield he(h.next()),r=p.done,!r;u=!0){i=p.value,u=!1;const m=i;for(const w of l.decode(m)){const E=a.decode(w);E&&(yield yield he(E))}}}catch(m){o={error:m}}finally{try{!u&&!r&&(s=h.return)&&(yield he(s.call(h)))}finally{if(o)throw o.error}}for(const m of l.flush()){const w=a.decode(m);w&&(yield yield he(w))}})}function NI(t){return Jt(this,arguments,function*(){var n,r,o,s;let i=new Uint8Array;try{for(var a=!0,l=Kt(t),c;c=yield he(l.next()),n=c.done,!n;a=!0){s=c.value,a=!1;const u=s;if(u==null)continue;const h=u instanceof ArrayBuffer?new Uint8Array(u):typeof u=="string"?nu(u):u;let p=new Uint8Array(i.length+h.length);p.set(i),p.set(h,i.length),i=p;let m;for(;(m=RI(i))!==-1;)yield yield he(i.slice(0,m)),i=i.slice(m)}}catch(u){r={error:u}}finally{try{!a&&!n&&(o=l.return)&&(yield he(o.call(l)))}finally{if(r)throw r.error}}i.length>0&&(yield yield he(i))})}let MI=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,o]=xI(e,":");return o.startsWith(" ")&&(o=o.substring(1)),n==="event"?this.event=o:n==="data"&&this.data.push(o),null}};function xI(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function DI(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:o,startTime:s}=e,i=await(async()=>{var a;if(e.options.stream)return vt(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):AI.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const l=n.headers.get("content-type"),c=(a=l?.split(";")[0])===null||a===void 0?void 0:a.trim();return c?.includes("application/json")||c?.endsWith("+json")?await n.json():await n.text()})();return vt(t).debug(`[${r}] response parsed`,Hn({retryOfRequestLogID:o,url:n.url,status:n.status,body:i,durationMs:Date.now()-s})),i}let OI=class Y_ extends Promise{constructor(e,n,r=DI){super(o=>{o(null)}),this.responsePromise=n,this.parseResponse=r,this.client=e}_thenUnwrap(e){return new Y_(this.client,this.responsePromise,async(n,r)=>e(await this.parseResponse(n,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}};const X_=Symbol("brand.privateNullableHeaders");function*UI(t){if(!t)return;if(X_ in t){const{values:r,nulls:o}=t;yield*r.entries();for(const s of o)yield[s,null];return}let e=!1,n;t instanceof Headers?n=t.entries():eh(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const o=r[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const s=eh(r[1])?r[1]:[r[1]];let i=!1;for(const a of s)a!==void 0&&(e&&!i&&(i=!0,yield[o,null]),yield[o,a])}}const Lr=t=>{const e=new Headers,n=new Set;for(const r of t){const o=new Set;for(const[s,i]of UI(r)){const a=s.toLowerCase();o.has(a)||(e.delete(s),o.add(a)),i===null?(e.delete(s),n.add(a)):(e.append(s,i),n.delete(a))}}return{[X_]:!0,values:e,nulls:n}};const el=t=>{var e,n,r,o,s,i;if(typeof globalThis.process<"u")return(r=(n=(e=rS)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(i=(s=(o=globalThis.Deno.env)===null||o===void 0?void 0:o.get)===null||s===void 0?void 0:s.call(o,t))===null||i===void 0?void 0:i.trim()};var Q_;class va{constructor(e){var n,r,o,s,i,a,l,{baseURL:c=el("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:u=(n=el("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:h="v1beta"}=e,p=Ui(e,["baseURL","apiKey","apiVersion"]);const m=Object.assign(Object.assign({apiKey:u,apiVersion:h},p),{baseURL:c||"https://generativelanguage.googleapis.com"});this.baseURL=m.baseURL,this.timeout=(r=m.timeout)!==null&&r!==void 0?r:va.DEFAULT_TIMEOUT,this.logger=(o=m.logger)!==null&&o!==void 0?o:console;const w="warn";this.logLevel=w,this.logLevel=(i=(s=sh(m.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:sh(el("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&i!==void 0?i:w,this.fetchOptions=m.fetchOptions,this.maxRetries=(a=m.maxRetries)!==null&&a!==void 0?a:2,this.fetch=(l=m.fetch)!==null&&l!==void 0?l:mI(),this.encoder=yI,this._options=m,this.apiKey=u,this.apiVersion=h,this.clientAdapter=m.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const n=Lr([e.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return Lr([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Lr([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new xt(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${ur}`}defaultIdempotencyKey(){return`stainless-node-retry-${tI()}`}makeStatusError(e,n,r,o){return Dt.generate(e,n,r,o)}buildURL(e,n,r){const o=!this.baseURLOverridden()&&r||this.baseURL,s=rI(e)?new URL(e):new URL(o+(o.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return iI(i)||(n=Object.assign(Object.assign({},i),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(s.search=this.stringifyQuery(n)),s.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const n=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(o=>Object.assign({method:e,path:n},o)))}request(e,n=null){return new OI(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){var o,s,i;const a=await e,l=(o=a.maxRetries)!==null&&o!==void 0?o:this.maxRetries;n==null&&(n=l),await this.prepareOptions(a);const{req:c,url:u,timeout:h}=await this.buildRequest(a,{retryCount:l-n});await this.prepareRequest(c,{url:u,options:a});const p="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),m=r===void 0?"":`, retryOf: ${r}`,w=Date.now();if(vt(this).debug(`[${p}] sending request`,Hn({retryOfRequestLogID:r,method:a.method,url:u,options:a,headers:c.headers})),!((s=a.signal)===null||s===void 0)&&s.aborted)throw new oc;const E=new AbortController,_=await this.fetchWithTimeout(u,c,h,E).catch(nc),v=Date.now();if(_ instanceof globalThis.Error){const S=`retrying, ${n} attempts remaining`;if(!((i=a.signal)===null||i===void 0)&&i.aborted)throw new oc;const b=tc(_)||/timed? ?out/i.test(String(_)+("cause"in _?String(_.cause):""));if(n)return vt(this).info(`[${p}] connection ${b?"timed out":"failed"} - ${S}`),vt(this).debug(`[${p}] connection ${b?"timed out":"failed"} (${S})`,Hn({retryOfRequestLogID:r,url:u,durationMs:v-w,message:_.message})),this.retryRequest(a,n,r??p);throw vt(this).info(`[${p}] connection ${b?"timed out":"failed"} - error; no more retries left`),vt(this).debug(`[${p}] connection ${b?"timed out":"failed"} (error; no more retries left)`,Hn({retryOfRequestLogID:r,url:u,durationMs:v-w,message:_.message})),b?new M_:new _a({cause:_})}const g=`[${p}${m}] ${c.method} ${u} ${_.ok?"succeeded":"failed"} with status ${_.status} in ${v-w}ms`;if(!_.ok){const S=await this.shouldRetry(_);if(n&&S){const M=`retrying, ${n} attempts remaining`;return await _I(_.body),vt(this).info(`${g} - ${M}`),vt(this).debug(`[${p}] response error (${M})`,Hn({retryOfRequestLogID:r,url:_.url,status:_.status,headers:_.headers,durationMs:v-w})),this.retryRequest(a,n,r??p,_.headers)}const b=S?"error; no more retries left":"error; not retryable";vt(this).info(`${g} - ${b}`);const y=await _.text().catch(M=>nc(M).message),C=cI(y),k=C?void 0:y;throw vt(this).debug(`[${p}] response error (${b})`,Hn({retryOfRequestLogID:r,url:_.url,status:_.status,headers:_.headers,message:k,durationMs:Date.now()-w})),this.makeStatusError(_.status,C,k,_.headers)}return vt(this).info(g),vt(this).debug(`[${p}] response start`,Hn({retryOfRequestLogID:r,url:_.url,status:_.status,headers:_.headers,durationMs:v-w})),{response:_,options:a,controller:E,requestLogID:p,retryOfRequestLogID:r,startTime:w}}async fetchWithTimeout(e,n,r,o){const s=n||{},{signal:i,method:a}=s,l=Ui(s,["signal","method"]);i&&i.addEventListener("abort",()=>o.abort());const c=setTimeout(()=>o.abort(),r),u=globalThis.ReadableStream&&l.body instanceof globalThis.ReadableStream||typeof l.body=="object"&&l.body!==null&&Symbol.asyncIterator in l.body,h=Object.assign(Object.assign(Object.assign({signal:o.signal},u?{duplex:"half"}:{}),{method:"GET"}),l);a&&(h.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,h)}finally{clearTimeout(c)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,o){var s;let i;const a=o?.get("retry-after-ms");if(a){const c=parseFloat(a);Number.isNaN(c)||(i=c)}const l=o?.get("retry-after");if(l&&!i){const c=parseFloat(l);Number.isNaN(c)?i=Date.parse(l)-Date.now():i=c*1e3}if(!(i&&0<=i&&i<60*1e3)){const c=(s=e.maxRetries)!==null&&s!==void 0?s:this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(n,c)}return await uI(i),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const s=n-e,i=Math.min(.5*Math.pow(2,s),8),a=1-Math.random()*.25;return i*a*1e3}async buildRequest(e,{retryCount:n=0}={}){var r,o,s;const i=Object.assign({},e),{method:a,path:l,query:c,defaultBaseURL:u}=i,h=this.buildURL(l,c,u);"timeout"in i&&lI("timeout",i.timeout),i.timeout=(r=i.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:p,body:m}=this.buildBody({options:i}),w=await this.buildHeaders({options:e,method:a,bodyHeaders:p,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:a,headers:w},i.signal&&{signal:i.signal}),globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"}),m&&{body:m}),(o=this.fetchOptions)!==null&&o!==void 0?o:{}),(s=i.fetchOptions)!==null&&s!==void 0?s:{}),url:h,timeout:i.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:o}){let s={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);const i=await this.authHeaders(e);let a=Lr([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),pI()),this._options.defaultHeaders,r,e.headers,i]);return this.validateHeaders(a),a.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=Lr([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:gI(e)}:this.encoder({body:e,headers:r})}}va.DEFAULT_TIMEOUT=6e4;class nt extends va{constructor(){super(...arguments),this.interactions=new Z_(this)}}Q_=nt;nt.GeminiNextGenAPIClient=Q_;nt.GeminiNextGenAPIClientError=xt;nt.APIError=Dt;nt.APIConnectionError=_a;nt.APIConnectionTimeoutError=M_;nt.APIUserAbortError=oc;nt.NotFoundError=U_;nt.ConflictError=L_;nt.RateLimitError=F_;nt.BadRequestError=x_;nt.AuthenticationError=D_;nt.InternalServerError=V_;nt.PermissionDeniedError=O_;nt.UnprocessableEntityError=q_;nt.toFile=TI;nt.Interactions=Z_;function LI(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function qI(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function FI(t,e){const n={},r=d(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function VI(t,e){const n={},r=d(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function zI(t,e,n){const r={};if(d(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const o=d(t,["tunedModelDisplayName"]);if(e!==void 0&&o!=null&&f(e,["displayName"],o),d(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=d(t,["epochCount"]);e!==void 0&&s!=null&&f(e,["tuningTask","hyperparameters","epochCount"],s);const i=d(t,["learningRateMultiplier"]);if(i!=null&&f(r,["tuningTask","hyperparameters","learningRateMultiplier"],i),d(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");if(d(t,["tuningMode"])!==void 0)throw new Error("tuningMode parameter is not supported in Gemini API.");if(d(t,["customBaseModel"])!==void 0)throw new Error("customBaseModel parameter is not supported in Gemini API.");const a=d(t,["batchSize"]);e!==void 0&&a!=null&&f(e,["tuningTask","hyperparameters","batchSize"],a);const l=d(t,["learningRate"]);if(e!==void 0&&l!=null&&f(e,["tuningTask","hyperparameters","learningRate"],l),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(d(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");if(d(t,["baseTeacherModel"])!==void 0)throw new Error("baseTeacherModel parameter is not supported in Gemini API.");if(d(t,["tunedTeacherModelSource"])!==void 0)throw new Error("tunedTeacherModelSource parameter is not supported in Gemini API.");if(d(t,["sftLossWeightMultiplier"])!==void 0)throw new Error("sftLossWeightMultiplier parameter is not supported in Gemini API.");if(d(t,["outputUri"])!==void 0)throw new Error("outputUri parameter is not supported in Gemini API.");return r}function HI(t,e,n){const r={};let o=d(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const y=d(t,["validationDataset"]);e!==void 0&&y!=null&&f(e,["supervisedTuningSpec"],tl(y))}else if(o==="PREFERENCE_TUNING"){const y=d(t,["validationDataset"]);e!==void 0&&y!=null&&f(e,["preferenceOptimizationSpec"],tl(y))}else if(o==="DISTILLATION"){const y=d(t,["validationDataset"]);e!==void 0&&y!=null&&f(e,["distillationSpec"],tl(y))}const s=d(t,["tunedModelDisplayName"]);e!==void 0&&s!=null&&f(e,["tunedModelDisplayName"],s);const i=d(t,["description"]);e!==void 0&&i!=null&&f(e,["description"],i);let a=d(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const y=d(t,["epochCount"]);e!==void 0&&y!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],y)}else if(a==="PREFERENCE_TUNING"){const y=d(t,["epochCount"]);e!==void 0&&y!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],y)}else if(a==="DISTILLATION"){const y=d(t,["epochCount"]);e!==void 0&&y!=null&&f(e,["distillationSpec","hyperParameters","epochCount"],y)}let l=d(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const y=d(t,["learningRateMultiplier"]);e!==void 0&&y!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],y)}else if(l==="PREFERENCE_TUNING"){const y=d(t,["learningRateMultiplier"]);e!==void 0&&y!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],y)}else if(l==="DISTILLATION"){const y=d(t,["learningRateMultiplier"]);e!==void 0&&y!=null&&f(e,["distillationSpec","hyperParameters","learningRateMultiplier"],y)}let c=d(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const y=d(t,["exportLastCheckpointOnly"]);e!==void 0&&y!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],y)}else if(c==="PREFERENCE_TUNING"){const y=d(t,["exportLastCheckpointOnly"]);e!==void 0&&y!=null&&f(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],y)}else if(c==="DISTILLATION"){const y=d(t,["exportLastCheckpointOnly"]);e!==void 0&&y!=null&&f(e,["distillationSpec","exportLastCheckpointOnly"],y)}let u=d(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const y=d(t,["adapterSize"]);e!==void 0&&y!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],y)}else if(u==="PREFERENCE_TUNING"){const y=d(t,["adapterSize"]);e!==void 0&&y!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],y)}else if(u==="DISTILLATION"){const y=d(t,["adapterSize"]);e!==void 0&&y!=null&&f(e,["distillationSpec","hyperParameters","adapterSize"],y)}let h=d(n,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const y=d(t,["tuningMode"]);e!==void 0&&y!=null&&f(e,["supervisedTuningSpec","tuningMode"],y)}const p=d(t,["customBaseModel"]);e!==void 0&&p!=null&&f(e,["customBaseModel"],p);let m=d(n,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const y=d(t,["batchSize"]);e!==void 0&&y!=null&&f(e,["supervisedTuningSpec","hyperParameters","batchSize"],y)}let w=d(n,["config","method"]);if(w===void 0&&(w="SUPERVISED_FINE_TUNING"),w==="SUPERVISED_FINE_TUNING"){const y=d(t,["learningRate"]);e!==void 0&&y!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRate"],y)}const E=d(t,["labels"]);e!==void 0&&E!=null&&f(e,["labels"],E);const _=d(t,["beta"]);e!==void 0&&_!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","beta"],_);const v=d(t,["baseTeacherModel"]);e!==void 0&&v!=null&&f(e,["distillationSpec","baseTeacherModel"],v);const g=d(t,["tunedTeacherModelSource"]);e!==void 0&&g!=null&&f(e,["distillationSpec","tunedTeacherModelSource"],g);const S=d(t,["sftLossWeightMultiplier"]);e!==void 0&&S!=null&&f(e,["distillationSpec","hyperParameters","sftLossWeightMultiplier"],S);const b=d(t,["outputUri"]);return e!==void 0&&b!=null&&f(e,["outputUri"],b),r}function GI(t,e){const n={},r=d(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const o=d(t,["preTunedModel"]);o!=null&&f(n,["preTunedModel"],o);const s=d(t,["trainingDataset"]);s!=null&&tR(s);const i=d(t,["config"]);return i!=null&&zI(i,n),n}function BI(t,e){const n={},r=d(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const o=d(t,["preTunedModel"]);o!=null&&f(n,["preTunedModel"],o);const s=d(t,["trainingDataset"]);s!=null&&nR(s,n,e);const i=d(t,["config"]);return i!=null&&HI(i,n,e),n}function JI(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function KI(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function WI(t,e,n){const r={},o=d(t,["pageSize"]);e!==void 0&&o!=null&&f(e,["_query","pageSize"],o);const s=d(t,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const i=d(t,["filter"]);return e!==void 0&&i!=null&&f(e,["_query","filter"],i),r}function ZI(t,e,n){const r={},o=d(t,["pageSize"]);e!==void 0&&o!=null&&f(e,["_query","pageSize"],o);const s=d(t,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const i=d(t,["filter"]);return e!==void 0&&i!=null&&f(e,["_query","filter"],i),r}function YI(t,e){const n={},r=d(t,["config"]);return r!=null&&WI(r,n),n}function XI(t,e){const n={},r=d(t,["config"]);return r!=null&&ZI(r,n),n}function QI(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["nextPageToken"]);o!=null&&f(n,["nextPageToken"],o);const s=d(t,["tunedModels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>j_(a))),f(n,["tuningJobs"],i)}return n}function jI(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["nextPageToken"]);o!=null&&f(n,["nextPageToken"],o);const s=d(t,["tuningJobs"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>ac(a))),f(n,["tuningJobs"],i)}return n}function eR(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["model"],r);const o=d(t,["name"]);return o!=null&&f(n,["endpoint"],o),n}function tR(t,e){const n={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=d(t,["examples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),f(n,["examples","examples"],o)}return n}function nR(t,e,n){const r={};let o=d(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const i=d(t,["gcsUri"]);e!==void 0&&i!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],i)}else if(o==="PREFERENCE_TUNING"){const i=d(t,["gcsUri"]);e!==void 0&&i!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],i)}else if(o==="DISTILLATION"){const i=d(t,["gcsUri"]);e!==void 0&&i!=null&&f(e,["distillationSpec","promptDatasetUri"],i)}let s=d(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const i=d(t,["vertexDatasetResource"]);e!==void 0&&i!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],i)}else if(s==="PREFERENCE_TUNING"){const i=d(t,["vertexDatasetResource"]);e!==void 0&&i!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],i)}else if(s==="DISTILLATION"){const i=d(t,["vertexDatasetResource"]);e!==void 0&&i!=null&&f(e,["distillationSpec","promptDatasetUri"],i)}if(d(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function j_(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["name"]);o!=null&&f(n,["name"],o);const s=d(t,["state"]);s!=null&&f(n,["state"],p_(s));const i=d(t,["createTime"]);i!=null&&f(n,["createTime"],i);const a=d(t,["tuningTask","startTime"]);a!=null&&f(n,["startTime"],a);const l=d(t,["tuningTask","completeTime"]);l!=null&&f(n,["endTime"],l);const c=d(t,["updateTime"]);c!=null&&f(n,["updateTime"],c);const u=d(t,["description"]);u!=null&&f(n,["description"],u);const h=d(t,["baseModel"]);h!=null&&f(n,["baseModel"],h);const p=d(t,["_self"]);return p!=null&&f(n,["tunedModel"],eR(p)),n}function ac(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["name"]);o!=null&&f(n,["name"],o);const s=d(t,["state"]);s!=null&&f(n,["state"],p_(s));const i=d(t,["createTime"]);i!=null&&f(n,["createTime"],i);const a=d(t,["startTime"]);a!=null&&f(n,["startTime"],a);const l=d(t,["endTime"]);l!=null&&f(n,["endTime"],l);const c=d(t,["updateTime"]);c!=null&&f(n,["updateTime"],c);const u=d(t,["error"]);u!=null&&f(n,["error"],u);const h=d(t,["description"]);h!=null&&f(n,["description"],h);const p=d(t,["baseModel"]);p!=null&&f(n,["baseModel"],p);const m=d(t,["tunedModel"]);m!=null&&f(n,["tunedModel"],m);const w=d(t,["preTunedModel"]);w!=null&&f(n,["preTunedModel"],w);const E=d(t,["supervisedTuningSpec"]);E!=null&&f(n,["supervisedTuningSpec"],E);const _=d(t,["preferenceOptimizationSpec"]);_!=null&&f(n,["preferenceOptimizationSpec"],_);const v=d(t,["distillationSpec"]);v!=null&&f(n,["distillationSpec"],v);const g=d(t,["tuningDataStats"]);g!=null&&f(n,["tuningDataStats"],g);const S=d(t,["encryptionSpec"]);S!=null&&f(n,["encryptionSpec"],S);const b=d(t,["partnerModelTuningSpec"]);b!=null&&f(n,["partnerModelTuningSpec"],b);const y=d(t,["customBaseModel"]);y!=null&&f(n,["customBaseModel"],y);const C=d(t,["experiment"]);C!=null&&f(n,["experiment"],C);const k=d(t,["labels"]);k!=null&&f(n,["labels"],k);const P=d(t,["outputUri"]);P!=null&&f(n,["outputUri"],P);const M=d(t,["pipelineJob"]);M!=null&&f(n,["pipelineJob"],M);const q=d(t,["serviceAccount"]);q!=null&&f(n,["serviceAccount"],q);const D=d(t,["tunedModelDisplayName"]);D!=null&&f(n,["tunedModelDisplayName"],D);const G=d(t,["veoTuningSpec"]);return G!=null&&f(n,["veoTuningSpec"],G),n}function rR(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const o=d(t,["name"]);o!=null&&f(n,["name"],o);const s=d(t,["metadata"]);s!=null&&f(n,["metadata"],s);const i=d(t,["done"]);i!=null&&f(n,["done"],i);const a=d(t,["error"]);return a!=null&&f(n,["error"],a),n}function tl(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&f(n,["validationDatasetUri"],r);const o=d(t,["vertexDatasetResource"]);return o!=null&&f(n,["validationDatasetUri"],o),n}class oR extends pn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Qn(hn.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const o={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(o.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:o});return s.baseModel=void 0,await this.tuneInternal(s)}else{const o=Object.assign({},n);return await this.tuneInternal(o)}else{const o=Object.assign({},n),s=await this.tuneMldevInternal(o);let i="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?i=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(i=s.name.split("/operations/")[0]),{name:i,state:Kl.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=KI(e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>ac(u))}else{const c=JI(e);return a=ne("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>j_(u))}}async listInternal(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=XI(e);return a=ne("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=jI(u),p=new Mf;return Object.assign(p,h),p})}else{const c=YI(e);return a=ne("tunedModels",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=QI(u),p=new Mf;return Object.assign(p,h),p})}}async cancel(e){var n,r,o,s;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=qI(e);return a=ne("{name}:cancel",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=VI(u),p=new xf;return Object.assign(p,h),p})}else{const c=LI(e);return a=ne("{name}:cancel",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const h=FI(u),p=new xf;return Object.assign(p,h),p})}}async tuneInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI()){const a=BI(e,e);return s=ne("tuningJobs",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),o.then(l=>ac(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let o,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=GI(e);return s=ne("tunedModels",a._url),i=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),o.then(l=>rR(l))}}}class sR{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const iR=1024*1024*8,aR=3,lR=1e3,cR=2,qi="x-goog-upload-status";async function uR(t,e,n){var r;const o=await ey(t,e,n),s=await o?.json();if(((r=o?.headers)===null||r===void 0?void 0:r[qi])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function dR(t,e,n){var r;const o=await ey(t,e,n),s=await o?.json();if(((r=o?.headers)===null||r===void 0?void 0:r[qi])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const i=l_(s),a=new Yc;return Object.assign(a,i),a}async function ey(t,e,n){var r,o;let s=0,i=0,a=new Zl(new Response),l="upload";for(s=t.size;i<s;){const c=Math.min(iR,s-i),u=t.slice(i,i+c);i+c>=s&&(l+=", finalize");let h=0,p=lR;for(;h<aR&&(a=await n.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(i),"Content-Length":String(c)}}}),!(!((r=a?.headers)===null||r===void 0)&&r[qi]));)h++,await hR(p),p=p*cR;if(i+=c,((o=a?.headers)===null||o===void 0?void 0:o[qi])!=="active")break;if(s<=i)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function fR(t){return{size:t.size,type:t.type}}function hR(t){return new Promise(e=>setTimeout(e,t))}class pR{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await uR(e,n,r)}async uploadToFileSearchStore(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await dR(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await fR(e)}}class mR{create(e,n,r){return new gR(e,n,r)}}class gR{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const ah="x-goog-api-key";class _R{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(ah)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(ah,this.apiKey)}}}const yR="gl-node/";class vR{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new nt({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=aS(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const o=new _R(this.apiKey);this.apiClient=new uk({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:yR+"web",uploader:new pR,downloader:new sR}),this.models=new $k(this.apiClient),this.live=new Tk(this.apiClient,o,new mR),this.batches=new UE(this.apiClient),this.chats=new yT(this.models,this.apiClient),this.caches=new mT(this.apiClient),this.files=new AT(this.apiClient),this.operations=new Ak(this.apiClient),this.authTokens=new Jk(this.apiClient),this.tunings=new oR(this.apiClient),this.fileSearchStores=new eI(this.apiClient)}}const wR=Object.freeze({status:"aborted"});function J(t,e,n){function r(a,l){if(a._zod||Object.defineProperty(a,"_zod",{value:{def:l,constr:i,traits:new Set},enumerable:!1}),a._zod.traits.has(t))return;a._zod.traits.add(t),e(a,l);const c=i.prototype,u=Object.keys(c);for(let h=0;h<u.length;h++){const p=u[h];p in a||(a[p]=c[p].bind(a))}}const o=n?.Parent??Object;class s extends o{}Object.defineProperty(s,"name",{value:t});function i(a){var l;const c=n?.Parent?new s:this;r(c,a),(l=c._zod).deferred??(l.deferred=[]);for(const u of c._zod.deferred)u();return c}return Object.defineProperty(i,"init",{value:r}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>n?.Parent&&a instanceof n.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(i,"name",{value:t}),i}class Er extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class ty extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const ny={};function Tn(t){return ny}function ry(t){const e=Object.values(t).filter(r=>typeof r=="number");return Object.entries(t).filter(([r,o])=>e.indexOf(+r)===-1).map(([r,o])=>o)}function lc(t,e){return typeof e=="bigint"?e.toString():e}function wa(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function ru(t){return t==null}function ou(t){const e=t.startsWith("^")?1:0,n=t.endsWith("$")?t.length-1:t.length;return t.slice(e,n)}function SR(t,e){const n=(t.toString().split(".")[1]||"").length,r=e.toString();let o=(r.split(".")[1]||"").length;if(o===0&&/\d?e-\d?/.test(r)){const l=r.match(/\d?e-(\d?)/);l?.[1]&&(o=Number.parseInt(l[1]))}const s=n>o?n:o,i=Number.parseInt(t.toFixed(s).replace(".","")),a=Number.parseInt(e.toFixed(s).replace(".",""));return i%a/10**s}const lh=Symbol("evaluating");function Pe(t,e,n){let r;Object.defineProperty(t,e,{get(){if(r!==lh)return r===void 0&&(r=lh,r=n()),r},set(o){Object.defineProperty(t,e,{value:o})},configurable:!0})}function jn(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function kn(...t){const e={};for(const n of t){const r=Object.getOwnPropertyDescriptors(n);Object.assign(e,r)}return Object.defineProperties({},e)}function ch(t){return JSON.stringify(t)}function ER(t){return t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const oy="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function go(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const TR=wa(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function br(t){if(go(t)===!1)return!1;const e=t.constructor;if(e===void 0||typeof e!="function")return!0;const n=e.prototype;return!(go(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function sy(t){return br(t)?{...t}:Array.isArray(t)?[...t]:t}const bR=new Set(["string","number","symbol"]);function Cr(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function In(t,e,n){const r=new t._zod.constr(e??t._zod.def);return(!e||n?.parent)&&(r._zod.parent=t),r}function ae(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function CR(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const kR={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function IR(t,e){const n=t._zod.def,r=n.checks;if(r&&r.length>0)throw new Error(".pick() cannot be used on object schemas containing refinements");const s=kn(t._zod.def,{get shape(){const i={};for(const a in e){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);e[a]&&(i[a]=n.shape[a])}return jn(this,"shape",i),i},checks:[]});return In(t,s)}function RR(t,e){const n=t._zod.def,r=n.checks;if(r&&r.length>0)throw new Error(".omit() cannot be used on object schemas containing refinements");const s=kn(t._zod.def,{get shape(){const i={...t._zod.def.shape};for(const a in e){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);e[a]&&delete i[a]}return jn(this,"shape",i),i},checks:[]});return In(t,s)}function $R(t,e){if(!br(e))throw new Error("Invalid input to extend: expected a plain object");const n=t._zod.def.checks;if(n&&n.length>0){const s=t._zod.def.shape;for(const i in e)if(Object.getOwnPropertyDescriptor(s,i)!==void 0)throw new Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}const o=kn(t._zod.def,{get shape(){const s={...t._zod.def.shape,...e};return jn(this,"shape",s),s}});return In(t,o)}function AR(t,e){if(!br(e))throw new Error("Invalid input to safeExtend: expected a plain object");const n=kn(t._zod.def,{get shape(){const r={...t._zod.def.shape,...e};return jn(this,"shape",r),r}});return In(t,n)}function PR(t,e){const n=kn(t._zod.def,{get shape(){const r={...t._zod.def.shape,...e._zod.def.shape};return jn(this,"shape",r),r},get catchall(){return e._zod.def.catchall},checks:[]});return In(t,n)}function NR(t,e,n){const o=e._zod.def.checks;if(o&&o.length>0)throw new Error(".partial() cannot be used on object schemas containing refinements");const i=kn(e._zod.def,{get shape(){const a=e._zod.def.shape,l={...a};if(n)for(const c in n){if(!(c in a))throw new Error(`Unrecognized key: "${c}"`);n[c]&&(l[c]=t?new t({type:"optional",innerType:a[c]}):a[c])}else for(const c in a)l[c]=t?new t({type:"optional",innerType:a[c]}):a[c];return jn(this,"shape",l),l},checks:[]});return In(e,i)}function MR(t,e,n){const r=kn(e._zod.def,{get shape(){const o=e._zod.def.shape,s={...o};if(n)for(const i in n){if(!(i in s))throw new Error(`Unrecognized key: "${i}"`);n[i]&&(s[i]=new t({type:"nonoptional",innerType:o[i]}))}else for(const i in o)s[i]=new t({type:"nonoptional",innerType:o[i]});return jn(this,"shape",s),s}});return In(e,r)}function mr(t,e=0){if(t.aborted===!0)return!0;for(let n=e;n<t.issues.length;n++)if(t.issues[n]?.continue!==!0)return!0;return!1}function gr(t,e){return e.map(n=>{var r;return(r=n).path??(r.path=[]),n.path.unshift(t),n})}function Uo(t){return typeof t=="string"?t:t?.message}function bn(t,e,n){const r={...t,path:t.path??[]};if(!t.message){const o=Uo(t.inst?._zod.def?.error?.(t))??Uo(e?.error?.(t))??Uo(n.customError?.(t))??Uo(n.localeError?.(t))??"Invalid input";r.message=o}return delete r.inst,delete r.continue,e?.reportInput||delete r.input,r}function su(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function _o(...t){const[e,n,r]=t;return typeof e=="string"?{message:e,code:"custom",input:n,inst:r}:{...e}}const iy=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,lc,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},ay=J("$ZodError",iy),ly=J("$ZodError",iy,{Parent:Error});function xR(t,e=n=>n.message){const n={},r=[];for(const o of t.issues)o.path.length>0?(n[o.path[0]]=n[o.path[0]]||[],n[o.path[0]].push(e(o))):r.push(e(o));return{formErrors:r,fieldErrors:n}}function DR(t,e=n=>n.message){const n={_errors:[]},r=o=>{for(const s of o.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(i=>r({issues:i}));else if(s.code==="invalid_key")r({issues:s.issues});else if(s.code==="invalid_element")r({issues:s.issues});else if(s.path.length===0)n._errors.push(e(s));else{let i=n,a=0;for(;a<s.path.length;){const l=s.path[a];a===s.path.length-1?(i[l]=i[l]||{_errors:[]},i[l]._errors.push(e(s))):i[l]=i[l]||{_errors:[]},i=i[l],a++}}};return r(t),n}const iu=t=>(e,n,r,o)=>{const s=r?Object.assign(r,{async:!1}):{async:!1},i=e._zod.run({value:n,issues:[]},s);if(i instanceof Promise)throw new Er;if(i.issues.length){const a=new(o?.Err??t)(i.issues.map(l=>bn(l,s,Tn())));throw oy(a,o?.callee),a}return i.value},au=t=>async(e,n,r,o)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let i=e._zod.run({value:n,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){const a=new(o?.Err??t)(i.issues.map(l=>bn(l,s,Tn())));throw oy(a,o?.callee),a}return i.value},Sa=t=>(e,n,r)=>{const o=r?{...r,async:!1}:{async:!1},s=e._zod.run({value:n,issues:[]},o);if(s instanceof Promise)throw new Er;return s.issues.length?{success:!1,error:new(t??ay)(s.issues.map(i=>bn(i,o,Tn())))}:{success:!0,data:s.value}},cy=Sa(ly),Ea=t=>async(e,n,r)=>{const o=r?Object.assign(r,{async:!0}):{async:!0};let s=e._zod.run({value:n,issues:[]},o);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new t(s.issues.map(i=>bn(i,o,Tn())))}:{success:!0,data:s.value}},OR=Ea(ly),UR=t=>(e,n,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return iu(t)(e,n,o)},LR=t=>(e,n,r)=>iu(t)(e,n,r),qR=t=>async(e,n,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return au(t)(e,n,o)},FR=t=>async(e,n,r)=>au(t)(e,n,r),VR=t=>(e,n,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Sa(t)(e,n,o)},zR=t=>(e,n,r)=>Sa(t)(e,n,r),HR=t=>async(e,n,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Ea(t)(e,n,o)},GR=t=>async(e,n,r)=>Ea(t)(e,n,r),BR=/^[cC][^\s-]{8,}$/,JR=/^[0-9a-z]+$/,KR=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,WR=/^[0-9a-vA-V]{20}$/,ZR=/^[A-Za-z0-9]{27}$/,YR=/^[a-zA-Z0-9_-]{21}$/,XR=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,QR=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,uh=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,jR=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,e$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function t$(){return new RegExp(e$,"u")}const n$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,r$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,o$=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,s$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,i$=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,uy=/^[A-Za-z0-9_-]*$/,a$=/^\+[1-9]\d{6,14}$/,dy="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",l$=new RegExp(`^${dy}$`);function fy(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function c$(t){return new RegExp(`^${fy(t)}$`)}function u$(t){const e=fy({precision:t.precision}),n=["Z"];t.local&&n.push(""),t.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${e}(?:${n.join("|")})`;return new RegExp(`^${dy}T(?:${r})$`)}const d$=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},f$=/^-?\d+$/,hy=/^-?\d+(?:\.\d+)?$/,h$=/^(?:true|false)$/i,p$=/^null$/i,m$=/^[^A-Z]*$/,g$=/^[^a-z]*$/,Tt=J("$ZodCheck",(t,e)=>{var n;t._zod??(t._zod={}),t._zod.def=e,(n=t._zod).onattach??(n.onattach=[])}),py={number:"number",bigint:"bigint",object:"date"},my=J("$ZodCheckLessThan",(t,e)=>{Tt.init(t,e);const n=py[typeof e.value];t._zod.onattach.push(r=>{const o=r._zod.bag,s=(e.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<s&&(e.inclusive?o.maximum=e.value:o.exclusiveMaximum=e.value)}),t._zod.check=r=>{(e.inclusive?r.value<=e.value:r.value<e.value)||r.issues.push({origin:n,code:"too_big",maximum:typeof e.value=="object"?e.value.getTime():e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),gy=J("$ZodCheckGreaterThan",(t,e)=>{Tt.init(t,e);const n=py[typeof e.value];t._zod.onattach.push(r=>{const o=r._zod.bag,s=(e.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>s&&(e.inclusive?o.minimum=e.value:o.exclusiveMinimum=e.value)}),t._zod.check=r=>{(e.inclusive?r.value>=e.value:r.value>e.value)||r.issues.push({origin:n,code:"too_small",minimum:typeof e.value=="object"?e.value.getTime():e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),_$=J("$ZodCheckMultipleOf",(t,e)=>{Tt.init(t,e),t._zod.onattach.push(n=>{var r;(r=n._zod.bag).multipleOf??(r.multipleOf=e.value)}),t._zod.check=n=>{if(typeof n.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%e.value===BigInt(0):SR(n.value,e.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:e.value,input:n.value,inst:t,continue:!e.abort})}}),y$=J("$ZodCheckNumberFormat",(t,e)=>{Tt.init(t,e),e.format=e.format||"float64";const n=e.format?.includes("int"),r=n?"int":"number",[o,s]=kR[e.format];t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=e.format,a.minimum=o,a.maximum=s,n&&(a.pattern=f$)}),t._zod.check=i=>{const a=i.value;if(n){if(!Number.isInteger(a)){i.issues.push({expected:r,format:e.format,code:"invalid_type",continue:!1,input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,inclusive:!0,continue:!e.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,inclusive:!0,continue:!e.abort});return}}a<o&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:o,inclusive:!0,inst:t,continue:!e.abort}),a>s&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inclusive:!0,inst:t,continue:!e.abort})}}),v$=J("$ZodCheckMaxLength",(t,e)=>{var n;Tt.init(t,e),(n=t._zod.def).when??(n.when=r=>{const o=r.value;return!ru(o)&&o.length!==void 0}),t._zod.onattach.push(r=>{const o=r._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<o&&(r._zod.bag.maximum=e.maximum)}),t._zod.check=r=>{const o=r.value;if(o.length<=e.maximum)return;const i=su(o);r.issues.push({origin:i,code:"too_big",maximum:e.maximum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),w$=J("$ZodCheckMinLength",(t,e)=>{var n;Tt.init(t,e),(n=t._zod.def).when??(n.when=r=>{const o=r.value;return!ru(o)&&o.length!==void 0}),t._zod.onattach.push(r=>{const o=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>o&&(r._zod.bag.minimum=e.minimum)}),t._zod.check=r=>{const o=r.value;if(o.length>=e.minimum)return;const i=su(o);r.issues.push({origin:i,code:"too_small",minimum:e.minimum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),S$=J("$ZodCheckLengthEquals",(t,e)=>{var n;Tt.init(t,e),(n=t._zod.def).when??(n.when=r=>{const o=r.value;return!ru(o)&&o.length!==void 0}),t._zod.onattach.push(r=>{const o=r._zod.bag;o.minimum=e.length,o.maximum=e.length,o.length=e.length}),t._zod.check=r=>{const o=r.value,s=o.length;if(s===e.length)return;const i=su(o),a=s>e.length;r.issues.push({origin:i,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:r.value,inst:t,continue:!e.abort})}}),Ta=J("$ZodCheckStringFormat",(t,e)=>{var n,r;Tt.init(t,e),t._zod.onattach.push(o=>{const s=o._zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(n=t._zod).check??(n.check=o=>{e.pattern.lastIndex=0,!e.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:e.format,input:o.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(r=t._zod).check??(r.check=()=>{})}),E$=J("$ZodCheckRegex",(t,e)=>{Ta.init(t,e),t._zod.check=n=>{e.pattern.lastIndex=0,!e.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),T$=J("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=m$),Ta.init(t,e)}),b$=J("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=g$),Ta.init(t,e)}),C$=J("$ZodCheckIncludes",(t,e)=>{Tt.init(t,e);const n=Cr(e.includes),r=new RegExp(typeof e.position=="number"?`^.{${e.position}}${n}`:n);e.pattern=r,t._zod.onattach.push(o=>{const s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),t._zod.check=o=>{o.value.includes(e.includes,e.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:o.value,inst:t,continue:!e.abort})}}),k$=J("$ZodCheckStartsWith",(t,e)=>{Tt.init(t,e);const n=new RegExp(`^${Cr(e.prefix)}.*`);e.pattern??(e.pattern=n),t._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(n)}),t._zod.check=r=>{r.value.startsWith(e.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:r.value,inst:t,continue:!e.abort})}}),I$=J("$ZodCheckEndsWith",(t,e)=>{Tt.init(t,e);const n=new RegExp(`.*${Cr(e.suffix)}$`);e.pattern??(e.pattern=n),t._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(n)}),t._zod.check=r=>{r.value.endsWith(e.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:r.value,inst:t,continue:!e.abort})}}),R$=J("$ZodCheckOverwrite",(t,e)=>{Tt.init(t,e),t._zod.check=n=>{n.value=e.tx(n.value)}});class $${constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const r=e.split(`
`).filter(i=>i),o=Math.min(...r.map(i=>i.length-i.trimStart().length)),s=r.map(i=>i.slice(o)).map(i=>" ".repeat(this.indent*2)+i);for(const i of s)this.content.push(i)}compile(){const e=Function,n=this?.args,o=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...n,o.join(`
`))}}const A$={major:4,minor:3,patch:6},Fe=J("$ZodType",(t,e)=>{var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=A$;const r=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&r.unshift(t);for(const o of r)for(const s of o._zod.onattach)s(t);if(r.length===0)(n=t._zod).deferred??(n.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const o=(i,a,l)=>{let c=mr(i),u;for(const h of a){if(h._zod.def.when){if(!h._zod.def.when(i))continue}else if(c)continue;const p=i.issues.length,m=h._zod.check(i);if(m instanceof Promise&&l?.async===!1)throw new Er;if(u||m instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await m,i.issues.length!==p&&(c||(c=mr(i,p)))});else{if(i.issues.length===p)continue;c||(c=mr(i,p))}}return u?u.then(()=>i):i},s=(i,a,l)=>{if(mr(i))return i.aborted=!0,i;const c=o(a,r,l);if(c instanceof Promise){if(l.async===!1)throw new Er;return c.then(u=>t._zod.parse(u,l))}return t._zod.parse(c,l)};t._zod.run=(i,a)=>{if(a.skipChecks)return t._zod.parse(i,a);if(a.direction==="backward"){const c=t._zod.parse({value:i.value,issues:[]},{...a,skipChecks:!0});return c instanceof Promise?c.then(u=>s(u,i,a)):s(c,i,a)}const l=t._zod.parse(i,a);if(l instanceof Promise){if(a.async===!1)throw new Er;return l.then(c=>o(c,r,a))}return o(l,r,a)}}Pe(t,"~standard",()=>({validate:o=>{try{const s=cy(t,o);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return OR(t,o).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}))}),lu=J("$ZodString",(t,e)=>{Fe.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??d$(t._zod.bag),t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:t}),n}}),He=J("$ZodStringFormat",(t,e)=>{Ta.init(t,e),lu.init(t,e)}),P$=J("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=QR),He.init(t,e)}),N$=J("$ZodUUID",(t,e)=>{if(e.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(r===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=uh(r))}else e.pattern??(e.pattern=uh());He.init(t,e)}),M$=J("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=jR),He.init(t,e)}),x$=J("$ZodURL",(t,e)=>{He.init(t,e),t._zod.check=n=>{try{const r=n.value.trim(),o=new URL(r);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(o.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:e.hostname.source,input:n.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:n.value,inst:t,continue:!e.abort})),e.normalize?n.value=o.href:n.value=r;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:t,continue:!e.abort})}}}),D$=J("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=t$()),He.init(t,e)}),O$=J("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=YR),He.init(t,e)}),U$=J("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=BR),He.init(t,e)}),L$=J("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=JR),He.init(t,e)}),q$=J("$ZodULID",(t,e)=>{e.pattern??(e.pattern=KR),He.init(t,e)}),F$=J("$ZodXID",(t,e)=>{e.pattern??(e.pattern=WR),He.init(t,e)}),V$=J("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=ZR),He.init(t,e)}),z$=J("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=u$(e)),He.init(t,e)}),H$=J("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=l$),He.init(t,e)}),G$=J("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=c$(e)),He.init(t,e)}),B$=J("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=XR),He.init(t,e)}),J$=J("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=n$),He.init(t,e),t._zod.bag.format="ipv4"}),K$=J("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=r$),He.init(t,e),t._zod.bag.format="ipv6",t._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:t,continue:!e.abort})}}}),W$=J("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=o$),He.init(t,e)}),Z$=J("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=s$),He.init(t,e),t._zod.check=n=>{const r=n.value.split("/");try{if(r.length!==2)throw new Error;const[o,s]=r;if(!s)throw new Error;const i=Number(s);if(`${i}`!==s)throw new Error;if(i<0||i>128)throw new Error;new URL(`http://[${o}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:t,continue:!e.abort})}}});function _y(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const Y$=J("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=i$),He.init(t,e),t._zod.bag.contentEncoding="base64",t._zod.check=n=>{_y(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:t,continue:!e.abort})}});function X$(t){if(!uy.test(t))return!1;const e=t.replace(/[-_]/g,r=>r==="-"?"+":"/"),n=e.padEnd(Math.ceil(e.length/4)*4,"=");return _y(n)}const Q$=J("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=uy),He.init(t,e),t._zod.bag.contentEncoding="base64url",t._zod.check=n=>{X$(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:t,continue:!e.abort})}}),j$=J("$ZodE164",(t,e)=>{e.pattern??(e.pattern=a$),He.init(t,e)});function eA(t,e=null){try{const n=t.split(".");if(n.length!==3)return!1;const[r]=n;if(!r)return!1;const o=JSON.parse(atob(r));return!("typ"in o&&o?.typ!=="JWT"||!o.alg||e&&(!("alg"in o)||o.alg!==e))}catch{return!1}}const tA=J("$ZodJWT",(t,e)=>{He.init(t,e),t._zod.check=n=>{eA(n.value,e.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:t,continue:!e.abort})}}),yy=J("$ZodNumber",(t,e)=>{Fe.init(t,e),t._zod.pattern=t._zod.bag.pattern??hy,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=Number(n.value)}catch{}const o=n.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return n;const s=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:o,inst:t,...s?{received:s}:{}}),n}}),nA=J("$ZodNumberFormat",(t,e)=>{y$.init(t,e),yy.init(t,e)}),rA=J("$ZodBoolean",(t,e)=>{Fe.init(t,e),t._zod.pattern=h$,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=!!n.value}catch{}const o=n.value;return typeof o=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:t}),n}}),oA=J("$ZodNull",(t,e)=>{Fe.init(t,e),t._zod.pattern=p$,t._zod.values=new Set([null]),t._zod.parse=(n,r)=>{const o=n.value;return o===null||n.issues.push({expected:"null",code:"invalid_type",input:o,inst:t}),n}}),sA=J("$ZodAny",(t,e)=>{Fe.init(t,e),t._zod.parse=n=>n}),iA=J("$ZodUnknown",(t,e)=>{Fe.init(t,e),t._zod.parse=n=>n}),aA=J("$ZodNever",(t,e)=>{Fe.init(t,e),t._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:t}),n)});function dh(t,e,n){t.issues.length&&e.issues.push(...gr(n,t.issues)),e.value[n]=t.value}const lA=J("$ZodArray",(t,e)=>{Fe.init(t,e),t._zod.parse=(n,r)=>{const o=n.value;if(!Array.isArray(o))return n.issues.push({expected:"array",code:"invalid_type",input:o,inst:t}),n;n.value=Array(o.length);const s=[];for(let i=0;i<o.length;i++){const a=o[i],l=e.element._zod.run({value:a,issues:[]},r);l instanceof Promise?s.push(l.then(c=>dh(c,n,i))):dh(l,n,i)}return s.length?Promise.all(s).then(()=>n):n}});function Fi(t,e,n,r,o){if(t.issues.length){if(o&&!(n in r))return;e.issues.push(...gr(n,t.issues))}t.value===void 0?n in r&&(e.value[n]=void 0):e.value[n]=t.value}function vy(t){const e=Object.keys(t.shape);for(const r of e)if(!t.shape?.[r]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${r}": expected a Zod schema`);const n=CR(t.shape);return{...t,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(n)}}function wy(t,e,n,r,o,s){const i=[],a=o.keySet,l=o.catchall._zod,c=l.def.type,u=l.optout==="optional";for(const h in e){if(a.has(h))continue;if(c==="never"){i.push(h);continue}const p=l.run({value:e[h],issues:[]},r);p instanceof Promise?t.push(p.then(m=>Fi(m,n,h,e,u))):Fi(p,n,h,e,u)}return i.length&&n.issues.push({code:"unrecognized_keys",keys:i,input:e,inst:s}),t.length?Promise.all(t).then(()=>n):n}const cA=J("$ZodObject",(t,e)=>{if(Fe.init(t,e),!Object.getOwnPropertyDescriptor(e,"shape")?.get){const a=e.shape;Object.defineProperty(e,"shape",{get:()=>{const l={...a};return Object.defineProperty(e,"shape",{value:l}),l}})}const r=wa(()=>vy(e));Pe(t._zod,"propValues",()=>{const a=e.shape,l={};for(const c in a){const u=a[c]._zod;if(u.values){l[c]??(l[c]=new Set);for(const h of u.values)l[c].add(h)}}return l});const o=go,s=e.catchall;let i;t._zod.parse=(a,l)=>{i??(i=r.value);const c=a.value;if(!o(c))return a.issues.push({expected:"object",code:"invalid_type",input:c,inst:t}),a;a.value={};const u=[],h=i.shape;for(const p of i.keys){const m=h[p],w=m._zod.optout==="optional",E=m._zod.run({value:c[p],issues:[]},l);E instanceof Promise?u.push(E.then(_=>Fi(_,a,p,c,w))):Fi(E,a,p,c,w)}return s?wy(u,c,a,l,r.value,t):u.length?Promise.all(u).then(()=>a):a}}),uA=J("$ZodObjectJIT",(t,e)=>{cA.init(t,e);const n=t._zod.parse,r=wa(()=>vy(e)),o=p=>{const m=new $$(["shape","payload","ctx"]),w=r.value,E=S=>{const b=ch(S);return`shape[${b}]._zod.run({ value: input[${b}], issues: [] }, ctx)`};m.write("const input = payload.value;");const _=Object.create(null);let v=0;for(const S of w.keys)_[S]=`key_${v++}`;m.write("const newResult = {};");for(const S of w.keys){const b=_[S],y=ch(S),k=p[S]?._zod?.optout==="optional";m.write(`const ${b} = ${E(S)};`),k?m.write(`
        if (${b}.issues.length) {
          if (${y} in input) {
            payload.issues = payload.issues.concat(${b}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${y}, ...iss.path] : [${y}]
            })));
          }
        }
        
        if (${b}.value === undefined) {
          if (${y} in input) {
            newResult[${y}] = undefined;
          }
        } else {
          newResult[${y}] = ${b}.value;
        }
        
      `):m.write(`
        if (${b}.issues.length) {
          payload.issues = payload.issues.concat(${b}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${y}, ...iss.path] : [${y}]
          })));
        }
        
        if (${b}.value === undefined) {
          if (${y} in input) {
            newResult[${y}] = undefined;
          }
        } else {
          newResult[${y}] = ${b}.value;
        }
        
      `)}m.write("payload.value = newResult;"),m.write("return payload;");const g=m.compile();return(S,b)=>g(p,S,b)};let s;const i=go,a=!ny.jitless,c=a&&TR.value,u=e.catchall;let h;t._zod.parse=(p,m)=>{h??(h=r.value);const w=p.value;return i(w)?a&&c&&m?.async===!1&&m.jitless!==!0?(s||(s=o(e.shape)),p=s(p,m),u?wy([],w,p,m,h,t):p):n(p,m):(p.issues.push({expected:"object",code:"invalid_type",input:w,inst:t}),p)}});function fh(t,e,n,r){for(const s of t)if(s.issues.length===0)return e.value=s.value,e;const o=t.filter(s=>!mr(s));return o.length===1?(e.value=o[0].value,o[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:t.map(s=>s.issues.map(i=>bn(i,r,Tn())))}),e)}const Sy=J("$ZodUnion",(t,e)=>{Fe.init(t,e),Pe(t._zod,"optin",()=>e.options.some(o=>o._zod.optin==="optional")?"optional":void 0),Pe(t._zod,"optout",()=>e.options.some(o=>o._zod.optout==="optional")?"optional":void 0),Pe(t._zod,"values",()=>{if(e.options.every(o=>o._zod.values))return new Set(e.options.flatMap(o=>Array.from(o._zod.values)))}),Pe(t._zod,"pattern",()=>{if(e.options.every(o=>o._zod.pattern)){const o=e.options.map(s=>s._zod.pattern);return new RegExp(`^(${o.map(s=>ou(s.source)).join("|")})$`)}});const n=e.options.length===1,r=e.options[0]._zod.run;t._zod.parse=(o,s)=>{if(n)return r(o,s);let i=!1;const a=[];for(const l of e.options){const c=l._zod.run({value:o.value,issues:[]},s);if(c instanceof Promise)a.push(c),i=!0;else{if(c.issues.length===0)return c;a.push(c)}}return i?Promise.all(a).then(l=>fh(l,o,t,s)):fh(a,o,t,s)}}),dA=J("$ZodDiscriminatedUnion",(t,e)=>{e.inclusive=!1,Sy.init(t,e);const n=t._zod.parse;Pe(t._zod,"propValues",()=>{const o={};for(const s of e.options){const i=s._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(const[a,l]of Object.entries(i)){o[a]||(o[a]=new Set);for(const c of l)o[a].add(c)}}return o});const r=wa(()=>{const o=e.options,s=new Map;for(const i of o){const a=i._zod.propValues?.[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(i)}"`);for(const l of a){if(s.has(l))throw new Error(`Duplicate discriminator value "${String(l)}"`);s.set(l,i)}}return s});t._zod.parse=(o,s)=>{const i=o.value;if(!go(i))return o.issues.push({code:"invalid_type",expected:"object",input:i,inst:t}),o;const a=r.value.get(i?.[e.discriminator]);return a?a._zod.run(o,s):e.unionFallback?n(o,s):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:e.discriminator,input:i,path:[e.discriminator],inst:t}),o)}}),fA=J("$ZodIntersection",(t,e)=>{Fe.init(t,e),t._zod.parse=(n,r)=>{const o=n.value,s=e.left._zod.run({value:o,issues:[]},r),i=e.right._zod.run({value:o,issues:[]},r);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([l,c])=>hh(n,l,c)):hh(n,s,i)}});function cc(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(br(t)&&br(e)){const n=Object.keys(e),r=Object.keys(t).filter(s=>n.indexOf(s)!==-1),o={...t,...e};for(const s of r){const i=cc(t[s],e[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};o[s]=i.data}return{valid:!0,data:o}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<t.length;r++){const o=t[r],s=e[r],i=cc(o,s);if(!i.valid)return{valid:!1,mergeErrorPath:[r,...i.mergeErrorPath]};n.push(i.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function hh(t,e,n){const r=new Map;let o;for(const a of e.issues)if(a.code==="unrecognized_keys"){o??(o=a);for(const l of a.keys)r.has(l)||r.set(l,{}),r.get(l).l=!0}else t.issues.push(a);for(const a of n.issues)if(a.code==="unrecognized_keys")for(const l of a.keys)r.has(l)||r.set(l,{}),r.get(l).r=!0;else t.issues.push(a);const s=[...r].filter(([,a])=>a.l&&a.r).map(([a])=>a);if(s.length&&o&&t.issues.push({...o,keys:s}),mr(t))return t;const i=cc(e.value,n.value);if(!i.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(i.mergeErrorPath)}`);return t.value=i.data,t}const hA=J("$ZodRecord",(t,e)=>{Fe.init(t,e),t._zod.parse=(n,r)=>{const o=n.value;if(!br(o))return n.issues.push({expected:"record",code:"invalid_type",input:o,inst:t}),n;const s=[],i=e.keyType._zod.values;if(i){n.value={};const a=new Set;for(const c of i)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){a.add(typeof c=="number"?c.toString():c);const u=e.valueType._zod.run({value:o[c],issues:[]},r);u instanceof Promise?s.push(u.then(h=>{h.issues.length&&n.issues.push(...gr(c,h.issues)),n.value[c]=h.value})):(u.issues.length&&n.issues.push(...gr(c,u.issues)),n.value[c]=u.value)}let l;for(const c in o)a.has(c)||(l=l??[],l.push(c));l&&l.length>0&&n.issues.push({code:"unrecognized_keys",input:o,inst:t,keys:l})}else{n.value={};for(const a of Reflect.ownKeys(o)){if(a==="__proto__")continue;let l=e.keyType._zod.run({value:a,issues:[]},r);if(l instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(typeof a=="string"&&hy.test(a)&&l.issues.length){const h=e.keyType._zod.run({value:Number(a),issues:[]},r);if(h instanceof Promise)throw new Error("Async schemas not supported in object keys currently");h.issues.length===0&&(l=h)}if(l.issues.length){e.mode==="loose"?n.value[a]=o[a]:n.issues.push({code:"invalid_key",origin:"record",issues:l.issues.map(h=>bn(h,r,Tn())),input:a,path:[a],inst:t});continue}const u=e.valueType._zod.run({value:o[a],issues:[]},r);u instanceof Promise?s.push(u.then(h=>{h.issues.length&&n.issues.push(...gr(a,h.issues)),n.value[l.value]=h.value})):(u.issues.length&&n.issues.push(...gr(a,u.issues)),n.value[l.value]=u.value)}}return s.length?Promise.all(s).then(()=>n):n}}),pA=J("$ZodEnum",(t,e)=>{Fe.init(t,e);const n=ry(e.entries),r=new Set(n);t._zod.values=r,t._zod.pattern=new RegExp(`^(${n.filter(o=>bR.has(typeof o)).map(o=>typeof o=="string"?Cr(o):o.toString()).join("|")})$`),t._zod.parse=(o,s)=>{const i=o.value;return r.has(i)||o.issues.push({code:"invalid_value",values:n,input:i,inst:t}),o}}),mA=J("$ZodLiteral",(t,e)=>{if(Fe.init(t,e),e.values.length===0)throw new Error("Cannot create literal schema with no valid values");const n=new Set(e.values);t._zod.values=n,t._zod.pattern=new RegExp(`^(${e.values.map(r=>typeof r=="string"?Cr(r):r?Cr(r.toString()):String(r)).join("|")})$`),t._zod.parse=(r,o)=>{const s=r.value;return n.has(s)||r.issues.push({code:"invalid_value",values:e.values,input:s,inst:t}),r}}),gA=J("$ZodTransform",(t,e)=>{Fe.init(t,e),t._zod.parse=(n,r)=>{if(r.direction==="backward")throw new ty(t.constructor.name);const o=e.transform(n.value,n);if(r.async)return(o instanceof Promise?o:Promise.resolve(o)).then(i=>(n.value=i,n));if(o instanceof Promise)throw new Er;return n.value=o,n}});function ph(t,e){return t.issues.length&&e===void 0?{issues:[],value:void 0}:t}const Ey=J("$ZodOptional",(t,e)=>{Fe.init(t,e),t._zod.optin="optional",t._zod.optout="optional",Pe(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Pe(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${ou(n.source)})?$`):void 0}),t._zod.parse=(n,r)=>{if(e.innerType._zod.optin==="optional"){const o=e.innerType._zod.run(n,r);return o instanceof Promise?o.then(s=>ph(s,n.value)):ph(o,n.value)}return n.value===void 0?n:e.innerType._zod.run(n,r)}}),_A=J("$ZodExactOptional",(t,e)=>{Ey.init(t,e),Pe(t._zod,"values",()=>e.innerType._zod.values),Pe(t._zod,"pattern",()=>e.innerType._zod.pattern),t._zod.parse=(n,r)=>e.innerType._zod.run(n,r)}),yA=J("$ZodNullable",(t,e)=>{Fe.init(t,e),Pe(t._zod,"optin",()=>e.innerType._zod.optin),Pe(t._zod,"optout",()=>e.innerType._zod.optout),Pe(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${ou(n.source)}|null)$`):void 0}),Pe(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(n,r)=>n.value===null?n:e.innerType._zod.run(n,r)}),vA=J("$ZodDefault",(t,e)=>{Fe.init(t,e),t._zod.optin="optional",Pe(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>{if(r.direction==="backward")return e.innerType._zod.run(n,r);if(n.value===void 0)return n.value=e.defaultValue,n;const o=e.innerType._zod.run(n,r);return o instanceof Promise?o.then(s=>mh(s,e)):mh(o,e)}});function mh(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const wA=J("$ZodPrefault",(t,e)=>{Fe.init(t,e),t._zod.optin="optional",Pe(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>(r.direction==="backward"||n.value===void 0&&(n.value=e.defaultValue),e.innerType._zod.run(n,r))}),SA=J("$ZodNonOptional",(t,e)=>{Fe.init(t,e),Pe(t._zod,"values",()=>{const n=e.innerType._zod.values;return n?new Set([...n].filter(r=>r!==void 0)):void 0}),t._zod.parse=(n,r)=>{const o=e.innerType._zod.run(n,r);return o instanceof Promise?o.then(s=>gh(s,t)):gh(o,t)}});function gh(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const EA=J("$ZodCatch",(t,e)=>{Fe.init(t,e),Pe(t._zod,"optin",()=>e.innerType._zod.optin),Pe(t._zod,"optout",()=>e.innerType._zod.optout),Pe(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>{if(r.direction==="backward")return e.innerType._zod.run(n,r);const o=e.innerType._zod.run(n,r);return o instanceof Promise?o.then(s=>(n.value=s.value,s.issues.length&&(n.value=e.catchValue({...n,error:{issues:s.issues.map(i=>bn(i,r,Tn()))},input:n.value}),n.issues=[]),n)):(n.value=o.value,o.issues.length&&(n.value=e.catchValue({...n,error:{issues:o.issues.map(s=>bn(s,r,Tn()))},input:n.value}),n.issues=[]),n)}}),TA=J("$ZodPipe",(t,e)=>{Fe.init(t,e),Pe(t._zod,"values",()=>e.in._zod.values),Pe(t._zod,"optin",()=>e.in._zod.optin),Pe(t._zod,"optout",()=>e.out._zod.optout),Pe(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(n,r)=>{if(r.direction==="backward"){const s=e.out._zod.run(n,r);return s instanceof Promise?s.then(i=>Lo(i,e.in,r)):Lo(s,e.in,r)}const o=e.in._zod.run(n,r);return o instanceof Promise?o.then(s=>Lo(s,e.out,r)):Lo(o,e.out,r)}});function Lo(t,e,n){return t.issues.length?(t.aborted=!0,t):e._zod.run({value:t.value,issues:t.issues},n)}const bA=J("$ZodReadonly",(t,e)=>{Fe.init(t,e),Pe(t._zod,"propValues",()=>e.innerType._zod.propValues),Pe(t._zod,"values",()=>e.innerType._zod.values),Pe(t._zod,"optin",()=>e.innerType?._zod?.optin),Pe(t._zod,"optout",()=>e.innerType?._zod?.optout),t._zod.parse=(n,r)=>{if(r.direction==="backward")return e.innerType._zod.run(n,r);const o=e.innerType._zod.run(n,r);return o instanceof Promise?o.then(_h):_h(o)}});function _h(t){return t.value=Object.freeze(t.value),t}const CA=J("$ZodCustom",(t,e)=>{Tt.init(t,e),Fe.init(t,e),t._zod.parse=(n,r)=>n,t._zod.check=n=>{const r=n.value,o=e.fn(r);if(o instanceof Promise)return o.then(s=>yh(s,n,r,t));yh(o,n,r,t)}});function yh(t,e,n,r){if(!t){const o={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(o.params=r._zod.def.params),e.issues.push(_o(o))}}var vh;class kA{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...n){const r=n[0];return this._map.set(e,r),r&&typeof r=="object"&&"id"in r&&this._idmap.set(r.id,e),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const r={...this.get(n)??{}};delete r.id;const o={...r,...this._map.get(e)};return Object.keys(o).length?o:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function IA(){return new kA}(vh=globalThis).__zod_globalRegistry??(vh.__zod_globalRegistry=IA());const Zr=globalThis.__zod_globalRegistry;function RA(t,e){return new t({type:"string",...ae(e)})}function $A(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...ae(e)})}function wh(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...ae(e)})}function AA(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...ae(e)})}function PA(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ae(e)})}function NA(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ae(e)})}function MA(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ae(e)})}function Ty(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...ae(e)})}function xA(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...ae(e)})}function DA(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...ae(e)})}function OA(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...ae(e)})}function UA(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...ae(e)})}function LA(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...ae(e)})}function qA(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...ae(e)})}function FA(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...ae(e)})}function VA(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...ae(e)})}function zA(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...ae(e)})}function HA(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ae(e)})}function GA(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ae(e)})}function BA(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...ae(e)})}function JA(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...ae(e)})}function KA(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...ae(e)})}function WA(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...ae(e)})}function ZA(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ae(e)})}function YA(t,e){return new t({type:"string",format:"date",check:"string_format",...ae(e)})}function XA(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...ae(e)})}function QA(t,e){return new t({type:"string",format:"duration",check:"string_format",...ae(e)})}function jA(t,e){return new t({type:"number",checks:[],...ae(e)})}function eP(t,e){return new t({type:"number",coerce:!0,checks:[],...ae(e)})}function tP(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...ae(e)})}function nP(t,e){return new t({type:"boolean",...ae(e)})}function rP(t,e){return new t({type:"null",...ae(e)})}function oP(t){return new t({type:"any"})}function sP(t){return new t({type:"unknown"})}function iP(t,e){return new t({type:"never",...ae(e)})}function Sh(t,e){return new my({check:"less_than",...ae(e),value:t,inclusive:!1})}function nl(t,e){return new my({check:"less_than",...ae(e),value:t,inclusive:!0})}function Eh(t,e){return new gy({check:"greater_than",...ae(e),value:t,inclusive:!1})}function rl(t,e){return new gy({check:"greater_than",...ae(e),value:t,inclusive:!0})}function Th(t,e){return new _$({check:"multiple_of",...ae(e),value:t})}function by(t,e){return new v$({check:"max_length",...ae(e),maximum:t})}function Vi(t,e){return new w$({check:"min_length",...ae(e),minimum:t})}function Cy(t,e){return new S$({check:"length_equals",...ae(e),length:t})}function aP(t,e){return new E$({check:"string_format",format:"regex",...ae(e),pattern:t})}function lP(t){return new T$({check:"string_format",format:"lowercase",...ae(t)})}function cP(t){return new b$({check:"string_format",format:"uppercase",...ae(t)})}function uP(t,e){return new C$({check:"string_format",format:"includes",...ae(e),includes:t})}function dP(t,e){return new k$({check:"string_format",format:"starts_with",...ae(e),prefix:t})}function fP(t,e){return new I$({check:"string_format",format:"ends_with",...ae(e),suffix:t})}function Pr(t){return new R$({check:"overwrite",tx:t})}function hP(t){return Pr(e=>e.normalize(t))}function pP(){return Pr(t=>t.trim())}function mP(){return Pr(t=>t.toLowerCase())}function gP(){return Pr(t=>t.toUpperCase())}function _P(){return Pr(t=>ER(t))}function yP(t,e,n){return new t({type:"array",element:e,...ae(n)})}function vP(t,e,n){const r=ae(n);return r.abort??(r.abort=!0),new t({type:"custom",check:"custom",fn:e,...r})}function wP(t,e,n){return new t({type:"custom",check:"custom",fn:e,...ae(n)})}function SP(t){const e=EP(n=>(n.addIssue=r=>{if(typeof r=="string")n.issues.push(_o(r,n.value,e._zod.def));else{const o=r;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=n.value),o.inst??(o.inst=e),o.continue??(o.continue=!e._zod.def.abort),n.issues.push(_o(o))}},t(n.value,n)));return e}function EP(t,e){const n=new Tt({check:"custom",...ae(e)});return n._zod.check=t,n}function ky(t){let e=t?.target??"draft-2020-12";return e==="draft-4"&&(e="draft-04"),e==="draft-7"&&(e="draft-07"),{processors:t.processors??{},metadataRegistry:t?.metadata??Zr,target:e,unrepresentable:t?.unrepresentable??"throw",override:t?.override??(()=>{}),io:t?.io??"output",counter:0,seen:new Map,cycles:t?.cycles??"ref",reused:t?.reused??"inline",external:t?.external??void 0}}function Xe(t,e,n={path:[],schemaPath:[]}){var r;const o=t._zod.def,s=e.seen.get(t);if(s)return s.count++,n.schemaPath.includes(t)&&(s.cycle=n.path),s.schema;const i={schema:{},count:1,cycle:void 0,path:n.path};e.seen.set(t,i);const a=t._zod.toJSONSchema?.();if(a)i.schema=a;else{const u={...n,schemaPath:[...n.schemaPath,t],path:n.path};if(t._zod.processJSONSchema)t._zod.processJSONSchema(e,i.schema,u);else{const p=i.schema,m=e.processors[o.type];if(!m)throw new Error(`[toJSONSchema]: Non-representable type encountered: ${o.type}`);m(t,e,p,u)}const h=t._zod.parent;h&&(i.ref||(i.ref=h),Xe(h,e,u),e.seen.get(h).isParent=!0)}const l=e.metadataRegistry.get(t);return l&&Object.assign(i.schema,l),e.io==="input"&&_t(t)&&(delete i.schema.examples,delete i.schema.default),e.io==="input"&&i.schema._prefault&&((r=i.schema).default??(r.default=i.schema._prefault)),delete i.schema._prefault,e.seen.get(t).schema}function Iy(t,e){const n=t.seen.get(e);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=new Map;for(const i of t.seen.entries()){const a=t.metadataRegistry.get(i[0])?.id;if(a){const l=r.get(a);if(l&&l!==i[0])throw new Error(`Duplicate schema id "${a}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);r.set(a,i[0])}}const o=i=>{const a=t.target==="draft-2020-12"?"$defs":"definitions";if(t.external){const h=t.external.registry.get(i[0])?.id,p=t.external.uri??(w=>w);if(h)return{ref:p(h)};const m=i[1].defId??i[1].schema.id??`schema${t.counter++}`;return i[1].defId=m,{defId:m,ref:`${p("__shared")}#/${a}/${m}`}}if(i[1]===n)return{ref:"#"};const c=`#/${a}/`,u=i[1].schema.id??`__schema${t.counter++}`;return{defId:u,ref:c+u}},s=i=>{if(i[1].schema.$ref)return;const a=i[1],{ref:l,defId:c}=o(i);a.def={...a.schema},c&&(a.defId=c);const u=a.schema;for(const h in u)delete u[h];u.$ref=l};if(t.cycles==="throw")for(const i of t.seen.entries()){const a=i[1];if(a.cycle)throw new Error(`Cycle detected: #/${a.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const i of t.seen.entries()){const a=i[1];if(e===i[0]){s(i);continue}if(t.external){const c=t.external.registry.get(i[0])?.id;if(e!==i[0]&&c){s(i);continue}}if(t.metadataRegistry.get(i[0])?.id){s(i);continue}if(a.cycle){s(i);continue}if(a.count>1&&t.reused==="ref"){s(i);continue}}}function Ry(t,e){const n=t.seen.get(e);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=i=>{const a=t.seen.get(i);if(a.ref===null)return;const l=a.def??a.schema,c={...l},u=a.ref;if(a.ref=null,u){r(u);const p=t.seen.get(u),m=p.schema;if(m.$ref&&(t.target==="draft-07"||t.target==="draft-04"||t.target==="openapi-3.0")?(l.allOf=l.allOf??[],l.allOf.push(m)):Object.assign(l,m),Object.assign(l,c),i._zod.parent===u)for(const E in l)E==="$ref"||E==="allOf"||E in c||delete l[E];if(m.$ref&&p.def)for(const E in l)E==="$ref"||E==="allOf"||E in p.def&&JSON.stringify(l[E])===JSON.stringify(p.def[E])&&delete l[E]}const h=i._zod.parent;if(h&&h!==u){r(h);const p=t.seen.get(h);if(p?.schema.$ref&&(l.$ref=p.schema.$ref,p.def))for(const m in l)m==="$ref"||m==="allOf"||m in p.def&&JSON.stringify(l[m])===JSON.stringify(p.def[m])&&delete l[m]}t.override({zodSchema:i,jsonSchema:l,path:a.path??[]})};for(const i of[...t.seen.entries()].reverse())r(i[0]);const o={};if(t.target==="draft-2020-12"?o.$schema="https://json-schema.org/draft/2020-12/schema":t.target==="draft-07"?o.$schema="http://json-schema.org/draft-07/schema#":t.target==="draft-04"?o.$schema="http://json-schema.org/draft-04/schema#":t.target,t.external?.uri){const i=t.external.registry.get(e)?.id;if(!i)throw new Error("Schema is missing an `id` property");o.$id=t.external.uri(i)}Object.assign(o,n.def??n.schema);const s=t.external?.defs??{};for(const i of t.seen.entries()){const a=i[1];a.def&&a.defId&&(s[a.defId]=a.def)}t.external||Object.keys(s).length>0&&(t.target==="draft-2020-12"?o.$defs=s:o.definitions=s);try{const i=JSON.parse(JSON.stringify(o));return Object.defineProperty(i,"~standard",{value:{...e["~standard"],jsonSchema:{input:zi(e,"input",t.processors),output:zi(e,"output",t.processors)}},enumerable:!1,writable:!1}),i}catch{throw new Error("Error converting schema to JSON.")}}function _t(t,e){const n=e??{seen:new Set};if(n.seen.has(t))return!1;n.seen.add(t);const r=t._zod.def;if(r.type==="transform")return!0;if(r.type==="array")return _t(r.element,n);if(r.type==="set")return _t(r.valueType,n);if(r.type==="lazy")return _t(r.getter(),n);if(r.type==="promise"||r.type==="optional"||r.type==="nonoptional"||r.type==="nullable"||r.type==="readonly"||r.type==="default"||r.type==="prefault")return _t(r.innerType,n);if(r.type==="intersection")return _t(r.left,n)||_t(r.right,n);if(r.type==="record"||r.type==="map")return _t(r.keyType,n)||_t(r.valueType,n);if(r.type==="pipe")return _t(r.in,n)||_t(r.out,n);if(r.type==="object"){for(const o in r.shape)if(_t(r.shape[o],n))return!0;return!1}if(r.type==="union"){for(const o of r.options)if(_t(o,n))return!0;return!1}if(r.type==="tuple"){for(const o of r.items)if(_t(o,n))return!0;return!!(r.rest&&_t(r.rest,n))}return!1}const TP=(t,e={})=>n=>{const r=ky({...n,processors:e});return Xe(t,r),Iy(r,t),Ry(r,t)},zi=(t,e,n={})=>r=>{const{libraryOptions:o,target:s}=r??{},i=ky({...o??{},target:s,io:e,processors:n});return Xe(t,i),Iy(i,t),Ry(i,t)},bP={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},CP=(t,e,n,r)=>{const o=n;o.type="string";const{minimum:s,maximum:i,format:a,patterns:l,contentEncoding:c}=t._zod.bag;if(typeof s=="number"&&(o.minLength=s),typeof i=="number"&&(o.maxLength=i),a&&(o.format=bP[a]??a,o.format===""&&delete o.format,a==="time"&&delete o.format),c&&(o.contentEncoding=c),l&&l.size>0){const u=[...l];u.length===1?o.pattern=u[0].source:u.length>1&&(o.allOf=[...u.map(h=>({...e.target==="draft-07"||e.target==="draft-04"||e.target==="openapi-3.0"?{type:"string"}:{},pattern:h.source}))])}},kP=(t,e,n,r)=>{const o=n,{minimum:s,maximum:i,format:a,multipleOf:l,exclusiveMaximum:c,exclusiveMinimum:u}=t._zod.bag;typeof a=="string"&&a.includes("int")?o.type="integer":o.type="number",typeof u=="number"&&(e.target==="draft-04"||e.target==="openapi-3.0"?(o.minimum=u,o.exclusiveMinimum=!0):o.exclusiveMinimum=u),typeof s=="number"&&(o.minimum=s,typeof u=="number"&&e.target!=="draft-04"&&(u>=s?delete o.minimum:delete o.exclusiveMinimum)),typeof c=="number"&&(e.target==="draft-04"||e.target==="openapi-3.0"?(o.maximum=c,o.exclusiveMaximum=!0):o.exclusiveMaximum=c),typeof i=="number"&&(o.maximum=i,typeof c=="number"&&e.target!=="draft-04"&&(c<=i?delete o.maximum:delete o.exclusiveMaximum)),typeof l=="number"&&(o.multipleOf=l)},IP=(t,e,n,r)=>{n.type="boolean"},RP=(t,e,n,r)=>{e.target==="openapi-3.0"?(n.type="string",n.nullable=!0,n.enum=[null]):n.type="null"},$P=(t,e,n,r)=>{n.not={}},AP=(t,e,n,r)=>{},PP=(t,e,n,r)=>{},NP=(t,e,n,r)=>{const o=t._zod.def,s=ry(o.entries);s.every(i=>typeof i=="number")&&(n.type="number"),s.every(i=>typeof i=="string")&&(n.type="string"),n.enum=s},MP=(t,e,n,r)=>{const o=t._zod.def,s=[];for(const i of o.values)if(i===void 0){if(e.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof i=="bigint"){if(e.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");s.push(Number(i))}else s.push(i);if(s.length!==0)if(s.length===1){const i=s[0];n.type=i===null?"null":typeof i,e.target==="draft-04"||e.target==="openapi-3.0"?n.enum=[i]:n.const=i}else s.every(i=>typeof i=="number")&&(n.type="number"),s.every(i=>typeof i=="string")&&(n.type="string"),s.every(i=>typeof i=="boolean")&&(n.type="boolean"),s.every(i=>i===null)&&(n.type="null"),n.enum=s},xP=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema")},DP=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema")},OP=(t,e,n,r)=>{const o=n,s=t._zod.def,{minimum:i,maximum:a}=t._zod.bag;typeof i=="number"&&(o.minItems=i),typeof a=="number"&&(o.maxItems=a),o.type="array",o.items=Xe(s.element,e,{...r,path:[...r.path,"items"]})},UP=(t,e,n,r)=>{const o=n,s=t._zod.def;o.type="object",o.properties={};const i=s.shape;for(const c in i)o.properties[c]=Xe(i[c],e,{...r,path:[...r.path,"properties",c]});const a=new Set(Object.keys(i)),l=new Set([...a].filter(c=>{const u=s.shape[c]._zod;return e.io==="input"?u.optin===void 0:u.optout===void 0}));l.size>0&&(o.required=Array.from(l)),s.catchall?._zod.def.type==="never"?o.additionalProperties=!1:s.catchall?s.catchall&&(o.additionalProperties=Xe(s.catchall,e,{...r,path:[...r.path,"additionalProperties"]})):e.io==="output"&&(o.additionalProperties=!1)},LP=(t,e,n,r)=>{const o=t._zod.def,s=o.inclusive===!1,i=o.options.map((a,l)=>Xe(a,e,{...r,path:[...r.path,s?"oneOf":"anyOf",l]}));s?n.oneOf=i:n.anyOf=i},qP=(t,e,n,r)=>{const o=t._zod.def,s=Xe(o.left,e,{...r,path:[...r.path,"allOf",0]}),i=Xe(o.right,e,{...r,path:[...r.path,"allOf",1]}),a=c=>"allOf"in c&&Object.keys(c).length===1,l=[...a(s)?s.allOf:[s],...a(i)?i.allOf:[i]];n.allOf=l},FP=(t,e,n,r)=>{const o=n,s=t._zod.def;o.type="object";const i=s.keyType,l=i._zod.bag?.patterns;if(s.mode==="loose"&&l&&l.size>0){const u=Xe(s.valueType,e,{...r,path:[...r.path,"patternProperties","*"]});o.patternProperties={};for(const h of l)o.patternProperties[h.source]=u}else(e.target==="draft-07"||e.target==="draft-2020-12")&&(o.propertyNames=Xe(s.keyType,e,{...r,path:[...r.path,"propertyNames"]})),o.additionalProperties=Xe(s.valueType,e,{...r,path:[...r.path,"additionalProperties"]});const c=i._zod.values;if(c){const u=[...c].filter(h=>typeof h=="string"||typeof h=="number");u.length>0&&(o.required=u)}},VP=(t,e,n,r)=>{const o=t._zod.def,s=Xe(o.innerType,e,r),i=e.seen.get(t);e.target==="openapi-3.0"?(i.ref=o.innerType,n.nullable=!0):n.anyOf=[s,{type:"null"}]},zP=(t,e,n,r)=>{const o=t._zod.def;Xe(o.innerType,e,r);const s=e.seen.get(t);s.ref=o.innerType},HP=(t,e,n,r)=>{const o=t._zod.def;Xe(o.innerType,e,r);const s=e.seen.get(t);s.ref=o.innerType,n.default=JSON.parse(JSON.stringify(o.defaultValue))},GP=(t,e,n,r)=>{const o=t._zod.def;Xe(o.innerType,e,r);const s=e.seen.get(t);s.ref=o.innerType,e.io==="input"&&(n._prefault=JSON.parse(JSON.stringify(o.defaultValue)))},BP=(t,e,n,r)=>{const o=t._zod.def;Xe(o.innerType,e,r);const s=e.seen.get(t);s.ref=o.innerType;let i;try{i=o.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}n.default=i},JP=(t,e,n,r)=>{const o=t._zod.def,s=e.io==="input"?o.in._zod.def.type==="transform"?o.out:o.in:o.out;Xe(s,e,r);const i=e.seen.get(t);i.ref=s},KP=(t,e,n,r)=>{const o=t._zod.def;Xe(o.innerType,e,r);const s=e.seen.get(t);s.ref=o.innerType,n.readOnly=!0},$y=(t,e,n,r)=>{const o=t._zod.def;Xe(o.innerType,e,r);const s=e.seen.get(t);s.ref=o.innerType};function ba(t){return!!t._zod}function wn(t,e){return ba(t)?cy(t,e):t.safeParse(e)}function Ay(t){if(!t)return;let e;if(ba(t)?e=t._zod?.def?.shape:e=t.shape,!!e){if(typeof e=="function")try{return e()}catch{return}return e}}function WP(t){if(ba(t)){const s=t._zod?.def;if(s){if(s.value!==void 0)return s.value;if(Array.isArray(s.values)&&s.values.length>0)return s.values[0]}}const n=t._def;if(n){if(n.value!==void 0)return n.value;if(Array.isArray(n.values)&&n.values.length>0)return n.values[0]}const r=t.value;if(r!==void 0)return r}const ZP=J("ZodISODateTime",(t,e)=>{z$.init(t,e),Ke.init(t,e)});function Py(t){return ZA(ZP,t)}const YP=J("ZodISODate",(t,e)=>{H$.init(t,e),Ke.init(t,e)});function XP(t){return YA(YP,t)}const QP=J("ZodISOTime",(t,e)=>{G$.init(t,e),Ke.init(t,e)});function jP(t){return XA(QP,t)}const eN=J("ZodISODuration",(t,e)=>{B$.init(t,e),Ke.init(t,e)});function tN(t){return QA(eN,t)}const nN=(t,e)=>{ay.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:n=>DR(t,n)},flatten:{value:n=>xR(t,n)},addIssue:{value:n=>{t.issues.push(n),t.message=JSON.stringify(t.issues,lc,2)}},addIssues:{value:n=>{t.issues.push(...n),t.message=JSON.stringify(t.issues,lc,2)}},isEmpty:{get(){return t.issues.length===0}}})},Ot=J("ZodError",nN,{Parent:Error}),rN=iu(Ot),oN=au(Ot),sN=Sa(Ot),iN=Ea(Ot),aN=UR(Ot),lN=LR(Ot),cN=qR(Ot),uN=FR(Ot),dN=VR(Ot),fN=zR(Ot),hN=HR(Ot),pN=GR(Ot),Ve=J("ZodType",(t,e)=>(Fe.init(t,e),Object.assign(t["~standard"],{jsonSchema:{input:zi(t,"input"),output:zi(t,"output")}}),t.toJSONSchema=TP(t,{}),t.def=e,t.type=e.type,Object.defineProperty(t,"_def",{value:e}),t.check=(...n)=>t.clone(kn(e,{checks:[...e.checks??[],...n.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),{parent:!0}),t.with=t.check,t.clone=(n,r)=>In(t,n,r),t.brand=()=>t,t.register=((n,r)=>(n.add(t,r),t)),t.parse=(n,r)=>rN(t,n,r,{callee:t.parse}),t.safeParse=(n,r)=>sN(t,n,r),t.parseAsync=async(n,r)=>oN(t,n,r,{callee:t.parseAsync}),t.safeParseAsync=async(n,r)=>iN(t,n,r),t.spa=t.safeParseAsync,t.encode=(n,r)=>aN(t,n,r),t.decode=(n,r)=>lN(t,n,r),t.encodeAsync=async(n,r)=>cN(t,n,r),t.decodeAsync=async(n,r)=>uN(t,n,r),t.safeEncode=(n,r)=>dN(t,n,r),t.safeDecode=(n,r)=>fN(t,n,r),t.safeEncodeAsync=async(n,r)=>hN(t,n,r),t.safeDecodeAsync=async(n,r)=>pN(t,n,r),t.refine=(n,r)=>t.check(aM(n,r)),t.superRefine=n=>t.check(lM(n)),t.overwrite=n=>t.check(Pr(n)),t.optional=()=>We(t),t.exactOptional=()=>WN(t),t.nullable=()=>kh(t),t.nullish=()=>We(kh(t)),t.nonoptional=n=>eM(t,n),t.array=()=>j(t),t.or=n=>ze([t,n]),t.and=n=>uu(t,n),t.transform=n=>dc(t,Ly(n)),t.default=n=>XN(t,n),t.prefault=n=>jN(t,n),t.catch=n=>nM(t,n),t.pipe=n=>dc(t,n),t.readonly=()=>sM(t),t.describe=n=>{const r=t.clone();return Zr.add(r,{description:n}),r},Object.defineProperty(t,"description",{get(){return Zr.get(t)?.description},configurable:!0}),t.meta=(...n)=>{if(n.length===0)return Zr.get(t);const r=t.clone();return Zr.add(r,n[0]),r},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t.apply=n=>n(t),t)),Ny=J("_ZodString",(t,e)=>{lu.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(r,o,s)=>CP(t,r,o);const n=t._zod.bag;t.format=n.format??null,t.minLength=n.minimum??null,t.maxLength=n.maximum??null,t.regex=(...r)=>t.check(aP(...r)),t.includes=(...r)=>t.check(uP(...r)),t.startsWith=(...r)=>t.check(dP(...r)),t.endsWith=(...r)=>t.check(fP(...r)),t.min=(...r)=>t.check(Vi(...r)),t.max=(...r)=>t.check(by(...r)),t.length=(...r)=>t.check(Cy(...r)),t.nonempty=(...r)=>t.check(Vi(1,...r)),t.lowercase=r=>t.check(lP(r)),t.uppercase=r=>t.check(cP(r)),t.trim=()=>t.check(pP()),t.normalize=(...r)=>t.check(hP(...r)),t.toLowerCase=()=>t.check(mP()),t.toUpperCase=()=>t.check(gP()),t.slugify=()=>t.check(_P())}),mN=J("ZodString",(t,e)=>{lu.init(t,e),Ny.init(t,e),t.email=n=>t.check($A(gN,n)),t.url=n=>t.check(Ty(My,n)),t.jwt=n=>t.check(WA(NN,n)),t.emoji=n=>t.check(xA(yN,n)),t.guid=n=>t.check(wh(bh,n)),t.uuid=n=>t.check(AA(qo,n)),t.uuidv4=n=>t.check(PA(qo,n)),t.uuidv6=n=>t.check(NA(qo,n)),t.uuidv7=n=>t.check(MA(qo,n)),t.nanoid=n=>t.check(DA(vN,n)),t.guid=n=>t.check(wh(bh,n)),t.cuid=n=>t.check(OA(wN,n)),t.cuid2=n=>t.check(UA(SN,n)),t.ulid=n=>t.check(LA(EN,n)),t.base64=n=>t.check(BA($N,n)),t.base64url=n=>t.check(JA(AN,n)),t.xid=n=>t.check(qA(TN,n)),t.ksuid=n=>t.check(FA(bN,n)),t.ipv4=n=>t.check(VA(CN,n)),t.ipv6=n=>t.check(zA(kN,n)),t.cidrv4=n=>t.check(HA(IN,n)),t.cidrv6=n=>t.check(GA(RN,n)),t.e164=n=>t.check(KA(PN,n)),t.datetime=n=>t.check(Py(n)),t.date=n=>t.check(XP(n)),t.time=n=>t.check(jP(n)),t.duration=n=>t.check(tN(n))});function F(t){return RA(mN,t)}const Ke=J("ZodStringFormat",(t,e)=>{He.init(t,e),Ny.init(t,e)}),gN=J("ZodEmail",(t,e)=>{M$.init(t,e),Ke.init(t,e)}),bh=J("ZodGUID",(t,e)=>{P$.init(t,e),Ke.init(t,e)}),qo=J("ZodUUID",(t,e)=>{N$.init(t,e),Ke.init(t,e)}),My=J("ZodURL",(t,e)=>{x$.init(t,e),Ke.init(t,e)});function _N(t){return Ty(My,t)}const yN=J("ZodEmoji",(t,e)=>{D$.init(t,e),Ke.init(t,e)}),vN=J("ZodNanoID",(t,e)=>{O$.init(t,e),Ke.init(t,e)}),wN=J("ZodCUID",(t,e)=>{U$.init(t,e),Ke.init(t,e)}),SN=J("ZodCUID2",(t,e)=>{L$.init(t,e),Ke.init(t,e)}),EN=J("ZodULID",(t,e)=>{q$.init(t,e),Ke.init(t,e)}),TN=J("ZodXID",(t,e)=>{F$.init(t,e),Ke.init(t,e)}),bN=J("ZodKSUID",(t,e)=>{V$.init(t,e),Ke.init(t,e)}),CN=J("ZodIPv4",(t,e)=>{J$.init(t,e),Ke.init(t,e)}),kN=J("ZodIPv6",(t,e)=>{K$.init(t,e),Ke.init(t,e)}),IN=J("ZodCIDRv4",(t,e)=>{W$.init(t,e),Ke.init(t,e)}),RN=J("ZodCIDRv6",(t,e)=>{Z$.init(t,e),Ke.init(t,e)}),$N=J("ZodBase64",(t,e)=>{Y$.init(t,e),Ke.init(t,e)}),AN=J("ZodBase64URL",(t,e)=>{Q$.init(t,e),Ke.init(t,e)}),PN=J("ZodE164",(t,e)=>{j$.init(t,e),Ke.init(t,e)}),NN=J("ZodJWT",(t,e)=>{tA.init(t,e),Ke.init(t,e)}),cu=J("ZodNumber",(t,e)=>{yy.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(r,o,s)=>kP(t,r,o),t.gt=(r,o)=>t.check(Eh(r,o)),t.gte=(r,o)=>t.check(rl(r,o)),t.min=(r,o)=>t.check(rl(r,o)),t.lt=(r,o)=>t.check(Sh(r,o)),t.lte=(r,o)=>t.check(nl(r,o)),t.max=(r,o)=>t.check(nl(r,o)),t.int=r=>t.check(Ch(r)),t.safe=r=>t.check(Ch(r)),t.positive=r=>t.check(Eh(0,r)),t.nonnegative=r=>t.check(rl(0,r)),t.negative=r=>t.check(Sh(0,r)),t.nonpositive=r=>t.check(nl(0,r)),t.multipleOf=(r,o)=>t.check(Th(r,o)),t.step=(r,o)=>t.check(Th(r,o)),t.finite=()=>t;const n=t._zod.bag;t.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),t.isFinite=!0,t.format=n.format??null});function Ne(t){return jA(cu,t)}const MN=J("ZodNumberFormat",(t,e)=>{nA.init(t,e),cu.init(t,e)});function Ch(t){return tP(MN,t)}const xN=J("ZodBoolean",(t,e)=>{rA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>IP(t,n,r)});function qe(t){return nP(xN,t)}const DN=J("ZodNull",(t,e)=>{oA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>RP(t,n,r)});function xy(t){return rP(DN,t)}const ON=J("ZodAny",(t,e)=>{sA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>AP()});function UN(){return oP(ON)}const LN=J("ZodUnknown",(t,e)=>{iA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>PP()});function Be(){return sP(LN)}const qN=J("ZodNever",(t,e)=>{aA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>$P(t,n,r)});function FN(t){return iP(qN,t)}const VN=J("ZodArray",(t,e)=>{lA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>OP(t,n,r,o),t.element=e.element,t.min=(n,r)=>t.check(Vi(n,r)),t.nonempty=n=>t.check(Vi(1,n)),t.max=(n,r)=>t.check(by(n,r)),t.length=(n,r)=>t.check(Cy(n,r)),t.unwrap=()=>t.element});function j(t,e){return yP(VN,t,e)}const Dy=J("ZodObject",(t,e)=>{uA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>UP(t,n,r,o),Pe(t,"shape",()=>e.shape),t.keyof=()=>At(Object.keys(t._zod.def.shape)),t.catchall=n=>t.clone({...t._zod.def,catchall:n}),t.passthrough=()=>t.clone({...t._zod.def,catchall:Be()}),t.loose=()=>t.clone({...t._zod.def,catchall:Be()}),t.strict=()=>t.clone({...t._zod.def,catchall:FN()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=n=>$R(t,n),t.safeExtend=n=>AR(t,n),t.merge=n=>PR(t,n),t.pick=n=>IR(t,n),t.omit=n=>RR(t,n),t.partial=(...n)=>NR(qy,t,n[0]),t.required=(...n)=>MR(Fy,t,n[0])});function te(t,e){const n={type:"object",shape:t??{},...ae(e)};return new Dy(n)}function ct(t,e){return new Dy({type:"object",shape:t,catchall:Be(),...ae(e)})}const Oy=J("ZodUnion",(t,e)=>{Sy.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>LP(t,n,r,o),t.options=e.options});function ze(t,e){return new Oy({type:"union",options:t,...ae(e)})}const zN=J("ZodDiscriminatedUnion",(t,e)=>{Oy.init(t,e),dA.init(t,e)});function Uy(t,e,n){return new zN({type:"union",options:e,discriminator:t,...ae(n)})}const HN=J("ZodIntersection",(t,e)=>{fA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>qP(t,n,r,o)});function uu(t,e){return new HN({type:"intersection",left:t,right:e})}const GN=J("ZodRecord",(t,e)=>{hA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>FP(t,n,r,o),t.keyType=e.keyType,t.valueType=e.valueType});function Je(t,e,n){return new GN({type:"record",keyType:t,valueType:e,...ae(n)})}const uc=J("ZodEnum",(t,e)=>{pA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(r,o,s)=>NP(t,r,o),t.enum=e.entries,t.options=Object.values(e.entries);const n=new Set(Object.keys(e.entries));t.extract=(r,o)=>{const s={};for(const i of r)if(n.has(i))s[i]=e.entries[i];else throw new Error(`Key ${i} not found in enum`);return new uc({...e,checks:[],...ae(o),entries:s})},t.exclude=(r,o)=>{const s={...e.entries};for(const i of r)if(n.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new uc({...e,checks:[],...ae(o),entries:s})}});function At(t,e){const n=Array.isArray(t)?Object.fromEntries(t.map(r=>[r,r])):t;return new uc({type:"enum",entries:n,...ae(e)})}const BN=J("ZodLiteral",(t,e)=>{mA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>MP(t,n,r),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function le(t,e){return new BN({type:"literal",values:Array.isArray(t)?t:[t],...ae(e)})}const JN=J("ZodTransform",(t,e)=>{gA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>DP(t,n),t._zod.parse=(n,r)=>{if(r.direction==="backward")throw new ty(t.constructor.name);n.addIssue=s=>{if(typeof s=="string")n.issues.push(_o(s,n.value,e));else{const i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=n.value),i.inst??(i.inst=t),n.issues.push(_o(i))}};const o=e.transform(n.value,n);return o instanceof Promise?o.then(s=>(n.value=s,n)):(n.value=o,n)}});function Ly(t){return new JN({type:"transform",transform:t})}const qy=J("ZodOptional",(t,e)=>{Ey.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>$y(t,n,r,o),t.unwrap=()=>t._zod.def.innerType});function We(t){return new qy({type:"optional",innerType:t})}const KN=J("ZodExactOptional",(t,e)=>{_A.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>$y(t,n,r,o),t.unwrap=()=>t._zod.def.innerType});function WN(t){return new KN({type:"optional",innerType:t})}const ZN=J("ZodNullable",(t,e)=>{yA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>VP(t,n,r,o),t.unwrap=()=>t._zod.def.innerType});function kh(t){return new ZN({type:"nullable",innerType:t})}const YN=J("ZodDefault",(t,e)=>{vA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>HP(t,n,r,o),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function XN(t,e){return new YN({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():sy(e)}})}const QN=J("ZodPrefault",(t,e)=>{wA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>GP(t,n,r,o),t.unwrap=()=>t._zod.def.innerType});function jN(t,e){return new QN({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():sy(e)}})}const Fy=J("ZodNonOptional",(t,e)=>{SA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>zP(t,n,r,o),t.unwrap=()=>t._zod.def.innerType});function eM(t,e){return new Fy({type:"nonoptional",innerType:t,...ae(e)})}const tM=J("ZodCatch",(t,e)=>{EA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>BP(t,n,r,o),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function nM(t,e){return new tM({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const rM=J("ZodPipe",(t,e)=>{TA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>JP(t,n,r,o),t.in=e.in,t.out=e.out});function dc(t,e){return new rM({type:"pipe",in:t,out:e})}const oM=J("ZodReadonly",(t,e)=>{bA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>KP(t,n,r,o),t.unwrap=()=>t._zod.def.innerType});function sM(t){return new oM({type:"readonly",innerType:t})}const Vy=J("ZodCustom",(t,e)=>{CA.init(t,e),Ve.init(t,e),t._zod.processJSONSchema=(n,r,o)=>xP(t,n)});function iM(t,e){return vP(Vy,t??(()=>!0),e)}function aM(t,e={}){return wP(Vy,t,e)}function lM(t){return SP(t)}function zy(t,e){return dc(Ly(t),e)}const cM={custom:"custom"};function uM(t){return eP(cu,t)}const Ca="2025-11-25",dM=[Ca,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Gn="io.modelcontextprotocol/related-task",ka="2.0",ut=iM(t=>t!==null&&(typeof t=="object"||typeof t=="function")),Hy=ze([F(),Ne().int()]),Gy=F();ct({ttl:ze([Ne(),xy()]).optional(),pollInterval:Ne().optional()});const fM=te({ttl:Ne().optional()}),hM=te({taskId:F()}),du=ct({progressToken:Hy.optional(),[Gn]:hM.optional()}),Pt=te({_meta:du.optional()}),wo=Pt.extend({task:fM.optional()}),pM=t=>wo.safeParse(t).success,ft=te({method:F(),params:Pt.loose().optional()}),Ut=te({_meta:du.optional()}),Lt=te({method:F(),params:Ut.loose().optional()}),ht=ct({_meta:du.optional()}),Ia=ze([F(),Ne().int()]),By=te({jsonrpc:le(ka),id:Ia,...ft.shape}).strict(),fc=t=>By.safeParse(t).success,Jy=te({jsonrpc:le(ka),...Lt.shape}).strict(),mM=t=>Jy.safeParse(t).success,fu=te({jsonrpc:le(ka),id:Ia,result:ht}).strict(),Yr=t=>fu.safeParse(t).success;var pe;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(pe||(pe={}));const hu=te({jsonrpc:le(ka),id:Ia.optional(),error:te({code:Ne().int(),message:F(),data:Be().optional()})}).strict(),gM=t=>hu.safeParse(t).success,ol=ze([By,Jy,fu,hu]);ze([fu,hu]);const _r=ht.strict(),_M=Ut.extend({requestId:Ia.optional(),reason:F().optional()}),pu=Lt.extend({method:le("notifications/cancelled"),params:_M}),yM=te({src:F(),mimeType:F().optional(),sizes:j(F()).optional(),theme:At(["light","dark"]).optional()}),So=te({icons:j(yM).optional()}),kr=te({name:F(),title:F().optional()}),Ky=kr.extend({...kr.shape,...So.shape,version:F(),websiteUrl:F().optional(),description:F().optional()}),vM=uu(te({applyDefaults:qe().optional()}),Je(F(),Be())),wM=zy(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,uu(te({form:vM.optional(),url:ut.optional()}),Je(F(),Be()).optional())),SM=ct({list:ut.optional(),cancel:ut.optional(),requests:ct({sampling:ct({createMessage:ut.optional()}).optional(),elicitation:ct({create:ut.optional()}).optional()}).optional()}),EM=ct({list:ut.optional(),cancel:ut.optional(),requests:ct({tools:ct({call:ut.optional()}).optional()}).optional()}),TM=te({experimental:Je(F(),ut).optional(),sampling:te({context:ut.optional(),tools:ut.optional()}).optional(),elicitation:wM.optional(),roots:te({listChanged:qe().optional()}).optional(),tasks:SM.optional()}),bM=Pt.extend({protocolVersion:F(),capabilities:TM,clientInfo:Ky}),CM=ft.extend({method:le("initialize"),params:bM}),kM=te({experimental:Je(F(),ut).optional(),logging:ut.optional(),completions:ut.optional(),prompts:te({listChanged:qe().optional()}).optional(),resources:te({subscribe:qe().optional(),listChanged:qe().optional()}).optional(),tools:te({listChanged:qe().optional()}).optional(),tasks:EM.optional()}),Wy=ht.extend({protocolVersion:F(),capabilities:kM,serverInfo:Ky,instructions:F().optional()}),Zy=Lt.extend({method:le("notifications/initialized"),params:Ut.optional()}),IM=t=>Zy.safeParse(t).success,mu=ft.extend({method:le("ping"),params:Pt.optional()}),RM=te({progress:Ne(),total:We(Ne()),message:We(F())}),$M=te({...Ut.shape,...RM.shape,progressToken:Hy}),gu=Lt.extend({method:le("notifications/progress"),params:$M}),AM=Pt.extend({cursor:Gy.optional()}),Eo=ft.extend({params:AM.optional()}),To=ht.extend({nextCursor:Gy.optional()}),PM=At(["working","input_required","completed","failed","cancelled"]),bo=te({taskId:F(),status:PM,ttl:ze([Ne(),xy()]),createdAt:F(),lastUpdatedAt:F(),pollInterval:We(Ne()),statusMessage:We(F())}),yo=ht.extend({task:bo}),NM=Ut.merge(bo),Hi=Lt.extend({method:le("notifications/tasks/status"),params:NM}),_u=ft.extend({method:le("tasks/get"),params:Pt.extend({taskId:F()})}),yu=ht.merge(bo),vu=ft.extend({method:le("tasks/result"),params:Pt.extend({taskId:F()})});ht.loose();const wu=Eo.extend({method:le("tasks/list")}),Su=To.extend({tasks:j(bo)}),Eu=ft.extend({method:le("tasks/cancel"),params:Pt.extend({taskId:F()})}),MM=ht.merge(bo),Yy=te({uri:F(),mimeType:We(F()),_meta:Je(F(),Be()).optional()}),Xy=Yy.extend({text:F()}),Tu=F().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),Qy=Yy.extend({blob:Tu}),Co=At(["user","assistant"]),Nr=te({audience:j(Co).optional(),priority:Ne().min(0).max(1).optional(),lastModified:Py({offset:!0}).optional()}),jy=te({...kr.shape,...So.shape,uri:F(),description:We(F()),mimeType:We(F()),annotations:Nr.optional(),_meta:We(ct({}))}),xM=te({...kr.shape,...So.shape,uriTemplate:F(),description:We(F()),mimeType:We(F()),annotations:Nr.optional(),_meta:We(ct({}))}),DM=Eo.extend({method:le("resources/list")}),ev=To.extend({resources:j(jy)}),OM=Eo.extend({method:le("resources/templates/list")}),tv=To.extend({resourceTemplates:j(xM)}),bu=Pt.extend({uri:F()}),UM=bu,LM=ft.extend({method:le("resources/read"),params:UM}),nv=ht.extend({contents:j(ze([Xy,Qy]))}),rv=Lt.extend({method:le("notifications/resources/list_changed"),params:Ut.optional()}),qM=bu,FM=ft.extend({method:le("resources/subscribe"),params:qM}),VM=bu,zM=ft.extend({method:le("resources/unsubscribe"),params:VM}),HM=Ut.extend({uri:F()}),GM=Lt.extend({method:le("notifications/resources/updated"),params:HM}),BM=te({name:F(),description:We(F()),required:We(qe())}),JM=te({...kr.shape,...So.shape,description:We(F()),arguments:We(j(BM)),_meta:We(ct({}))}),KM=Eo.extend({method:le("prompts/list")}),ov=To.extend({prompts:j(JM)}),WM=Pt.extend({name:F(),arguments:Je(F(),F()).optional()}),ZM=ft.extend({method:le("prompts/get"),params:WM}),Cu=te({type:le("text"),text:F(),annotations:Nr.optional(),_meta:Je(F(),Be()).optional()}),ku=te({type:le("image"),data:Tu,mimeType:F(),annotations:Nr.optional(),_meta:Je(F(),Be()).optional()}),Iu=te({type:le("audio"),data:Tu,mimeType:F(),annotations:Nr.optional(),_meta:Je(F(),Be()).optional()}),YM=te({type:le("tool_use"),name:F(),id:F(),input:Je(F(),Be()),_meta:Je(F(),Be()).optional()}),XM=te({type:le("resource"),resource:ze([Xy,Qy]),annotations:Nr.optional(),_meta:Je(F(),Be()).optional()}),QM=jy.extend({type:le("resource_link")}),Ru=ze([Cu,ku,Iu,QM,XM]),jM=te({role:Co,content:Ru}),sv=ht.extend({description:F().optional(),messages:j(jM)}),iv=Lt.extend({method:le("notifications/prompts/list_changed"),params:Ut.optional()}),e1=te({title:F().optional(),readOnlyHint:qe().optional(),destructiveHint:qe().optional(),idempotentHint:qe().optional(),openWorldHint:qe().optional()}),t1=te({taskSupport:At(["required","optional","forbidden"]).optional()}),av=te({...kr.shape,...So.shape,description:F().optional(),inputSchema:te({type:le("object"),properties:Je(F(),ut).optional(),required:j(F()).optional()}).catchall(Be()),outputSchema:te({type:le("object"),properties:Je(F(),ut).optional(),required:j(F()).optional()}).catchall(Be()).optional(),annotations:e1.optional(),execution:t1.optional(),_meta:Je(F(),Be()).optional()}),n1=Eo.extend({method:le("tools/list")}),lv=To.extend({tools:j(av)}),Ra=ht.extend({content:j(Ru).default([]),structuredContent:Je(F(),Be()).optional(),isError:qe().optional()});Ra.or(ht.extend({toolResult:Be()}));const r1=wo.extend({name:F(),arguments:Je(F(),Be()).optional()}),o1=ft.extend({method:le("tools/call"),params:r1}),cv=Lt.extend({method:le("notifications/tools/list_changed"),params:Ut.optional()}),s1=te({autoRefresh:qe().default(!0),debounceMs:Ne().int().nonnegative().default(300)}),uv=At(["debug","info","notice","warning","error","critical","alert","emergency"]),i1=Pt.extend({level:uv}),a1=ft.extend({method:le("logging/setLevel"),params:i1}),l1=Ut.extend({level:uv,logger:F().optional(),data:Be()}),c1=Lt.extend({method:le("notifications/message"),params:l1}),u1=te({name:F().optional()}),d1=te({hints:j(u1).optional(),costPriority:Ne().min(0).max(1).optional(),speedPriority:Ne().min(0).max(1).optional(),intelligencePriority:Ne().min(0).max(1).optional()}),f1=te({mode:At(["auto","required","none"]).optional()}),h1=te({type:le("tool_result"),toolUseId:F().describe("The unique identifier for the corresponding tool call."),content:j(Ru).default([]),structuredContent:te({}).loose().optional(),isError:qe().optional(),_meta:Je(F(),Be()).optional()}),p1=Uy("type",[Cu,ku,Iu]),Gi=Uy("type",[Cu,ku,Iu,YM,h1]),m1=te({role:Co,content:ze([Gi,j(Gi)]),_meta:Je(F(),Be()).optional()}),g1=wo.extend({messages:j(m1),modelPreferences:d1.optional(),systemPrompt:F().optional(),includeContext:At(["none","thisServer","allServers"]).optional(),temperature:Ne().optional(),maxTokens:Ne().int(),stopSequences:j(F()).optional(),metadata:ut.optional(),tools:j(av).optional(),toolChoice:f1.optional()}),dv=ft.extend({method:le("sampling/createMessage"),params:g1}),fv=ht.extend({model:F(),stopReason:We(At(["endTurn","stopSequence","maxTokens"]).or(F())),role:Co,content:p1}),hv=ht.extend({model:F(),stopReason:We(At(["endTurn","stopSequence","maxTokens","toolUse"]).or(F())),role:Co,content:ze([Gi,j(Gi)])}),_1=te({type:le("boolean"),title:F().optional(),description:F().optional(),default:qe().optional()}),y1=te({type:le("string"),title:F().optional(),description:F().optional(),minLength:Ne().optional(),maxLength:Ne().optional(),format:At(["email","uri","date","date-time"]).optional(),default:F().optional()}),v1=te({type:At(["number","integer"]),title:F().optional(),description:F().optional(),minimum:Ne().optional(),maximum:Ne().optional(),default:Ne().optional()}),w1=te({type:le("string"),title:F().optional(),description:F().optional(),enum:j(F()),default:F().optional()}),S1=te({type:le("string"),title:F().optional(),description:F().optional(),oneOf:j(te({const:F(),title:F()})),default:F().optional()}),E1=te({type:le("string"),title:F().optional(),description:F().optional(),enum:j(F()),enumNames:j(F()).optional(),default:F().optional()}),T1=ze([w1,S1]),b1=te({type:le("array"),title:F().optional(),description:F().optional(),minItems:Ne().optional(),maxItems:Ne().optional(),items:te({type:le("string"),enum:j(F())}),default:j(F()).optional()}),C1=te({type:le("array"),title:F().optional(),description:F().optional(),minItems:Ne().optional(),maxItems:Ne().optional(),items:te({anyOf:j(te({const:F(),title:F()}))}),default:j(F()).optional()}),k1=ze([b1,C1]),I1=ze([E1,T1,k1]),R1=ze([I1,_1,y1,v1]),$1=wo.extend({mode:le("form").optional(),message:F(),requestedSchema:te({type:le("object"),properties:Je(F(),R1),required:j(F()).optional()})}),A1=wo.extend({mode:le("url"),message:F(),elicitationId:F(),url:F().url()}),P1=ze([$1,A1]),pv=ft.extend({method:le("elicitation/create"),params:P1}),N1=Ut.extend({elicitationId:F()}),M1=Lt.extend({method:le("notifications/elicitation/complete"),params:N1}),mv=ht.extend({action:At(["accept","decline","cancel"]),content:zy(t=>t===null?void 0:t,Je(F(),ze([F(),Ne(),qe(),j(F())])).optional())}),x1=te({type:le("ref/resource"),uri:F()}),D1=te({type:le("ref/prompt"),name:F()}),O1=Pt.extend({ref:ze([D1,x1]),argument:te({name:F(),value:F()}),context:te({arguments:Je(F(),F()).optional()}).optional()}),U1=ft.extend({method:le("completion/complete"),params:O1}),gv=ht.extend({completion:ct({values:j(F()).max(100),total:We(Ne().int()),hasMore:We(qe())})}),L1=te({uri:F().startsWith("file://"),name:F().optional(),_meta:Je(F(),Be()).optional()}),q1=ft.extend({method:le("roots/list"),params:Pt.optional()}),F1=ht.extend({roots:j(L1)}),V1=Lt.extend({method:le("notifications/roots/list_changed"),params:Ut.optional()});ze([mu,CM,U1,a1,ZM,KM,DM,OM,LM,FM,zM,o1,n1,_u,vu,wu,Eu]);ze([pu,gu,Zy,V1,Hi]);ze([_r,fv,hv,mv,F1,yu,Su,yo]);ze([mu,dv,pv,q1,_u,vu,wu,Eu]);ze([pu,gu,c1,GM,rv,cv,iv,Hi,M1]);ze([_r,Wy,gv,sv,ov,ev,tv,nv,Ra,lv,yu,Su,yo]);class de extends Error{constructor(e,n,r){super(`MCP error ${e}: ${n}`),this.code=e,this.data=r,this.name="McpError"}static fromError(e,n,r){if(e===pe.UrlElicitationRequired&&r){const o=r;if(o.elicitations)return new z1(o.elicitations,n)}return new de(e,n,r)}}class z1 extends de{constructor(e,n=`URL elicitation${e.length>1?"s":""} required`){super(pe.UrlElicitationRequired,n,{elicitations:e})}get elicitations(){return this.data?.elicitations??[]}}function Mn(t){return t==="completed"||t==="failed"||t==="cancelled"}new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Ih(t){const n=Ay(t)?.method;if(!n)throw new Error("Schema is missing a method literal");const r=WP(n);if(typeof r!="string")throw new Error("Schema method literal must be a string");return r}function Rh(t,e){const n=wn(t,e);if(!n.success)throw n.error;return n.data}const H1=6e4;class G1{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(pu,n=>{this._oncancel(n)}),this.setNotificationHandler(gu,n=>{this._onprogress(n)}),this.setRequestHandler(mu,n=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(_u,async(n,r)=>{const o=await this._taskStore.getTask(n.params.taskId,r.sessionId);if(!o)throw new de(pe.InvalidParams,"Failed to retrieve task: Task not found");return{...o}}),this.setRequestHandler(vu,async(n,r)=>{const o=async()=>{const s=n.params.taskId;if(this._taskMessageQueue){let a;for(;a=await this._taskMessageQueue.dequeue(s,r.sessionId);){if(a.type==="response"||a.type==="error"){const l=a.message,c=l.id,u=this._requestResolvers.get(c);if(u)if(this._requestResolvers.delete(c),a.type==="response")u(l);else{const h=l,p=new de(h.error.code,h.error.message,h.error.data);u(p)}else{const h=a.type==="response"?"Response":"Error";this._onerror(new Error(`${h} handler missing for request ${c}`))}continue}await this._transport?.send(a.message,{relatedRequestId:r.requestId})}}const i=await this._taskStore.getTask(s,r.sessionId);if(!i)throw new de(pe.InvalidParams,`Task not found: ${s}`);if(!Mn(i.status))return await this._waitForTaskUpdate(s,r.signal),await o();if(Mn(i.status)){const a=await this._taskStore.getTaskResult(s,r.sessionId);return this._clearTaskQueue(s),{...a,_meta:{...a._meta,[Gn]:{taskId:s}}}}return await o()};return await o()}),this.setRequestHandler(wu,async(n,r)=>{try{const{tasks:o,nextCursor:s}=await this._taskStore.listTasks(n.params?.cursor,r.sessionId);return{tasks:o,nextCursor:s,_meta:{}}}catch(o){throw new de(pe.InvalidParams,`Failed to list tasks: ${o instanceof Error?o.message:String(o)}`)}}),this.setRequestHandler(Eu,async(n,r)=>{try{const o=await this._taskStore.getTask(n.params.taskId,r.sessionId);if(!o)throw new de(pe.InvalidParams,`Task not found: ${n.params.taskId}`);if(Mn(o.status))throw new de(pe.InvalidParams,`Cannot cancel task in terminal status: ${o.status}`);await this._taskStore.updateTaskStatus(n.params.taskId,"cancelled","Client cancelled task execution.",r.sessionId),this._clearTaskQueue(n.params.taskId);const s=await this._taskStore.getTask(n.params.taskId,r.sessionId);if(!s)throw new de(pe.InvalidParams,`Task not found after cancellation: ${n.params.taskId}`);return{_meta:{},...s}}catch(o){throw o instanceof de?o:new de(pe.InvalidRequest,`Failed to cancel task: ${o instanceof Error?o.message:String(o)}`)}}))}async _oncancel(e){if(!e.params.requestId)return;this._requestHandlerAbortControllers.get(e.params.requestId)?.abort(e.params.reason)}_setupTimeout(e,n,r,o,s=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(o,n),startTime:Date.now(),timeout:n,maxTotalTimeout:r,resetTimeoutOnProgress:s,onTimeout:o})}_resetTimeout(e){const n=this._timeoutInfo.get(e);if(!n)return!1;const r=Date.now()-n.startTime;if(n.maxTotalTimeout&&r>=n.maxTotalTimeout)throw this._timeoutInfo.delete(e),de.fromError(pe.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:n.maxTotalTimeout,totalElapsed:r});return clearTimeout(n.timeoutId),n.timeoutId=setTimeout(n.onTimeout,n.timeout),!0}_cleanupTimeout(e){const n=this._timeoutInfo.get(e);n&&(clearTimeout(n.timeoutId),this._timeoutInfo.delete(e))}async connect(e){this._transport=e;const n=this.transport?.onclose;this._transport.onclose=()=>{n?.(),this._onclose()};const r=this.transport?.onerror;this._transport.onerror=s=>{r?.(s),this._onerror(s)};const o=this._transport?.onmessage;this._transport.onmessage=(s,i)=>{o?.(s,i),Yr(s)||gM(s)?this._onresponse(s):fc(s)?this._onrequest(s,i):mM(s)?this._onnotification(s):this._onerror(new Error(`Unknown message type: ${JSON.stringify(s)}`))},await this._transport.start()}_onclose(){const e=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();const n=de.fromError(pe.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(const r of e.values())r(n)}_onerror(e){this.onerror?.(e)}_onnotification(e){const n=this._notificationHandlers.get(e.method)??this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(e)).catch(r=>this._onerror(new Error(`Uncaught error in notification handler: ${r}`)))}_onrequest(e,n){const r=this._requestHandlers.get(e.method)??this.fallbackRequestHandler,o=this._transport,s=e.params?._meta?.[Gn]?.taskId;if(r===void 0){const u={jsonrpc:"2.0",id:e.id,error:{code:pe.MethodNotFound,message:"Method not found"}};s&&this._taskMessageQueue?this._enqueueTaskMessage(s,{type:"error",message:u,timestamp:Date.now()},o?.sessionId).catch(h=>this._onerror(new Error(`Failed to enqueue error response: ${h}`))):o?.send(u).catch(h=>this._onerror(new Error(`Failed to send an error response: ${h}`)));return}const i=new AbortController;this._requestHandlerAbortControllers.set(e.id,i);const a=pM(e.params)?e.params.task:void 0,l=this._taskStore?this.requestTaskStore(e,o?.sessionId):void 0,c={signal:i.signal,sessionId:o?.sessionId,_meta:e.params?._meta,sendNotification:async u=>{const h={relatedRequestId:e.id};s&&(h.relatedTask={taskId:s}),await this.notification(u,h)},sendRequest:async(u,h,p)=>{const m={...p,relatedRequestId:e.id};s&&!m.relatedTask&&(m.relatedTask={taskId:s});const w=m.relatedTask?.taskId??s;return w&&l&&await l.updateTaskStatus(w,"input_required"),await this.request(u,h,m)},authInfo:n?.authInfo,requestId:e.id,requestInfo:n?.requestInfo,taskId:s,taskStore:l,taskRequestedTtl:a?.ttl,closeSSEStream:n?.closeSSEStream,closeStandaloneSSEStream:n?.closeStandaloneSSEStream};Promise.resolve().then(()=>{a&&this.assertTaskHandlerCapability(e.method)}).then(()=>r(e,c)).then(async u=>{if(i.signal.aborted)return;const h={result:u,jsonrpc:"2.0",id:e.id};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"response",message:h,timestamp:Date.now()},o?.sessionId):await o?.send(h)},async u=>{if(i.signal.aborted)return;const h={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(u.code)?u.code:pe.InternalError,message:u.message??"Internal error",...u.data!==void 0&&{data:u.data}}};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"error",message:h,timestamp:Date.now()},o?.sessionId):await o?.send(h)}).catch(u=>this._onerror(new Error(`Failed to send response: ${u}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){const{progressToken:n,...r}=e.params,o=Number(n),s=this._progressHandlers.get(o);if(!s){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}const i=this._responseHandlers.get(o),a=this._timeoutInfo.get(o);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(o)}catch(l){this._responseHandlers.delete(o),this._progressHandlers.delete(o),this._cleanupTimeout(o),i(l);return}s(r)}_onresponse(e){const n=Number(e.id),r=this._requestResolvers.get(n);if(r){if(this._requestResolvers.delete(n),Yr(e))r(e);else{const i=new de(e.error.code,e.error.message,e.error.data);r(i)}return}const o=this._responseHandlers.get(n);if(o===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(n),this._cleanupTimeout(n);let s=!1;if(Yr(e)&&e.result&&typeof e.result=="object"){const i=e.result;if(i.task&&typeof i.task=="object"){const a=i.task;typeof a.taskId=="string"&&(s=!0,this._taskProgressTokens.set(a.taskId,n))}}if(s||this._progressHandlers.delete(n),Yr(e))o(e);else{const i=de.fromError(e.error.code,e.error.message,e.error.data);o(i)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(e,n,r){const{task:o}=r??{};if(!o){try{yield{type:"result",result:await this.request(e,n,r)}}catch(i){yield{type:"error",error:i instanceof de?i:new de(pe.InternalError,String(i))}}return}let s;try{const i=await this.request(e,yo,r);if(i.task)s=i.task.taskId,yield{type:"taskCreated",task:i.task};else throw new de(pe.InternalError,"Task creation did not return a task");for(;;){const a=await this.getTask({taskId:s},r);if(yield{type:"taskStatus",task:a},Mn(a.status)){a.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:s},n,r)}:a.status==="failed"?yield{type:"error",error:new de(pe.InternalError,`Task ${s} failed`)}:a.status==="cancelled"&&(yield{type:"error",error:new de(pe.InternalError,`Task ${s} was cancelled`)});return}if(a.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:s},n,r)};return}const l=a.pollInterval??this._options?.defaultTaskPollInterval??1e3;await new Promise(c=>setTimeout(c,l)),r?.signal?.throwIfAborted()}}catch(i){yield{type:"error",error:i instanceof de?i:new de(pe.InternalError,String(i))}}}request(e,n,r){const{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i,task:a,relatedTask:l}=r??{};return new Promise((c,u)=>{const h=g=>{u(g)};if(!this._transport){h(new Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{this.assertCapabilityForMethod(e.method),a&&this.assertTaskCapability(e.method)}catch(g){h(g);return}r?.signal?.throwIfAborted();const p=this._requestMessageId++,m={...e,jsonrpc:"2.0",id:p};r?.onprogress&&(this._progressHandlers.set(p,r.onprogress),m.params={...e.params,_meta:{...e.params?._meta||{},progressToken:p}}),a&&(m.params={...m.params,task:a}),l&&(m.params={...m.params,_meta:{...m.params?._meta||{},[Gn]:l}});const w=g=>{this._responseHandlers.delete(p),this._progressHandlers.delete(p),this._cleanupTimeout(p),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:p,reason:String(g)}},{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(b=>this._onerror(new Error(`Failed to send cancellation: ${b}`)));const S=g instanceof de?g:new de(pe.RequestTimeout,String(g));u(S)};this._responseHandlers.set(p,g=>{if(!r?.signal?.aborted){if(g instanceof Error)return u(g);try{const S=wn(n,g.result);S.success?c(S.data):u(S.error)}catch(S){u(S)}}}),r?.signal?.addEventListener("abort",()=>{w(r?.signal?.reason)});const E=r?.timeout??H1,_=()=>w(de.fromError(pe.RequestTimeout,"Request timed out",{timeout:E}));this._setupTimeout(p,E,r?.maxTotalTimeout,_,r?.resetTimeoutOnProgress??!1);const v=l?.taskId;if(v){const g=S=>{const b=this._responseHandlers.get(p);b?b(S):this._onerror(new Error(`Response handler missing for side-channeled request ${p}`))};this._requestResolvers.set(p,g),this._enqueueTaskMessage(v,{type:"request",message:m,timestamp:Date.now()}).catch(S=>{this._cleanupTimeout(p),u(S)})}else this._transport.send(m,{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(g=>{this._cleanupTimeout(p),u(g)})})}async getTask(e,n){return this.request({method:"tasks/get",params:e},yu,n)}async getTaskResult(e,n,r){return this.request({method:"tasks/result",params:e},n,r)}async listTasks(e,n){return this.request({method:"tasks/list",params:e},Su,n)}async cancelTask(e,n){return this.request({method:"tasks/cancel",params:e},MM,n)}async notification(e,n){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);const r=n?.relatedTask?.taskId;if(r){const a={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...e.params?._meta||{},[Gn]:n.relatedTask}}};await this._enqueueTaskMessage(r,{type:"notification",message:a,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(e.method)&&!e.params&&!n?.relatedRequestId&&!n?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let a={...e,jsonrpc:"2.0"};n?.relatedTask&&(a={...a,params:{...a.params,_meta:{...a.params?._meta||{},[Gn]:n.relatedTask}}}),this._transport?.send(a,n).catch(l=>this._onerror(l))});return}let i={...e,jsonrpc:"2.0"};n?.relatedTask&&(i={...i,params:{...i.params,_meta:{...i.params?._meta||{},[Gn]:n.relatedTask}}}),await this._transport.send(i,n)}setRequestHandler(e,n){const r=Ih(e);this.assertRequestHandlerCapability(r),this._requestHandlers.set(r,(o,s)=>{const i=Rh(e,o);return Promise.resolve(n(i,s))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,n){const r=Ih(e);this._notificationHandlers.set(r,o=>{const s=Rh(e,o);return Promise.resolve(n(s))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){const n=this._taskProgressTokens.get(e);n!==void 0&&(this._progressHandlers.delete(n),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,n,r){if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");const o=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,n,r,o)}async _clearTaskQueue(e,n){if(this._taskMessageQueue){const r=await this._taskMessageQueue.dequeueAll(e,n);for(const o of r)if(o.type==="request"&&fc(o.message)){const s=o.message.id,i=this._requestResolvers.get(s);i?(i(new de(pe.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(s)):this._onerror(new Error(`Resolver missing for request ${s} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,n){let r=this._options?.defaultTaskPollInterval??1e3;try{const o=await this._taskStore?.getTask(e);o?.pollInterval&&(r=o.pollInterval)}catch{}return new Promise((o,s)=>{if(n.aborted){s(new de(pe.InvalidRequest,"Request cancelled"));return}const i=setTimeout(o,r);n.addEventListener("abort",()=>{clearTimeout(i),s(new de(pe.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,n){const r=this._taskStore;if(!r)throw new Error("No task store configured");return{createTask:async o=>{if(!e)throw new Error("No request provided");return await r.createTask(o,e.id,{method:e.method,params:e.params},n)},getTask:async o=>{const s=await r.getTask(o,n);if(!s)throw new de(pe.InvalidParams,"Failed to retrieve task: Task not found");return s},storeTaskResult:async(o,s,i)=>{await r.storeTaskResult(o,s,i,n);const a=await r.getTask(o,n);if(a){const l=Hi.parse({method:"notifications/tasks/status",params:a});await this.notification(l),Mn(a.status)&&this._cleanupTaskProgressHandler(o)}},getTaskResult:o=>r.getTaskResult(o,n),updateTaskStatus:async(o,s,i)=>{const a=await r.getTask(o,n);if(!a)throw new de(pe.InvalidParams,`Task "${o}" not found - it may have been cleaned up`);if(Mn(a.status))throw new de(pe.InvalidParams,`Cannot update task "${o}" from terminal status "${a.status}" to "${s}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await r.updateTaskStatus(o,s,i,n);const l=await r.getTask(o,n);if(l){const c=Hi.parse({method:"notifications/tasks/status",params:l});await this.notification(c),Mn(l.status)&&this._cleanupTaskProgressHandler(o)}},listTasks:o=>r.listTasks(o,n)}}}function $h(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function B1(t,e){const n={...t};for(const r in e){const o=r,s=e[o];if(s===void 0)continue;const i=n[o];$h(i)&&$h(s)?n[o]={...i,...s}:n[o]=s}return n}function _v(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Fo={exports:{}},sl={},tn={},xn={},il={},al={},ll={},Ah;function Bi(){return Ah||(Ah=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class e{}t._CodeOrName=e,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends e{constructor(g){if(super(),!t.IDENTIFIER.test(g))throw new Error("CodeGen: name must be a valid identifier");this.str=g}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=n;class r extends e{constructor(g){super(),this._items=typeof g=="string"?[g]:g}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const g=this._items[0];return g===""||g==='""'}get str(){var g;return(g=this._str)!==null&&g!==void 0?g:this._str=this._items.reduce((S,b)=>`${S}${b}`,"")}get names(){var g;return(g=this._names)!==null&&g!==void 0?g:this._names=this._items.reduce((S,b)=>(b instanceof n&&(S[b.str]=(S[b.str]||0)+1),S),{})}}t._Code=r,t.nil=new r("");function o(v,...g){const S=[v[0]];let b=0;for(;b<g.length;)a(S,g[b]),S.push(v[++b]);return new r(S)}t._=o;const s=new r("+");function i(v,...g){const S=[m(v[0])];let b=0;for(;b<g.length;)S.push(s),a(S,g[b]),S.push(s,m(v[++b]));return l(S),new r(S)}t.str=i;function a(v,g){g instanceof r?v.push(...g._items):g instanceof n?v.push(g):v.push(h(g))}t.addCodeArg=a;function l(v){let g=1;for(;g<v.length-1;){if(v[g]===s){const S=c(v[g-1],v[g+1]);if(S!==void 0){v.splice(g-1,3,S);continue}v[g++]="+"}g++}}function c(v,g){if(g==='""')return v;if(v==='""')return g;if(typeof v=="string")return g instanceof n||v[v.length-1]!=='"'?void 0:typeof g!="string"?`${v.slice(0,-1)}${g}"`:g[0]==='"'?v.slice(0,-1)+g.slice(1):void 0;if(typeof g=="string"&&g[0]==='"'&&!(v instanceof n))return`"${v}${g.slice(1)}`}function u(v,g){return g.emptyStr()?v:v.emptyStr()?g:i`${v}${g}`}t.strConcat=u;function h(v){return typeof v=="number"||typeof v=="boolean"||v===null?v:m(Array.isArray(v)?v.join(","):v)}function p(v){return new r(m(v))}t.stringify=p;function m(v){return JSON.stringify(v).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.safeStringify=m;function w(v){return typeof v=="string"&&t.IDENTIFIER.test(v)?new r(`.${v}`):o`[${v}]`}t.getProperty=w;function E(v){if(typeof v=="string"&&t.IDENTIFIER.test(v))return new r(`${v}`);throw new Error(`CodeGen: invalid export name: ${v}, use explicit $id name mapping`)}t.getEsmExportName=E;function _(v){return new r(v.toString())}t.regexpCode=_})(ll)),ll}var cl={},Ph;function Nh(){return Ph||(Ph=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const e=Bi();class n extends Error{constructor(c){super(`CodeGen: "code" for ${c} not defined`),this.value=c.value}}var r;(function(l){l[l.Started=0]="Started",l[l.Completed=1]="Completed"})(r||(t.UsedValueState=r={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class o{constructor({prefixes:c,parent:u}={}){this._names={},this._prefixes=c,this._parent=u}toName(c){return c instanceof e.Name?c:this.name(c)}name(c){return new e.Name(this._newName(c))}_newName(c){const u=this._names[c]||this._nameGroup(c);return`${c}${u.index++}`}_nameGroup(c){var u,h;if(!((h=(u=this._parent)===null||u===void 0?void 0:u._prefixes)===null||h===void 0)&&h.has(c)||this._prefixes&&!this._prefixes.has(c))throw new Error(`CodeGen: prefix "${c}" is not allowed in this scope`);return this._names[c]={prefix:c,index:0}}}t.Scope=o;class s extends e.Name{constructor(c,u){super(u),this.prefix=c}setValue(c,{property:u,itemIndex:h}){this.value=c,this.scopePath=(0,e._)`.${new e.Name(u)}[${h}]`}}t.ValueScopeName=s;const i=(0,e._)`\n`;class a extends o{constructor(c){super(c),this._values={},this._scope=c.scope,this.opts={...c,_n:c.lines?i:e.nil}}get(){return this._scope}name(c){return new s(c,this._newName(c))}value(c,u){var h;if(u.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const p=this.toName(c),{prefix:m}=p,w=(h=u.key)!==null&&h!==void 0?h:u.ref;let E=this._values[m];if(E){const g=E.get(w);if(g)return g}else E=this._values[m]=new Map;E.set(w,p);const _=this._scope[m]||(this._scope[m]=[]),v=_.length;return _[v]=u.ref,p.setValue(u,{property:m,itemIndex:v}),p}getValue(c,u){const h=this._values[c];if(h)return h.get(u)}scopeRefs(c,u=this._values){return this._reduceValues(u,h=>{if(h.scopePath===void 0)throw new Error(`CodeGen: name "${h}" has no value`);return(0,e._)`${c}${h.scopePath}`})}scopeCode(c=this._values,u,h){return this._reduceValues(c,p=>{if(p.value===void 0)throw new Error(`CodeGen: name "${p}" has no value`);return p.value.code},u,h)}_reduceValues(c,u,h={},p){let m=e.nil;for(const w in c){const E=c[w];if(!E)continue;const _=h[w]=h[w]||new Map;E.forEach(v=>{if(_.has(v))return;_.set(v,r.Started);let g=u(v);if(g){const S=this.opts.es5?t.varKinds.var:t.varKinds.const;m=(0,e._)`${m}${S} ${v} = ${g};${this.opts._n}`}else if(g=p?.(v))m=(0,e._)`${m}${g}${this.opts._n}`;else throw new n(v);_.set(v,r.Completed)})}return m}}t.ValueScope=a})(cl)),cl}var Mh;function we(){return Mh||(Mh=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const e=Bi(),n=Nh();var r=Bi();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}});var o=Nh();Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return o.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return o.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return o.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return o.varKinds}}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class s{optimizeNodes(){return this}optimizeNames(T,I){return this}}class i extends s{constructor(T,I,x){super(),this.varKind=T,this.name=I,this.rhs=x}render({es5:T,_n:I}){const x=T?n.varKinds.var:this.varKind,W=this.rhs===void 0?"":` = ${this.rhs}`;return`${x} ${this.name}${W};`+I}optimizeNames(T,I){if(T[this.name.str])return this.rhs&&(this.rhs=K(this.rhs,T,I)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class a extends s{constructor(T,I,x){super(),this.lhs=T,this.rhs=I,this.sideEffects=x}render({_n:T}){return`${this.lhs} = ${this.rhs};`+T}optimizeNames(T,I){if(!(this.lhs instanceof e.Name&&!T[this.lhs.str]&&!this.sideEffects))return this.rhs=K(this.rhs,T,I),this}get names(){const T=this.lhs instanceof e.Name?{}:{...this.lhs.names};return B(T,this.rhs)}}class l extends a{constructor(T,I,x,W){super(T,x,W),this.op=I}render({_n:T}){return`${this.lhs} ${this.op}= ${this.rhs};`+T}}class c extends s{constructor(T){super(),this.label=T,this.names={}}render({_n:T}){return`${this.label}:`+T}}class u extends s{constructor(T){super(),this.label=T,this.names={}}render({_n:T}){return`break${this.label?` ${this.label}`:""};`+T}}class h extends s{constructor(T){super(),this.error=T}render({_n:T}){return`throw ${this.error};`+T}get names(){return this.error.names}}class p extends s{constructor(T){super(),this.code=T}render({_n:T}){return`${this.code};`+T}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(T,I){return this.code=K(this.code,T,I),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class m extends s{constructor(T=[]){super(),this.nodes=T}render(T){return this.nodes.reduce((I,x)=>I+x.render(T),"")}optimizeNodes(){const{nodes:T}=this;let I=T.length;for(;I--;){const x=T[I].optimizeNodes();Array.isArray(x)?T.splice(I,1,...x):x?T[I]=x:T.splice(I,1)}return T.length>0?this:void 0}optimizeNames(T,I){const{nodes:x}=this;let W=x.length;for(;W--;){const Z=x[W];Z.optimizeNames(T,I)||(oe(T,Z.names),x.splice(W,1))}return x.length>0?this:void 0}get names(){return this.nodes.reduce((T,I)=>G(T,I.names),{})}}class w extends m{render(T){return"{"+T._n+super.render(T)+"}"+T._n}}class E extends m{}class _ extends w{}_.kind="else";class v extends w{constructor(T,I){super(I),this.condition=T}render(T){let I=`if(${this.condition})`+super.render(T);return this.else&&(I+="else "+this.else.render(T)),I}optimizeNodes(){super.optimizeNodes();const T=this.condition;if(T===!0)return this.nodes;let I=this.else;if(I){const x=I.optimizeNodes();I=this.else=Array.isArray(x)?new _(x):x}if(I)return T===!1?I instanceof v?I:I.nodes:this.nodes.length?this:new v(Se(T),I instanceof v?[I]:I.nodes);if(!(T===!1||!this.nodes.length))return this}optimizeNames(T,I){var x;if(this.else=(x=this.else)===null||x===void 0?void 0:x.optimizeNames(T,I),!!(super.optimizeNames(T,I)||this.else))return this.condition=K(this.condition,T,I),this}get names(){const T=super.names;return B(T,this.condition),this.else&&G(T,this.else.names),T}}v.kind="if";class g extends w{}g.kind="for";class S extends g{constructor(T){super(),this.iteration=T}render(T){return`for(${this.iteration})`+super.render(T)}optimizeNames(T,I){if(super.optimizeNames(T,I))return this.iteration=K(this.iteration,T,I),this}get names(){return G(super.names,this.iteration.names)}}class b extends g{constructor(T,I,x,W){super(),this.varKind=T,this.name=I,this.from=x,this.to=W}render(T){const I=T.es5?n.varKinds.var:this.varKind,{name:x,from:W,to:Z}=this;return`for(${I} ${x}=${W}; ${x}<${Z}; ${x}++)`+super.render(T)}get names(){const T=B(super.names,this.from);return B(T,this.to)}}class y extends g{constructor(T,I,x,W){super(),this.loop=T,this.varKind=I,this.name=x,this.iterable=W}render(T){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(T)}optimizeNames(T,I){if(super.optimizeNames(T,I))return this.iterable=K(this.iterable,T,I),this}get names(){return G(super.names,this.iterable.names)}}class C extends w{constructor(T,I,x){super(),this.name=T,this.args=I,this.async=x}render(T){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(T)}}C.kind="func";class k extends m{render(T){return"return "+super.render(T)}}k.kind="return";class P extends w{render(T){let I="try"+super.render(T);return this.catch&&(I+=this.catch.render(T)),this.finally&&(I+=this.finally.render(T)),I}optimizeNodes(){var T,I;return super.optimizeNodes(),(T=this.catch)===null||T===void 0||T.optimizeNodes(),(I=this.finally)===null||I===void 0||I.optimizeNodes(),this}optimizeNames(T,I){var x,W;return super.optimizeNames(T,I),(x=this.catch)===null||x===void 0||x.optimizeNames(T,I),(W=this.finally)===null||W===void 0||W.optimizeNames(T,I),this}get names(){const T=super.names;return this.catch&&G(T,this.catch.names),this.finally&&G(T,this.finally.names),T}}class M extends w{constructor(T){super(),this.error=T}render(T){return`catch(${this.error})`+super.render(T)}}M.kind="catch";class q extends w{render(T){return"finally"+super.render(T)}}q.kind="finally";class D{constructor(T,I={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...I,_n:I.lines?`
`:""},this._extScope=T,this._scope=new n.Scope({parent:T}),this._nodes=[new E]}toString(){return this._root.render(this.opts)}name(T){return this._scope.name(T)}scopeName(T){return this._extScope.name(T)}scopeValue(T,I){const x=this._extScope.value(T,I);return(this._values[x.prefix]||(this._values[x.prefix]=new Set)).add(x),x}getScopeValue(T,I){return this._extScope.getValue(T,I)}scopeRefs(T){return this._extScope.scopeRefs(T,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(T,I,x,W){const Z=this._scope.toName(I);return x!==void 0&&W&&(this._constants[Z.str]=x),this._leafNode(new i(T,Z,x)),Z}const(T,I,x){return this._def(n.varKinds.const,T,I,x)}let(T,I,x){return this._def(n.varKinds.let,T,I,x)}var(T,I,x){return this._def(n.varKinds.var,T,I,x)}assign(T,I,x){return this._leafNode(new a(T,I,x))}add(T,I){return this._leafNode(new l(T,t.operators.ADD,I))}code(T){return typeof T=="function"?T():T!==e.nil&&this._leafNode(new p(T)),this}object(...T){const I=["{"];for(const[x,W]of T)I.length>1&&I.push(","),I.push(x),(x!==W||this.opts.es5)&&(I.push(":"),(0,e.addCodeArg)(I,W));return I.push("}"),new e._Code(I)}if(T,I,x){if(this._blockNode(new v(T)),I&&x)this.code(I).else().code(x).endIf();else if(I)this.code(I).endIf();else if(x)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(T){return this._elseNode(new v(T))}else(){return this._elseNode(new _)}endIf(){return this._endBlockNode(v,_)}_for(T,I){return this._blockNode(T),I&&this.code(I).endFor(),this}for(T,I){return this._for(new S(T),I)}forRange(T,I,x,W,Z=this.opts.es5?n.varKinds.var:n.varKinds.let){const se=this._scope.toName(T);return this._for(new b(Z,se,I,x),()=>W(se))}forOf(T,I,x,W=n.varKinds.const){const Z=this._scope.toName(T);if(this.opts.es5){const se=I instanceof e.Name?I:this.var("_arr",I);return this.forRange("_i",0,(0,e._)`${se}.length`,re=>{this.var(Z,(0,e._)`${se}[${re}]`),x(Z)})}return this._for(new y("of",W,Z,I),()=>x(Z))}forIn(T,I,x,W=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(T,(0,e._)`Object.keys(${I})`,x);const Z=this._scope.toName(T);return this._for(new y("in",W,Z,I),()=>x(Z))}endFor(){return this._endBlockNode(g)}label(T){return this._leafNode(new c(T))}break(T){return this._leafNode(new u(T))}return(T){const I=new k;if(this._blockNode(I),this.code(T),I.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(k)}try(T,I,x){if(!I&&!x)throw new Error('CodeGen: "try" without "catch" and "finally"');const W=new P;if(this._blockNode(W),this.code(T),I){const Z=this.name("e");this._currNode=W.catch=new M(Z),I(Z)}return x&&(this._currNode=W.finally=new q,this.code(x)),this._endBlockNode(M,q)}throw(T){return this._leafNode(new h(T))}block(T,I){return this._blockStarts.push(this._nodes.length),T&&this.code(T).endBlock(I),this}endBlock(T){const I=this._blockStarts.pop();if(I===void 0)throw new Error("CodeGen: not in self-balancing block");const x=this._nodes.length-I;if(x<0||T!==void 0&&x!==T)throw new Error(`CodeGen: wrong number of nodes: ${x} vs ${T} expected`);return this._nodes.length=I,this}func(T,I=e.nil,x,W){return this._blockNode(new C(T,I,x)),W&&this.code(W).endFunc(),this}endFunc(){return this._endBlockNode(C)}optimize(T=1){for(;T-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(T){return this._currNode.nodes.push(T),this}_blockNode(T){this._currNode.nodes.push(T),this._nodes.push(T)}_endBlockNode(T,I){const x=this._currNode;if(x instanceof T||I&&x instanceof I)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${I?`${T.kind}/${I.kind}`:T.kind}"`)}_elseNode(T){const I=this._currNode;if(!(I instanceof v))throw new Error('CodeGen: "else" without "if"');return this._currNode=I.else=T,this}get _root(){return this._nodes[0]}get _currNode(){const T=this._nodes;return T[T.length-1]}set _currNode(T){const I=this._nodes;I[I.length-1]=T}}t.CodeGen=D;function G(A,T){for(const I in T)A[I]=(A[I]||0)+(T[I]||0);return A}function B(A,T){return T instanceof e._CodeOrName?G(A,T.names):A}function K(A,T,I){if(A instanceof e.Name)return x(A);if(!W(A))return A;return new e._Code(A._items.reduce((Z,se)=>(se instanceof e.Name&&(se=x(se)),se instanceof e._Code?Z.push(...se._items):Z.push(se),Z),[]));function x(Z){const se=I[Z.str];return se===void 0||T[Z.str]!==1?Z:(delete T[Z.str],se)}function W(Z){return Z instanceof e._Code&&Z._items.some(se=>se instanceof e.Name&&T[se.str]===1&&I[se.str]!==void 0)}}function oe(A,T){for(const I in T)A[I]=(A[I]||0)-(T[I]||0)}function Se(A){return typeof A=="boolean"||typeof A=="number"||A===null?!A:(0,e._)`!${O(A)}`}t.not=Se;const be=$(t.operators.AND);function ee(...A){return A.reduce(be)}t.and=ee;const ge=$(t.operators.OR);function V(...A){return A.reduce(ge)}t.or=V;function $(A){return(T,I)=>T===e.nil?I:I===e.nil?T:(0,e._)`${O(T)} ${A} ${O(I)}`}function O(A){return A instanceof e.Name?A:(0,e._)`(${A})`}})(al)),al}var _e={},xh;function Ie(){if(xh)return _e;xh=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.checkStrictMode=_e.getErrorPath=_e.Type=_e.useFunc=_e.setEvaluated=_e.evaluatedPropsToName=_e.mergeEvaluated=_e.eachItem=_e.unescapeJsonPointer=_e.escapeJsonPointer=_e.escapeFragment=_e.unescapeFragment=_e.schemaRefOrVal=_e.schemaHasRulesButRef=_e.schemaHasRules=_e.checkUnknownRules=_e.alwaysValidSchema=_e.toHash=void 0;const t=we(),e=Bi();function n(y){const C={};for(const k of y)C[k]=!0;return C}_e.toHash=n;function r(y,C){return typeof C=="boolean"?C:Object.keys(C).length===0?!0:(o(y,C),!s(C,y.self.RULES.all))}_e.alwaysValidSchema=r;function o(y,C=y.schema){const{opts:k,self:P}=y;if(!k.strictSchema||typeof C=="boolean")return;const M=P.RULES.keywords;for(const q in C)M[q]||b(y,`unknown keyword: "${q}"`)}_e.checkUnknownRules=o;function s(y,C){if(typeof y=="boolean")return!y;for(const k in y)if(C[k])return!0;return!1}_e.schemaHasRules=s;function i(y,C){if(typeof y=="boolean")return!y;for(const k in y)if(k!=="$ref"&&C.all[k])return!0;return!1}_e.schemaHasRulesButRef=i;function a({topSchemaRef:y,schemaPath:C},k,P,M){if(!M){if(typeof k=="number"||typeof k=="boolean")return k;if(typeof k=="string")return(0,t._)`${k}`}return(0,t._)`${y}${C}${(0,t.getProperty)(P)}`}_e.schemaRefOrVal=a;function l(y){return h(decodeURIComponent(y))}_e.unescapeFragment=l;function c(y){return encodeURIComponent(u(y))}_e.escapeFragment=c;function u(y){return typeof y=="number"?`${y}`:y.replace(/~/g,"~0").replace(/\//g,"~1")}_e.escapeJsonPointer=u;function h(y){return y.replace(/~1/g,"/").replace(/~0/g,"~")}_e.unescapeJsonPointer=h;function p(y,C){if(Array.isArray(y))for(const k of y)C(k);else C(y)}_e.eachItem=p;function m({mergeNames:y,mergeToName:C,mergeValues:k,resultToName:P}){return(M,q,D,G)=>{const B=D===void 0?q:D instanceof t.Name?(q instanceof t.Name?y(M,q,D):C(M,q,D),D):q instanceof t.Name?(C(M,D,q),q):k(q,D);return G===t.Name&&!(B instanceof t.Name)?P(M,B):B}}_e.mergeEvaluated={props:m({mergeNames:(y,C,k)=>y.if((0,t._)`${k} !== true && ${C} !== undefined`,()=>{y.if((0,t._)`${C} === true`,()=>y.assign(k,!0),()=>y.assign(k,(0,t._)`${k} || {}`).code((0,t._)`Object.assign(${k}, ${C})`))}),mergeToName:(y,C,k)=>y.if((0,t._)`${k} !== true`,()=>{C===!0?y.assign(k,!0):(y.assign(k,(0,t._)`${k} || {}`),E(y,k,C))}),mergeValues:(y,C)=>y===!0?!0:{...y,...C},resultToName:w}),items:m({mergeNames:(y,C,k)=>y.if((0,t._)`${k} !== true && ${C} !== undefined`,()=>y.assign(k,(0,t._)`${C} === true ? true : ${k} > ${C} ? ${k} : ${C}`)),mergeToName:(y,C,k)=>y.if((0,t._)`${k} !== true`,()=>y.assign(k,C===!0?!0:(0,t._)`${k} > ${C} ? ${k} : ${C}`)),mergeValues:(y,C)=>y===!0?!0:Math.max(y,C),resultToName:(y,C)=>y.var("items",C)})};function w(y,C){if(C===!0)return y.var("props",!0);const k=y.var("props",(0,t._)`{}`);return C!==void 0&&E(y,k,C),k}_e.evaluatedPropsToName=w;function E(y,C,k){Object.keys(k).forEach(P=>y.assign((0,t._)`${C}${(0,t.getProperty)(P)}`,!0))}_e.setEvaluated=E;const _={};function v(y,C){return y.scopeValue("func",{ref:C,code:_[C.code]||(_[C.code]=new e._Code(C.code))})}_e.useFunc=v;var g;(function(y){y[y.Num=0]="Num",y[y.Str=1]="Str"})(g||(_e.Type=g={}));function S(y,C,k){if(y instanceof t.Name){const P=C===g.Num;return k?P?(0,t._)`"[" + ${y} + "]"`:(0,t._)`"['" + ${y} + "']"`:P?(0,t._)`"/" + ${y}`:(0,t._)`"/" + ${y}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return k?(0,t.getProperty)(y).toString():"/"+u(y)}_e.getErrorPath=S;function b(y,C,k=y.opts.strictSchema){if(k){if(C=`strict mode: ${C}`,k===!0)throw new Error(C);y.self.logger.warn(C)}}return _e.checkStrictMode=b,_e}var Vo={},Dh;function Rn(){if(Dh)return Vo;Dh=1,Object.defineProperty(Vo,"__esModule",{value:!0});const t=we(),e={data:new t.Name("data"),valCxt:new t.Name("valCxt"),instancePath:new t.Name("instancePath"),parentData:new t.Name("parentData"),parentDataProperty:new t.Name("parentDataProperty"),rootData:new t.Name("rootData"),dynamicAnchors:new t.Name("dynamicAnchors"),vErrors:new t.Name("vErrors"),errors:new t.Name("errors"),this:new t.Name("this"),self:new t.Name("self"),scope:new t.Name("scope"),json:new t.Name("json"),jsonPos:new t.Name("jsonPos"),jsonLen:new t.Name("jsonLen"),jsonPart:new t.Name("jsonPart")};return Vo.default=e,Vo}var Oh;function $a(){return Oh||(Oh=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const e=we(),n=Ie(),r=Rn();t.keywordError={message:({keyword:_})=>(0,e.str)`must pass "${_}" keyword validation`},t.keyword$DataError={message:({keyword:_,schemaType:v})=>v?(0,e.str)`"${_}" keyword must be ${v} ($data)`:(0,e.str)`"${_}" keyword is invalid ($data)`};function o(_,v=t.keywordError,g,S){const{it:b}=_,{gen:y,compositeRule:C,allErrors:k}=b,P=h(_,v,g);S??(C||k)?l(y,P):c(b,(0,e._)`[${P}]`)}t.reportError=o;function s(_,v=t.keywordError,g){const{it:S}=_,{gen:b,compositeRule:y,allErrors:C}=S,k=h(_,v,g);l(b,k),y||C||c(S,r.default.vErrors)}t.reportExtraError=s;function i(_,v){_.assign(r.default.errors,v),_.if((0,e._)`${r.default.vErrors} !== null`,()=>_.if(v,()=>_.assign((0,e._)`${r.default.vErrors}.length`,v),()=>_.assign(r.default.vErrors,null)))}t.resetErrorsCount=i;function a({gen:_,keyword:v,schemaValue:g,data:S,errsCount:b,it:y}){if(b===void 0)throw new Error("ajv implementation error");const C=_.name("err");_.forRange("i",b,r.default.errors,k=>{_.const(C,(0,e._)`${r.default.vErrors}[${k}]`),_.if((0,e._)`${C}.instancePath === undefined`,()=>_.assign((0,e._)`${C}.instancePath`,(0,e.strConcat)(r.default.instancePath,y.errorPath))),_.assign((0,e._)`${C}.schemaPath`,(0,e.str)`${y.errSchemaPath}/${v}`),y.opts.verbose&&(_.assign((0,e._)`${C}.schema`,g),_.assign((0,e._)`${C}.data`,S))})}t.extendErrors=a;function l(_,v){const g=_.const("err",v);_.if((0,e._)`${r.default.vErrors} === null`,()=>_.assign(r.default.vErrors,(0,e._)`[${g}]`),(0,e._)`${r.default.vErrors}.push(${g})`),_.code((0,e._)`${r.default.errors}++`)}function c(_,v){const{gen:g,validateName:S,schemaEnv:b}=_;b.$async?g.throw((0,e._)`new ${_.ValidationError}(${v})`):(g.assign((0,e._)`${S}.errors`,v),g.return(!1))}const u={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function h(_,v,g){const{createErrors:S}=_.it;return S===!1?(0,e._)`{}`:p(_,v,g)}function p(_,v,g={}){const{gen:S,it:b}=_,y=[m(b,g),w(_,g)];return E(_,v,y),S.object(...y)}function m({errorPath:_},{instancePath:v}){const g=v?(0,e.str)`${_}${(0,n.getErrorPath)(v,n.Type.Str)}`:_;return[r.default.instancePath,(0,e.strConcat)(r.default.instancePath,g)]}function w({keyword:_,it:{errSchemaPath:v}},{schemaPath:g,parentSchema:S}){let b=S?v:(0,e.str)`${v}/${_}`;return g&&(b=(0,e.str)`${b}${(0,n.getErrorPath)(g,n.Type.Str)}`),[u.schemaPath,b]}function E(_,{params:v,message:g},S){const{keyword:b,data:y,schemaValue:C,it:k}=_,{opts:P,propertyName:M,topSchemaRef:q,schemaPath:D}=k;S.push([u.keyword,b],[u.params,typeof v=="function"?v(_):v||(0,e._)`{}`]),P.messages&&S.push([u.message,typeof g=="function"?g(_):g]),P.verbose&&S.push([u.schema,C],[u.parentSchema,(0,e._)`${q}${D}`],[r.default.data,y]),M&&S.push([u.propertyName,M])}})(il)),il}var Uh;function J1(){if(Uh)return xn;Uh=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.boolOrEmptySchema=xn.topBoolOrEmptySchema=void 0;const t=$a(),e=we(),n=Rn(),r={message:"boolean schema is false"};function o(a){const{gen:l,schema:c,validateName:u}=a;c===!1?i(a,!1):typeof c=="object"&&c.$async===!0?l.return(n.default.data):(l.assign((0,e._)`${u}.errors`,null),l.return(!0))}xn.topBoolOrEmptySchema=o;function s(a,l){const{gen:c,schema:u}=a;u===!1?(c.var(l,!1),i(a)):c.var(l,!0)}xn.boolOrEmptySchema=s;function i(a,l){const{gen:c,data:u}=a,h={gen:c,keyword:"false schema",data:u,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:a};(0,t.reportError)(h,r,void 0,l)}return xn}var ot={},Dn={},Lh;function yv(){if(Lh)return Dn;Lh=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.getRules=Dn.isJSONType=void 0;const t=["string","number","integer","boolean","null","object","array"],e=new Set(t);function n(o){return typeof o=="string"&&e.has(o)}Dn.isJSONType=n;function r(){const o={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...o,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},o.number,o.string,o.array,o.object],post:{rules:[]},all:{},keywords:{}}}return Dn.getRules=r,Dn}var nn={},qh;function vv(){if(qh)return nn;qh=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.shouldUseRule=nn.shouldUseGroup=nn.schemaHasRulesForType=void 0;function t({schema:r,self:o},s){const i=o.RULES.types[s];return i&&i!==!0&&e(r,i)}nn.schemaHasRulesForType=t;function e(r,o){return o.rules.some(s=>n(r,s))}nn.shouldUseGroup=e;function n(r,o){var s;return r[o.keyword]!==void 0||((s=o.definition.implements)===null||s===void 0?void 0:s.some(i=>r[i]!==void 0))}return nn.shouldUseRule=n,nn}var Fh;function Ji(){if(Fh)return ot;Fh=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.reportTypeError=ot.checkDataTypes=ot.checkDataType=ot.coerceAndCheckDataType=ot.getJSONTypes=ot.getSchemaTypes=ot.DataType=void 0;const t=yv(),e=vv(),n=$a(),r=we(),o=Ie();var s;(function(g){g[g.Correct=0]="Correct",g[g.Wrong=1]="Wrong"})(s||(ot.DataType=s={}));function i(g){const S=a(g.type);if(S.includes("null")){if(g.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!S.length&&g.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');g.nullable===!0&&S.push("null")}return S}ot.getSchemaTypes=i;function a(g){const S=Array.isArray(g)?g:g?[g]:[];if(S.every(t.isJSONType))return S;throw new Error("type must be JSONType or JSONType[]: "+S.join(","))}ot.getJSONTypes=a;function l(g,S){const{gen:b,data:y,opts:C}=g,k=u(S,C.coerceTypes),P=S.length>0&&!(k.length===0&&S.length===1&&(0,e.schemaHasRulesForType)(g,S[0]));if(P){const M=w(S,y,C.strictNumbers,s.Wrong);b.if(M,()=>{k.length?h(g,S,k):_(g)})}return P}ot.coerceAndCheckDataType=l;const c=new Set(["string","number","integer","boolean","null"]);function u(g,S){return S?g.filter(b=>c.has(b)||S==="array"&&b==="array"):[]}function h(g,S,b){const{gen:y,data:C,opts:k}=g,P=y.let("dataType",(0,r._)`typeof ${C}`),M=y.let("coerced",(0,r._)`undefined`);k.coerceTypes==="array"&&y.if((0,r._)`${P} == 'object' && Array.isArray(${C}) && ${C}.length == 1`,()=>y.assign(C,(0,r._)`${C}[0]`).assign(P,(0,r._)`typeof ${C}`).if(w(S,C,k.strictNumbers),()=>y.assign(M,C))),y.if((0,r._)`${M} !== undefined`);for(const D of b)(c.has(D)||D==="array"&&k.coerceTypes==="array")&&q(D);y.else(),_(g),y.endIf(),y.if((0,r._)`${M} !== undefined`,()=>{y.assign(C,M),p(g,M)});function q(D){switch(D){case"string":y.elseIf((0,r._)`${P} == "number" || ${P} == "boolean"`).assign(M,(0,r._)`"" + ${C}`).elseIf((0,r._)`${C} === null`).assign(M,(0,r._)`""`);return;case"number":y.elseIf((0,r._)`${P} == "boolean" || ${C} === null
              || (${P} == "string" && ${C} && ${C} == +${C})`).assign(M,(0,r._)`+${C}`);return;case"integer":y.elseIf((0,r._)`${P} === "boolean" || ${C} === null
              || (${P} === "string" && ${C} && ${C} == +${C} && !(${C} % 1))`).assign(M,(0,r._)`+${C}`);return;case"boolean":y.elseIf((0,r._)`${C} === "false" || ${C} === 0 || ${C} === null`).assign(M,!1).elseIf((0,r._)`${C} === "true" || ${C} === 1`).assign(M,!0);return;case"null":y.elseIf((0,r._)`${C} === "" || ${C} === 0 || ${C} === false`),y.assign(M,null);return;case"array":y.elseIf((0,r._)`${P} === "string" || ${P} === "number"
              || ${P} === "boolean" || ${C} === null`).assign(M,(0,r._)`[${C}]`)}}}function p({gen:g,parentData:S,parentDataProperty:b},y){g.if((0,r._)`${S} !== undefined`,()=>g.assign((0,r._)`${S}[${b}]`,y))}function m(g,S,b,y=s.Correct){const C=y===s.Correct?r.operators.EQ:r.operators.NEQ;let k;switch(g){case"null":return(0,r._)`${S} ${C} null`;case"array":k=(0,r._)`Array.isArray(${S})`;break;case"object":k=(0,r._)`${S} && typeof ${S} == "object" && !Array.isArray(${S})`;break;case"integer":k=P((0,r._)`!(${S} % 1) && !isNaN(${S})`);break;case"number":k=P();break;default:return(0,r._)`typeof ${S} ${C} ${g}`}return y===s.Correct?k:(0,r.not)(k);function P(M=r.nil){return(0,r.and)((0,r._)`typeof ${S} == "number"`,M,b?(0,r._)`isFinite(${S})`:r.nil)}}ot.checkDataType=m;function w(g,S,b,y){if(g.length===1)return m(g[0],S,b,y);let C;const k=(0,o.toHash)(g);if(k.array&&k.object){const P=(0,r._)`typeof ${S} != "object"`;C=k.null?P:(0,r._)`!${S} || ${P}`,delete k.null,delete k.array,delete k.object}else C=r.nil;k.number&&delete k.integer;for(const P in k)C=(0,r.and)(C,m(P,S,b,y));return C}ot.checkDataTypes=w;const E={message:({schema:g})=>`must be ${g}`,params:({schema:g,schemaValue:S})=>typeof g=="string"?(0,r._)`{type: ${g}}`:(0,r._)`{type: ${S}}`};function _(g){const S=v(g);(0,n.reportError)(S,E)}ot.reportTypeError=_;function v(g){const{gen:S,data:b,schema:y}=g,C=(0,o.schemaRefOrVal)(g,y,"type");return{gen:S,keyword:"type",data:b,schema:y.type,schemaCode:C,schemaValue:C,parentSchema:y,params:{},it:g}}return ot}var qr={},Vh;function K1(){if(Vh)return qr;Vh=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.assignDefaults=void 0;const t=we(),e=Ie();function n(o,s){const{properties:i,items:a}=o.schema;if(s==="object"&&i)for(const l in i)r(o,l,i[l].default);else s==="array"&&Array.isArray(a)&&a.forEach((l,c)=>r(o,c,l.default))}qr.assignDefaults=n;function r(o,s,i){const{gen:a,compositeRule:l,data:c,opts:u}=o;if(i===void 0)return;const h=(0,t._)`${c}${(0,t.getProperty)(s)}`;if(l){(0,e.checkStrictMode)(o,`default is ignored for: ${h}`);return}let p=(0,t._)`${h} === undefined`;u.useDefaults==="empty"&&(p=(0,t._)`${p} || ${h} === null || ${h} === ""`),a.if(p,(0,t._)`${h} = ${(0,t.stringify)(i)}`)}return qr}var Ft={},De={},zh;function Zt(){if(zh)return De;zh=1,Object.defineProperty(De,"__esModule",{value:!0}),De.validateUnion=De.validateArray=De.usePattern=De.callValidateCode=De.schemaProperties=De.allSchemaProperties=De.noPropertyInData=De.propertyInData=De.isOwnProperty=De.hasPropFunc=De.reportMissingProp=De.checkMissingProp=De.checkReportMissingProp=void 0;const t=we(),e=Ie(),n=Rn(),r=Ie();function o(g,S){const{gen:b,data:y,it:C}=g;b.if(u(b,y,S,C.opts.ownProperties),()=>{g.setParams({missingProperty:(0,t._)`${S}`},!0),g.error()})}De.checkReportMissingProp=o;function s({gen:g,data:S,it:{opts:b}},y,C){return(0,t.or)(...y.map(k=>(0,t.and)(u(g,S,k,b.ownProperties),(0,t._)`${C} = ${k}`)))}De.checkMissingProp=s;function i(g,S){g.setParams({missingProperty:S},!0),g.error()}De.reportMissingProp=i;function a(g){return g.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,t._)`Object.prototype.hasOwnProperty`})}De.hasPropFunc=a;function l(g,S,b){return(0,t._)`${a(g)}.call(${S}, ${b})`}De.isOwnProperty=l;function c(g,S,b,y){const C=(0,t._)`${S}${(0,t.getProperty)(b)} !== undefined`;return y?(0,t._)`${C} && ${l(g,S,b)}`:C}De.propertyInData=c;function u(g,S,b,y){const C=(0,t._)`${S}${(0,t.getProperty)(b)} === undefined`;return y?(0,t.or)(C,(0,t.not)(l(g,S,b))):C}De.noPropertyInData=u;function h(g){return g?Object.keys(g).filter(S=>S!=="__proto__"):[]}De.allSchemaProperties=h;function p(g,S){return h(S).filter(b=>!(0,e.alwaysValidSchema)(g,S[b]))}De.schemaProperties=p;function m({schemaCode:g,data:S,it:{gen:b,topSchemaRef:y,schemaPath:C,errorPath:k},it:P},M,q,D){const G=D?(0,t._)`${g}, ${S}, ${y}${C}`:S,B=[[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,k)],[n.default.parentData,P.parentData],[n.default.parentDataProperty,P.parentDataProperty],[n.default.rootData,n.default.rootData]];P.opts.dynamicRef&&B.push([n.default.dynamicAnchors,n.default.dynamicAnchors]);const K=(0,t._)`${G}, ${b.object(...B)}`;return q!==t.nil?(0,t._)`${M}.call(${q}, ${K})`:(0,t._)`${M}(${K})`}De.callValidateCode=m;const w=(0,t._)`new RegExp`;function E({gen:g,it:{opts:S}},b){const y=S.unicodeRegExp?"u":"",{regExp:C}=S.code,k=C(b,y);return g.scopeValue("pattern",{key:k.toString(),ref:k,code:(0,t._)`${C.code==="new RegExp"?w:(0,r.useFunc)(g,C)}(${b}, ${y})`})}De.usePattern=E;function _(g){const{gen:S,data:b,keyword:y,it:C}=g,k=S.name("valid");if(C.allErrors){const M=S.let("valid",!0);return P(()=>S.assign(M,!1)),M}return S.var(k,!0),P(()=>S.break()),k;function P(M){const q=S.const("len",(0,t._)`${b}.length`);S.forRange("i",0,q,D=>{g.subschema({keyword:y,dataProp:D,dataPropType:e.Type.Num},k),S.if((0,t.not)(k),M)})}}De.validateArray=_;function v(g){const{gen:S,schema:b,keyword:y,it:C}=g;if(!Array.isArray(b))throw new Error("ajv implementation error");if(b.some(q=>(0,e.alwaysValidSchema)(C,q))&&!C.opts.unevaluated)return;const P=S.let("valid",!1),M=S.name("_valid");S.block(()=>b.forEach((q,D)=>{const G=g.subschema({keyword:y,schemaProp:D,compositeRule:!0},M);S.assign(P,(0,t._)`${P} || ${M}`),g.mergeValidEvaluated(G,M)||S.if((0,t.not)(P))})),g.result(P,()=>g.reset(),()=>g.error(!0))}return De.validateUnion=v,De}var Hh;function W1(){if(Hh)return Ft;Hh=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.validateKeywordUsage=Ft.validSchemaType=Ft.funcKeywordCode=Ft.macroKeywordCode=void 0;const t=we(),e=Rn(),n=Zt(),r=$a();function o(p,m){const{gen:w,keyword:E,schema:_,parentSchema:v,it:g}=p,S=m.macro.call(g.self,_,v,g),b=c(w,E,S);g.opts.validateSchema!==!1&&g.self.validateSchema(S,!0);const y=w.name("valid");p.subschema({schema:S,schemaPath:t.nil,errSchemaPath:`${g.errSchemaPath}/${E}`,topSchemaRef:b,compositeRule:!0},y),p.pass(y,()=>p.error(!0))}Ft.macroKeywordCode=o;function s(p,m){var w;const{gen:E,keyword:_,schema:v,parentSchema:g,$data:S,it:b}=p;l(b,m);const y=!S&&m.compile?m.compile.call(b.self,v,g,b):m.validate,C=c(E,_,y),k=E.let("valid");p.block$data(k,P),p.ok((w=m.valid)!==null&&w!==void 0?w:k);function P(){if(m.errors===!1)D(),m.modifying&&i(p),G(()=>p.error());else{const B=m.async?M():q();m.modifying&&i(p),G(()=>a(p,B))}}function M(){const B=E.let("ruleErrs",null);return E.try(()=>D((0,t._)`await `),K=>E.assign(k,!1).if((0,t._)`${K} instanceof ${b.ValidationError}`,()=>E.assign(B,(0,t._)`${K}.errors`),()=>E.throw(K))),B}function q(){const B=(0,t._)`${C}.errors`;return E.assign(B,null),D(t.nil),B}function D(B=m.async?(0,t._)`await `:t.nil){const K=b.opts.passContext?e.default.this:e.default.self,oe=!("compile"in m&&!S||m.schema===!1);E.assign(k,(0,t._)`${B}${(0,n.callValidateCode)(p,C,K,oe)}`,m.modifying)}function G(B){var K;E.if((0,t.not)((K=m.valid)!==null&&K!==void 0?K:k),B)}}Ft.funcKeywordCode=s;function i(p){const{gen:m,data:w,it:E}=p;m.if(E.parentData,()=>m.assign(w,(0,t._)`${E.parentData}[${E.parentDataProperty}]`))}function a(p,m){const{gen:w}=p;w.if((0,t._)`Array.isArray(${m})`,()=>{w.assign(e.default.vErrors,(0,t._)`${e.default.vErrors} === null ? ${m} : ${e.default.vErrors}.concat(${m})`).assign(e.default.errors,(0,t._)`${e.default.vErrors}.length`),(0,r.extendErrors)(p)},()=>p.error())}function l({schemaEnv:p},m){if(m.async&&!p.$async)throw new Error("async keyword in sync schema")}function c(p,m,w){if(w===void 0)throw new Error(`keyword "${m}" failed to compile`);return p.scopeValue("keyword",typeof w=="function"?{ref:w}:{ref:w,code:(0,t.stringify)(w)})}function u(p,m,w=!1){return!m.length||m.some(E=>E==="array"?Array.isArray(p):E==="object"?p&&typeof p=="object"&&!Array.isArray(p):typeof p==E||w&&typeof p>"u")}Ft.validSchemaType=u;function h({schema:p,opts:m,self:w,errSchemaPath:E},_,v){if(Array.isArray(_.keyword)?!_.keyword.includes(v):_.keyword!==v)throw new Error("ajv implementation error");const g=_.dependencies;if(g?.some(S=>!Object.prototype.hasOwnProperty.call(p,S)))throw new Error(`parent schema must have dependencies of ${v}: ${g.join(",")}`);if(_.validateSchema&&!_.validateSchema(p[v])){const b=`keyword "${v}" value is invalid at path "${E}": `+w.errorsText(_.validateSchema.errors);if(m.validateSchema==="log")w.logger.error(b);else throw new Error(b)}}return Ft.validateKeywordUsage=h,Ft}var rn={},Gh;function Z1(){if(Gh)return rn;Gh=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.extendSubschemaMode=rn.extendSubschemaData=rn.getSubschema=void 0;const t=we(),e=Ie();function n(s,{keyword:i,schemaProp:a,schema:l,schemaPath:c,errSchemaPath:u,topSchemaRef:h}){if(i!==void 0&&l!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(i!==void 0){const p=s.schema[i];return a===void 0?{schema:p,schemaPath:(0,t._)`${s.schemaPath}${(0,t.getProperty)(i)}`,errSchemaPath:`${s.errSchemaPath}/${i}`}:{schema:p[a],schemaPath:(0,t._)`${s.schemaPath}${(0,t.getProperty)(i)}${(0,t.getProperty)(a)}`,errSchemaPath:`${s.errSchemaPath}/${i}/${(0,e.escapeFragment)(a)}`}}if(l!==void 0){if(c===void 0||u===void 0||h===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:l,schemaPath:c,topSchemaRef:h,errSchemaPath:u}}throw new Error('either "keyword" or "schema" must be passed')}rn.getSubschema=n;function r(s,i,{dataProp:a,dataPropType:l,data:c,dataTypes:u,propertyName:h}){if(c!==void 0&&a!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:p}=i;if(a!==void 0){const{errorPath:w,dataPathArr:E,opts:_}=i,v=p.let("data",(0,t._)`${i.data}${(0,t.getProperty)(a)}`,!0);m(v),s.errorPath=(0,t.str)`${w}${(0,e.getErrorPath)(a,l,_.jsPropertySyntax)}`,s.parentDataProperty=(0,t._)`${a}`,s.dataPathArr=[...E,s.parentDataProperty]}if(c!==void 0){const w=c instanceof t.Name?c:p.let("data",c,!0);m(w),h!==void 0&&(s.propertyName=h)}u&&(s.dataTypes=u);function m(w){s.data=w,s.dataLevel=i.dataLevel+1,s.dataTypes=[],i.definedProperties=new Set,s.parentData=i.data,s.dataNames=[...i.dataNames,w]}}rn.extendSubschemaData=r;function o(s,{jtdDiscriminator:i,jtdMetadata:a,compositeRule:l,createErrors:c,allErrors:u}){l!==void 0&&(s.compositeRule=l),c!==void 0&&(s.createErrors=c),u!==void 0&&(s.allErrors=u),s.jtdDiscriminator=i,s.jtdMetadata=a}return rn.extendSubschemaMode=o,rn}var mt={},ul,Bh;function Aa(){return Bh||(Bh=1,ul=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,o,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(o=r;o--!==0;)if(!t(e[o],n[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(o=r;o--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[o]))return!1;for(o=r;o--!==0;){var i=s[o];if(!t(e[i],n[i]))return!1}return!0}return e!==e&&n!==n}),ul}var dl={exports:{}},Jh;function Y1(){if(Jh)return dl.exports;Jh=1;var t=dl.exports=function(r,o,s){typeof o=="function"&&(s=o,o={}),s=o.cb||s;var i=typeof s=="function"?s:s.pre||function(){},a=s.post||function(){};e(o,i,a,r,"",r)};t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function e(r,o,s,i,a,l,c,u,h,p){if(i&&typeof i=="object"&&!Array.isArray(i)){o(i,a,l,c,u,h,p);for(var m in i){var w=i[m];if(Array.isArray(w)){if(m in t.arrayKeywords)for(var E=0;E<w.length;E++)e(r,o,s,w[E],a+"/"+m+"/"+E,l,a,m,i,E)}else if(m in t.propsKeywords){if(w&&typeof w=="object")for(var _ in w)e(r,o,s,w[_],a+"/"+m+"/"+n(_),l,a,m,i,_)}else(m in t.keywords||r.allKeys&&!(m in t.skipKeywords))&&e(r,o,s,w,a+"/"+m,l,a,m,i)}s(i,a,l,c,u,h,p)}}function n(r){return r.replace(/~/g,"~0").replace(/\//g,"~1")}return dl.exports}var Kh;function Pa(){if(Kh)return mt;Kh=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.getSchemaRefs=mt.resolveUrl=mt.normalizeId=mt._getFullPath=mt.getFullPath=mt.inlineRef=void 0;const t=Ie(),e=Aa(),n=Y1(),r=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function o(E,_=!0){return typeof E=="boolean"?!0:_===!0?!i(E):_?a(E)<=_:!1}mt.inlineRef=o;const s=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function i(E){for(const _ in E){if(s.has(_))return!0;const v=E[_];if(Array.isArray(v)&&v.some(i)||typeof v=="object"&&i(v))return!0}return!1}function a(E){let _=0;for(const v in E){if(v==="$ref")return 1/0;if(_++,!r.has(v)&&(typeof E[v]=="object"&&(0,t.eachItem)(E[v],g=>_+=a(g)),_===1/0))return 1/0}return _}function l(E,_="",v){v!==!1&&(_=h(_));const g=E.parse(_);return c(E,g)}mt.getFullPath=l;function c(E,_){return E.serialize(_).split("#")[0]+"#"}mt._getFullPath=c;const u=/#\/?$/;function h(E){return E?E.replace(u,""):""}mt.normalizeId=h;function p(E,_,v){return v=h(v),E.resolve(_,v)}mt.resolveUrl=p;const m=/^[a-z_][-a-z0-9._]*$/i;function w(E,_){if(typeof E=="boolean")return{};const{schemaId:v,uriResolver:g}=this.opts,S=h(E[v]||_),b={"":S},y=l(g,S,!1),C={},k=new Set;return n(E,{allKeys:!0},(q,D,G,B)=>{if(B===void 0)return;const K=y+D;let oe=b[B];typeof q[v]=="string"&&(oe=Se.call(this,q[v])),be.call(this,q.$anchor),be.call(this,q.$dynamicAnchor),b[D]=oe;function Se(ee){const ge=this.opts.uriResolver.resolve;if(ee=h(oe?ge(oe,ee):ee),k.has(ee))throw M(ee);k.add(ee);let V=this.refs[ee];return typeof V=="string"&&(V=this.refs[V]),typeof V=="object"?P(q,V.schema,ee):ee!==h(K)&&(ee[0]==="#"?(P(q,C[ee],ee),C[ee]=q):this.refs[ee]=K),ee}function be(ee){if(typeof ee=="string"){if(!m.test(ee))throw new Error(`invalid anchor "${ee}"`);Se.call(this,`#${ee}`)}}}),C;function P(q,D,G){if(D!==void 0&&!e(q,D))throw M(G)}function M(q){return new Error(`reference "${q}" resolves to more than one schema`)}}return mt.getSchemaRefs=w,mt}var Wh;function Na(){if(Wh)return tn;Wh=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.getData=tn.KeywordCxt=tn.validateFunctionCode=void 0;const t=J1(),e=Ji(),n=vv(),r=Ji(),o=K1(),s=W1(),i=Z1(),a=we(),l=Rn(),c=Pa(),u=Ie(),h=$a();function p(R){if(y(R)&&(k(R),b(R))){_(R);return}m(R,()=>(0,t.topBoolOrEmptySchema)(R))}tn.validateFunctionCode=p;function m({gen:R,validateName:N,schema:L,schemaEnv:z,opts:Y},Q){Y.code.es5?R.func(N,(0,a._)`${l.default.data}, ${l.default.valCxt}`,z.$async,()=>{R.code((0,a._)`"use strict"; ${g(L,Y)}`),E(R,Y),R.code(Q)}):R.func(N,(0,a._)`${l.default.data}, ${w(Y)}`,z.$async,()=>R.code(g(L,Y)).code(Q))}function w(R){return(0,a._)`{${l.default.instancePath}="", ${l.default.parentData}, ${l.default.parentDataProperty}, ${l.default.rootData}=${l.default.data}${R.dynamicRef?(0,a._)`, ${l.default.dynamicAnchors}={}`:a.nil}}={}`}function E(R,N){R.if(l.default.valCxt,()=>{R.var(l.default.instancePath,(0,a._)`${l.default.valCxt}.${l.default.instancePath}`),R.var(l.default.parentData,(0,a._)`${l.default.valCxt}.${l.default.parentData}`),R.var(l.default.parentDataProperty,(0,a._)`${l.default.valCxt}.${l.default.parentDataProperty}`),R.var(l.default.rootData,(0,a._)`${l.default.valCxt}.${l.default.rootData}`),N.dynamicRef&&R.var(l.default.dynamicAnchors,(0,a._)`${l.default.valCxt}.${l.default.dynamicAnchors}`)},()=>{R.var(l.default.instancePath,(0,a._)`""`),R.var(l.default.parentData,(0,a._)`undefined`),R.var(l.default.parentDataProperty,(0,a._)`undefined`),R.var(l.default.rootData,l.default.data),N.dynamicRef&&R.var(l.default.dynamicAnchors,(0,a._)`{}`)})}function _(R){const{schema:N,opts:L,gen:z}=R;m(R,()=>{L.$comment&&N.$comment&&B(R),q(R),z.let(l.default.vErrors,null),z.let(l.default.errors,0),L.unevaluated&&v(R),P(R),K(R)})}function v(R){const{gen:N,validateName:L}=R;R.evaluated=N.const("evaluated",(0,a._)`${L}.evaluated`),N.if((0,a._)`${R.evaluated}.dynamicProps`,()=>N.assign((0,a._)`${R.evaluated}.props`,(0,a._)`undefined`)),N.if((0,a._)`${R.evaluated}.dynamicItems`,()=>N.assign((0,a._)`${R.evaluated}.items`,(0,a._)`undefined`))}function g(R,N){const L=typeof R=="object"&&R[N.schemaId];return L&&(N.code.source||N.code.process)?(0,a._)`/*# sourceURL=${L} */`:a.nil}function S(R,N){if(y(R)&&(k(R),b(R))){C(R,N);return}(0,t.boolOrEmptySchema)(R,N)}function b({schema:R,self:N}){if(typeof R=="boolean")return!R;for(const L in R)if(N.RULES.all[L])return!0;return!1}function y(R){return typeof R.schema!="boolean"}function C(R,N){const{schema:L,gen:z,opts:Y}=R;Y.$comment&&L.$comment&&B(R),D(R),G(R);const Q=z.const("_errs",l.default.errors);P(R,Q),z.var(N,(0,a._)`${Q} === ${l.default.errors}`)}function k(R){(0,u.checkUnknownRules)(R),M(R)}function P(R,N){if(R.opts.jtd)return Se(R,[],!1,N);const L=(0,e.getSchemaTypes)(R.schema),z=(0,e.coerceAndCheckDataType)(R,L);Se(R,L,!z,N)}function M(R){const{schema:N,errSchemaPath:L,opts:z,self:Y}=R;N.$ref&&z.ignoreKeywordsWithRef&&(0,u.schemaHasRulesButRef)(N,Y.RULES)&&Y.logger.warn(`$ref: keywords ignored in schema at path "${L}"`)}function q(R){const{schema:N,opts:L}=R;N.default!==void 0&&L.useDefaults&&L.strictSchema&&(0,u.checkStrictMode)(R,"default is ignored in the schema root")}function D(R){const N=R.schema[R.opts.schemaId];N&&(R.baseId=(0,c.resolveUrl)(R.opts.uriResolver,R.baseId,N))}function G(R){if(R.schema.$async&&!R.schemaEnv.$async)throw new Error("async schema in sync schema")}function B({gen:R,schemaEnv:N,schema:L,errSchemaPath:z,opts:Y}){const Q=L.$comment;if(Y.$comment===!0)R.code((0,a._)`${l.default.self}.logger.log(${Q})`);else if(typeof Y.$comment=="function"){const Ee=(0,a.str)`${z}/$comment`,Ge=R.scopeValue("root",{ref:N.root});R.code((0,a._)`${l.default.self}.opts.$comment(${Q}, ${Ee}, ${Ge}.schema)`)}}function K(R){const{gen:N,schemaEnv:L,validateName:z,ValidationError:Y,opts:Q}=R;L.$async?N.if((0,a._)`${l.default.errors} === 0`,()=>N.return(l.default.data),()=>N.throw((0,a._)`new ${Y}(${l.default.vErrors})`)):(N.assign((0,a._)`${z}.errors`,l.default.vErrors),Q.unevaluated&&oe(R),N.return((0,a._)`${l.default.errors} === 0`))}function oe({gen:R,evaluated:N,props:L,items:z}){L instanceof a.Name&&R.assign((0,a._)`${N}.props`,L),z instanceof a.Name&&R.assign((0,a._)`${N}.items`,z)}function Se(R,N,L,z){const{gen:Y,schema:Q,data:Ee,allErrors:Ge,opts:Me,self:xe}=R,{RULES:Te}=xe;if(Q.$ref&&(Me.ignoreKeywordsWithRef||!(0,u.schemaHasRulesButRef)(Q,Te))){Y.block(()=>W(R,"$ref",Te.all.$ref.definition));return}Me.jtd||ee(R,N),Y.block(()=>{for(const Le of Te.rules)bt(Le);bt(Te.post)});function bt(Le){(0,n.shouldUseGroup)(Q,Le)&&(Le.type?(Y.if((0,r.checkDataType)(Le.type,Ee,Me.strictNumbers)),be(R,Le),N.length===1&&N[0]===Le.type&&L&&(Y.else(),(0,r.reportTypeError)(R)),Y.endIf()):be(R,Le),Ge||Y.if((0,a._)`${l.default.errors} === ${z||0}`))}}function be(R,N){const{gen:L,schema:z,opts:{useDefaults:Y}}=R;Y&&(0,o.assignDefaults)(R,N.type),L.block(()=>{for(const Q of N.rules)(0,n.shouldUseRule)(z,Q)&&W(R,Q.keyword,Q.definition,N.type)})}function ee(R,N){R.schemaEnv.meta||!R.opts.strictTypes||(ge(R,N),R.opts.allowUnionTypes||V(R,N),$(R,R.dataTypes))}function ge(R,N){if(N.length){if(!R.dataTypes.length){R.dataTypes=N;return}N.forEach(L=>{A(R.dataTypes,L)||I(R,`type "${L}" not allowed by context "${R.dataTypes.join(",")}"`)}),T(R,N)}}function V(R,N){N.length>1&&!(N.length===2&&N.includes("null"))&&I(R,"use allowUnionTypes to allow union type keyword")}function $(R,N){const L=R.self.RULES.all;for(const z in L){const Y=L[z];if(typeof Y=="object"&&(0,n.shouldUseRule)(R.schema,Y)){const{type:Q}=Y.definition;Q.length&&!Q.some(Ee=>O(N,Ee))&&I(R,`missing type "${Q.join(",")}" for keyword "${z}"`)}}}function O(R,N){return R.includes(N)||N==="number"&&R.includes("integer")}function A(R,N){return R.includes(N)||N==="integer"&&R.includes("number")}function T(R,N){const L=[];for(const z of R.dataTypes)A(N,z)?L.push(z):N.includes("integer")&&z==="number"&&L.push("integer");R.dataTypes=L}function I(R,N){const L=R.schemaEnv.baseId+R.errSchemaPath;N+=` at "${L}" (strictTypes)`,(0,u.checkStrictMode)(R,N,R.opts.strictTypes)}class x{constructor(N,L,z){if((0,s.validateKeywordUsage)(N,L,z),this.gen=N.gen,this.allErrors=N.allErrors,this.keyword=z,this.data=N.data,this.schema=N.schema[z],this.$data=L.$data&&N.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,u.schemaRefOrVal)(N,this.schema,z,this.$data),this.schemaType=L.schemaType,this.parentSchema=N.schema,this.params={},this.it=N,this.def=L,this.$data)this.schemaCode=N.gen.const("vSchema",re(this.$data,N));else if(this.schemaCode=this.schemaValue,!(0,s.validSchemaType)(this.schema,L.schemaType,L.allowUndefined))throw new Error(`${z} value must be ${JSON.stringify(L.schemaType)}`);("code"in L?L.trackErrors:L.errors!==!1)&&(this.errsCount=N.gen.const("_errs",l.default.errors))}result(N,L,z){this.failResult((0,a.not)(N),L,z)}failResult(N,L,z){this.gen.if(N),z?z():this.error(),L?(this.gen.else(),L(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(N,L){this.failResult((0,a.not)(N),void 0,L)}fail(N){if(N===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(N),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(N){if(!this.$data)return this.fail(N);const{schemaCode:L}=this;this.fail((0,a._)`${L} !== undefined && (${(0,a.or)(this.invalid$data(),N)})`)}error(N,L,z){if(L){this.setParams(L),this._error(N,z),this.setParams({});return}this._error(N,z)}_error(N,L){(N?h.reportExtraError:h.reportError)(this,this.def.error,L)}$dataError(){(0,h.reportError)(this,this.def.$dataError||h.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,h.resetErrorsCount)(this.gen,this.errsCount)}ok(N){this.allErrors||this.gen.if(N)}setParams(N,L){L?Object.assign(this.params,N):this.params=N}block$data(N,L,z=a.nil){this.gen.block(()=>{this.check$data(N,z),L()})}check$data(N=a.nil,L=a.nil){if(!this.$data)return;const{gen:z,schemaCode:Y,schemaType:Q,def:Ee}=this;z.if((0,a.or)((0,a._)`${Y} === undefined`,L)),N!==a.nil&&z.assign(N,!0),(Q.length||Ee.validateSchema)&&(z.elseIf(this.invalid$data()),this.$dataError(),N!==a.nil&&z.assign(N,!1)),z.else()}invalid$data(){const{gen:N,schemaCode:L,schemaType:z,def:Y,it:Q}=this;return(0,a.or)(Ee(),Ge());function Ee(){if(z.length){if(!(L instanceof a.Name))throw new Error("ajv implementation error");const Me=Array.isArray(z)?z:[z];return(0,a._)`${(0,r.checkDataTypes)(Me,L,Q.opts.strictNumbers,r.DataType.Wrong)}`}return a.nil}function Ge(){if(Y.validateSchema){const Me=N.scopeValue("validate$data",{ref:Y.validateSchema});return(0,a._)`!${Me}(${L})`}return a.nil}}subschema(N,L){const z=(0,i.getSubschema)(this.it,N);(0,i.extendSubschemaData)(z,this.it,N),(0,i.extendSubschemaMode)(z,N);const Y={...this.it,...z,items:void 0,props:void 0};return S(Y,L),Y}mergeEvaluated(N,L){const{it:z,gen:Y}=this;z.opts.unevaluated&&(z.props!==!0&&N.props!==void 0&&(z.props=u.mergeEvaluated.props(Y,N.props,z.props,L)),z.items!==!0&&N.items!==void 0&&(z.items=u.mergeEvaluated.items(Y,N.items,z.items,L)))}mergeValidEvaluated(N,L){const{it:z,gen:Y}=this;if(z.opts.unevaluated&&(z.props!==!0||z.items!==!0))return Y.if(L,()=>this.mergeEvaluated(N,a.Name)),!0}}tn.KeywordCxt=x;function W(R,N,L,z){const Y=new x(R,L,N);"code"in L?L.code(Y,z):Y.$data&&L.validate?(0,s.funcKeywordCode)(Y,L):"macro"in L?(0,s.macroKeywordCode)(Y,L):(L.compile||L.validate)&&(0,s.funcKeywordCode)(Y,L)}const Z=/^\/(?:[^~]|~0|~1)*$/,se=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function re(R,{dataLevel:N,dataNames:L,dataPathArr:z}){let Y,Q;if(R==="")return l.default.rootData;if(R[0]==="/"){if(!Z.test(R))throw new Error(`Invalid JSON-pointer: ${R}`);Y=R,Q=l.default.rootData}else{const xe=se.exec(R);if(!xe)throw new Error(`Invalid JSON-pointer: ${R}`);const Te=+xe[1];if(Y=xe[2],Y==="#"){if(Te>=N)throw new Error(Me("property/index",Te));return z[N-Te]}if(Te>N)throw new Error(Me("data",Te));if(Q=L[N-Te],!Y)return Q}let Ee=Q;const Ge=Y.split("/");for(const xe of Ge)xe&&(Q=(0,a._)`${Q}${(0,a.getProperty)((0,u.unescapeJsonPointer)(xe))}`,Ee=(0,a._)`${Ee} && ${Q}`);return Ee;function Me(xe,Te){return`Cannot access ${xe} ${Te} levels up, current level is ${N}`}}return tn.getData=re,tn}var zo={},Zh;function $u(){if(Zh)return zo;Zh=1,Object.defineProperty(zo,"__esModule",{value:!0});class t extends Error{constructor(n){super("validation failed"),this.errors=n,this.ajv=this.validation=!0}}return zo.default=t,zo}var Ho={},Yh;function Ma(){if(Yh)return Ho;Yh=1,Object.defineProperty(Ho,"__esModule",{value:!0});const t=Pa();class e extends Error{constructor(r,o,s,i){super(i||`can't resolve reference ${s} from id ${o}`),this.missingRef=(0,t.resolveUrl)(r,o,s),this.missingSchema=(0,t.normalizeId)((0,t.getFullPath)(r,this.missingRef))}}return Ho.default=e,Ho}var Ct={},Xh;function Au(){if(Xh)return Ct;Xh=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.resolveSchema=Ct.getCompilingSchema=Ct.resolveRef=Ct.compileSchema=Ct.SchemaEnv=void 0;const t=we(),e=$u(),n=Rn(),r=Pa(),o=Ie(),s=Na();class i{constructor(v){var g;this.refs={},this.dynamicAnchors={};let S;typeof v.schema=="object"&&(S=v.schema),this.schema=v.schema,this.schemaId=v.schemaId,this.root=v.root||this,this.baseId=(g=v.baseId)!==null&&g!==void 0?g:(0,r.normalizeId)(S?.[v.schemaId||"$id"]),this.schemaPath=v.schemaPath,this.localRefs=v.localRefs,this.meta=v.meta,this.$async=S?.$async,this.refs={}}}Ct.SchemaEnv=i;function a(_){const v=u.call(this,_);if(v)return v;const g=(0,r.getFullPath)(this.opts.uriResolver,_.root.baseId),{es5:S,lines:b}=this.opts.code,{ownProperties:y}=this.opts,C=new t.CodeGen(this.scope,{es5:S,lines:b,ownProperties:y});let k;_.$async&&(k=C.scopeValue("Error",{ref:e.default,code:(0,t._)`require("ajv/dist/runtime/validation_error").default`}));const P=C.scopeName("validate");_.validateName=P;const M={gen:C,allErrors:this.opts.allErrors,data:n.default.data,parentData:n.default.parentData,parentDataProperty:n.default.parentDataProperty,dataNames:[n.default.data],dataPathArr:[t.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:C.scopeValue("schema",this.opts.code.source===!0?{ref:_.schema,code:(0,t.stringify)(_.schema)}:{ref:_.schema}),validateName:P,ValidationError:k,schema:_.schema,schemaEnv:_,rootId:g,baseId:_.baseId||g,schemaPath:t.nil,errSchemaPath:_.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,t._)`""`,opts:this.opts,self:this};let q;try{this._compilations.add(_),(0,s.validateFunctionCode)(M),C.optimize(this.opts.code.optimize);const D=C.toString();q=`${C.scopeRefs(n.default.scope)}return ${D}`,this.opts.code.process&&(q=this.opts.code.process(q,_));const B=new Function(`${n.default.self}`,`${n.default.scope}`,q)(this,this.scope.get());if(this.scope.value(P,{ref:B}),B.errors=null,B.schema=_.schema,B.schemaEnv=_,_.$async&&(B.$async=!0),this.opts.code.source===!0&&(B.source={validateName:P,validateCode:D,scopeValues:C._values}),this.opts.unevaluated){const{props:K,items:oe}=M;B.evaluated={props:K instanceof t.Name?void 0:K,items:oe instanceof t.Name?void 0:oe,dynamicProps:K instanceof t.Name,dynamicItems:oe instanceof t.Name},B.source&&(B.source.evaluated=(0,t.stringify)(B.evaluated))}return _.validate=B,_}catch(D){throw delete _.validate,delete _.validateName,q&&this.logger.error("Error compiling schema, function code:",q),D}finally{this._compilations.delete(_)}}Ct.compileSchema=a;function l(_,v,g){var S;g=(0,r.resolveUrl)(this.opts.uriResolver,v,g);const b=_.refs[g];if(b)return b;let y=p.call(this,_,g);if(y===void 0){const C=(S=_.localRefs)===null||S===void 0?void 0:S[g],{schemaId:k}=this.opts;C&&(y=new i({schema:C,schemaId:k,root:_,baseId:v}))}if(y!==void 0)return _.refs[g]=c.call(this,y)}Ct.resolveRef=l;function c(_){return(0,r.inlineRef)(_.schema,this.opts.inlineRefs)?_.schema:_.validate?_:a.call(this,_)}function u(_){for(const v of this._compilations)if(h(v,_))return v}Ct.getCompilingSchema=u;function h(_,v){return _.schema===v.schema&&_.root===v.root&&_.baseId===v.baseId}function p(_,v){let g;for(;typeof(g=this.refs[v])=="string";)v=g;return g||this.schemas[v]||m.call(this,_,v)}function m(_,v){const g=this.opts.uriResolver.parse(v),S=(0,r._getFullPath)(this.opts.uriResolver,g);let b=(0,r.getFullPath)(this.opts.uriResolver,_.baseId,void 0);if(Object.keys(_.schema).length>0&&S===b)return E.call(this,g,_);const y=(0,r.normalizeId)(S),C=this.refs[y]||this.schemas[y];if(typeof C=="string"){const k=m.call(this,_,C);return typeof k?.schema!="object"?void 0:E.call(this,g,k)}if(typeof C?.schema=="object"){if(C.validate||a.call(this,C),y===(0,r.normalizeId)(v)){const{schema:k}=C,{schemaId:P}=this.opts,M=k[P];return M&&(b=(0,r.resolveUrl)(this.opts.uriResolver,b,M)),new i({schema:k,schemaId:P,root:_,baseId:b})}return E.call(this,g,C)}}Ct.resolveSchema=m;const w=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function E(_,{baseId:v,schema:g,root:S}){var b;if(((b=_.fragment)===null||b===void 0?void 0:b[0])!=="/")return;for(const k of _.fragment.slice(1).split("/")){if(typeof g=="boolean")return;const P=g[(0,o.unescapeFragment)(k)];if(P===void 0)return;g=P;const M=typeof g=="object"&&g[this.opts.schemaId];!w.has(k)&&M&&(v=(0,r.resolveUrl)(this.opts.uriResolver,v,M))}let y;if(typeof g!="boolean"&&g.$ref&&!(0,o.schemaHasRulesButRef)(g,this.RULES)){const k=(0,r.resolveUrl)(this.opts.uriResolver,v,g.$ref);y=m.call(this,S,k)}const{schemaId:C}=this.opts;if(y=y||new i({schema:g,schemaId:C,root:S,baseId:v}),y.schema!==y.root.schema)return y}return Ct}const X1="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",Q1="Meta-schema for $data reference (JSON AnySchema extension proposal)",j1="object",ex=["$data"],tx={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},nx=!1,rx={$id:X1,description:Q1,type:j1,required:ex,properties:tx,additionalProperties:nx};var Go={},Fr={exports:{}},fl,Qh;function wv(){if(Qh)return fl;Qh=1;const t=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),e=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function n(p){let m="",w=0,E=0;for(E=0;E<p.length;E++)if(w=p[E].charCodeAt(0),w!==48){if(!(w>=48&&w<=57||w>=65&&w<=70||w>=97&&w<=102))return"";m+=p[E];break}for(E+=1;E<p.length;E++){if(w=p[E].charCodeAt(0),!(w>=48&&w<=57||w>=65&&w<=70||w>=97&&w<=102))return"";m+=p[E]}return m}const r=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function o(p){return p.length=0,!0}function s(p,m,w){if(p.length){const E=n(p);if(E!=="")m.push(E);else return w.error=!0,!1;p.length=0}return!0}function i(p){let m=0;const w={error:!1,address:"",zone:""},E=[],_=[];let v=!1,g=!1,S=s;for(let b=0;b<p.length;b++){const y=p[b];if(!(y==="["||y==="]"))if(y===":"){if(v===!0&&(g=!0),!S(_,E,w))break;if(++m>7){w.error=!0;break}b>0&&p[b-1]===":"&&(v=!0),E.push(":");continue}else if(y==="%"){if(!S(_,E,w))break;S=o}else{_.push(y);continue}}return _.length&&(S===o?w.zone=_.join(""):g?E.push(_.join("")):E.push(n(_))),w.address=E.join(""),w}function a(p){if(l(p,":")<2)return{host:p,isIPV6:!1};const m=i(p);if(m.error)return{host:p,isIPV6:!1};{let w=m.address,E=m.address;return m.zone&&(w+="%"+m.zone,E+="%25"+m.zone),{host:w,isIPV6:!0,escapedHost:E}}}function l(p,m){let w=0;for(let E=0;E<p.length;E++)p[E]===m&&w++;return w}function c(p){let m=p;const w=[];let E=-1,_=0;for(;_=m.length;){if(_===1){if(m===".")break;if(m==="/"){w.push("/");break}else{w.push(m);break}}else if(_===2){if(m[0]==="."){if(m[1]===".")break;if(m[1]==="/"){m=m.slice(2);continue}}else if(m[0]==="/"&&(m[1]==="."||m[1]==="/")){w.push("/");break}}else if(_===3&&m==="/.."){w.length!==0&&w.pop(),w.push("/");break}if(m[0]==="."){if(m[1]==="."){if(m[2]==="/"){m=m.slice(3);continue}}else if(m[1]==="/"){m=m.slice(2);continue}}else if(m[0]==="/"&&m[1]==="."){if(m[2]==="/"){m=m.slice(2);continue}else if(m[2]==="."&&m[3]==="/"){m=m.slice(3),w.length!==0&&w.pop();continue}}if((E=m.indexOf("/",1))===-1){w.push(m);break}else w.push(m.slice(0,E)),m=m.slice(E)}return w.join("")}function u(p,m){const w=m!==!0?escape:unescape;return p.scheme!==void 0&&(p.scheme=w(p.scheme)),p.userinfo!==void 0&&(p.userinfo=w(p.userinfo)),p.host!==void 0&&(p.host=w(p.host)),p.path!==void 0&&(p.path=w(p.path)),p.query!==void 0&&(p.query=w(p.query)),p.fragment!==void 0&&(p.fragment=w(p.fragment)),p}function h(p){const m=[];if(p.userinfo!==void 0&&(m.push(p.userinfo),m.push("@")),p.host!==void 0){let w=unescape(p.host);if(!e(w)){const E=a(w);E.isIPV6===!0?w=`[${E.escapedHost}]`:w=p.host}m.push(w)}return(typeof p.port=="number"||typeof p.port=="string")&&(m.push(":"),m.push(String(p.port))),m.length?m.join(""):void 0}return fl={nonSimpleDomain:r,recomposeAuthority:h,normalizeComponentEncoding:u,removeDotSegments:c,isIPv4:e,isUUID:t,normalizeIPv6:a,stringArrayToHexStripped:n},fl}var hl,jh;function ox(){if(jh)return hl;jh=1;const{isUUID:t}=wv(),e=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,n=["http","https","ws","wss","urn","urn:uuid"];function r(y){return n.indexOf(y)!==-1}function o(y){return y.secure===!0?!0:y.secure===!1?!1:y.scheme?y.scheme.length===3&&(y.scheme[0]==="w"||y.scheme[0]==="W")&&(y.scheme[1]==="s"||y.scheme[1]==="S")&&(y.scheme[2]==="s"||y.scheme[2]==="S"):!1}function s(y){return y.host||(y.error=y.error||"HTTP URIs must have a host."),y}function i(y){const C=String(y.scheme).toLowerCase()==="https";return(y.port===(C?443:80)||y.port==="")&&(y.port=void 0),y.path||(y.path="/"),y}function a(y){return y.secure=o(y),y.resourceName=(y.path||"/")+(y.query?"?"+y.query:""),y.path=void 0,y.query=void 0,y}function l(y){if((y.port===(o(y)?443:80)||y.port==="")&&(y.port=void 0),typeof y.secure=="boolean"&&(y.scheme=y.secure?"wss":"ws",y.secure=void 0),y.resourceName){const[C,k]=y.resourceName.split("?");y.path=C&&C!=="/"?C:void 0,y.query=k,y.resourceName=void 0}return y.fragment=void 0,y}function c(y,C){if(!y.path)return y.error="URN can not be parsed",y;const k=y.path.match(e);if(k){const P=C.scheme||y.scheme||"urn";y.nid=k[1].toLowerCase(),y.nss=k[2];const M=`${P}:${C.nid||y.nid}`,q=b(M);y.path=void 0,q&&(y=q.parse(y,C))}else y.error=y.error||"URN can not be parsed.";return y}function u(y,C){if(y.nid===void 0)throw new Error("URN without nid cannot be serialized");const k=C.scheme||y.scheme||"urn",P=y.nid.toLowerCase(),M=`${k}:${C.nid||P}`,q=b(M);q&&(y=q.serialize(y,C));const D=y,G=y.nss;return D.path=`${P||C.nid}:${G}`,C.skipEscape=!0,D}function h(y,C){const k=y;return k.uuid=k.nss,k.nss=void 0,!C.tolerant&&(!k.uuid||!t(k.uuid))&&(k.error=k.error||"UUID is not valid."),k}function p(y){const C=y;return C.nss=(y.uuid||"").toLowerCase(),C}const m={scheme:"http",domainHost:!0,parse:s,serialize:i},w={scheme:"https",domainHost:m.domainHost,parse:s,serialize:i},E={scheme:"ws",domainHost:!0,parse:a,serialize:l},_={scheme:"wss",domainHost:E.domainHost,parse:E.parse,serialize:E.serialize},S={http:m,https:w,ws:E,wss:_,urn:{scheme:"urn",parse:c,serialize:u,skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:h,serialize:p,skipNormalize:!0}};Object.setPrototypeOf(S,null);function b(y){return y&&(S[y]||S[y.toLowerCase()])||void 0}return hl={wsIsSecure:o,SCHEMES:S,isValidSchemeName:r,getSchemeHandler:b},hl}var ep;function Sv(){if(ep)return Fr.exports;ep=1;const{normalizeIPv6:t,removeDotSegments:e,recomposeAuthority:n,normalizeComponentEncoding:r,isIPv4:o,nonSimpleDomain:s}=wv(),{SCHEMES:i,getSchemeHandler:a}=ox();function l(_,v){return typeof _=="string"?_=p(w(_,v),v):typeof _=="object"&&(_=w(p(_,v),v)),_}function c(_,v,g){const S=g?Object.assign({scheme:"null"},g):{scheme:"null"},b=u(w(_,S),w(v,S),S,!0);return S.skipEscape=!0,p(b,S)}function u(_,v,g,S){const b={};return S||(_=w(p(_,g),g),v=w(p(v,g),g)),g=g||{},!g.tolerant&&v.scheme?(b.scheme=v.scheme,b.userinfo=v.userinfo,b.host=v.host,b.port=v.port,b.path=e(v.path||""),b.query=v.query):(v.userinfo!==void 0||v.host!==void 0||v.port!==void 0?(b.userinfo=v.userinfo,b.host=v.host,b.port=v.port,b.path=e(v.path||""),b.query=v.query):(v.path?(v.path[0]==="/"?b.path=e(v.path):((_.userinfo!==void 0||_.host!==void 0||_.port!==void 0)&&!_.path?b.path="/"+v.path:_.path?b.path=_.path.slice(0,_.path.lastIndexOf("/")+1)+v.path:b.path=v.path,b.path=e(b.path)),b.query=v.query):(b.path=_.path,v.query!==void 0?b.query=v.query:b.query=_.query),b.userinfo=_.userinfo,b.host=_.host,b.port=_.port),b.scheme=_.scheme),b.fragment=v.fragment,b}function h(_,v,g){return typeof _=="string"?(_=unescape(_),_=p(r(w(_,g),!0),{...g,skipEscape:!0})):typeof _=="object"&&(_=p(r(_,!0),{...g,skipEscape:!0})),typeof v=="string"?(v=unescape(v),v=p(r(w(v,g),!0),{...g,skipEscape:!0})):typeof v=="object"&&(v=p(r(v,!0),{...g,skipEscape:!0})),_.toLowerCase()===v.toLowerCase()}function p(_,v){const g={host:_.host,scheme:_.scheme,userinfo:_.userinfo,port:_.port,path:_.path,query:_.query,nid:_.nid,nss:_.nss,uuid:_.uuid,fragment:_.fragment,reference:_.reference,resourceName:_.resourceName,secure:_.secure,error:""},S=Object.assign({},v),b=[],y=a(S.scheme||g.scheme);y&&y.serialize&&y.serialize(g,S),g.path!==void 0&&(S.skipEscape?g.path=unescape(g.path):(g.path=escape(g.path),g.scheme!==void 0&&(g.path=g.path.split("%3A").join(":")))),S.reference!=="suffix"&&g.scheme&&b.push(g.scheme,":");const C=n(g);if(C!==void 0&&(S.reference!=="suffix"&&b.push("//"),b.push(C),g.path&&g.path[0]!=="/"&&b.push("/")),g.path!==void 0){let k=g.path;!S.absolutePath&&(!y||!y.absolutePath)&&(k=e(k)),C===void 0&&k[0]==="/"&&k[1]==="/"&&(k="/%2F"+k.slice(2)),b.push(k)}return g.query!==void 0&&b.push("?",g.query),g.fragment!==void 0&&b.push("#",g.fragment),b.join("")}const m=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function w(_,v){const g=Object.assign({},v),S={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0};let b=!1;g.reference==="suffix"&&(g.scheme?_=g.scheme+":"+_:_="//"+_);const y=_.match(m);if(y){if(S.scheme=y[1],S.userinfo=y[3],S.host=y[4],S.port=parseInt(y[5],10),S.path=y[6]||"",S.query=y[7],S.fragment=y[8],isNaN(S.port)&&(S.port=y[5]),S.host)if(o(S.host)===!1){const P=t(S.host);S.host=P.host.toLowerCase(),b=P.isIPV6}else b=!0;S.scheme===void 0&&S.userinfo===void 0&&S.host===void 0&&S.port===void 0&&S.query===void 0&&!S.path?S.reference="same-document":S.scheme===void 0?S.reference="relative":S.fragment===void 0?S.reference="absolute":S.reference="uri",g.reference&&g.reference!=="suffix"&&g.reference!==S.reference&&(S.error=S.error||"URI is not a "+g.reference+" reference.");const C=a(g.scheme||S.scheme);if(!g.unicodeSupport&&(!C||!C.unicodeSupport)&&S.host&&(g.domainHost||C&&C.domainHost)&&b===!1&&s(S.host))try{S.host=URL.domainToASCII(S.host.toLowerCase())}catch(k){S.error=S.error||"Host's domain name can not be converted to ASCII: "+k}(!C||C&&!C.skipNormalize)&&(_.indexOf("%")!==-1&&(S.scheme!==void 0&&(S.scheme=unescape(S.scheme)),S.host!==void 0&&(S.host=unescape(S.host))),S.path&&(S.path=escape(unescape(S.path))),S.fragment&&(S.fragment=encodeURI(decodeURIComponent(S.fragment)))),C&&C.parse&&C.parse(S,g)}else S.error=S.error||"URI can not be parsed.";return S}const E={SCHEMES:i,normalize:l,resolve:c,resolveComponent:u,equal:h,serialize:p,parse:w};return Fr.exports=E,Fr.exports.default=E,Fr.exports.fastUri=E,Fr.exports}var tp;function sx(){if(tp)return Go;tp=1,Object.defineProperty(Go,"__esModule",{value:!0});const t=Sv();return t.code='require("ajv/dist/runtime/uri").default',Go.default=t,Go}var np;function ix(){return np||(np=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=Na();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var n=we();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const r=$u(),o=Ma(),s=yv(),i=Au(),a=we(),l=Pa(),c=Ji(),u=Ie(),h=rx,p=sx(),m=(V,$)=>new RegExp(V,$);m.code="new RegExp";const w=["removeAdditional","useDefaults","coerceTypes"],E=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),_={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},v={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},g=200;function S(V){var $,O,A,T,I,x,W,Z,se,re,R,N,L,z,Y,Q,Ee,Ge,Me,xe,Te,bt,Le,An,Pn;const qt=V.strict,Nn=($=V.code)===null||$===void 0?void 0:$.optimize,Dr=Nn===!0||Nn===void 0?1:Nn||0,Or=(A=(O=V.code)===null||O===void 0?void 0:O.regExp)!==null&&A!==void 0?A:m,Xa=(T=V.uriResolver)!==null&&T!==void 0?T:p.default;return{strictSchema:(x=(I=V.strictSchema)!==null&&I!==void 0?I:qt)!==null&&x!==void 0?x:!0,strictNumbers:(Z=(W=V.strictNumbers)!==null&&W!==void 0?W:qt)!==null&&Z!==void 0?Z:!0,strictTypes:(re=(se=V.strictTypes)!==null&&se!==void 0?se:qt)!==null&&re!==void 0?re:"log",strictTuples:(N=(R=V.strictTuples)!==null&&R!==void 0?R:qt)!==null&&N!==void 0?N:"log",strictRequired:(z=(L=V.strictRequired)!==null&&L!==void 0?L:qt)!==null&&z!==void 0?z:!1,code:V.code?{...V.code,optimize:Dr,regExp:Or}:{optimize:Dr,regExp:Or},loopRequired:(Y=V.loopRequired)!==null&&Y!==void 0?Y:g,loopEnum:(Q=V.loopEnum)!==null&&Q!==void 0?Q:g,meta:(Ee=V.meta)!==null&&Ee!==void 0?Ee:!0,messages:(Ge=V.messages)!==null&&Ge!==void 0?Ge:!0,inlineRefs:(Me=V.inlineRefs)!==null&&Me!==void 0?Me:!0,schemaId:(xe=V.schemaId)!==null&&xe!==void 0?xe:"$id",addUsedSchema:(Te=V.addUsedSchema)!==null&&Te!==void 0?Te:!0,validateSchema:(bt=V.validateSchema)!==null&&bt!==void 0?bt:!0,validateFormats:(Le=V.validateFormats)!==null&&Le!==void 0?Le:!0,unicodeRegExp:(An=V.unicodeRegExp)!==null&&An!==void 0?An:!0,int32range:(Pn=V.int32range)!==null&&Pn!==void 0?Pn:!0,uriResolver:Xa}}class b{constructor($={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,$=this.opts={...$,...S($)};const{es5:O,lines:A}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:E,es5:O,lines:A}),this.logger=G($.logger);const T=$.validateFormats;$.validateFormats=!1,this.RULES=(0,s.getRules)(),y.call(this,_,$,"NOT SUPPORTED"),y.call(this,v,$,"DEPRECATED","warn"),this._metaOpts=q.call(this),$.formats&&P.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),$.keywords&&M.call(this,$.keywords),typeof $.meta=="object"&&this.addMetaSchema($.meta),k.call(this),$.validateFormats=T}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:$,meta:O,schemaId:A}=this.opts;let T=h;A==="id"&&(T={...h},T.id=T.$id,delete T.$id),O&&$&&this.addMetaSchema(T,T[A],!1)}defaultMeta(){const{meta:$,schemaId:O}=this.opts;return this.opts.defaultMeta=typeof $=="object"?$[O]||$:void 0}validate($,O){let A;if(typeof $=="string"){if(A=this.getSchema($),!A)throw new Error(`no schema with key or ref "${$}"`)}else A=this.compile($);const T=A(O);return"$async"in A||(this.errors=A.errors),T}compile($,O){const A=this._addSchema($,O);return A.validate||this._compileSchemaEnv(A)}compileAsync($,O){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:A}=this.opts;return T.call(this,$,O);async function T(re,R){await I.call(this,re.$schema);const N=this._addSchema(re,R);return N.validate||x.call(this,N)}async function I(re){re&&!this.getSchema(re)&&await T.call(this,{$ref:re},!0)}async function x(re){try{return this._compileSchemaEnv(re)}catch(R){if(!(R instanceof o.default))throw R;return W.call(this,R),await Z.call(this,R.missingSchema),x.call(this,re)}}function W({missingSchema:re,missingRef:R}){if(this.refs[re])throw new Error(`AnySchema ${re} is loaded but ${R} cannot be resolved`)}async function Z(re){const R=await se.call(this,re);this.refs[re]||await I.call(this,R.$schema),this.refs[re]||this.addSchema(R,re,O)}async function se(re){const R=this._loading[re];if(R)return R;try{return await(this._loading[re]=A(re))}finally{delete this._loading[re]}}}addSchema($,O,A,T=this.opts.validateSchema){if(Array.isArray($)){for(const x of $)this.addSchema(x,void 0,A,T);return this}let I;if(typeof $=="object"){const{schemaId:x}=this.opts;if(I=$[x],I!==void 0&&typeof I!="string")throw new Error(`schema ${x} must be string`)}return O=(0,l.normalizeId)(O||I),this._checkUnique(O),this.schemas[O]=this._addSchema($,A,O,T,!0),this}addMetaSchema($,O,A=this.opts.validateSchema){return this.addSchema($,O,!0,A),this}validateSchema($,O){if(typeof $=="boolean")return!0;let A;if(A=$.$schema,A!==void 0&&typeof A!="string")throw new Error("$schema must be a string");if(A=A||this.opts.defaultMeta||this.defaultMeta(),!A)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const T=this.validate(A,$);if(!T&&O){const I="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(I);else throw new Error(I)}return T}getSchema($){let O;for(;typeof(O=C.call(this,$))=="string";)$=O;if(O===void 0){const{schemaId:A}=this.opts,T=new i.SchemaEnv({schema:{},schemaId:A});if(O=i.resolveSchema.call(this,T,$),!O)return;this.refs[$]=O}return O.validate||this._compileSchemaEnv(O)}removeSchema($){if($ instanceof RegExp)return this._removeAllSchemas(this.schemas,$),this._removeAllSchemas(this.refs,$),this;switch(typeof $){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const O=C.call(this,$);return typeof O=="object"&&this._cache.delete(O.schema),delete this.schemas[$],delete this.refs[$],this}case"object":{const O=$;this._cache.delete(O);let A=$[this.opts.schemaId];return A&&(A=(0,l.normalizeId)(A),delete this.schemas[A],delete this.refs[A]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary($){for(const O of $)this.addKeyword(O);return this}addKeyword($,O){let A;if(typeof $=="string")A=$,typeof O=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),O.keyword=A);else if(typeof $=="object"&&O===void 0){if(O=$,A=O.keyword,Array.isArray(A)&&!A.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(K.call(this,A,O),!O)return(0,u.eachItem)(A,I=>oe.call(this,I)),this;be.call(this,O);const T={...O,type:(0,c.getJSONTypes)(O.type),schemaType:(0,c.getJSONTypes)(O.schemaType)};return(0,u.eachItem)(A,T.type.length===0?I=>oe.call(this,I,T):I=>T.type.forEach(x=>oe.call(this,I,T,x))),this}getKeyword($){const O=this.RULES.all[$];return typeof O=="object"?O.definition:!!O}removeKeyword($){const{RULES:O}=this;delete O.keywords[$],delete O.all[$];for(const A of O.rules){const T=A.rules.findIndex(I=>I.keyword===$);T>=0&&A.rules.splice(T,1)}return this}addFormat($,O){return typeof O=="string"&&(O=new RegExp(O)),this.formats[$]=O,this}errorsText($=this.errors,{separator:O=", ",dataVar:A="data"}={}){return!$||$.length===0?"No errors":$.map(T=>`${A}${T.instancePath} ${T.message}`).reduce((T,I)=>T+O+I)}$dataMetaSchema($,O){const A=this.RULES.all;$=JSON.parse(JSON.stringify($));for(const T of O){const I=T.split("/").slice(1);let x=$;for(const W of I)x=x[W];for(const W in A){const Z=A[W];if(typeof Z!="object")continue;const{$data:se}=Z.definition,re=x[W];se&&re&&(x[W]=ge(re))}}return $}_removeAllSchemas($,O){for(const A in $){const T=$[A];(!O||O.test(A))&&(typeof T=="string"?delete $[A]:T&&!T.meta&&(this._cache.delete(T.schema),delete $[A]))}}_addSchema($,O,A,T=this.opts.validateSchema,I=this.opts.addUsedSchema){let x;const{schemaId:W}=this.opts;if(typeof $=="object")x=$[W];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof $!="boolean")throw new Error("schema must be object or boolean")}let Z=this._cache.get($);if(Z!==void 0)return Z;A=(0,l.normalizeId)(x||A);const se=l.getSchemaRefs.call(this,$,A);return Z=new i.SchemaEnv({schema:$,schemaId:W,meta:O,baseId:A,localRefs:se}),this._cache.set(Z.schema,Z),I&&!A.startsWith("#")&&(A&&this._checkUnique(A),this.refs[A]=Z),T&&this.validateSchema($,!0),Z}_checkUnique($){if(this.schemas[$]||this.refs[$])throw new Error(`schema with key or id "${$}" already exists`)}_compileSchemaEnv($){if($.meta?this._compileMetaSchema($):i.compileSchema.call(this,$),!$.validate)throw new Error("ajv implementation error");return $.validate}_compileMetaSchema($){const O=this.opts;this.opts=this._metaOpts;try{i.compileSchema.call(this,$)}finally{this.opts=O}}}b.ValidationError=r.default,b.MissingRefError=o.default,t.default=b;function y(V,$,O,A="error"){for(const T in V){const I=T;I in $&&this.logger[A](`${O}: option ${T}. ${V[I]}`)}}function C(V){return V=(0,l.normalizeId)(V),this.schemas[V]||this.refs[V]}function k(){const V=this.opts.schemas;if(V)if(Array.isArray(V))this.addSchema(V);else for(const $ in V)this.addSchema(V[$],$)}function P(){for(const V in this.opts.formats){const $=this.opts.formats[V];$&&this.addFormat(V,$)}}function M(V){if(Array.isArray(V)){this.addVocabulary(V);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const $ in V){const O=V[$];O.keyword||(O.keyword=$),this.addKeyword(O)}}function q(){const V={...this.opts};for(const $ of w)delete V[$];return V}const D={log(){},warn(){},error(){}};function G(V){if(V===!1)return D;if(V===void 0)return console;if(V.log&&V.warn&&V.error)return V;throw new Error("logger must implement log, warn and error methods")}const B=/^[a-z_$][a-z0-9_$:-]*$/i;function K(V,$){const{RULES:O}=this;if((0,u.eachItem)(V,A=>{if(O.keywords[A])throw new Error(`Keyword ${A} is already defined`);if(!B.test(A))throw new Error(`Keyword ${A} has invalid name`)}),!!$&&$.$data&&!("code"in $||"validate"in $))throw new Error('$data keyword must have "code" or "validate" function')}function oe(V,$,O){var A;const T=$?.post;if(O&&T)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:I}=this;let x=T?I.post:I.rules.find(({type:Z})=>Z===O);if(x||(x={type:O,rules:[]},I.rules.push(x)),I.keywords[V]=!0,!$)return;const W={keyword:V,definition:{...$,type:(0,c.getJSONTypes)($.type),schemaType:(0,c.getJSONTypes)($.schemaType)}};$.before?Se.call(this,x,W,$.before):x.rules.push(W),I.all[V]=W,(A=$.implements)===null||A===void 0||A.forEach(Z=>this.addKeyword(Z))}function Se(V,$,O){const A=V.rules.findIndex(T=>T.keyword===O);A>=0?V.rules.splice(A,0,$):(V.rules.push($),this.logger.warn(`rule ${O} is not defined`))}function be(V){let{metaSchema:$}=V;$!==void 0&&(V.$data&&this.opts.$data&&($=ge($)),V.validateSchema=this.compile($,!0))}const ee={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function ge(V){return{anyOf:[V,ee]}}})(sl)),sl}var Bo={},Jo={},Ko={},rp;function ax(){if(rp)return Ko;rp=1,Object.defineProperty(Ko,"__esModule",{value:!0});const t={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};return Ko.default=t,Ko}var gn={},op;function lx(){if(op)return gn;op=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.callRef=gn.getValidate=void 0;const t=Ma(),e=Zt(),n=we(),r=Rn(),o=Au(),s=Ie(),i={keyword:"$ref",schemaType:"string",code(c){const{gen:u,schema:h,it:p}=c,{baseId:m,schemaEnv:w,validateName:E,opts:_,self:v}=p,{root:g}=w;if((h==="#"||h==="#/")&&m===g.baseId)return b();const S=o.resolveRef.call(v,g,m,h);if(S===void 0)throw new t.default(p.opts.uriResolver,m,h);if(S instanceof o.SchemaEnv)return y(S);return C(S);function b(){if(w===g)return l(c,E,w,w.$async);const k=u.scopeValue("root",{ref:g});return l(c,(0,n._)`${k}.validate`,g,g.$async)}function y(k){const P=a(c,k);l(c,P,k,k.$async)}function C(k){const P=u.scopeValue("schema",_.code.source===!0?{ref:k,code:(0,n.stringify)(k)}:{ref:k}),M=u.name("valid"),q=c.subschema({schema:k,dataTypes:[],schemaPath:n.nil,topSchemaRef:P,errSchemaPath:h},M);c.mergeEvaluated(q),c.ok(M)}}};function a(c,u){const{gen:h}=c;return u.validate?h.scopeValue("validate",{ref:u.validate}):(0,n._)`${h.scopeValue("wrapper",{ref:u})}.validate`}gn.getValidate=a;function l(c,u,h,p){const{gen:m,it:w}=c,{allErrors:E,schemaEnv:_,opts:v}=w,g=v.passContext?r.default.this:n.nil;p?S():b();function S(){if(!_.$async)throw new Error("async schema referenced by sync schema");const k=m.let("valid");m.try(()=>{m.code((0,n._)`await ${(0,e.callValidateCode)(c,u,g)}`),C(u),E||m.assign(k,!0)},P=>{m.if((0,n._)`!(${P} instanceof ${w.ValidationError})`,()=>m.throw(P)),y(P),E||m.assign(k,!1)}),c.ok(k)}function b(){c.result((0,e.callValidateCode)(c,u,g),()=>C(u),()=>y(u))}function y(k){const P=(0,n._)`${k}.errors`;m.assign(r.default.vErrors,(0,n._)`${r.default.vErrors} === null ? ${P} : ${r.default.vErrors}.concat(${P})`),m.assign(r.default.errors,(0,n._)`${r.default.vErrors}.length`)}function C(k){var P;if(!w.opts.unevaluated)return;const M=(P=h?.validate)===null||P===void 0?void 0:P.evaluated;if(w.props!==!0)if(M&&!M.dynamicProps)M.props!==void 0&&(w.props=s.mergeEvaluated.props(m,M.props,w.props));else{const q=m.var("props",(0,n._)`${k}.evaluated.props`);w.props=s.mergeEvaluated.props(m,q,w.props,n.Name)}if(w.items!==!0)if(M&&!M.dynamicItems)M.items!==void 0&&(w.items=s.mergeEvaluated.items(m,M.items,w.items));else{const q=m.var("items",(0,n._)`${k}.evaluated.items`);w.items=s.mergeEvaluated.items(m,q,w.items,n.Name)}}}return gn.callRef=l,gn.default=i,gn}var sp;function cx(){if(sp)return Jo;sp=1,Object.defineProperty(Jo,"__esModule",{value:!0});const t=ax(),e=lx(),n=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",t.default,e.default];return Jo.default=n,Jo}var Wo={},Zo={},ip;function ux(){if(ip)return Zo;ip=1,Object.defineProperty(Zo,"__esModule",{value:!0});const t=we(),e=t.operators,n={maximum:{okStr:"<=",ok:e.LTE,fail:e.GT},minimum:{okStr:">=",ok:e.GTE,fail:e.LT},exclusiveMaximum:{okStr:"<",ok:e.LT,fail:e.GTE},exclusiveMinimum:{okStr:">",ok:e.GT,fail:e.LTE}},r={message:({keyword:s,schemaCode:i})=>(0,t.str)`must be ${n[s].okStr} ${i}`,params:({keyword:s,schemaCode:i})=>(0,t._)`{comparison: ${n[s].okStr}, limit: ${i}}`},o={keyword:Object.keys(n),type:"number",schemaType:"number",$data:!0,error:r,code(s){const{keyword:i,data:a,schemaCode:l}=s;s.fail$data((0,t._)`${a} ${n[i].fail} ${l} || isNaN(${a})`)}};return Zo.default=o,Zo}var Yo={},ap;function dx(){if(ap)return Yo;ap=1,Object.defineProperty(Yo,"__esModule",{value:!0});const t=we(),n={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:r})=>(0,t.str)`must be multiple of ${r}`,params:({schemaCode:r})=>(0,t._)`{multipleOf: ${r}}`},code(r){const{gen:o,data:s,schemaCode:i,it:a}=r,l=a.opts.multipleOfPrecision,c=o.let("res"),u=l?(0,t._)`Math.abs(Math.round(${c}) - ${c}) > 1e-${l}`:(0,t._)`${c} !== parseInt(${c})`;r.fail$data((0,t._)`(${i} === 0 || (${c} = ${s}/${i}, ${u}))`)}};return Yo.default=n,Yo}var Xo={},Qo={},lp;function fx(){if(lp)return Qo;lp=1,Object.defineProperty(Qo,"__esModule",{value:!0});function t(e){const n=e.length;let r=0,o=0,s;for(;o<n;)r++,s=e.charCodeAt(o++),s>=55296&&s<=56319&&o<n&&(s=e.charCodeAt(o),(s&64512)===56320&&o++);return r}return Qo.default=t,t.code='require("ajv/dist/runtime/ucs2length").default',Qo}var cp;function hx(){if(cp)return Xo;cp=1,Object.defineProperty(Xo,"__esModule",{value:!0});const t=we(),e=Ie(),n=fx(),o={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:s,schemaCode:i}){const a=s==="maxLength"?"more":"fewer";return(0,t.str)`must NOT have ${a} than ${i} characters`},params:({schemaCode:s})=>(0,t._)`{limit: ${s}}`},code(s){const{keyword:i,data:a,schemaCode:l,it:c}=s,u=i==="maxLength"?t.operators.GT:t.operators.LT,h=c.opts.unicode===!1?(0,t._)`${a}.length`:(0,t._)`${(0,e.useFunc)(s.gen,n.default)}(${a})`;s.fail$data((0,t._)`${h} ${u} ${l}`)}};return Xo.default=o,Xo}var jo={},up;function px(){if(up)return jo;up=1,Object.defineProperty(jo,"__esModule",{value:!0});const t=Zt(),e=we(),r={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:o})=>(0,e.str)`must match pattern "${o}"`,params:({schemaCode:o})=>(0,e._)`{pattern: ${o}}`},code(o){const{data:s,$data:i,schema:a,schemaCode:l,it:c}=o,u=c.opts.unicodeRegExp?"u":"",h=i?(0,e._)`(new RegExp(${l}, ${u}))`:(0,t.usePattern)(o,a);o.fail$data((0,e._)`!${h}.test(${s})`)}};return jo.default=r,jo}var es={},dp;function mx(){if(dp)return es;dp=1,Object.defineProperty(es,"__esModule",{value:!0});const t=we(),n={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:r,schemaCode:o}){const s=r==="maxProperties"?"more":"fewer";return(0,t.str)`must NOT have ${s} than ${o} properties`},params:({schemaCode:r})=>(0,t._)`{limit: ${r}}`},code(r){const{keyword:o,data:s,schemaCode:i}=r,a=o==="maxProperties"?t.operators.GT:t.operators.LT;r.fail$data((0,t._)`Object.keys(${s}).length ${a} ${i}`)}};return es.default=n,es}var ts={},fp;function gx(){if(fp)return ts;fp=1,Object.defineProperty(ts,"__esModule",{value:!0});const t=Zt(),e=we(),n=Ie(),o={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:s}})=>(0,e.str)`must have required property '${s}'`,params:({params:{missingProperty:s}})=>(0,e._)`{missingProperty: ${s}}`},code(s){const{gen:i,schema:a,schemaCode:l,data:c,$data:u,it:h}=s,{opts:p}=h;if(!u&&a.length===0)return;const m=a.length>=p.loopRequired;if(h.allErrors?w():E(),p.strictRequired){const g=s.parentSchema.properties,{definedProperties:S}=s.it;for(const b of a)if(g?.[b]===void 0&&!S.has(b)){const y=h.schemaEnv.baseId+h.errSchemaPath,C=`required property "${b}" is not defined at "${y}" (strictRequired)`;(0,n.checkStrictMode)(h,C,h.opts.strictRequired)}}function w(){if(m||u)s.block$data(e.nil,_);else for(const g of a)(0,t.checkReportMissingProp)(s,g)}function E(){const g=i.let("missing");if(m||u){const S=i.let("valid",!0);s.block$data(S,()=>v(g,S)),s.ok(S)}else i.if((0,t.checkMissingProp)(s,a,g)),(0,t.reportMissingProp)(s,g),i.else()}function _(){i.forOf("prop",l,g=>{s.setParams({missingProperty:g}),i.if((0,t.noPropertyInData)(i,c,g,p.ownProperties),()=>s.error())})}function v(g,S){s.setParams({missingProperty:g}),i.forOf(g,l,()=>{i.assign(S,(0,t.propertyInData)(i,c,g,p.ownProperties)),i.if((0,e.not)(S),()=>{s.error(),i.break()})},e.nil)}}};return ts.default=o,ts}var ns={},hp;function _x(){if(hp)return ns;hp=1,Object.defineProperty(ns,"__esModule",{value:!0});const t=we(),n={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:r,schemaCode:o}){const s=r==="maxItems"?"more":"fewer";return(0,t.str)`must NOT have ${s} than ${o} items`},params:({schemaCode:r})=>(0,t._)`{limit: ${r}}`},code(r){const{keyword:o,data:s,schemaCode:i}=r,a=o==="maxItems"?t.operators.GT:t.operators.LT;r.fail$data((0,t._)`${s}.length ${a} ${i}`)}};return ns.default=n,ns}var rs={},os={},pp;function Pu(){if(pp)return os;pp=1,Object.defineProperty(os,"__esModule",{value:!0});const t=Aa();return t.code='require("ajv/dist/runtime/equal").default',os.default=t,os}var mp;function yx(){if(mp)return rs;mp=1,Object.defineProperty(rs,"__esModule",{value:!0});const t=Ji(),e=we(),n=Ie(),r=Pu(),s={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i,j:a}})=>(0,e.str)`must NOT have duplicate items (items ## ${a} and ${i} are identical)`,params:({params:{i,j:a}})=>(0,e._)`{i: ${i}, j: ${a}}`},code(i){const{gen:a,data:l,$data:c,schema:u,parentSchema:h,schemaCode:p,it:m}=i;if(!c&&!u)return;const w=a.let("valid"),E=h.items?(0,t.getSchemaTypes)(h.items):[];i.block$data(w,_,(0,e._)`${p} === false`),i.ok(w);function _(){const b=a.let("i",(0,e._)`${l}.length`),y=a.let("j");i.setParams({i:b,j:y}),a.assign(w,!0),a.if((0,e._)`${b} > 1`,()=>(v()?g:S)(b,y))}function v(){return E.length>0&&!E.some(b=>b==="object"||b==="array")}function g(b,y){const C=a.name("item"),k=(0,t.checkDataTypes)(E,C,m.opts.strictNumbers,t.DataType.Wrong),P=a.const("indices",(0,e._)`{}`);a.for((0,e._)`;${b}--;`,()=>{a.let(C,(0,e._)`${l}[${b}]`),a.if(k,(0,e._)`continue`),E.length>1&&a.if((0,e._)`typeof ${C} == "string"`,(0,e._)`${C} += "_"`),a.if((0,e._)`typeof ${P}[${C}] == "number"`,()=>{a.assign(y,(0,e._)`${P}[${C}]`),i.error(),a.assign(w,!1).break()}).code((0,e._)`${P}[${C}] = ${b}`)})}function S(b,y){const C=(0,n.useFunc)(a,r.default),k=a.name("outer");a.label(k).for((0,e._)`;${b}--;`,()=>a.for((0,e._)`${y} = ${b}; ${y}--;`,()=>a.if((0,e._)`${C}(${l}[${b}], ${l}[${y}])`,()=>{i.error(),a.assign(w,!1).break(k)})))}}};return rs.default=s,rs}var ss={},gp;function vx(){if(gp)return ss;gp=1,Object.defineProperty(ss,"__esModule",{value:!0});const t=we(),e=Ie(),n=Pu(),o={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:s})=>(0,t._)`{allowedValue: ${s}}`},code(s){const{gen:i,data:a,$data:l,schemaCode:c,schema:u}=s;l||u&&typeof u=="object"?s.fail$data((0,t._)`!${(0,e.useFunc)(i,n.default)}(${a}, ${c})`):s.fail((0,t._)`${u} !== ${a}`)}};return ss.default=o,ss}var is={},_p;function wx(){if(_p)return is;_p=1,Object.defineProperty(is,"__esModule",{value:!0});const t=we(),e=Ie(),n=Pu(),o={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:s})=>(0,t._)`{allowedValues: ${s}}`},code(s){const{gen:i,data:a,$data:l,schema:c,schemaCode:u,it:h}=s;if(!l&&c.length===0)throw new Error("enum must have non-empty array");const p=c.length>=h.opts.loopEnum;let m;const w=()=>m??(m=(0,e.useFunc)(i,n.default));let E;if(p||l)E=i.let("valid"),s.block$data(E,_);else{if(!Array.isArray(c))throw new Error("ajv implementation error");const g=i.const("vSchema",u);E=(0,t.or)(...c.map((S,b)=>v(g,b)))}s.pass(E);function _(){i.assign(E,!1),i.forOf("v",u,g=>i.if((0,t._)`${w()}(${a}, ${g})`,()=>i.assign(E,!0).break()))}function v(g,S){const b=c[S];return typeof b=="object"&&b!==null?(0,t._)`${w()}(${a}, ${g}[${S}])`:(0,t._)`${a} === ${b}`}}};return is.default=o,is}var yp;function Sx(){if(yp)return Wo;yp=1,Object.defineProperty(Wo,"__esModule",{value:!0});const t=ux(),e=dx(),n=hx(),r=px(),o=mx(),s=gx(),i=_x(),a=yx(),l=vx(),c=wx(),u=[t.default,e.default,n.default,r.default,o.default,s.default,i.default,a.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},l.default,c.default];return Wo.default=u,Wo}var as={},tr={},vp;function Ev(){if(vp)return tr;vp=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.validateAdditionalItems=void 0;const t=we(),e=Ie(),r={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:s}})=>(0,t.str)`must NOT have more than ${s} items`,params:({params:{len:s}})=>(0,t._)`{limit: ${s}}`},code(s){const{parentSchema:i,it:a}=s,{items:l}=i;if(!Array.isArray(l)){(0,e.checkStrictMode)(a,'"additionalItems" is ignored when "items" is not an array of schemas');return}o(s,l)}};function o(s,i){const{gen:a,schema:l,data:c,keyword:u,it:h}=s;h.items=!0;const p=a.const("len",(0,t._)`${c}.length`);if(l===!1)s.setParams({len:i.length}),s.pass((0,t._)`${p} <= ${i.length}`);else if(typeof l=="object"&&!(0,e.alwaysValidSchema)(h,l)){const w=a.var("valid",(0,t._)`${p} <= ${i.length}`);a.if((0,t.not)(w),()=>m(w)),s.ok(w)}function m(w){a.forRange("i",i.length,p,E=>{s.subschema({keyword:u,dataProp:E,dataPropType:e.Type.Num},w),h.allErrors||a.if((0,t.not)(w),()=>a.break())})}}return tr.validateAdditionalItems=o,tr.default=r,tr}var ls={},nr={},wp;function Tv(){if(wp)return nr;wp=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.validateTuple=void 0;const t=we(),e=Ie(),n=Zt(),r={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(s){const{schema:i,it:a}=s;if(Array.isArray(i))return o(s,"additionalItems",i);a.items=!0,!(0,e.alwaysValidSchema)(a,i)&&s.ok((0,n.validateArray)(s))}};function o(s,i,a=s.schema){const{gen:l,parentSchema:c,data:u,keyword:h,it:p}=s;E(c),p.opts.unevaluated&&a.length&&p.items!==!0&&(p.items=e.mergeEvaluated.items(l,a.length,p.items));const m=l.name("valid"),w=l.const("len",(0,t._)`${u}.length`);a.forEach((_,v)=>{(0,e.alwaysValidSchema)(p,_)||(l.if((0,t._)`${w} > ${v}`,()=>s.subschema({keyword:h,schemaProp:v,dataProp:v},m)),s.ok(m))});function E(_){const{opts:v,errSchemaPath:g}=p,S=a.length,b=S===_.minItems&&(S===_.maxItems||_[i]===!1);if(v.strictTuples&&!b){const y=`"${h}" is ${S}-tuple, but minItems or maxItems/${i} are not specified or different at path "${g}"`;(0,e.checkStrictMode)(p,y,v.strictTuples)}}}return nr.validateTuple=o,nr.default=r,nr}var Sp;function Ex(){if(Sp)return ls;Sp=1,Object.defineProperty(ls,"__esModule",{value:!0});const t=Tv(),e={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:n=>(0,t.validateTuple)(n,"items")};return ls.default=e,ls}var cs={},Ep;function Tx(){if(Ep)return cs;Ep=1,Object.defineProperty(cs,"__esModule",{value:!0});const t=we(),e=Ie(),n=Zt(),r=Ev(),s={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:i}})=>(0,t.str)`must NOT have more than ${i} items`,params:({params:{len:i}})=>(0,t._)`{limit: ${i}}`},code(i){const{schema:a,parentSchema:l,it:c}=i,{prefixItems:u}=l;c.items=!0,!(0,e.alwaysValidSchema)(c,a)&&(u?(0,r.validateAdditionalItems)(i,u):i.ok((0,n.validateArray)(i)))}};return cs.default=s,cs}var us={},Tp;function bx(){if(Tp)return us;Tp=1,Object.defineProperty(us,"__esModule",{value:!0});const t=we(),e=Ie(),r={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:o,max:s}})=>s===void 0?(0,t.str)`must contain at least ${o} valid item(s)`:(0,t.str)`must contain at least ${o} and no more than ${s} valid item(s)`,params:({params:{min:o,max:s}})=>s===void 0?(0,t._)`{minContains: ${o}}`:(0,t._)`{minContains: ${o}, maxContains: ${s}}`},code(o){const{gen:s,schema:i,parentSchema:a,data:l,it:c}=o;let u,h;const{minContains:p,maxContains:m}=a;c.opts.next?(u=p===void 0?1:p,h=m):u=1;const w=s.const("len",(0,t._)`${l}.length`);if(o.setParams({min:u,max:h}),h===void 0&&u===0){(0,e.checkStrictMode)(c,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(h!==void 0&&u>h){(0,e.checkStrictMode)(c,'"minContains" > "maxContains" is always invalid'),o.fail();return}if((0,e.alwaysValidSchema)(c,i)){let S=(0,t._)`${w} >= ${u}`;h!==void 0&&(S=(0,t._)`${S} && ${w} <= ${h}`),o.pass(S);return}c.items=!0;const E=s.name("valid");h===void 0&&u===1?v(E,()=>s.if(E,()=>s.break())):u===0?(s.let(E,!0),h!==void 0&&s.if((0,t._)`${l}.length > 0`,_)):(s.let(E,!1),_()),o.result(E,()=>o.reset());function _(){const S=s.name("_valid"),b=s.let("count",0);v(S,()=>s.if(S,()=>g(b)))}function v(S,b){s.forRange("i",0,w,y=>{o.subschema({keyword:"contains",dataProp:y,dataPropType:e.Type.Num,compositeRule:!0},S),b()})}function g(S){s.code((0,t._)`${S}++`),h===void 0?s.if((0,t._)`${S} >= ${u}`,()=>s.assign(E,!0).break()):(s.if((0,t._)`${S} > ${h}`,()=>s.assign(E,!1).break()),u===1?s.assign(E,!0):s.if((0,t._)`${S} >= ${u}`,()=>s.assign(E,!0)))}}};return us.default=r,us}var pl={},bp;function Cx(){return bp||(bp=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const e=we(),n=Ie(),r=Zt();t.error={message:({params:{property:l,depsCount:c,deps:u}})=>{const h=c===1?"property":"properties";return(0,e.str)`must have ${h} ${u} when property ${l} is present`},params:({params:{property:l,depsCount:c,deps:u,missingProperty:h}})=>(0,e._)`{property: ${l},
    missingProperty: ${h},
    depsCount: ${c},
    deps: ${u}}`};const o={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(l){const[c,u]=s(l);i(l,c),a(l,u)}};function s({schema:l}){const c={},u={};for(const h in l){if(h==="__proto__")continue;const p=Array.isArray(l[h])?c:u;p[h]=l[h]}return[c,u]}function i(l,c=l.schema){const{gen:u,data:h,it:p}=l;if(Object.keys(c).length===0)return;const m=u.let("missing");for(const w in c){const E=c[w];if(E.length===0)continue;const _=(0,r.propertyInData)(u,h,w,p.opts.ownProperties);l.setParams({property:w,depsCount:E.length,deps:E.join(", ")}),p.allErrors?u.if(_,()=>{for(const v of E)(0,r.checkReportMissingProp)(l,v)}):(u.if((0,e._)`${_} && (${(0,r.checkMissingProp)(l,E,m)})`),(0,r.reportMissingProp)(l,m),u.else())}}t.validatePropertyDeps=i;function a(l,c=l.schema){const{gen:u,data:h,keyword:p,it:m}=l,w=u.name("valid");for(const E in c)(0,n.alwaysValidSchema)(m,c[E])||(u.if((0,r.propertyInData)(u,h,E,m.opts.ownProperties),()=>{const _=l.subschema({keyword:p,schemaProp:E},w);l.mergeValidEvaluated(_,w)},()=>u.var(w,!0)),l.ok(w))}t.validateSchemaDeps=a,t.default=o})(pl)),pl}var ds={},Cp;function kx(){if(Cp)return ds;Cp=1,Object.defineProperty(ds,"__esModule",{value:!0});const t=we(),e=Ie(),r={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:o})=>(0,t._)`{propertyName: ${o.propertyName}}`},code(o){const{gen:s,schema:i,data:a,it:l}=o;if((0,e.alwaysValidSchema)(l,i))return;const c=s.name("valid");s.forIn("key",a,u=>{o.setParams({propertyName:u}),o.subschema({keyword:"propertyNames",data:u,dataTypes:["string"],propertyName:u,compositeRule:!0},c),s.if((0,t.not)(c),()=>{o.error(!0),l.allErrors||s.break()})}),o.ok(c)}};return ds.default=r,ds}var fs={},kp;function bv(){if(kp)return fs;kp=1,Object.defineProperty(fs,"__esModule",{value:!0});const t=Zt(),e=we(),n=Rn(),r=Ie(),s={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:i})=>(0,e._)`{additionalProperty: ${i.additionalProperty}}`},code(i){const{gen:a,schema:l,parentSchema:c,data:u,errsCount:h,it:p}=i;if(!h)throw new Error("ajv implementation error");const{allErrors:m,opts:w}=p;if(p.props=!0,w.removeAdditional!=="all"&&(0,r.alwaysValidSchema)(p,l))return;const E=(0,t.allSchemaProperties)(c.properties),_=(0,t.allSchemaProperties)(c.patternProperties);v(),i.ok((0,e._)`${h} === ${n.default.errors}`);function v(){a.forIn("key",u,C=>{!E.length&&!_.length?b(C):a.if(g(C),()=>b(C))})}function g(C){let k;if(E.length>8){const P=(0,r.schemaRefOrVal)(p,c.properties,"properties");k=(0,t.isOwnProperty)(a,P,C)}else E.length?k=(0,e.or)(...E.map(P=>(0,e._)`${C} === ${P}`)):k=e.nil;return _.length&&(k=(0,e.or)(k,..._.map(P=>(0,e._)`${(0,t.usePattern)(i,P)}.test(${C})`))),(0,e.not)(k)}function S(C){a.code((0,e._)`delete ${u}[${C}]`)}function b(C){if(w.removeAdditional==="all"||w.removeAdditional&&l===!1){S(C);return}if(l===!1){i.setParams({additionalProperty:C}),i.error(),m||a.break();return}if(typeof l=="object"&&!(0,r.alwaysValidSchema)(p,l)){const k=a.name("valid");w.removeAdditional==="failing"?(y(C,k,!1),a.if((0,e.not)(k),()=>{i.reset(),S(C)})):(y(C,k),m||a.if((0,e.not)(k),()=>a.break()))}}function y(C,k,P){const M={keyword:"additionalProperties",dataProp:C,dataPropType:r.Type.Str};P===!1&&Object.assign(M,{compositeRule:!0,createErrors:!1,allErrors:!1}),i.subschema(M,k)}}};return fs.default=s,fs}var hs={},Ip;function Ix(){if(Ip)return hs;Ip=1,Object.defineProperty(hs,"__esModule",{value:!0});const t=Na(),e=Zt(),n=Ie(),r=bv(),o={keyword:"properties",type:"object",schemaType:"object",code(s){const{gen:i,schema:a,parentSchema:l,data:c,it:u}=s;u.opts.removeAdditional==="all"&&l.additionalProperties===void 0&&r.default.code(new t.KeywordCxt(u,r.default,"additionalProperties"));const h=(0,e.allSchemaProperties)(a);for(const _ of h)u.definedProperties.add(_);u.opts.unevaluated&&h.length&&u.props!==!0&&(u.props=n.mergeEvaluated.props(i,(0,n.toHash)(h),u.props));const p=h.filter(_=>!(0,n.alwaysValidSchema)(u,a[_]));if(p.length===0)return;const m=i.name("valid");for(const _ of p)w(_)?E(_):(i.if((0,e.propertyInData)(i,c,_,u.opts.ownProperties)),E(_),u.allErrors||i.else().var(m,!0),i.endIf()),s.it.definedProperties.add(_),s.ok(m);function w(_){return u.opts.useDefaults&&!u.compositeRule&&a[_].default!==void 0}function E(_){s.subschema({keyword:"properties",schemaProp:_,dataProp:_},m)}}};return hs.default=o,hs}var ps={},Rp;function Rx(){if(Rp)return ps;Rp=1,Object.defineProperty(ps,"__esModule",{value:!0});const t=Zt(),e=we(),n=Ie(),r=Ie(),o={keyword:"patternProperties",type:"object",schemaType:"object",code(s){const{gen:i,schema:a,data:l,parentSchema:c,it:u}=s,{opts:h}=u,p=(0,t.allSchemaProperties)(a),m=p.filter(b=>(0,n.alwaysValidSchema)(u,a[b]));if(p.length===0||m.length===p.length&&(!u.opts.unevaluated||u.props===!0))return;const w=h.strictSchema&&!h.allowMatchingProperties&&c.properties,E=i.name("valid");u.props!==!0&&!(u.props instanceof e.Name)&&(u.props=(0,r.evaluatedPropsToName)(i,u.props));const{props:_}=u;v();function v(){for(const b of p)w&&g(b),u.allErrors?S(b):(i.var(E,!0),S(b),i.if(E))}function g(b){for(const y in w)new RegExp(b).test(y)&&(0,n.checkStrictMode)(u,`property ${y} matches pattern ${b} (use allowMatchingProperties)`)}function S(b){i.forIn("key",l,y=>{i.if((0,e._)`${(0,t.usePattern)(s,b)}.test(${y})`,()=>{const C=m.includes(b);C||s.subschema({keyword:"patternProperties",schemaProp:b,dataProp:y,dataPropType:r.Type.Str},E),u.opts.unevaluated&&_!==!0?i.assign((0,e._)`${_}[${y}]`,!0):!C&&!u.allErrors&&i.if((0,e.not)(E),()=>i.break())})})}}};return ps.default=o,ps}var ms={},$p;function $x(){if($p)return ms;$p=1,Object.defineProperty(ms,"__esModule",{value:!0});const t=Ie(),e={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(n){const{gen:r,schema:o,it:s}=n;if((0,t.alwaysValidSchema)(s,o)){n.fail();return}const i=r.name("valid");n.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),n.failResult(i,()=>n.reset(),()=>n.error())},error:{message:"must NOT be valid"}};return ms.default=e,ms}var gs={},Ap;function Ax(){if(Ap)return gs;Ap=1,Object.defineProperty(gs,"__esModule",{value:!0});const e={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Zt().validateUnion,error:{message:"must match a schema in anyOf"}};return gs.default=e,gs}var _s={},Pp;function Px(){if(Pp)return _s;Pp=1,Object.defineProperty(_s,"__esModule",{value:!0});const t=we(),e=Ie(),r={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:o})=>(0,t._)`{passingSchemas: ${o.passing}}`},code(o){const{gen:s,schema:i,parentSchema:a,it:l}=o;if(!Array.isArray(i))throw new Error("ajv implementation error");if(l.opts.discriminator&&a.discriminator)return;const c=i,u=s.let("valid",!1),h=s.let("passing",null),p=s.name("_valid");o.setParams({passing:h}),s.block(m),o.result(u,()=>o.reset(),()=>o.error(!0));function m(){c.forEach((w,E)=>{let _;(0,e.alwaysValidSchema)(l,w)?s.var(p,!0):_=o.subschema({keyword:"oneOf",schemaProp:E,compositeRule:!0},p),E>0&&s.if((0,t._)`${p} && ${u}`).assign(u,!1).assign(h,(0,t._)`[${h}, ${E}]`).else(),s.if(p,()=>{s.assign(u,!0),s.assign(h,E),_&&o.mergeEvaluated(_,t.Name)})})}}};return _s.default=r,_s}var ys={},Np;function Nx(){if(Np)return ys;Np=1,Object.defineProperty(ys,"__esModule",{value:!0});const t=Ie(),e={keyword:"allOf",schemaType:"array",code(n){const{gen:r,schema:o,it:s}=n;if(!Array.isArray(o))throw new Error("ajv implementation error");const i=r.name("valid");o.forEach((a,l)=>{if((0,t.alwaysValidSchema)(s,a))return;const c=n.subschema({keyword:"allOf",schemaProp:l},i);n.ok(i),n.mergeEvaluated(c)})}};return ys.default=e,ys}var vs={},Mp;function Mx(){if(Mp)return vs;Mp=1,Object.defineProperty(vs,"__esModule",{value:!0});const t=we(),e=Ie(),r={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:s})=>(0,t.str)`must match "${s.ifClause}" schema`,params:({params:s})=>(0,t._)`{failingKeyword: ${s.ifClause}}`},code(s){const{gen:i,parentSchema:a,it:l}=s;a.then===void 0&&a.else===void 0&&(0,e.checkStrictMode)(l,'"if" without "then" and "else" is ignored');const c=o(l,"then"),u=o(l,"else");if(!c&&!u)return;const h=i.let("valid",!0),p=i.name("_valid");if(m(),s.reset(),c&&u){const E=i.let("ifClause");s.setParams({ifClause:E}),i.if(p,w("then",E),w("else",E))}else c?i.if(p,w("then")):i.if((0,t.not)(p),w("else"));s.pass(h,()=>s.error(!0));function m(){const E=s.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},p);s.mergeEvaluated(E)}function w(E,_){return()=>{const v=s.subschema({keyword:E},p);i.assign(h,p),s.mergeValidEvaluated(v,h),_?i.assign(_,(0,t._)`${E}`):s.setParams({ifClause:E})}}}};function o(s,i){const a=s.schema[i];return a!==void 0&&!(0,e.alwaysValidSchema)(s,a)}return vs.default=r,vs}var ws={},xp;function xx(){if(xp)return ws;xp=1,Object.defineProperty(ws,"__esModule",{value:!0});const t=Ie(),e={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:n,parentSchema:r,it:o}){r.if===void 0&&(0,t.checkStrictMode)(o,`"${n}" without "if" is ignored`)}};return ws.default=e,ws}var Dp;function Dx(){if(Dp)return as;Dp=1,Object.defineProperty(as,"__esModule",{value:!0});const t=Ev(),e=Ex(),n=Tv(),r=Tx(),o=bx(),s=Cx(),i=kx(),a=bv(),l=Ix(),c=Rx(),u=$x(),h=Ax(),p=Px(),m=Nx(),w=Mx(),E=xx();function _(v=!1){const g=[u.default,h.default,p.default,m.default,w.default,E.default,i.default,a.default,s.default,l.default,c.default];return v?g.push(e.default,r.default):g.push(t.default,n.default),g.push(o.default),g}return as.default=_,as}var Ss={},Es={},Op;function Ox(){if(Op)return Es;Op=1,Object.defineProperty(Es,"__esModule",{value:!0});const t=we(),n={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:r})=>(0,t.str)`must match format "${r}"`,params:({schemaCode:r})=>(0,t._)`{format: ${r}}`},code(r,o){const{gen:s,data:i,$data:a,schema:l,schemaCode:c,it:u}=r,{opts:h,errSchemaPath:p,schemaEnv:m,self:w}=u;if(!h.validateFormats)return;a?E():_();function E(){const v=s.scopeValue("formats",{ref:w.formats,code:h.code.formats}),g=s.const("fDef",(0,t._)`${v}[${c}]`),S=s.let("fType"),b=s.let("format");s.if((0,t._)`typeof ${g} == "object" && !(${g} instanceof RegExp)`,()=>s.assign(S,(0,t._)`${g}.type || "string"`).assign(b,(0,t._)`${g}.validate`),()=>s.assign(S,(0,t._)`"string"`).assign(b,g)),r.fail$data((0,t.or)(y(),C()));function y(){return h.strictSchema===!1?t.nil:(0,t._)`${c} && !${b}`}function C(){const k=m.$async?(0,t._)`(${g}.async ? await ${b}(${i}) : ${b}(${i}))`:(0,t._)`${b}(${i})`,P=(0,t._)`(typeof ${b} == "function" ? ${k} : ${b}.test(${i}))`;return(0,t._)`${b} && ${b} !== true && ${S} === ${o} && !${P}`}}function _(){const v=w.formats[l];if(!v){y();return}if(v===!0)return;const[g,S,b]=C(v);g===o&&r.pass(k());function y(){if(h.strictSchema===!1){w.logger.warn(P());return}throw new Error(P());function P(){return`unknown format "${l}" ignored in schema at path "${p}"`}}function C(P){const M=P instanceof RegExp?(0,t.regexpCode)(P):h.code.formats?(0,t._)`${h.code.formats}${(0,t.getProperty)(l)}`:void 0,q=s.scopeValue("formats",{key:l,ref:P,code:M});return typeof P=="object"&&!(P instanceof RegExp)?[P.type||"string",P.validate,(0,t._)`${q}.validate`]:["string",P,q]}function k(){if(typeof v=="object"&&!(v instanceof RegExp)&&v.async){if(!m.$async)throw new Error("async format in sync schema");return(0,t._)`await ${b}(${i})`}return typeof S=="function"?(0,t._)`${b}(${i})`:(0,t._)`${b}.test(${i})`}}}};return Es.default=n,Es}var Up;function Ux(){if(Up)return Ss;Up=1,Object.defineProperty(Ss,"__esModule",{value:!0});const e=[Ox().default];return Ss.default=e,Ss}var On={},Lp;function Lx(){return Lp||(Lp=1,Object.defineProperty(On,"__esModule",{value:!0}),On.contentVocabulary=On.metadataVocabulary=void 0,On.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],On.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]),On}var qp;function qx(){if(qp)return Bo;qp=1,Object.defineProperty(Bo,"__esModule",{value:!0});const t=cx(),e=Sx(),n=Dx(),r=Ux(),o=Lx(),s=[t.default,e.default,(0,n.default)(),r.default,o.metadataVocabulary,o.contentVocabulary];return Bo.default=s,Bo}var Ts={},Vr={},Fp;function Fx(){if(Fp)return Vr;Fp=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.DiscrError=void 0;var t;return(function(e){e.Tag="tag",e.Mapping="mapping"})(t||(Vr.DiscrError=t={})),Vr}var Vp;function Vx(){if(Vp)return Ts;Vp=1,Object.defineProperty(Ts,"__esModule",{value:!0});const t=we(),e=Fx(),n=Au(),r=Ma(),o=Ie(),i={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:a,tagName:l}})=>a===e.DiscrError.Tag?`tag "${l}" must be string`:`value of tag "${l}" must be in oneOf`,params:({params:{discrError:a,tag:l,tagName:c}})=>(0,t._)`{error: ${a}, tag: ${c}, tagValue: ${l}}`},code(a){const{gen:l,data:c,schema:u,parentSchema:h,it:p}=a,{oneOf:m}=h;if(!p.opts.discriminator)throw new Error("discriminator: requires discriminator option");const w=u.propertyName;if(typeof w!="string")throw new Error("discriminator: requires propertyName");if(u.mapping)throw new Error("discriminator: mapping is not supported");if(!m)throw new Error("discriminator: requires oneOf keyword");const E=l.let("valid",!1),_=l.const("tag",(0,t._)`${c}${(0,t.getProperty)(w)}`);l.if((0,t._)`typeof ${_} == "string"`,()=>v(),()=>a.error(!1,{discrError:e.DiscrError.Tag,tag:_,tagName:w})),a.ok(E);function v(){const b=S();l.if(!1);for(const y in b)l.elseIf((0,t._)`${_} === ${y}`),l.assign(E,g(b[y]));l.else(),a.error(!1,{discrError:e.DiscrError.Mapping,tag:_,tagName:w}),l.endIf()}function g(b){const y=l.name("valid"),C=a.subschema({keyword:"oneOf",schemaProp:b},y);return a.mergeEvaluated(C,t.Name),y}function S(){var b;const y={},C=P(h);let k=!0;for(let D=0;D<m.length;D++){let G=m[D];if(G?.$ref&&!(0,o.schemaHasRulesButRef)(G,p.self.RULES)){const K=G.$ref;if(G=n.resolveRef.call(p.self,p.schemaEnv.root,p.baseId,K),G instanceof n.SchemaEnv&&(G=G.schema),G===void 0)throw new r.default(p.opts.uriResolver,p.baseId,K)}const B=(b=G?.properties)===null||b===void 0?void 0:b[w];if(typeof B!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${w}"`);k=k&&(C||P(G)),M(B,D)}if(!k)throw new Error(`discriminator: "${w}" must be required`);return y;function P({required:D}){return Array.isArray(D)&&D.includes(w)}function M(D,G){if(D.const)q(D.const,G);else if(D.enum)for(const B of D.enum)q(B,G);else throw new Error(`discriminator: "properties/${w}" must have "const" or "enum"`)}function q(D,G){if(typeof D!="string"||D in y)throw new Error(`discriminator: "${w}" values must be unique strings`);y[D]=G}}}};return Ts.default=i,Ts}const zx="http://json-schema.org/draft-07/schema#",Hx="http://json-schema.org/draft-07/schema#",Gx="Core schema meta-schema",Bx={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},Jx=["object","boolean"],Kx={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},Wx={$schema:zx,$id:Hx,title:Gx,definitions:Bx,type:Jx,properties:Kx,default:!0};var zp;function Zx(){return zp||(zp=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=e.Ajv=void 0;const n=ix(),r=qx(),o=Vx(),s=Wx,i=["/properties"],a="http://json-schema.org/draft-07/schema";class l extends n.default{_addVocabularies(){super._addVocabularies(),r.default.forEach(w=>this.addVocabulary(w)),this.opts.discriminator&&this.addKeyword(o.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const w=this.opts.$data?this.$dataMetaSchema(s,i):s;this.addMetaSchema(w,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}e.Ajv=l,t.exports=e=l,t.exports.Ajv=l,Object.defineProperty(e,"__esModule",{value:!0}),e.default=l;var c=Na();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var u=we();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var h=$u();Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return h.default}});var p=Ma();Object.defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return p.default}})})(Fo,Fo.exports)),Fo.exports}var Yx=Zx();const Xx=_v(Yx);var bs={exports:{}},ml={},Hp;function Qx(){return Hp||(Hp=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatNames=t.fastFormats=t.fullFormats=void 0;function e(D,G){return{validate:D,compare:G}}t.fullFormats={date:e(s,i),time:e(l(!0),c),"date-time":e(p(!0),m),"iso-time":e(l(),u),"iso-date-time":e(p(),w),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:v,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:q,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:S,int32:{type:"number",validate:C},int64:{type:"number",validate:k},float:{type:"number",validate:P},double:{type:"number",validate:P},password:!0,binary:!0},t.fastFormats={...t.fullFormats,date:e(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,i),time:e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,c),"date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,m),"iso-time":e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,u),"iso-date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,w),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},t.formatNames=Object.keys(t.fullFormats);function n(D){return D%4===0&&(D%100!==0||D%400===0)}const r=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o=[0,31,28,31,30,31,30,31,31,30,31,30,31];function s(D){const G=r.exec(D);if(!G)return!1;const B=+G[1],K=+G[2],oe=+G[3];return K>=1&&K<=12&&oe>=1&&oe<=(K===2&&n(B)?29:o[K])}function i(D,G){if(D&&G)return D>G?1:D<G?-1:0}const a=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function l(D){return function(B){const K=a.exec(B);if(!K)return!1;const oe=+K[1],Se=+K[2],be=+K[3],ee=K[4],ge=K[5]==="-"?-1:1,V=+(K[6]||0),$=+(K[7]||0);if(V>23||$>59||D&&!ee)return!1;if(oe<=23&&Se<=59&&be<60)return!0;const O=Se-$*ge,A=oe-V*ge-(O<0?1:0);return(A===23||A===-1)&&(O===59||O===-1)&&be<61}}function c(D,G){if(!(D&&G))return;const B=new Date("2020-01-01T"+D).valueOf(),K=new Date("2020-01-01T"+G).valueOf();if(B&&K)return B-K}function u(D,G){if(!(D&&G))return;const B=a.exec(D),K=a.exec(G);if(B&&K)return D=B[1]+B[2]+B[3],G=K[1]+K[2]+K[3],D>G?1:D<G?-1:0}const h=/t|\s/i;function p(D){const G=l(D);return function(K){const oe=K.split(h);return oe.length===2&&s(oe[0])&&G(oe[1])}}function m(D,G){if(!(D&&G))return;const B=new Date(D).valueOf(),K=new Date(G).valueOf();if(B&&K)return B-K}function w(D,G){if(!(D&&G))return;const[B,K]=D.split(h),[oe,Se]=G.split(h),be=i(B,oe);if(be!==void 0)return be||c(K,Se)}const E=/\/|:/,_=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function v(D){return E.test(D)&&_.test(D)}const g=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function S(D){return g.lastIndex=0,g.test(D)}const b=-2147483648,y=2**31-1;function C(D){return Number.isInteger(D)&&D<=y&&D>=b}function k(D){return Number.isInteger(D)}function P(){return!0}const M=/[^\\]\\Z/;function q(D){if(M.test(D))return!1;try{return new RegExp(D),!0}catch{return!1}}})(ml)),ml}var gl={},Cs={exports:{}},_l={},on={},Un={},yl={},vl={},wl={},Gp;function Ki(){return Gp||(Gp=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class e{}t._CodeOrName=e,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends e{constructor(g){if(super(),!t.IDENTIFIER.test(g))throw new Error("CodeGen: name must be a valid identifier");this.str=g}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=n;class r extends e{constructor(g){super(),this._items=typeof g=="string"?[g]:g}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const g=this._items[0];return g===""||g==='""'}get str(){var g;return(g=this._str)!==null&&g!==void 0?g:this._str=this._items.reduce((S,b)=>`${S}${b}`,"")}get names(){var g;return(g=this._names)!==null&&g!==void 0?g:this._names=this._items.reduce((S,b)=>(b instanceof n&&(S[b.str]=(S[b.str]||0)+1),S),{})}}t._Code=r,t.nil=new r("");function o(v,...g){const S=[v[0]];let b=0;for(;b<g.length;)a(S,g[b]),S.push(v[++b]);return new r(S)}t._=o;const s=new r("+");function i(v,...g){const S=[m(v[0])];let b=0;for(;b<g.length;)S.push(s),a(S,g[b]),S.push(s,m(v[++b]));return l(S),new r(S)}t.str=i;function a(v,g){g instanceof r?v.push(...g._items):g instanceof n?v.push(g):v.push(h(g))}t.addCodeArg=a;function l(v){let g=1;for(;g<v.length-1;){if(v[g]===s){const S=c(v[g-1],v[g+1]);if(S!==void 0){v.splice(g-1,3,S);continue}v[g++]="+"}g++}}function c(v,g){if(g==='""')return v;if(v==='""')return g;if(typeof v=="string")return g instanceof n||v[v.length-1]!=='"'?void 0:typeof g!="string"?`${v.slice(0,-1)}${g}"`:g[0]==='"'?v.slice(0,-1)+g.slice(1):void 0;if(typeof g=="string"&&g[0]==='"'&&!(v instanceof n))return`"${v}${g.slice(1)}`}function u(v,g){return g.emptyStr()?v:v.emptyStr()?g:i`${v}${g}`}t.strConcat=u;function h(v){return typeof v=="number"||typeof v=="boolean"||v===null?v:m(Array.isArray(v)?v.join(","):v)}function p(v){return new r(m(v))}t.stringify=p;function m(v){return JSON.stringify(v).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.safeStringify=m;function w(v){return typeof v=="string"&&t.IDENTIFIER.test(v)?new r(`.${v}`):o`[${v}]`}t.getProperty=w;function E(v){if(typeof v=="string"&&t.IDENTIFIER.test(v))return new r(`${v}`);throw new Error(`CodeGen: invalid export name: ${v}, use explicit $id name mapping`)}t.getEsmExportName=E;function _(v){return new r(v.toString())}t.regexpCode=_})(wl)),wl}var Sl={},Bp;function Jp(){return Bp||(Bp=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const e=Ki();class n extends Error{constructor(c){super(`CodeGen: "code" for ${c} not defined`),this.value=c.value}}var r;(function(l){l[l.Started=0]="Started",l[l.Completed=1]="Completed"})(r||(t.UsedValueState=r={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class o{constructor({prefixes:c,parent:u}={}){this._names={},this._prefixes=c,this._parent=u}toName(c){return c instanceof e.Name?c:this.name(c)}name(c){return new e.Name(this._newName(c))}_newName(c){const u=this._names[c]||this._nameGroup(c);return`${c}${u.index++}`}_nameGroup(c){var u,h;if(!((h=(u=this._parent)===null||u===void 0?void 0:u._prefixes)===null||h===void 0)&&h.has(c)||this._prefixes&&!this._prefixes.has(c))throw new Error(`CodeGen: prefix "${c}" is not allowed in this scope`);return this._names[c]={prefix:c,index:0}}}t.Scope=o;class s extends e.Name{constructor(c,u){super(u),this.prefix=c}setValue(c,{property:u,itemIndex:h}){this.value=c,this.scopePath=(0,e._)`.${new e.Name(u)}[${h}]`}}t.ValueScopeName=s;const i=(0,e._)`\n`;class a extends o{constructor(c){super(c),this._values={},this._scope=c.scope,this.opts={...c,_n:c.lines?i:e.nil}}get(){return this._scope}name(c){return new s(c,this._newName(c))}value(c,u){var h;if(u.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const p=this.toName(c),{prefix:m}=p,w=(h=u.key)!==null&&h!==void 0?h:u.ref;let E=this._values[m];if(E){const g=E.get(w);if(g)return g}else E=this._values[m]=new Map;E.set(w,p);const _=this._scope[m]||(this._scope[m]=[]),v=_.length;return _[v]=u.ref,p.setValue(u,{property:m,itemIndex:v}),p}getValue(c,u){const h=this._values[c];if(h)return h.get(u)}scopeRefs(c,u=this._values){return this._reduceValues(u,h=>{if(h.scopePath===void 0)throw new Error(`CodeGen: name "${h}" has no value`);return(0,e._)`${c}${h.scopePath}`})}scopeCode(c=this._values,u,h){return this._reduceValues(c,p=>{if(p.value===void 0)throw new Error(`CodeGen: name "${p}" has no value`);return p.value.code},u,h)}_reduceValues(c,u,h={},p){let m=e.nil;for(const w in c){const E=c[w];if(!E)continue;const _=h[w]=h[w]||new Map;E.forEach(v=>{if(_.has(v))return;_.set(v,r.Started);let g=u(v);if(g){const S=this.opts.es5?t.varKinds.var:t.varKinds.const;m=(0,e._)`${m}${S} ${v} = ${g};${this.opts._n}`}else if(g=p?.(v))m=(0,e._)`${m}${g}${this.opts._n}`;else throw new n(v);_.set(v,r.Completed)})}return m}}t.ValueScope=a})(Sl)),Sl}var Kp;function ve(){return Kp||(Kp=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const e=Ki(),n=Jp();var r=Ki();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}});var o=Jp();Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return o.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return o.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return o.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return o.varKinds}}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class s{optimizeNodes(){return this}optimizeNames(T,I){return this}}class i extends s{constructor(T,I,x){super(),this.varKind=T,this.name=I,this.rhs=x}render({es5:T,_n:I}){const x=T?n.varKinds.var:this.varKind,W=this.rhs===void 0?"":` = ${this.rhs}`;return`${x} ${this.name}${W};`+I}optimizeNames(T,I){if(T[this.name.str])return this.rhs&&(this.rhs=K(this.rhs,T,I)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class a extends s{constructor(T,I,x){super(),this.lhs=T,this.rhs=I,this.sideEffects=x}render({_n:T}){return`${this.lhs} = ${this.rhs};`+T}optimizeNames(T,I){if(!(this.lhs instanceof e.Name&&!T[this.lhs.str]&&!this.sideEffects))return this.rhs=K(this.rhs,T,I),this}get names(){const T=this.lhs instanceof e.Name?{}:{...this.lhs.names};return B(T,this.rhs)}}class l extends a{constructor(T,I,x,W){super(T,x,W),this.op=I}render({_n:T}){return`${this.lhs} ${this.op}= ${this.rhs};`+T}}class c extends s{constructor(T){super(),this.label=T,this.names={}}render({_n:T}){return`${this.label}:`+T}}class u extends s{constructor(T){super(),this.label=T,this.names={}}render({_n:T}){return`break${this.label?` ${this.label}`:""};`+T}}class h extends s{constructor(T){super(),this.error=T}render({_n:T}){return`throw ${this.error};`+T}get names(){return this.error.names}}class p extends s{constructor(T){super(),this.code=T}render({_n:T}){return`${this.code};`+T}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(T,I){return this.code=K(this.code,T,I),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class m extends s{constructor(T=[]){super(),this.nodes=T}render(T){return this.nodes.reduce((I,x)=>I+x.render(T),"")}optimizeNodes(){const{nodes:T}=this;let I=T.length;for(;I--;){const x=T[I].optimizeNodes();Array.isArray(x)?T.splice(I,1,...x):x?T[I]=x:T.splice(I,1)}return T.length>0?this:void 0}optimizeNames(T,I){const{nodes:x}=this;let W=x.length;for(;W--;){const Z=x[W];Z.optimizeNames(T,I)||(oe(T,Z.names),x.splice(W,1))}return x.length>0?this:void 0}get names(){return this.nodes.reduce((T,I)=>G(T,I.names),{})}}class w extends m{render(T){return"{"+T._n+super.render(T)+"}"+T._n}}class E extends m{}class _ extends w{}_.kind="else";class v extends w{constructor(T,I){super(I),this.condition=T}render(T){let I=`if(${this.condition})`+super.render(T);return this.else&&(I+="else "+this.else.render(T)),I}optimizeNodes(){super.optimizeNodes();const T=this.condition;if(T===!0)return this.nodes;let I=this.else;if(I){const x=I.optimizeNodes();I=this.else=Array.isArray(x)?new _(x):x}if(I)return T===!1?I instanceof v?I:I.nodes:this.nodes.length?this:new v(Se(T),I instanceof v?[I]:I.nodes);if(!(T===!1||!this.nodes.length))return this}optimizeNames(T,I){var x;if(this.else=(x=this.else)===null||x===void 0?void 0:x.optimizeNames(T,I),!!(super.optimizeNames(T,I)||this.else))return this.condition=K(this.condition,T,I),this}get names(){const T=super.names;return B(T,this.condition),this.else&&G(T,this.else.names),T}}v.kind="if";class g extends w{}g.kind="for";class S extends g{constructor(T){super(),this.iteration=T}render(T){return`for(${this.iteration})`+super.render(T)}optimizeNames(T,I){if(super.optimizeNames(T,I))return this.iteration=K(this.iteration,T,I),this}get names(){return G(super.names,this.iteration.names)}}class b extends g{constructor(T,I,x,W){super(),this.varKind=T,this.name=I,this.from=x,this.to=W}render(T){const I=T.es5?n.varKinds.var:this.varKind,{name:x,from:W,to:Z}=this;return`for(${I} ${x}=${W}; ${x}<${Z}; ${x}++)`+super.render(T)}get names(){const T=B(super.names,this.from);return B(T,this.to)}}class y extends g{constructor(T,I,x,W){super(),this.loop=T,this.varKind=I,this.name=x,this.iterable=W}render(T){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(T)}optimizeNames(T,I){if(super.optimizeNames(T,I))return this.iterable=K(this.iterable,T,I),this}get names(){return G(super.names,this.iterable.names)}}class C extends w{constructor(T,I,x){super(),this.name=T,this.args=I,this.async=x}render(T){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(T)}}C.kind="func";class k extends m{render(T){return"return "+super.render(T)}}k.kind="return";class P extends w{render(T){let I="try"+super.render(T);return this.catch&&(I+=this.catch.render(T)),this.finally&&(I+=this.finally.render(T)),I}optimizeNodes(){var T,I;return super.optimizeNodes(),(T=this.catch)===null||T===void 0||T.optimizeNodes(),(I=this.finally)===null||I===void 0||I.optimizeNodes(),this}optimizeNames(T,I){var x,W;return super.optimizeNames(T,I),(x=this.catch)===null||x===void 0||x.optimizeNames(T,I),(W=this.finally)===null||W===void 0||W.optimizeNames(T,I),this}get names(){const T=super.names;return this.catch&&G(T,this.catch.names),this.finally&&G(T,this.finally.names),T}}class M extends w{constructor(T){super(),this.error=T}render(T){return`catch(${this.error})`+super.render(T)}}M.kind="catch";class q extends w{render(T){return"finally"+super.render(T)}}q.kind="finally";class D{constructor(T,I={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...I,_n:I.lines?`
`:""},this._extScope=T,this._scope=new n.Scope({parent:T}),this._nodes=[new E]}toString(){return this._root.render(this.opts)}name(T){return this._scope.name(T)}scopeName(T){return this._extScope.name(T)}scopeValue(T,I){const x=this._extScope.value(T,I);return(this._values[x.prefix]||(this._values[x.prefix]=new Set)).add(x),x}getScopeValue(T,I){return this._extScope.getValue(T,I)}scopeRefs(T){return this._extScope.scopeRefs(T,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(T,I,x,W){const Z=this._scope.toName(I);return x!==void 0&&W&&(this._constants[Z.str]=x),this._leafNode(new i(T,Z,x)),Z}const(T,I,x){return this._def(n.varKinds.const,T,I,x)}let(T,I,x){return this._def(n.varKinds.let,T,I,x)}var(T,I,x){return this._def(n.varKinds.var,T,I,x)}assign(T,I,x){return this._leafNode(new a(T,I,x))}add(T,I){return this._leafNode(new l(T,t.operators.ADD,I))}code(T){return typeof T=="function"?T():T!==e.nil&&this._leafNode(new p(T)),this}object(...T){const I=["{"];for(const[x,W]of T)I.length>1&&I.push(","),I.push(x),(x!==W||this.opts.es5)&&(I.push(":"),(0,e.addCodeArg)(I,W));return I.push("}"),new e._Code(I)}if(T,I,x){if(this._blockNode(new v(T)),I&&x)this.code(I).else().code(x).endIf();else if(I)this.code(I).endIf();else if(x)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(T){return this._elseNode(new v(T))}else(){return this._elseNode(new _)}endIf(){return this._endBlockNode(v,_)}_for(T,I){return this._blockNode(T),I&&this.code(I).endFor(),this}for(T,I){return this._for(new S(T),I)}forRange(T,I,x,W,Z=this.opts.es5?n.varKinds.var:n.varKinds.let){const se=this._scope.toName(T);return this._for(new b(Z,se,I,x),()=>W(se))}forOf(T,I,x,W=n.varKinds.const){const Z=this._scope.toName(T);if(this.opts.es5){const se=I instanceof e.Name?I:this.var("_arr",I);return this.forRange("_i",0,(0,e._)`${se}.length`,re=>{this.var(Z,(0,e._)`${se}[${re}]`),x(Z)})}return this._for(new y("of",W,Z,I),()=>x(Z))}forIn(T,I,x,W=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(T,(0,e._)`Object.keys(${I})`,x);const Z=this._scope.toName(T);return this._for(new y("in",W,Z,I),()=>x(Z))}endFor(){return this._endBlockNode(g)}label(T){return this._leafNode(new c(T))}break(T){return this._leafNode(new u(T))}return(T){const I=new k;if(this._blockNode(I),this.code(T),I.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(k)}try(T,I,x){if(!I&&!x)throw new Error('CodeGen: "try" without "catch" and "finally"');const W=new P;if(this._blockNode(W),this.code(T),I){const Z=this.name("e");this._currNode=W.catch=new M(Z),I(Z)}return x&&(this._currNode=W.finally=new q,this.code(x)),this._endBlockNode(M,q)}throw(T){return this._leafNode(new h(T))}block(T,I){return this._blockStarts.push(this._nodes.length),T&&this.code(T).endBlock(I),this}endBlock(T){const I=this._blockStarts.pop();if(I===void 0)throw new Error("CodeGen: not in self-balancing block");const x=this._nodes.length-I;if(x<0||T!==void 0&&x!==T)throw new Error(`CodeGen: wrong number of nodes: ${x} vs ${T} expected`);return this._nodes.length=I,this}func(T,I=e.nil,x,W){return this._blockNode(new C(T,I,x)),W&&this.code(W).endFunc(),this}endFunc(){return this._endBlockNode(C)}optimize(T=1){for(;T-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(T){return this._currNode.nodes.push(T),this}_blockNode(T){this._currNode.nodes.push(T),this._nodes.push(T)}_endBlockNode(T,I){const x=this._currNode;if(x instanceof T||I&&x instanceof I)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${I?`${T.kind}/${I.kind}`:T.kind}"`)}_elseNode(T){const I=this._currNode;if(!(I instanceof v))throw new Error('CodeGen: "else" without "if"');return this._currNode=I.else=T,this}get _root(){return this._nodes[0]}get _currNode(){const T=this._nodes;return T[T.length-1]}set _currNode(T){const I=this._nodes;I[I.length-1]=T}}t.CodeGen=D;function G(A,T){for(const I in T)A[I]=(A[I]||0)+(T[I]||0);return A}function B(A,T){return T instanceof e._CodeOrName?G(A,T.names):A}function K(A,T,I){if(A instanceof e.Name)return x(A);if(!W(A))return A;return new e._Code(A._items.reduce((Z,se)=>(se instanceof e.Name&&(se=x(se)),se instanceof e._Code?Z.push(...se._items):Z.push(se),Z),[]));function x(Z){const se=I[Z.str];return se===void 0||T[Z.str]!==1?Z:(delete T[Z.str],se)}function W(Z){return Z instanceof e._Code&&Z._items.some(se=>se instanceof e.Name&&T[se.str]===1&&I[se.str]!==void 0)}}function oe(A,T){for(const I in T)A[I]=(A[I]||0)-(T[I]||0)}function Se(A){return typeof A=="boolean"||typeof A=="number"||A===null?!A:(0,e._)`!${O(A)}`}t.not=Se;const be=$(t.operators.AND);function ee(...A){return A.reduce(be)}t.and=ee;const ge=$(t.operators.OR);function V(...A){return A.reduce(ge)}t.or=V;function $(A){return(T,I)=>T===e.nil?I:I===e.nil?T:(0,e._)`${O(T)} ${A} ${O(I)}`}function O(A){return A instanceof e.Name?A:(0,e._)`(${A})`}})(vl)),vl}var ye={},Wp;function Re(){if(Wp)return ye;Wp=1,Object.defineProperty(ye,"__esModule",{value:!0}),ye.checkStrictMode=ye.getErrorPath=ye.Type=ye.useFunc=ye.setEvaluated=ye.evaluatedPropsToName=ye.mergeEvaluated=ye.eachItem=ye.unescapeJsonPointer=ye.escapeJsonPointer=ye.escapeFragment=ye.unescapeFragment=ye.schemaRefOrVal=ye.schemaHasRulesButRef=ye.schemaHasRules=ye.checkUnknownRules=ye.alwaysValidSchema=ye.toHash=void 0;const t=ve(),e=Ki();function n(y){const C={};for(const k of y)C[k]=!0;return C}ye.toHash=n;function r(y,C){return typeof C=="boolean"?C:Object.keys(C).length===0?!0:(o(y,C),!s(C,y.self.RULES.all))}ye.alwaysValidSchema=r;function o(y,C=y.schema){const{opts:k,self:P}=y;if(!k.strictSchema||typeof C=="boolean")return;const M=P.RULES.keywords;for(const q in C)M[q]||b(y,`unknown keyword: "${q}"`)}ye.checkUnknownRules=o;function s(y,C){if(typeof y=="boolean")return!y;for(const k in y)if(C[k])return!0;return!1}ye.schemaHasRules=s;function i(y,C){if(typeof y=="boolean")return!y;for(const k in y)if(k!=="$ref"&&C.all[k])return!0;return!1}ye.schemaHasRulesButRef=i;function a({topSchemaRef:y,schemaPath:C},k,P,M){if(!M){if(typeof k=="number"||typeof k=="boolean")return k;if(typeof k=="string")return(0,t._)`${k}`}return(0,t._)`${y}${C}${(0,t.getProperty)(P)}`}ye.schemaRefOrVal=a;function l(y){return h(decodeURIComponent(y))}ye.unescapeFragment=l;function c(y){return encodeURIComponent(u(y))}ye.escapeFragment=c;function u(y){return typeof y=="number"?`${y}`:y.replace(/~/g,"~0").replace(/\//g,"~1")}ye.escapeJsonPointer=u;function h(y){return y.replace(/~1/g,"/").replace(/~0/g,"~")}ye.unescapeJsonPointer=h;function p(y,C){if(Array.isArray(y))for(const k of y)C(k);else C(y)}ye.eachItem=p;function m({mergeNames:y,mergeToName:C,mergeValues:k,resultToName:P}){return(M,q,D,G)=>{const B=D===void 0?q:D instanceof t.Name?(q instanceof t.Name?y(M,q,D):C(M,q,D),D):q instanceof t.Name?(C(M,D,q),q):k(q,D);return G===t.Name&&!(B instanceof t.Name)?P(M,B):B}}ye.mergeEvaluated={props:m({mergeNames:(y,C,k)=>y.if((0,t._)`${k} !== true && ${C} !== undefined`,()=>{y.if((0,t._)`${C} === true`,()=>y.assign(k,!0),()=>y.assign(k,(0,t._)`${k} || {}`).code((0,t._)`Object.assign(${k}, ${C})`))}),mergeToName:(y,C,k)=>y.if((0,t._)`${k} !== true`,()=>{C===!0?y.assign(k,!0):(y.assign(k,(0,t._)`${k} || {}`),E(y,k,C))}),mergeValues:(y,C)=>y===!0?!0:{...y,...C},resultToName:w}),items:m({mergeNames:(y,C,k)=>y.if((0,t._)`${k} !== true && ${C} !== undefined`,()=>y.assign(k,(0,t._)`${C} === true ? true : ${k} > ${C} ? ${k} : ${C}`)),mergeToName:(y,C,k)=>y.if((0,t._)`${k} !== true`,()=>y.assign(k,C===!0?!0:(0,t._)`${k} > ${C} ? ${k} : ${C}`)),mergeValues:(y,C)=>y===!0?!0:Math.max(y,C),resultToName:(y,C)=>y.var("items",C)})};function w(y,C){if(C===!0)return y.var("props",!0);const k=y.var("props",(0,t._)`{}`);return C!==void 0&&E(y,k,C),k}ye.evaluatedPropsToName=w;function E(y,C,k){Object.keys(k).forEach(P=>y.assign((0,t._)`${C}${(0,t.getProperty)(P)}`,!0))}ye.setEvaluated=E;const _={};function v(y,C){return y.scopeValue("func",{ref:C,code:_[C.code]||(_[C.code]=new e._Code(C.code))})}ye.useFunc=v;var g;(function(y){y[y.Num=0]="Num",y[y.Str=1]="Str"})(g||(ye.Type=g={}));function S(y,C,k){if(y instanceof t.Name){const P=C===g.Num;return k?P?(0,t._)`"[" + ${y} + "]"`:(0,t._)`"['" + ${y} + "']"`:P?(0,t._)`"/" + ${y}`:(0,t._)`"/" + ${y}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return k?(0,t.getProperty)(y).toString():"/"+u(y)}ye.getErrorPath=S;function b(y,C,k=y.opts.strictSchema){if(k){if(C=`strict mode: ${C}`,k===!0)throw new Error(C);y.self.logger.warn(C)}}return ye.checkStrictMode=b,ye}var ks={},Zp;function $n(){if(Zp)return ks;Zp=1,Object.defineProperty(ks,"__esModule",{value:!0});const t=ve(),e={data:new t.Name("data"),valCxt:new t.Name("valCxt"),instancePath:new t.Name("instancePath"),parentData:new t.Name("parentData"),parentDataProperty:new t.Name("parentDataProperty"),rootData:new t.Name("rootData"),dynamicAnchors:new t.Name("dynamicAnchors"),vErrors:new t.Name("vErrors"),errors:new t.Name("errors"),this:new t.Name("this"),self:new t.Name("self"),scope:new t.Name("scope"),json:new t.Name("json"),jsonPos:new t.Name("jsonPos"),jsonLen:new t.Name("jsonLen"),jsonPart:new t.Name("jsonPart")};return ks.default=e,ks}var Yp;function xa(){return Yp||(Yp=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const e=ve(),n=Re(),r=$n();t.keywordError={message:({keyword:_})=>(0,e.str)`must pass "${_}" keyword validation`},t.keyword$DataError={message:({keyword:_,schemaType:v})=>v?(0,e.str)`"${_}" keyword must be ${v} ($data)`:(0,e.str)`"${_}" keyword is invalid ($data)`};function o(_,v=t.keywordError,g,S){const{it:b}=_,{gen:y,compositeRule:C,allErrors:k}=b,P=h(_,v,g);S??(C||k)?l(y,P):c(b,(0,e._)`[${P}]`)}t.reportError=o;function s(_,v=t.keywordError,g){const{it:S}=_,{gen:b,compositeRule:y,allErrors:C}=S,k=h(_,v,g);l(b,k),y||C||c(S,r.default.vErrors)}t.reportExtraError=s;function i(_,v){_.assign(r.default.errors,v),_.if((0,e._)`${r.default.vErrors} !== null`,()=>_.if(v,()=>_.assign((0,e._)`${r.default.vErrors}.length`,v),()=>_.assign(r.default.vErrors,null)))}t.resetErrorsCount=i;function a({gen:_,keyword:v,schemaValue:g,data:S,errsCount:b,it:y}){if(b===void 0)throw new Error("ajv implementation error");const C=_.name("err");_.forRange("i",b,r.default.errors,k=>{_.const(C,(0,e._)`${r.default.vErrors}[${k}]`),_.if((0,e._)`${C}.instancePath === undefined`,()=>_.assign((0,e._)`${C}.instancePath`,(0,e.strConcat)(r.default.instancePath,y.errorPath))),_.assign((0,e._)`${C}.schemaPath`,(0,e.str)`${y.errSchemaPath}/${v}`),y.opts.verbose&&(_.assign((0,e._)`${C}.schema`,g),_.assign((0,e._)`${C}.data`,S))})}t.extendErrors=a;function l(_,v){const g=_.const("err",v);_.if((0,e._)`${r.default.vErrors} === null`,()=>_.assign(r.default.vErrors,(0,e._)`[${g}]`),(0,e._)`${r.default.vErrors}.push(${g})`),_.code((0,e._)`${r.default.errors}++`)}function c(_,v){const{gen:g,validateName:S,schemaEnv:b}=_;b.$async?g.throw((0,e._)`new ${_.ValidationError}(${v})`):(g.assign((0,e._)`${S}.errors`,v),g.return(!1))}const u={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function h(_,v,g){const{createErrors:S}=_.it;return S===!1?(0,e._)`{}`:p(_,v,g)}function p(_,v,g={}){const{gen:S,it:b}=_,y=[m(b,g),w(_,g)];return E(_,v,y),S.object(...y)}function m({errorPath:_},{instancePath:v}){const g=v?(0,e.str)`${_}${(0,n.getErrorPath)(v,n.Type.Str)}`:_;return[r.default.instancePath,(0,e.strConcat)(r.default.instancePath,g)]}function w({keyword:_,it:{errSchemaPath:v}},{schemaPath:g,parentSchema:S}){let b=S?v:(0,e.str)`${v}/${_}`;return g&&(b=(0,e.str)`${b}${(0,n.getErrorPath)(g,n.Type.Str)}`),[u.schemaPath,b]}function E(_,{params:v,message:g},S){const{keyword:b,data:y,schemaValue:C,it:k}=_,{opts:P,propertyName:M,topSchemaRef:q,schemaPath:D}=k;S.push([u.keyword,b],[u.params,typeof v=="function"?v(_):v||(0,e._)`{}`]),P.messages&&S.push([u.message,typeof g=="function"?g(_):g]),P.verbose&&S.push([u.schema,C],[u.parentSchema,(0,e._)`${q}${D}`],[r.default.data,y]),M&&S.push([u.propertyName,M])}})(yl)),yl}var Xp;function jx(){if(Xp)return Un;Xp=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.boolOrEmptySchema=Un.topBoolOrEmptySchema=void 0;const t=xa(),e=ve(),n=$n(),r={message:"boolean schema is false"};function o(a){const{gen:l,schema:c,validateName:u}=a;c===!1?i(a,!1):typeof c=="object"&&c.$async===!0?l.return(n.default.data):(l.assign((0,e._)`${u}.errors`,null),l.return(!0))}Un.topBoolOrEmptySchema=o;function s(a,l){const{gen:c,schema:u}=a;u===!1?(c.var(l,!1),i(a)):c.var(l,!0)}Un.boolOrEmptySchema=s;function i(a,l){const{gen:c,data:u}=a,h={gen:c,keyword:"false schema",data:u,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:a};(0,t.reportError)(h,r,void 0,l)}return Un}var st={},Ln={},Qp;function Cv(){if(Qp)return Ln;Qp=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.getRules=Ln.isJSONType=void 0;const t=["string","number","integer","boolean","null","object","array"],e=new Set(t);function n(o){return typeof o=="string"&&e.has(o)}Ln.isJSONType=n;function r(){const o={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...o,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},o.number,o.string,o.array,o.object],post:{rules:[]},all:{},keywords:{}}}return Ln.getRules=r,Ln}var sn={},jp;function kv(){if(jp)return sn;jp=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.shouldUseRule=sn.shouldUseGroup=sn.schemaHasRulesForType=void 0;function t({schema:r,self:o},s){const i=o.RULES.types[s];return i&&i!==!0&&e(r,i)}sn.schemaHasRulesForType=t;function e(r,o){return o.rules.some(s=>n(r,s))}sn.shouldUseGroup=e;function n(r,o){var s;return r[o.keyword]!==void 0||((s=o.definition.implements)===null||s===void 0?void 0:s.some(i=>r[i]!==void 0))}return sn.shouldUseRule=n,sn}var em;function Wi(){if(em)return st;em=1,Object.defineProperty(st,"__esModule",{value:!0}),st.reportTypeError=st.checkDataTypes=st.checkDataType=st.coerceAndCheckDataType=st.getJSONTypes=st.getSchemaTypes=st.DataType=void 0;const t=Cv(),e=kv(),n=xa(),r=ve(),o=Re();var s;(function(g){g[g.Correct=0]="Correct",g[g.Wrong=1]="Wrong"})(s||(st.DataType=s={}));function i(g){const S=a(g.type);if(S.includes("null")){if(g.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!S.length&&g.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');g.nullable===!0&&S.push("null")}return S}st.getSchemaTypes=i;function a(g){const S=Array.isArray(g)?g:g?[g]:[];if(S.every(t.isJSONType))return S;throw new Error("type must be JSONType or JSONType[]: "+S.join(","))}st.getJSONTypes=a;function l(g,S){const{gen:b,data:y,opts:C}=g,k=u(S,C.coerceTypes),P=S.length>0&&!(k.length===0&&S.length===1&&(0,e.schemaHasRulesForType)(g,S[0]));if(P){const M=w(S,y,C.strictNumbers,s.Wrong);b.if(M,()=>{k.length?h(g,S,k):_(g)})}return P}st.coerceAndCheckDataType=l;const c=new Set(["string","number","integer","boolean","null"]);function u(g,S){return S?g.filter(b=>c.has(b)||S==="array"&&b==="array"):[]}function h(g,S,b){const{gen:y,data:C,opts:k}=g,P=y.let("dataType",(0,r._)`typeof ${C}`),M=y.let("coerced",(0,r._)`undefined`);k.coerceTypes==="array"&&y.if((0,r._)`${P} == 'object' && Array.isArray(${C}) && ${C}.length == 1`,()=>y.assign(C,(0,r._)`${C}[0]`).assign(P,(0,r._)`typeof ${C}`).if(w(S,C,k.strictNumbers),()=>y.assign(M,C))),y.if((0,r._)`${M} !== undefined`);for(const D of b)(c.has(D)||D==="array"&&k.coerceTypes==="array")&&q(D);y.else(),_(g),y.endIf(),y.if((0,r._)`${M} !== undefined`,()=>{y.assign(C,M),p(g,M)});function q(D){switch(D){case"string":y.elseIf((0,r._)`${P} == "number" || ${P} == "boolean"`).assign(M,(0,r._)`"" + ${C}`).elseIf((0,r._)`${C} === null`).assign(M,(0,r._)`""`);return;case"number":y.elseIf((0,r._)`${P} == "boolean" || ${C} === null
              || (${P} == "string" && ${C} && ${C} == +${C})`).assign(M,(0,r._)`+${C}`);return;case"integer":y.elseIf((0,r._)`${P} === "boolean" || ${C} === null
              || (${P} === "string" && ${C} && ${C} == +${C} && !(${C} % 1))`).assign(M,(0,r._)`+${C}`);return;case"boolean":y.elseIf((0,r._)`${C} === "false" || ${C} === 0 || ${C} === null`).assign(M,!1).elseIf((0,r._)`${C} === "true" || ${C} === 1`).assign(M,!0);return;case"null":y.elseIf((0,r._)`${C} === "" || ${C} === 0 || ${C} === false`),y.assign(M,null);return;case"array":y.elseIf((0,r._)`${P} === "string" || ${P} === "number"
              || ${P} === "boolean" || ${C} === null`).assign(M,(0,r._)`[${C}]`)}}}function p({gen:g,parentData:S,parentDataProperty:b},y){g.if((0,r._)`${S} !== undefined`,()=>g.assign((0,r._)`${S}[${b}]`,y))}function m(g,S,b,y=s.Correct){const C=y===s.Correct?r.operators.EQ:r.operators.NEQ;let k;switch(g){case"null":return(0,r._)`${S} ${C} null`;case"array":k=(0,r._)`Array.isArray(${S})`;break;case"object":k=(0,r._)`${S} && typeof ${S} == "object" && !Array.isArray(${S})`;break;case"integer":k=P((0,r._)`!(${S} % 1) && !isNaN(${S})`);break;case"number":k=P();break;default:return(0,r._)`typeof ${S} ${C} ${g}`}return y===s.Correct?k:(0,r.not)(k);function P(M=r.nil){return(0,r.and)((0,r._)`typeof ${S} == "number"`,M,b?(0,r._)`isFinite(${S})`:r.nil)}}st.checkDataType=m;function w(g,S,b,y){if(g.length===1)return m(g[0],S,b,y);let C;const k=(0,o.toHash)(g);if(k.array&&k.object){const P=(0,r._)`typeof ${S} != "object"`;C=k.null?P:(0,r._)`!${S} || ${P}`,delete k.null,delete k.array,delete k.object}else C=r.nil;k.number&&delete k.integer;for(const P in k)C=(0,r.and)(C,m(P,S,b,y));return C}st.checkDataTypes=w;const E={message:({schema:g})=>`must be ${g}`,params:({schema:g,schemaValue:S})=>typeof g=="string"?(0,r._)`{type: ${g}}`:(0,r._)`{type: ${S}}`};function _(g){const S=v(g);(0,n.reportError)(S,E)}st.reportTypeError=_;function v(g){const{gen:S,data:b,schema:y}=g,C=(0,o.schemaRefOrVal)(g,y,"type");return{gen:S,keyword:"type",data:b,schema:y.type,schemaCode:C,schemaValue:C,parentSchema:y,params:{},it:g}}return st}var zr={},tm;function eD(){if(tm)return zr;tm=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.assignDefaults=void 0;const t=ve(),e=Re();function n(o,s){const{properties:i,items:a}=o.schema;if(s==="object"&&i)for(const l in i)r(o,l,i[l].default);else s==="array"&&Array.isArray(a)&&a.forEach((l,c)=>r(o,c,l.default))}zr.assignDefaults=n;function r(o,s,i){const{gen:a,compositeRule:l,data:c,opts:u}=o;if(i===void 0)return;const h=(0,t._)`${c}${(0,t.getProperty)(s)}`;if(l){(0,e.checkStrictMode)(o,`default is ignored for: ${h}`);return}let p=(0,t._)`${h} === undefined`;u.useDefaults==="empty"&&(p=(0,t._)`${p} || ${h} === null || ${h} === ""`),a.if(p,(0,t._)`${h} = ${(0,t.stringify)(i)}`)}return zr}var Vt={},Oe={},nm;function Yt(){if(nm)return Oe;nm=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.validateUnion=Oe.validateArray=Oe.usePattern=Oe.callValidateCode=Oe.schemaProperties=Oe.allSchemaProperties=Oe.noPropertyInData=Oe.propertyInData=Oe.isOwnProperty=Oe.hasPropFunc=Oe.reportMissingProp=Oe.checkMissingProp=Oe.checkReportMissingProp=void 0;const t=ve(),e=Re(),n=$n(),r=Re();function o(g,S){const{gen:b,data:y,it:C}=g;b.if(u(b,y,S,C.opts.ownProperties),()=>{g.setParams({missingProperty:(0,t._)`${S}`},!0),g.error()})}Oe.checkReportMissingProp=o;function s({gen:g,data:S,it:{opts:b}},y,C){return(0,t.or)(...y.map(k=>(0,t.and)(u(g,S,k,b.ownProperties),(0,t._)`${C} = ${k}`)))}Oe.checkMissingProp=s;function i(g,S){g.setParams({missingProperty:S},!0),g.error()}Oe.reportMissingProp=i;function a(g){return g.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,t._)`Object.prototype.hasOwnProperty`})}Oe.hasPropFunc=a;function l(g,S,b){return(0,t._)`${a(g)}.call(${S}, ${b})`}Oe.isOwnProperty=l;function c(g,S,b,y){const C=(0,t._)`${S}${(0,t.getProperty)(b)} !== undefined`;return y?(0,t._)`${C} && ${l(g,S,b)}`:C}Oe.propertyInData=c;function u(g,S,b,y){const C=(0,t._)`${S}${(0,t.getProperty)(b)} === undefined`;return y?(0,t.or)(C,(0,t.not)(l(g,S,b))):C}Oe.noPropertyInData=u;function h(g){return g?Object.keys(g).filter(S=>S!=="__proto__"):[]}Oe.allSchemaProperties=h;function p(g,S){return h(S).filter(b=>!(0,e.alwaysValidSchema)(g,S[b]))}Oe.schemaProperties=p;function m({schemaCode:g,data:S,it:{gen:b,topSchemaRef:y,schemaPath:C,errorPath:k},it:P},M,q,D){const G=D?(0,t._)`${g}, ${S}, ${y}${C}`:S,B=[[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,k)],[n.default.parentData,P.parentData],[n.default.parentDataProperty,P.parentDataProperty],[n.default.rootData,n.default.rootData]];P.opts.dynamicRef&&B.push([n.default.dynamicAnchors,n.default.dynamicAnchors]);const K=(0,t._)`${G}, ${b.object(...B)}`;return q!==t.nil?(0,t._)`${M}.call(${q}, ${K})`:(0,t._)`${M}(${K})`}Oe.callValidateCode=m;const w=(0,t._)`new RegExp`;function E({gen:g,it:{opts:S}},b){const y=S.unicodeRegExp?"u":"",{regExp:C}=S.code,k=C(b,y);return g.scopeValue("pattern",{key:k.toString(),ref:k,code:(0,t._)`${C.code==="new RegExp"?w:(0,r.useFunc)(g,C)}(${b}, ${y})`})}Oe.usePattern=E;function _(g){const{gen:S,data:b,keyword:y,it:C}=g,k=S.name("valid");if(C.allErrors){const M=S.let("valid",!0);return P(()=>S.assign(M,!1)),M}return S.var(k,!0),P(()=>S.break()),k;function P(M){const q=S.const("len",(0,t._)`${b}.length`);S.forRange("i",0,q,D=>{g.subschema({keyword:y,dataProp:D,dataPropType:e.Type.Num},k),S.if((0,t.not)(k),M)})}}Oe.validateArray=_;function v(g){const{gen:S,schema:b,keyword:y,it:C}=g;if(!Array.isArray(b))throw new Error("ajv implementation error");if(b.some(q=>(0,e.alwaysValidSchema)(C,q))&&!C.opts.unevaluated)return;const P=S.let("valid",!1),M=S.name("_valid");S.block(()=>b.forEach((q,D)=>{const G=g.subschema({keyword:y,schemaProp:D,compositeRule:!0},M);S.assign(P,(0,t._)`${P} || ${M}`),g.mergeValidEvaluated(G,M)||S.if((0,t.not)(P))})),g.result(P,()=>g.reset(),()=>g.error(!0))}return Oe.validateUnion=v,Oe}var rm;function tD(){if(rm)return Vt;rm=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.validateKeywordUsage=Vt.validSchemaType=Vt.funcKeywordCode=Vt.macroKeywordCode=void 0;const t=ve(),e=$n(),n=Yt(),r=xa();function o(p,m){const{gen:w,keyword:E,schema:_,parentSchema:v,it:g}=p,S=m.macro.call(g.self,_,v,g),b=c(w,E,S);g.opts.validateSchema!==!1&&g.self.validateSchema(S,!0);const y=w.name("valid");p.subschema({schema:S,schemaPath:t.nil,errSchemaPath:`${g.errSchemaPath}/${E}`,topSchemaRef:b,compositeRule:!0},y),p.pass(y,()=>p.error(!0))}Vt.macroKeywordCode=o;function s(p,m){var w;const{gen:E,keyword:_,schema:v,parentSchema:g,$data:S,it:b}=p;l(b,m);const y=!S&&m.compile?m.compile.call(b.self,v,g,b):m.validate,C=c(E,_,y),k=E.let("valid");p.block$data(k,P),p.ok((w=m.valid)!==null&&w!==void 0?w:k);function P(){if(m.errors===!1)D(),m.modifying&&i(p),G(()=>p.error());else{const B=m.async?M():q();m.modifying&&i(p),G(()=>a(p,B))}}function M(){const B=E.let("ruleErrs",null);return E.try(()=>D((0,t._)`await `),K=>E.assign(k,!1).if((0,t._)`${K} instanceof ${b.ValidationError}`,()=>E.assign(B,(0,t._)`${K}.errors`),()=>E.throw(K))),B}function q(){const B=(0,t._)`${C}.errors`;return E.assign(B,null),D(t.nil),B}function D(B=m.async?(0,t._)`await `:t.nil){const K=b.opts.passContext?e.default.this:e.default.self,oe=!("compile"in m&&!S||m.schema===!1);E.assign(k,(0,t._)`${B}${(0,n.callValidateCode)(p,C,K,oe)}`,m.modifying)}function G(B){var K;E.if((0,t.not)((K=m.valid)!==null&&K!==void 0?K:k),B)}}Vt.funcKeywordCode=s;function i(p){const{gen:m,data:w,it:E}=p;m.if(E.parentData,()=>m.assign(w,(0,t._)`${E.parentData}[${E.parentDataProperty}]`))}function a(p,m){const{gen:w}=p;w.if((0,t._)`Array.isArray(${m})`,()=>{w.assign(e.default.vErrors,(0,t._)`${e.default.vErrors} === null ? ${m} : ${e.default.vErrors}.concat(${m})`).assign(e.default.errors,(0,t._)`${e.default.vErrors}.length`),(0,r.extendErrors)(p)},()=>p.error())}function l({schemaEnv:p},m){if(m.async&&!p.$async)throw new Error("async keyword in sync schema")}function c(p,m,w){if(w===void 0)throw new Error(`keyword "${m}" failed to compile`);return p.scopeValue("keyword",typeof w=="function"?{ref:w}:{ref:w,code:(0,t.stringify)(w)})}function u(p,m,w=!1){return!m.length||m.some(E=>E==="array"?Array.isArray(p):E==="object"?p&&typeof p=="object"&&!Array.isArray(p):typeof p==E||w&&typeof p>"u")}Vt.validSchemaType=u;function h({schema:p,opts:m,self:w,errSchemaPath:E},_,v){if(Array.isArray(_.keyword)?!_.keyword.includes(v):_.keyword!==v)throw new Error("ajv implementation error");const g=_.dependencies;if(g?.some(S=>!Object.prototype.hasOwnProperty.call(p,S)))throw new Error(`parent schema must have dependencies of ${v}: ${g.join(",")}`);if(_.validateSchema&&!_.validateSchema(p[v])){const b=`keyword "${v}" value is invalid at path "${E}": `+w.errorsText(_.validateSchema.errors);if(m.validateSchema==="log")w.logger.error(b);else throw new Error(b)}}return Vt.validateKeywordUsage=h,Vt}var an={},om;function nD(){if(om)return an;om=1,Object.defineProperty(an,"__esModule",{value:!0}),an.extendSubschemaMode=an.extendSubschemaData=an.getSubschema=void 0;const t=ve(),e=Re();function n(s,{keyword:i,schemaProp:a,schema:l,schemaPath:c,errSchemaPath:u,topSchemaRef:h}){if(i!==void 0&&l!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(i!==void 0){const p=s.schema[i];return a===void 0?{schema:p,schemaPath:(0,t._)`${s.schemaPath}${(0,t.getProperty)(i)}`,errSchemaPath:`${s.errSchemaPath}/${i}`}:{schema:p[a],schemaPath:(0,t._)`${s.schemaPath}${(0,t.getProperty)(i)}${(0,t.getProperty)(a)}`,errSchemaPath:`${s.errSchemaPath}/${i}/${(0,e.escapeFragment)(a)}`}}if(l!==void 0){if(c===void 0||u===void 0||h===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:l,schemaPath:c,topSchemaRef:h,errSchemaPath:u}}throw new Error('either "keyword" or "schema" must be passed')}an.getSubschema=n;function r(s,i,{dataProp:a,dataPropType:l,data:c,dataTypes:u,propertyName:h}){if(c!==void 0&&a!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:p}=i;if(a!==void 0){const{errorPath:w,dataPathArr:E,opts:_}=i,v=p.let("data",(0,t._)`${i.data}${(0,t.getProperty)(a)}`,!0);m(v),s.errorPath=(0,t.str)`${w}${(0,e.getErrorPath)(a,l,_.jsPropertySyntax)}`,s.parentDataProperty=(0,t._)`${a}`,s.dataPathArr=[...E,s.parentDataProperty]}if(c!==void 0){const w=c instanceof t.Name?c:p.let("data",c,!0);m(w),h!==void 0&&(s.propertyName=h)}u&&(s.dataTypes=u);function m(w){s.data=w,s.dataLevel=i.dataLevel+1,s.dataTypes=[],i.definedProperties=new Set,s.parentData=i.data,s.dataNames=[...i.dataNames,w]}}an.extendSubschemaData=r;function o(s,{jtdDiscriminator:i,jtdMetadata:a,compositeRule:l,createErrors:c,allErrors:u}){l!==void 0&&(s.compositeRule=l),c!==void 0&&(s.createErrors=c),u!==void 0&&(s.allErrors=u),s.jtdDiscriminator=i,s.jtdMetadata=a}return an.extendSubschemaMode=o,an}var gt={},El={exports:{}},sm;function rD(){if(sm)return El.exports;sm=1;var t=El.exports=function(r,o,s){typeof o=="function"&&(s=o,o={}),s=o.cb||s;var i=typeof s=="function"?s:s.pre||function(){},a=s.post||function(){};e(o,i,a,r,"",r)};t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function e(r,o,s,i,a,l,c,u,h,p){if(i&&typeof i=="object"&&!Array.isArray(i)){o(i,a,l,c,u,h,p);for(var m in i){var w=i[m];if(Array.isArray(w)){if(m in t.arrayKeywords)for(var E=0;E<w.length;E++)e(r,o,s,w[E],a+"/"+m+"/"+E,l,a,m,i,E)}else if(m in t.propsKeywords){if(w&&typeof w=="object")for(var _ in w)e(r,o,s,w[_],a+"/"+m+"/"+n(_),l,a,m,i,_)}else(m in t.keywords||r.allKeys&&!(m in t.skipKeywords))&&e(r,o,s,w,a+"/"+m,l,a,m,i)}s(i,a,l,c,u,h,p)}}function n(r){return r.replace(/~/g,"~0").replace(/\//g,"~1")}return El.exports}var im;function Da(){if(im)return gt;im=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.getSchemaRefs=gt.resolveUrl=gt.normalizeId=gt._getFullPath=gt.getFullPath=gt.inlineRef=void 0;const t=Re(),e=Aa(),n=rD(),r=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function o(E,_=!0){return typeof E=="boolean"?!0:_===!0?!i(E):_?a(E)<=_:!1}gt.inlineRef=o;const s=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function i(E){for(const _ in E){if(s.has(_))return!0;const v=E[_];if(Array.isArray(v)&&v.some(i)||typeof v=="object"&&i(v))return!0}return!1}function a(E){let _=0;for(const v in E){if(v==="$ref")return 1/0;if(_++,!r.has(v)&&(typeof E[v]=="object"&&(0,t.eachItem)(E[v],g=>_+=a(g)),_===1/0))return 1/0}return _}function l(E,_="",v){v!==!1&&(_=h(_));const g=E.parse(_);return c(E,g)}gt.getFullPath=l;function c(E,_){return E.serialize(_).split("#")[0]+"#"}gt._getFullPath=c;const u=/#\/?$/;function h(E){return E?E.replace(u,""):""}gt.normalizeId=h;function p(E,_,v){return v=h(v),E.resolve(_,v)}gt.resolveUrl=p;const m=/^[a-z_][-a-z0-9._]*$/i;function w(E,_){if(typeof E=="boolean")return{};const{schemaId:v,uriResolver:g}=this.opts,S=h(E[v]||_),b={"":S},y=l(g,S,!1),C={},k=new Set;return n(E,{allKeys:!0},(q,D,G,B)=>{if(B===void 0)return;const K=y+D;let oe=b[B];typeof q[v]=="string"&&(oe=Se.call(this,q[v])),be.call(this,q.$anchor),be.call(this,q.$dynamicAnchor),b[D]=oe;function Se(ee){const ge=this.opts.uriResolver.resolve;if(ee=h(oe?ge(oe,ee):ee),k.has(ee))throw M(ee);k.add(ee);let V=this.refs[ee];return typeof V=="string"&&(V=this.refs[V]),typeof V=="object"?P(q,V.schema,ee):ee!==h(K)&&(ee[0]==="#"?(P(q,C[ee],ee),C[ee]=q):this.refs[ee]=K),ee}function be(ee){if(typeof ee=="string"){if(!m.test(ee))throw new Error(`invalid anchor "${ee}"`);Se.call(this,`#${ee}`)}}}),C;function P(q,D,G){if(D!==void 0&&!e(q,D))throw M(G)}function M(q){return new Error(`reference "${q}" resolves to more than one schema`)}}return gt.getSchemaRefs=w,gt}var am;function Oa(){if(am)return on;am=1,Object.defineProperty(on,"__esModule",{value:!0}),on.getData=on.KeywordCxt=on.validateFunctionCode=void 0;const t=jx(),e=Wi(),n=kv(),r=Wi(),o=eD(),s=tD(),i=nD(),a=ve(),l=$n(),c=Da(),u=Re(),h=xa();function p(R){if(y(R)&&(k(R),b(R))){_(R);return}m(R,()=>(0,t.topBoolOrEmptySchema)(R))}on.validateFunctionCode=p;function m({gen:R,validateName:N,schema:L,schemaEnv:z,opts:Y},Q){Y.code.es5?R.func(N,(0,a._)`${l.default.data}, ${l.default.valCxt}`,z.$async,()=>{R.code((0,a._)`"use strict"; ${g(L,Y)}`),E(R,Y),R.code(Q)}):R.func(N,(0,a._)`${l.default.data}, ${w(Y)}`,z.$async,()=>R.code(g(L,Y)).code(Q))}function w(R){return(0,a._)`{${l.default.instancePath}="", ${l.default.parentData}, ${l.default.parentDataProperty}, ${l.default.rootData}=${l.default.data}${R.dynamicRef?(0,a._)`, ${l.default.dynamicAnchors}={}`:a.nil}}={}`}function E(R,N){R.if(l.default.valCxt,()=>{R.var(l.default.instancePath,(0,a._)`${l.default.valCxt}.${l.default.instancePath}`),R.var(l.default.parentData,(0,a._)`${l.default.valCxt}.${l.default.parentData}`),R.var(l.default.parentDataProperty,(0,a._)`${l.default.valCxt}.${l.default.parentDataProperty}`),R.var(l.default.rootData,(0,a._)`${l.default.valCxt}.${l.default.rootData}`),N.dynamicRef&&R.var(l.default.dynamicAnchors,(0,a._)`${l.default.valCxt}.${l.default.dynamicAnchors}`)},()=>{R.var(l.default.instancePath,(0,a._)`""`),R.var(l.default.parentData,(0,a._)`undefined`),R.var(l.default.parentDataProperty,(0,a._)`undefined`),R.var(l.default.rootData,l.default.data),N.dynamicRef&&R.var(l.default.dynamicAnchors,(0,a._)`{}`)})}function _(R){const{schema:N,opts:L,gen:z}=R;m(R,()=>{L.$comment&&N.$comment&&B(R),q(R),z.let(l.default.vErrors,null),z.let(l.default.errors,0),L.unevaluated&&v(R),P(R),K(R)})}function v(R){const{gen:N,validateName:L}=R;R.evaluated=N.const("evaluated",(0,a._)`${L}.evaluated`),N.if((0,a._)`${R.evaluated}.dynamicProps`,()=>N.assign((0,a._)`${R.evaluated}.props`,(0,a._)`undefined`)),N.if((0,a._)`${R.evaluated}.dynamicItems`,()=>N.assign((0,a._)`${R.evaluated}.items`,(0,a._)`undefined`))}function g(R,N){const L=typeof R=="object"&&R[N.schemaId];return L&&(N.code.source||N.code.process)?(0,a._)`/*# sourceURL=${L} */`:a.nil}function S(R,N){if(y(R)&&(k(R),b(R))){C(R,N);return}(0,t.boolOrEmptySchema)(R,N)}function b({schema:R,self:N}){if(typeof R=="boolean")return!R;for(const L in R)if(N.RULES.all[L])return!0;return!1}function y(R){return typeof R.schema!="boolean"}function C(R,N){const{schema:L,gen:z,opts:Y}=R;Y.$comment&&L.$comment&&B(R),D(R),G(R);const Q=z.const("_errs",l.default.errors);P(R,Q),z.var(N,(0,a._)`${Q} === ${l.default.errors}`)}function k(R){(0,u.checkUnknownRules)(R),M(R)}function P(R,N){if(R.opts.jtd)return Se(R,[],!1,N);const L=(0,e.getSchemaTypes)(R.schema),z=(0,e.coerceAndCheckDataType)(R,L);Se(R,L,!z,N)}function M(R){const{schema:N,errSchemaPath:L,opts:z,self:Y}=R;N.$ref&&z.ignoreKeywordsWithRef&&(0,u.schemaHasRulesButRef)(N,Y.RULES)&&Y.logger.warn(`$ref: keywords ignored in schema at path "${L}"`)}function q(R){const{schema:N,opts:L}=R;N.default!==void 0&&L.useDefaults&&L.strictSchema&&(0,u.checkStrictMode)(R,"default is ignored in the schema root")}function D(R){const N=R.schema[R.opts.schemaId];N&&(R.baseId=(0,c.resolveUrl)(R.opts.uriResolver,R.baseId,N))}function G(R){if(R.schema.$async&&!R.schemaEnv.$async)throw new Error("async schema in sync schema")}function B({gen:R,schemaEnv:N,schema:L,errSchemaPath:z,opts:Y}){const Q=L.$comment;if(Y.$comment===!0)R.code((0,a._)`${l.default.self}.logger.log(${Q})`);else if(typeof Y.$comment=="function"){const Ee=(0,a.str)`${z}/$comment`,Ge=R.scopeValue("root",{ref:N.root});R.code((0,a._)`${l.default.self}.opts.$comment(${Q}, ${Ee}, ${Ge}.schema)`)}}function K(R){const{gen:N,schemaEnv:L,validateName:z,ValidationError:Y,opts:Q}=R;L.$async?N.if((0,a._)`${l.default.errors} === 0`,()=>N.return(l.default.data),()=>N.throw((0,a._)`new ${Y}(${l.default.vErrors})`)):(N.assign((0,a._)`${z}.errors`,l.default.vErrors),Q.unevaluated&&oe(R),N.return((0,a._)`${l.default.errors} === 0`))}function oe({gen:R,evaluated:N,props:L,items:z}){L instanceof a.Name&&R.assign((0,a._)`${N}.props`,L),z instanceof a.Name&&R.assign((0,a._)`${N}.items`,z)}function Se(R,N,L,z){const{gen:Y,schema:Q,data:Ee,allErrors:Ge,opts:Me,self:xe}=R,{RULES:Te}=xe;if(Q.$ref&&(Me.ignoreKeywordsWithRef||!(0,u.schemaHasRulesButRef)(Q,Te))){Y.block(()=>W(R,"$ref",Te.all.$ref.definition));return}Me.jtd||ee(R,N),Y.block(()=>{for(const Le of Te.rules)bt(Le);bt(Te.post)});function bt(Le){(0,n.shouldUseGroup)(Q,Le)&&(Le.type?(Y.if((0,r.checkDataType)(Le.type,Ee,Me.strictNumbers)),be(R,Le),N.length===1&&N[0]===Le.type&&L&&(Y.else(),(0,r.reportTypeError)(R)),Y.endIf()):be(R,Le),Ge||Y.if((0,a._)`${l.default.errors} === ${z||0}`))}}function be(R,N){const{gen:L,schema:z,opts:{useDefaults:Y}}=R;Y&&(0,o.assignDefaults)(R,N.type),L.block(()=>{for(const Q of N.rules)(0,n.shouldUseRule)(z,Q)&&W(R,Q.keyword,Q.definition,N.type)})}function ee(R,N){R.schemaEnv.meta||!R.opts.strictTypes||(ge(R,N),R.opts.allowUnionTypes||V(R,N),$(R,R.dataTypes))}function ge(R,N){if(N.length){if(!R.dataTypes.length){R.dataTypes=N;return}N.forEach(L=>{A(R.dataTypes,L)||I(R,`type "${L}" not allowed by context "${R.dataTypes.join(",")}"`)}),T(R,N)}}function V(R,N){N.length>1&&!(N.length===2&&N.includes("null"))&&I(R,"use allowUnionTypes to allow union type keyword")}function $(R,N){const L=R.self.RULES.all;for(const z in L){const Y=L[z];if(typeof Y=="object"&&(0,n.shouldUseRule)(R.schema,Y)){const{type:Q}=Y.definition;Q.length&&!Q.some(Ee=>O(N,Ee))&&I(R,`missing type "${Q.join(",")}" for keyword "${z}"`)}}}function O(R,N){return R.includes(N)||N==="number"&&R.includes("integer")}function A(R,N){return R.includes(N)||N==="integer"&&R.includes("number")}function T(R,N){const L=[];for(const z of R.dataTypes)A(N,z)?L.push(z):N.includes("integer")&&z==="number"&&L.push("integer");R.dataTypes=L}function I(R,N){const L=R.schemaEnv.baseId+R.errSchemaPath;N+=` at "${L}" (strictTypes)`,(0,u.checkStrictMode)(R,N,R.opts.strictTypes)}class x{constructor(N,L,z){if((0,s.validateKeywordUsage)(N,L,z),this.gen=N.gen,this.allErrors=N.allErrors,this.keyword=z,this.data=N.data,this.schema=N.schema[z],this.$data=L.$data&&N.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,u.schemaRefOrVal)(N,this.schema,z,this.$data),this.schemaType=L.schemaType,this.parentSchema=N.schema,this.params={},this.it=N,this.def=L,this.$data)this.schemaCode=N.gen.const("vSchema",re(this.$data,N));else if(this.schemaCode=this.schemaValue,!(0,s.validSchemaType)(this.schema,L.schemaType,L.allowUndefined))throw new Error(`${z} value must be ${JSON.stringify(L.schemaType)}`);("code"in L?L.trackErrors:L.errors!==!1)&&(this.errsCount=N.gen.const("_errs",l.default.errors))}result(N,L,z){this.failResult((0,a.not)(N),L,z)}failResult(N,L,z){this.gen.if(N),z?z():this.error(),L?(this.gen.else(),L(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(N,L){this.failResult((0,a.not)(N),void 0,L)}fail(N){if(N===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(N),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(N){if(!this.$data)return this.fail(N);const{schemaCode:L}=this;this.fail((0,a._)`${L} !== undefined && (${(0,a.or)(this.invalid$data(),N)})`)}error(N,L,z){if(L){this.setParams(L),this._error(N,z),this.setParams({});return}this._error(N,z)}_error(N,L){(N?h.reportExtraError:h.reportError)(this,this.def.error,L)}$dataError(){(0,h.reportError)(this,this.def.$dataError||h.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,h.resetErrorsCount)(this.gen,this.errsCount)}ok(N){this.allErrors||this.gen.if(N)}setParams(N,L){L?Object.assign(this.params,N):this.params=N}block$data(N,L,z=a.nil){this.gen.block(()=>{this.check$data(N,z),L()})}check$data(N=a.nil,L=a.nil){if(!this.$data)return;const{gen:z,schemaCode:Y,schemaType:Q,def:Ee}=this;z.if((0,a.or)((0,a._)`${Y} === undefined`,L)),N!==a.nil&&z.assign(N,!0),(Q.length||Ee.validateSchema)&&(z.elseIf(this.invalid$data()),this.$dataError(),N!==a.nil&&z.assign(N,!1)),z.else()}invalid$data(){const{gen:N,schemaCode:L,schemaType:z,def:Y,it:Q}=this;return(0,a.or)(Ee(),Ge());function Ee(){if(z.length){if(!(L instanceof a.Name))throw new Error("ajv implementation error");const Me=Array.isArray(z)?z:[z];return(0,a._)`${(0,r.checkDataTypes)(Me,L,Q.opts.strictNumbers,r.DataType.Wrong)}`}return a.nil}function Ge(){if(Y.validateSchema){const Me=N.scopeValue("validate$data",{ref:Y.validateSchema});return(0,a._)`!${Me}(${L})`}return a.nil}}subschema(N,L){const z=(0,i.getSubschema)(this.it,N);(0,i.extendSubschemaData)(z,this.it,N),(0,i.extendSubschemaMode)(z,N);const Y={...this.it,...z,items:void 0,props:void 0};return S(Y,L),Y}mergeEvaluated(N,L){const{it:z,gen:Y}=this;z.opts.unevaluated&&(z.props!==!0&&N.props!==void 0&&(z.props=u.mergeEvaluated.props(Y,N.props,z.props,L)),z.items!==!0&&N.items!==void 0&&(z.items=u.mergeEvaluated.items(Y,N.items,z.items,L)))}mergeValidEvaluated(N,L){const{it:z,gen:Y}=this;if(z.opts.unevaluated&&(z.props!==!0||z.items!==!0))return Y.if(L,()=>this.mergeEvaluated(N,a.Name)),!0}}on.KeywordCxt=x;function W(R,N,L,z){const Y=new x(R,L,N);"code"in L?L.code(Y,z):Y.$data&&L.validate?(0,s.funcKeywordCode)(Y,L):"macro"in L?(0,s.macroKeywordCode)(Y,L):(L.compile||L.validate)&&(0,s.funcKeywordCode)(Y,L)}const Z=/^\/(?:[^~]|~0|~1)*$/,se=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function re(R,{dataLevel:N,dataNames:L,dataPathArr:z}){let Y,Q;if(R==="")return l.default.rootData;if(R[0]==="/"){if(!Z.test(R))throw new Error(`Invalid JSON-pointer: ${R}`);Y=R,Q=l.default.rootData}else{const xe=se.exec(R);if(!xe)throw new Error(`Invalid JSON-pointer: ${R}`);const Te=+xe[1];if(Y=xe[2],Y==="#"){if(Te>=N)throw new Error(Me("property/index",Te));return z[N-Te]}if(Te>N)throw new Error(Me("data",Te));if(Q=L[N-Te],!Y)return Q}let Ee=Q;const Ge=Y.split("/");for(const xe of Ge)xe&&(Q=(0,a._)`${Q}${(0,a.getProperty)((0,u.unescapeJsonPointer)(xe))}`,Ee=(0,a._)`${Ee} && ${Q}`);return Ee;function Me(xe,Te){return`Cannot access ${xe} ${Te} levels up, current level is ${N}`}}return on.getData=re,on}var Is={},lm;function Nu(){if(lm)return Is;lm=1,Object.defineProperty(Is,"__esModule",{value:!0});class t extends Error{constructor(n){super("validation failed"),this.errors=n,this.ajv=this.validation=!0}}return Is.default=t,Is}var Rs={},cm;function Ua(){if(cm)return Rs;cm=1,Object.defineProperty(Rs,"__esModule",{value:!0});const t=Da();class e extends Error{constructor(r,o,s,i){super(i||`can't resolve reference ${s} from id ${o}`),this.missingRef=(0,t.resolveUrl)(r,o,s),this.missingSchema=(0,t.normalizeId)((0,t.getFullPath)(r,this.missingRef))}}return Rs.default=e,Rs}var kt={},um;function Mu(){if(um)return kt;um=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.resolveSchema=kt.getCompilingSchema=kt.resolveRef=kt.compileSchema=kt.SchemaEnv=void 0;const t=ve(),e=Nu(),n=$n(),r=Da(),o=Re(),s=Oa();class i{constructor(v){var g;this.refs={},this.dynamicAnchors={};let S;typeof v.schema=="object"&&(S=v.schema),this.schema=v.schema,this.schemaId=v.schemaId,this.root=v.root||this,this.baseId=(g=v.baseId)!==null&&g!==void 0?g:(0,r.normalizeId)(S?.[v.schemaId||"$id"]),this.schemaPath=v.schemaPath,this.localRefs=v.localRefs,this.meta=v.meta,this.$async=S?.$async,this.refs={}}}kt.SchemaEnv=i;function a(_){const v=u.call(this,_);if(v)return v;const g=(0,r.getFullPath)(this.opts.uriResolver,_.root.baseId),{es5:S,lines:b}=this.opts.code,{ownProperties:y}=this.opts,C=new t.CodeGen(this.scope,{es5:S,lines:b,ownProperties:y});let k;_.$async&&(k=C.scopeValue("Error",{ref:e.default,code:(0,t._)`require("ajv/dist/runtime/validation_error").default`}));const P=C.scopeName("validate");_.validateName=P;const M={gen:C,allErrors:this.opts.allErrors,data:n.default.data,parentData:n.default.parentData,parentDataProperty:n.default.parentDataProperty,dataNames:[n.default.data],dataPathArr:[t.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:C.scopeValue("schema",this.opts.code.source===!0?{ref:_.schema,code:(0,t.stringify)(_.schema)}:{ref:_.schema}),validateName:P,ValidationError:k,schema:_.schema,schemaEnv:_,rootId:g,baseId:_.baseId||g,schemaPath:t.nil,errSchemaPath:_.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,t._)`""`,opts:this.opts,self:this};let q;try{this._compilations.add(_),(0,s.validateFunctionCode)(M),C.optimize(this.opts.code.optimize);const D=C.toString();q=`${C.scopeRefs(n.default.scope)}return ${D}`,this.opts.code.process&&(q=this.opts.code.process(q,_));const B=new Function(`${n.default.self}`,`${n.default.scope}`,q)(this,this.scope.get());if(this.scope.value(P,{ref:B}),B.errors=null,B.schema=_.schema,B.schemaEnv=_,_.$async&&(B.$async=!0),this.opts.code.source===!0&&(B.source={validateName:P,validateCode:D,scopeValues:C._values}),this.opts.unevaluated){const{props:K,items:oe}=M;B.evaluated={props:K instanceof t.Name?void 0:K,items:oe instanceof t.Name?void 0:oe,dynamicProps:K instanceof t.Name,dynamicItems:oe instanceof t.Name},B.source&&(B.source.evaluated=(0,t.stringify)(B.evaluated))}return _.validate=B,_}catch(D){throw delete _.validate,delete _.validateName,q&&this.logger.error("Error compiling schema, function code:",q),D}finally{this._compilations.delete(_)}}kt.compileSchema=a;function l(_,v,g){var S;g=(0,r.resolveUrl)(this.opts.uriResolver,v,g);const b=_.refs[g];if(b)return b;let y=p.call(this,_,g);if(y===void 0){const C=(S=_.localRefs)===null||S===void 0?void 0:S[g],{schemaId:k}=this.opts;C&&(y=new i({schema:C,schemaId:k,root:_,baseId:v}))}if(y!==void 0)return _.refs[g]=c.call(this,y)}kt.resolveRef=l;function c(_){return(0,r.inlineRef)(_.schema,this.opts.inlineRefs)?_.schema:_.validate?_:a.call(this,_)}function u(_){for(const v of this._compilations)if(h(v,_))return v}kt.getCompilingSchema=u;function h(_,v){return _.schema===v.schema&&_.root===v.root&&_.baseId===v.baseId}function p(_,v){let g;for(;typeof(g=this.refs[v])=="string";)v=g;return g||this.schemas[v]||m.call(this,_,v)}function m(_,v){const g=this.opts.uriResolver.parse(v),S=(0,r._getFullPath)(this.opts.uriResolver,g);let b=(0,r.getFullPath)(this.opts.uriResolver,_.baseId,void 0);if(Object.keys(_.schema).length>0&&S===b)return E.call(this,g,_);const y=(0,r.normalizeId)(S),C=this.refs[y]||this.schemas[y];if(typeof C=="string"){const k=m.call(this,_,C);return typeof k?.schema!="object"?void 0:E.call(this,g,k)}if(typeof C?.schema=="object"){if(C.validate||a.call(this,C),y===(0,r.normalizeId)(v)){const{schema:k}=C,{schemaId:P}=this.opts,M=k[P];return M&&(b=(0,r.resolveUrl)(this.opts.uriResolver,b,M)),new i({schema:k,schemaId:P,root:_,baseId:b})}return E.call(this,g,C)}}kt.resolveSchema=m;const w=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function E(_,{baseId:v,schema:g,root:S}){var b;if(((b=_.fragment)===null||b===void 0?void 0:b[0])!=="/")return;for(const k of _.fragment.slice(1).split("/")){if(typeof g=="boolean")return;const P=g[(0,o.unescapeFragment)(k)];if(P===void 0)return;g=P;const M=typeof g=="object"&&g[this.opts.schemaId];!w.has(k)&&M&&(v=(0,r.resolveUrl)(this.opts.uriResolver,v,M))}let y;if(typeof g!="boolean"&&g.$ref&&!(0,o.schemaHasRulesButRef)(g,this.RULES)){const k=(0,r.resolveUrl)(this.opts.uriResolver,v,g.$ref);y=m.call(this,S,k)}const{schemaId:C}=this.opts;if(y=y||new i({schema:g,schemaId:C,root:S,baseId:v}),y.schema!==y.root.schema)return y}return kt}const oD="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",sD="Meta-schema for $data reference (JSON AnySchema extension proposal)",iD="object",aD=["$data"],lD={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},cD=!1,uD={$id:oD,description:sD,type:iD,required:aD,properties:lD,additionalProperties:cD};var $s={},dm;function dD(){if(dm)return $s;dm=1,Object.defineProperty($s,"__esModule",{value:!0});const t=Sv();return t.code='require("ajv/dist/runtime/uri").default',$s.default=t,$s}var fm;function fD(){return fm||(fm=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=Oa();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var n=ve();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const r=Nu(),o=Ua(),s=Cv(),i=Mu(),a=ve(),l=Da(),c=Wi(),u=Re(),h=uD,p=dD(),m=(V,$)=>new RegExp(V,$);m.code="new RegExp";const w=["removeAdditional","useDefaults","coerceTypes"],E=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),_={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},v={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},g=200;function S(V){var $,O,A,T,I,x,W,Z,se,re,R,N,L,z,Y,Q,Ee,Ge,Me,xe,Te,bt,Le,An,Pn;const qt=V.strict,Nn=($=V.code)===null||$===void 0?void 0:$.optimize,Dr=Nn===!0||Nn===void 0?1:Nn||0,Or=(A=(O=V.code)===null||O===void 0?void 0:O.regExp)!==null&&A!==void 0?A:m,Xa=(T=V.uriResolver)!==null&&T!==void 0?T:p.default;return{strictSchema:(x=(I=V.strictSchema)!==null&&I!==void 0?I:qt)!==null&&x!==void 0?x:!0,strictNumbers:(Z=(W=V.strictNumbers)!==null&&W!==void 0?W:qt)!==null&&Z!==void 0?Z:!0,strictTypes:(re=(se=V.strictTypes)!==null&&se!==void 0?se:qt)!==null&&re!==void 0?re:"log",strictTuples:(N=(R=V.strictTuples)!==null&&R!==void 0?R:qt)!==null&&N!==void 0?N:"log",strictRequired:(z=(L=V.strictRequired)!==null&&L!==void 0?L:qt)!==null&&z!==void 0?z:!1,code:V.code?{...V.code,optimize:Dr,regExp:Or}:{optimize:Dr,regExp:Or},loopRequired:(Y=V.loopRequired)!==null&&Y!==void 0?Y:g,loopEnum:(Q=V.loopEnum)!==null&&Q!==void 0?Q:g,meta:(Ee=V.meta)!==null&&Ee!==void 0?Ee:!0,messages:(Ge=V.messages)!==null&&Ge!==void 0?Ge:!0,inlineRefs:(Me=V.inlineRefs)!==null&&Me!==void 0?Me:!0,schemaId:(xe=V.schemaId)!==null&&xe!==void 0?xe:"$id",addUsedSchema:(Te=V.addUsedSchema)!==null&&Te!==void 0?Te:!0,validateSchema:(bt=V.validateSchema)!==null&&bt!==void 0?bt:!0,validateFormats:(Le=V.validateFormats)!==null&&Le!==void 0?Le:!0,unicodeRegExp:(An=V.unicodeRegExp)!==null&&An!==void 0?An:!0,int32range:(Pn=V.int32range)!==null&&Pn!==void 0?Pn:!0,uriResolver:Xa}}class b{constructor($={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,$=this.opts={...$,...S($)};const{es5:O,lines:A}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:E,es5:O,lines:A}),this.logger=G($.logger);const T=$.validateFormats;$.validateFormats=!1,this.RULES=(0,s.getRules)(),y.call(this,_,$,"NOT SUPPORTED"),y.call(this,v,$,"DEPRECATED","warn"),this._metaOpts=q.call(this),$.formats&&P.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),$.keywords&&M.call(this,$.keywords),typeof $.meta=="object"&&this.addMetaSchema($.meta),k.call(this),$.validateFormats=T}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:$,meta:O,schemaId:A}=this.opts;let T=h;A==="id"&&(T={...h},T.id=T.$id,delete T.$id),O&&$&&this.addMetaSchema(T,T[A],!1)}defaultMeta(){const{meta:$,schemaId:O}=this.opts;return this.opts.defaultMeta=typeof $=="object"?$[O]||$:void 0}validate($,O){let A;if(typeof $=="string"){if(A=this.getSchema($),!A)throw new Error(`no schema with key or ref "${$}"`)}else A=this.compile($);const T=A(O);return"$async"in A||(this.errors=A.errors),T}compile($,O){const A=this._addSchema($,O);return A.validate||this._compileSchemaEnv(A)}compileAsync($,O){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:A}=this.opts;return T.call(this,$,O);async function T(re,R){await I.call(this,re.$schema);const N=this._addSchema(re,R);return N.validate||x.call(this,N)}async function I(re){re&&!this.getSchema(re)&&await T.call(this,{$ref:re},!0)}async function x(re){try{return this._compileSchemaEnv(re)}catch(R){if(!(R instanceof o.default))throw R;return W.call(this,R),await Z.call(this,R.missingSchema),x.call(this,re)}}function W({missingSchema:re,missingRef:R}){if(this.refs[re])throw new Error(`AnySchema ${re} is loaded but ${R} cannot be resolved`)}async function Z(re){const R=await se.call(this,re);this.refs[re]||await I.call(this,R.$schema),this.refs[re]||this.addSchema(R,re,O)}async function se(re){const R=this._loading[re];if(R)return R;try{return await(this._loading[re]=A(re))}finally{delete this._loading[re]}}}addSchema($,O,A,T=this.opts.validateSchema){if(Array.isArray($)){for(const x of $)this.addSchema(x,void 0,A,T);return this}let I;if(typeof $=="object"){const{schemaId:x}=this.opts;if(I=$[x],I!==void 0&&typeof I!="string")throw new Error(`schema ${x} must be string`)}return O=(0,l.normalizeId)(O||I),this._checkUnique(O),this.schemas[O]=this._addSchema($,A,O,T,!0),this}addMetaSchema($,O,A=this.opts.validateSchema){return this.addSchema($,O,!0,A),this}validateSchema($,O){if(typeof $=="boolean")return!0;let A;if(A=$.$schema,A!==void 0&&typeof A!="string")throw new Error("$schema must be a string");if(A=A||this.opts.defaultMeta||this.defaultMeta(),!A)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const T=this.validate(A,$);if(!T&&O){const I="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(I);else throw new Error(I)}return T}getSchema($){let O;for(;typeof(O=C.call(this,$))=="string";)$=O;if(O===void 0){const{schemaId:A}=this.opts,T=new i.SchemaEnv({schema:{},schemaId:A});if(O=i.resolveSchema.call(this,T,$),!O)return;this.refs[$]=O}return O.validate||this._compileSchemaEnv(O)}removeSchema($){if($ instanceof RegExp)return this._removeAllSchemas(this.schemas,$),this._removeAllSchemas(this.refs,$),this;switch(typeof $){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const O=C.call(this,$);return typeof O=="object"&&this._cache.delete(O.schema),delete this.schemas[$],delete this.refs[$],this}case"object":{const O=$;this._cache.delete(O);let A=$[this.opts.schemaId];return A&&(A=(0,l.normalizeId)(A),delete this.schemas[A],delete this.refs[A]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary($){for(const O of $)this.addKeyword(O);return this}addKeyword($,O){let A;if(typeof $=="string")A=$,typeof O=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),O.keyword=A);else if(typeof $=="object"&&O===void 0){if(O=$,A=O.keyword,Array.isArray(A)&&!A.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(K.call(this,A,O),!O)return(0,u.eachItem)(A,I=>oe.call(this,I)),this;be.call(this,O);const T={...O,type:(0,c.getJSONTypes)(O.type),schemaType:(0,c.getJSONTypes)(O.schemaType)};return(0,u.eachItem)(A,T.type.length===0?I=>oe.call(this,I,T):I=>T.type.forEach(x=>oe.call(this,I,T,x))),this}getKeyword($){const O=this.RULES.all[$];return typeof O=="object"?O.definition:!!O}removeKeyword($){const{RULES:O}=this;delete O.keywords[$],delete O.all[$];for(const A of O.rules){const T=A.rules.findIndex(I=>I.keyword===$);T>=0&&A.rules.splice(T,1)}return this}addFormat($,O){return typeof O=="string"&&(O=new RegExp(O)),this.formats[$]=O,this}errorsText($=this.errors,{separator:O=", ",dataVar:A="data"}={}){return!$||$.length===0?"No errors":$.map(T=>`${A}${T.instancePath} ${T.message}`).reduce((T,I)=>T+O+I)}$dataMetaSchema($,O){const A=this.RULES.all;$=JSON.parse(JSON.stringify($));for(const T of O){const I=T.split("/").slice(1);let x=$;for(const W of I)x=x[W];for(const W in A){const Z=A[W];if(typeof Z!="object")continue;const{$data:se}=Z.definition,re=x[W];se&&re&&(x[W]=ge(re))}}return $}_removeAllSchemas($,O){for(const A in $){const T=$[A];(!O||O.test(A))&&(typeof T=="string"?delete $[A]:T&&!T.meta&&(this._cache.delete(T.schema),delete $[A]))}}_addSchema($,O,A,T=this.opts.validateSchema,I=this.opts.addUsedSchema){let x;const{schemaId:W}=this.opts;if(typeof $=="object")x=$[W];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof $!="boolean")throw new Error("schema must be object or boolean")}let Z=this._cache.get($);if(Z!==void 0)return Z;A=(0,l.normalizeId)(x||A);const se=l.getSchemaRefs.call(this,$,A);return Z=new i.SchemaEnv({schema:$,schemaId:W,meta:O,baseId:A,localRefs:se}),this._cache.set(Z.schema,Z),I&&!A.startsWith("#")&&(A&&this._checkUnique(A),this.refs[A]=Z),T&&this.validateSchema($,!0),Z}_checkUnique($){if(this.schemas[$]||this.refs[$])throw new Error(`schema with key or id "${$}" already exists`)}_compileSchemaEnv($){if($.meta?this._compileMetaSchema($):i.compileSchema.call(this,$),!$.validate)throw new Error("ajv implementation error");return $.validate}_compileMetaSchema($){const O=this.opts;this.opts=this._metaOpts;try{i.compileSchema.call(this,$)}finally{this.opts=O}}}b.ValidationError=r.default,b.MissingRefError=o.default,t.default=b;function y(V,$,O,A="error"){for(const T in V){const I=T;I in $&&this.logger[A](`${O}: option ${T}. ${V[I]}`)}}function C(V){return V=(0,l.normalizeId)(V),this.schemas[V]||this.refs[V]}function k(){const V=this.opts.schemas;if(V)if(Array.isArray(V))this.addSchema(V);else for(const $ in V)this.addSchema(V[$],$)}function P(){for(const V in this.opts.formats){const $=this.opts.formats[V];$&&this.addFormat(V,$)}}function M(V){if(Array.isArray(V)){this.addVocabulary(V);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const $ in V){const O=V[$];O.keyword||(O.keyword=$),this.addKeyword(O)}}function q(){const V={...this.opts};for(const $ of w)delete V[$];return V}const D={log(){},warn(){},error(){}};function G(V){if(V===!1)return D;if(V===void 0)return console;if(V.log&&V.warn&&V.error)return V;throw new Error("logger must implement log, warn and error methods")}const B=/^[a-z_$][a-z0-9_$:-]*$/i;function K(V,$){const{RULES:O}=this;if((0,u.eachItem)(V,A=>{if(O.keywords[A])throw new Error(`Keyword ${A} is already defined`);if(!B.test(A))throw new Error(`Keyword ${A} has invalid name`)}),!!$&&$.$data&&!("code"in $||"validate"in $))throw new Error('$data keyword must have "code" or "validate" function')}function oe(V,$,O){var A;const T=$?.post;if(O&&T)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:I}=this;let x=T?I.post:I.rules.find(({type:Z})=>Z===O);if(x||(x={type:O,rules:[]},I.rules.push(x)),I.keywords[V]=!0,!$)return;const W={keyword:V,definition:{...$,type:(0,c.getJSONTypes)($.type),schemaType:(0,c.getJSONTypes)($.schemaType)}};$.before?Se.call(this,x,W,$.before):x.rules.push(W),I.all[V]=W,(A=$.implements)===null||A===void 0||A.forEach(Z=>this.addKeyword(Z))}function Se(V,$,O){const A=V.rules.findIndex(T=>T.keyword===O);A>=0?V.rules.splice(A,0,$):(V.rules.push($),this.logger.warn(`rule ${O} is not defined`))}function be(V){let{metaSchema:$}=V;$!==void 0&&(V.$data&&this.opts.$data&&($=ge($)),V.validateSchema=this.compile($,!0))}const ee={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function ge(V){return{anyOf:[V,ee]}}})(_l)),_l}var As={},Ps={},Ns={},hm;function hD(){if(hm)return Ns;hm=1,Object.defineProperty(Ns,"__esModule",{value:!0});const t={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};return Ns.default=t,Ns}var _n={},pm;function pD(){if(pm)return _n;pm=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.callRef=_n.getValidate=void 0;const t=Ua(),e=Yt(),n=ve(),r=$n(),o=Mu(),s=Re(),i={keyword:"$ref",schemaType:"string",code(c){const{gen:u,schema:h,it:p}=c,{baseId:m,schemaEnv:w,validateName:E,opts:_,self:v}=p,{root:g}=w;if((h==="#"||h==="#/")&&m===g.baseId)return b();const S=o.resolveRef.call(v,g,m,h);if(S===void 0)throw new t.default(p.opts.uriResolver,m,h);if(S instanceof o.SchemaEnv)return y(S);return C(S);function b(){if(w===g)return l(c,E,w,w.$async);const k=u.scopeValue("root",{ref:g});return l(c,(0,n._)`${k}.validate`,g,g.$async)}function y(k){const P=a(c,k);l(c,P,k,k.$async)}function C(k){const P=u.scopeValue("schema",_.code.source===!0?{ref:k,code:(0,n.stringify)(k)}:{ref:k}),M=u.name("valid"),q=c.subschema({schema:k,dataTypes:[],schemaPath:n.nil,topSchemaRef:P,errSchemaPath:h},M);c.mergeEvaluated(q),c.ok(M)}}};function a(c,u){const{gen:h}=c;return u.validate?h.scopeValue("validate",{ref:u.validate}):(0,n._)`${h.scopeValue("wrapper",{ref:u})}.validate`}_n.getValidate=a;function l(c,u,h,p){const{gen:m,it:w}=c,{allErrors:E,schemaEnv:_,opts:v}=w,g=v.passContext?r.default.this:n.nil;p?S():b();function S(){if(!_.$async)throw new Error("async schema referenced by sync schema");const k=m.let("valid");m.try(()=>{m.code((0,n._)`await ${(0,e.callValidateCode)(c,u,g)}`),C(u),E||m.assign(k,!0)},P=>{m.if((0,n._)`!(${P} instanceof ${w.ValidationError})`,()=>m.throw(P)),y(P),E||m.assign(k,!1)}),c.ok(k)}function b(){c.result((0,e.callValidateCode)(c,u,g),()=>C(u),()=>y(u))}function y(k){const P=(0,n._)`${k}.errors`;m.assign(r.default.vErrors,(0,n._)`${r.default.vErrors} === null ? ${P} : ${r.default.vErrors}.concat(${P})`),m.assign(r.default.errors,(0,n._)`${r.default.vErrors}.length`)}function C(k){var P;if(!w.opts.unevaluated)return;const M=(P=h?.validate)===null||P===void 0?void 0:P.evaluated;if(w.props!==!0)if(M&&!M.dynamicProps)M.props!==void 0&&(w.props=s.mergeEvaluated.props(m,M.props,w.props));else{const q=m.var("props",(0,n._)`${k}.evaluated.props`);w.props=s.mergeEvaluated.props(m,q,w.props,n.Name)}if(w.items!==!0)if(M&&!M.dynamicItems)M.items!==void 0&&(w.items=s.mergeEvaluated.items(m,M.items,w.items));else{const q=m.var("items",(0,n._)`${k}.evaluated.items`);w.items=s.mergeEvaluated.items(m,q,w.items,n.Name)}}}return _n.callRef=l,_n.default=i,_n}var mm;function mD(){if(mm)return Ps;mm=1,Object.defineProperty(Ps,"__esModule",{value:!0});const t=hD(),e=pD(),n=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",t.default,e.default];return Ps.default=n,Ps}var Ms={},xs={},gm;function gD(){if(gm)return xs;gm=1,Object.defineProperty(xs,"__esModule",{value:!0});const t=ve(),e=t.operators,n={maximum:{okStr:"<=",ok:e.LTE,fail:e.GT},minimum:{okStr:">=",ok:e.GTE,fail:e.LT},exclusiveMaximum:{okStr:"<",ok:e.LT,fail:e.GTE},exclusiveMinimum:{okStr:">",ok:e.GT,fail:e.LTE}},r={message:({keyword:s,schemaCode:i})=>(0,t.str)`must be ${n[s].okStr} ${i}`,params:({keyword:s,schemaCode:i})=>(0,t._)`{comparison: ${n[s].okStr}, limit: ${i}}`},o={keyword:Object.keys(n),type:"number",schemaType:"number",$data:!0,error:r,code(s){const{keyword:i,data:a,schemaCode:l}=s;s.fail$data((0,t._)`${a} ${n[i].fail} ${l} || isNaN(${a})`)}};return xs.default=o,xs}var Ds={},_m;function _D(){if(_m)return Ds;_m=1,Object.defineProperty(Ds,"__esModule",{value:!0});const t=ve(),n={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:r})=>(0,t.str)`must be multiple of ${r}`,params:({schemaCode:r})=>(0,t._)`{multipleOf: ${r}}`},code(r){const{gen:o,data:s,schemaCode:i,it:a}=r,l=a.opts.multipleOfPrecision,c=o.let("res"),u=l?(0,t._)`Math.abs(Math.round(${c}) - ${c}) > 1e-${l}`:(0,t._)`${c} !== parseInt(${c})`;r.fail$data((0,t._)`(${i} === 0 || (${c} = ${s}/${i}, ${u}))`)}};return Ds.default=n,Ds}var Os={},Us={},ym;function yD(){if(ym)return Us;ym=1,Object.defineProperty(Us,"__esModule",{value:!0});function t(e){const n=e.length;let r=0,o=0,s;for(;o<n;)r++,s=e.charCodeAt(o++),s>=55296&&s<=56319&&o<n&&(s=e.charCodeAt(o),(s&64512)===56320&&o++);return r}return Us.default=t,t.code='require("ajv/dist/runtime/ucs2length").default',Us}var vm;function vD(){if(vm)return Os;vm=1,Object.defineProperty(Os,"__esModule",{value:!0});const t=ve(),e=Re(),n=yD(),o={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:s,schemaCode:i}){const a=s==="maxLength"?"more":"fewer";return(0,t.str)`must NOT have ${a} than ${i} characters`},params:({schemaCode:s})=>(0,t._)`{limit: ${s}}`},code(s){const{keyword:i,data:a,schemaCode:l,it:c}=s,u=i==="maxLength"?t.operators.GT:t.operators.LT,h=c.opts.unicode===!1?(0,t._)`${a}.length`:(0,t._)`${(0,e.useFunc)(s.gen,n.default)}(${a})`;s.fail$data((0,t._)`${h} ${u} ${l}`)}};return Os.default=o,Os}var Ls={},wm;function wD(){if(wm)return Ls;wm=1,Object.defineProperty(Ls,"__esModule",{value:!0});const t=Yt(),e=ve(),r={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:o})=>(0,e.str)`must match pattern "${o}"`,params:({schemaCode:o})=>(0,e._)`{pattern: ${o}}`},code(o){const{data:s,$data:i,schema:a,schemaCode:l,it:c}=o,u=c.opts.unicodeRegExp?"u":"",h=i?(0,e._)`(new RegExp(${l}, ${u}))`:(0,t.usePattern)(o,a);o.fail$data((0,e._)`!${h}.test(${s})`)}};return Ls.default=r,Ls}var qs={},Sm;function SD(){if(Sm)return qs;Sm=1,Object.defineProperty(qs,"__esModule",{value:!0});const t=ve(),n={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:r,schemaCode:o}){const s=r==="maxProperties"?"more":"fewer";return(0,t.str)`must NOT have ${s} than ${o} properties`},params:({schemaCode:r})=>(0,t._)`{limit: ${r}}`},code(r){const{keyword:o,data:s,schemaCode:i}=r,a=o==="maxProperties"?t.operators.GT:t.operators.LT;r.fail$data((0,t._)`Object.keys(${s}).length ${a} ${i}`)}};return qs.default=n,qs}var Fs={},Em;function ED(){if(Em)return Fs;Em=1,Object.defineProperty(Fs,"__esModule",{value:!0});const t=Yt(),e=ve(),n=Re(),o={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:s}})=>(0,e.str)`must have required property '${s}'`,params:({params:{missingProperty:s}})=>(0,e._)`{missingProperty: ${s}}`},code(s){const{gen:i,schema:a,schemaCode:l,data:c,$data:u,it:h}=s,{opts:p}=h;if(!u&&a.length===0)return;const m=a.length>=p.loopRequired;if(h.allErrors?w():E(),p.strictRequired){const g=s.parentSchema.properties,{definedProperties:S}=s.it;for(const b of a)if(g?.[b]===void 0&&!S.has(b)){const y=h.schemaEnv.baseId+h.errSchemaPath,C=`required property "${b}" is not defined at "${y}" (strictRequired)`;(0,n.checkStrictMode)(h,C,h.opts.strictRequired)}}function w(){if(m||u)s.block$data(e.nil,_);else for(const g of a)(0,t.checkReportMissingProp)(s,g)}function E(){const g=i.let("missing");if(m||u){const S=i.let("valid",!0);s.block$data(S,()=>v(g,S)),s.ok(S)}else i.if((0,t.checkMissingProp)(s,a,g)),(0,t.reportMissingProp)(s,g),i.else()}function _(){i.forOf("prop",l,g=>{s.setParams({missingProperty:g}),i.if((0,t.noPropertyInData)(i,c,g,p.ownProperties),()=>s.error())})}function v(g,S){s.setParams({missingProperty:g}),i.forOf(g,l,()=>{i.assign(S,(0,t.propertyInData)(i,c,g,p.ownProperties)),i.if((0,e.not)(S),()=>{s.error(),i.break()})},e.nil)}}};return Fs.default=o,Fs}var Vs={},Tm;function TD(){if(Tm)return Vs;Tm=1,Object.defineProperty(Vs,"__esModule",{value:!0});const t=ve(),n={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:r,schemaCode:o}){const s=r==="maxItems"?"more":"fewer";return(0,t.str)`must NOT have ${s} than ${o} items`},params:({schemaCode:r})=>(0,t._)`{limit: ${r}}`},code(r){const{keyword:o,data:s,schemaCode:i}=r,a=o==="maxItems"?t.operators.GT:t.operators.LT;r.fail$data((0,t._)`${s}.length ${a} ${i}`)}};return Vs.default=n,Vs}var zs={},Hs={},bm;function xu(){if(bm)return Hs;bm=1,Object.defineProperty(Hs,"__esModule",{value:!0});const t=Aa();return t.code='require("ajv/dist/runtime/equal").default',Hs.default=t,Hs}var Cm;function bD(){if(Cm)return zs;Cm=1,Object.defineProperty(zs,"__esModule",{value:!0});const t=Wi(),e=ve(),n=Re(),r=xu(),s={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i,j:a}})=>(0,e.str)`must NOT have duplicate items (items ## ${a} and ${i} are identical)`,params:({params:{i,j:a}})=>(0,e._)`{i: ${i}, j: ${a}}`},code(i){const{gen:a,data:l,$data:c,schema:u,parentSchema:h,schemaCode:p,it:m}=i;if(!c&&!u)return;const w=a.let("valid"),E=h.items?(0,t.getSchemaTypes)(h.items):[];i.block$data(w,_,(0,e._)`${p} === false`),i.ok(w);function _(){const b=a.let("i",(0,e._)`${l}.length`),y=a.let("j");i.setParams({i:b,j:y}),a.assign(w,!0),a.if((0,e._)`${b} > 1`,()=>(v()?g:S)(b,y))}function v(){return E.length>0&&!E.some(b=>b==="object"||b==="array")}function g(b,y){const C=a.name("item"),k=(0,t.checkDataTypes)(E,C,m.opts.strictNumbers,t.DataType.Wrong),P=a.const("indices",(0,e._)`{}`);a.for((0,e._)`;${b}--;`,()=>{a.let(C,(0,e._)`${l}[${b}]`),a.if(k,(0,e._)`continue`),E.length>1&&a.if((0,e._)`typeof ${C} == "string"`,(0,e._)`${C} += "_"`),a.if((0,e._)`typeof ${P}[${C}] == "number"`,()=>{a.assign(y,(0,e._)`${P}[${C}]`),i.error(),a.assign(w,!1).break()}).code((0,e._)`${P}[${C}] = ${b}`)})}function S(b,y){const C=(0,n.useFunc)(a,r.default),k=a.name("outer");a.label(k).for((0,e._)`;${b}--;`,()=>a.for((0,e._)`${y} = ${b}; ${y}--;`,()=>a.if((0,e._)`${C}(${l}[${b}], ${l}[${y}])`,()=>{i.error(),a.assign(w,!1).break(k)})))}}};return zs.default=s,zs}var Gs={},km;function CD(){if(km)return Gs;km=1,Object.defineProperty(Gs,"__esModule",{value:!0});const t=ve(),e=Re(),n=xu(),o={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:s})=>(0,t._)`{allowedValue: ${s}}`},code(s){const{gen:i,data:a,$data:l,schemaCode:c,schema:u}=s;l||u&&typeof u=="object"?s.fail$data((0,t._)`!${(0,e.useFunc)(i,n.default)}(${a}, ${c})`):s.fail((0,t._)`${u} !== ${a}`)}};return Gs.default=o,Gs}var Bs={},Im;function kD(){if(Im)return Bs;Im=1,Object.defineProperty(Bs,"__esModule",{value:!0});const t=ve(),e=Re(),n=xu(),o={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:s})=>(0,t._)`{allowedValues: ${s}}`},code(s){const{gen:i,data:a,$data:l,schema:c,schemaCode:u,it:h}=s;if(!l&&c.length===0)throw new Error("enum must have non-empty array");const p=c.length>=h.opts.loopEnum;let m;const w=()=>m??(m=(0,e.useFunc)(i,n.default));let E;if(p||l)E=i.let("valid"),s.block$data(E,_);else{if(!Array.isArray(c))throw new Error("ajv implementation error");const g=i.const("vSchema",u);E=(0,t.or)(...c.map((S,b)=>v(g,b)))}s.pass(E);function _(){i.assign(E,!1),i.forOf("v",u,g=>i.if((0,t._)`${w()}(${a}, ${g})`,()=>i.assign(E,!0).break()))}function v(g,S){const b=c[S];return typeof b=="object"&&b!==null?(0,t._)`${w()}(${a}, ${g}[${S}])`:(0,t._)`${a} === ${b}`}}};return Bs.default=o,Bs}var Rm;function ID(){if(Rm)return Ms;Rm=1,Object.defineProperty(Ms,"__esModule",{value:!0});const t=gD(),e=_D(),n=vD(),r=wD(),o=SD(),s=ED(),i=TD(),a=bD(),l=CD(),c=kD(),u=[t.default,e.default,n.default,r.default,o.default,s.default,i.default,a.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},l.default,c.default];return Ms.default=u,Ms}var Js={},rr={},$m;function Iv(){if($m)return rr;$m=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.validateAdditionalItems=void 0;const t=ve(),e=Re(),r={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:s}})=>(0,t.str)`must NOT have more than ${s} items`,params:({params:{len:s}})=>(0,t._)`{limit: ${s}}`},code(s){const{parentSchema:i,it:a}=s,{items:l}=i;if(!Array.isArray(l)){(0,e.checkStrictMode)(a,'"additionalItems" is ignored when "items" is not an array of schemas');return}o(s,l)}};function o(s,i){const{gen:a,schema:l,data:c,keyword:u,it:h}=s;h.items=!0;const p=a.const("len",(0,t._)`${c}.length`);if(l===!1)s.setParams({len:i.length}),s.pass((0,t._)`${p} <= ${i.length}`);else if(typeof l=="object"&&!(0,e.alwaysValidSchema)(h,l)){const w=a.var("valid",(0,t._)`${p} <= ${i.length}`);a.if((0,t.not)(w),()=>m(w)),s.ok(w)}function m(w){a.forRange("i",i.length,p,E=>{s.subschema({keyword:u,dataProp:E,dataPropType:e.Type.Num},w),h.allErrors||a.if((0,t.not)(w),()=>a.break())})}}return rr.validateAdditionalItems=o,rr.default=r,rr}var Ks={},or={},Am;function Rv(){if(Am)return or;Am=1,Object.defineProperty(or,"__esModule",{value:!0}),or.validateTuple=void 0;const t=ve(),e=Re(),n=Yt(),r={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(s){const{schema:i,it:a}=s;if(Array.isArray(i))return o(s,"additionalItems",i);a.items=!0,!(0,e.alwaysValidSchema)(a,i)&&s.ok((0,n.validateArray)(s))}};function o(s,i,a=s.schema){const{gen:l,parentSchema:c,data:u,keyword:h,it:p}=s;E(c),p.opts.unevaluated&&a.length&&p.items!==!0&&(p.items=e.mergeEvaluated.items(l,a.length,p.items));const m=l.name("valid"),w=l.const("len",(0,t._)`${u}.length`);a.forEach((_,v)=>{(0,e.alwaysValidSchema)(p,_)||(l.if((0,t._)`${w} > ${v}`,()=>s.subschema({keyword:h,schemaProp:v,dataProp:v},m)),s.ok(m))});function E(_){const{opts:v,errSchemaPath:g}=p,S=a.length,b=S===_.minItems&&(S===_.maxItems||_[i]===!1);if(v.strictTuples&&!b){const y=`"${h}" is ${S}-tuple, but minItems or maxItems/${i} are not specified or different at path "${g}"`;(0,e.checkStrictMode)(p,y,v.strictTuples)}}}return or.validateTuple=o,or.default=r,or}var Pm;function RD(){if(Pm)return Ks;Pm=1,Object.defineProperty(Ks,"__esModule",{value:!0});const t=Rv(),e={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:n=>(0,t.validateTuple)(n,"items")};return Ks.default=e,Ks}var Ws={},Nm;function $D(){if(Nm)return Ws;Nm=1,Object.defineProperty(Ws,"__esModule",{value:!0});const t=ve(),e=Re(),n=Yt(),r=Iv(),s={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:i}})=>(0,t.str)`must NOT have more than ${i} items`,params:({params:{len:i}})=>(0,t._)`{limit: ${i}}`},code(i){const{schema:a,parentSchema:l,it:c}=i,{prefixItems:u}=l;c.items=!0,!(0,e.alwaysValidSchema)(c,a)&&(u?(0,r.validateAdditionalItems)(i,u):i.ok((0,n.validateArray)(i)))}};return Ws.default=s,Ws}var Zs={},Mm;function AD(){if(Mm)return Zs;Mm=1,Object.defineProperty(Zs,"__esModule",{value:!0});const t=ve(),e=Re(),r={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:o,max:s}})=>s===void 0?(0,t.str)`must contain at least ${o} valid item(s)`:(0,t.str)`must contain at least ${o} and no more than ${s} valid item(s)`,params:({params:{min:o,max:s}})=>s===void 0?(0,t._)`{minContains: ${o}}`:(0,t._)`{minContains: ${o}, maxContains: ${s}}`},code(o){const{gen:s,schema:i,parentSchema:a,data:l,it:c}=o;let u,h;const{minContains:p,maxContains:m}=a;c.opts.next?(u=p===void 0?1:p,h=m):u=1;const w=s.const("len",(0,t._)`${l}.length`);if(o.setParams({min:u,max:h}),h===void 0&&u===0){(0,e.checkStrictMode)(c,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(h!==void 0&&u>h){(0,e.checkStrictMode)(c,'"minContains" > "maxContains" is always invalid'),o.fail();return}if((0,e.alwaysValidSchema)(c,i)){let S=(0,t._)`${w} >= ${u}`;h!==void 0&&(S=(0,t._)`${S} && ${w} <= ${h}`),o.pass(S);return}c.items=!0;const E=s.name("valid");h===void 0&&u===1?v(E,()=>s.if(E,()=>s.break())):u===0?(s.let(E,!0),h!==void 0&&s.if((0,t._)`${l}.length > 0`,_)):(s.let(E,!1),_()),o.result(E,()=>o.reset());function _(){const S=s.name("_valid"),b=s.let("count",0);v(S,()=>s.if(S,()=>g(b)))}function v(S,b){s.forRange("i",0,w,y=>{o.subschema({keyword:"contains",dataProp:y,dataPropType:e.Type.Num,compositeRule:!0},S),b()})}function g(S){s.code((0,t._)`${S}++`),h===void 0?s.if((0,t._)`${S} >= ${u}`,()=>s.assign(E,!0).break()):(s.if((0,t._)`${S} > ${h}`,()=>s.assign(E,!1).break()),u===1?s.assign(E,!0):s.if((0,t._)`${S} >= ${u}`,()=>s.assign(E,!0)))}}};return Zs.default=r,Zs}var Tl={},xm;function PD(){return xm||(xm=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const e=ve(),n=Re(),r=Yt();t.error={message:({params:{property:l,depsCount:c,deps:u}})=>{const h=c===1?"property":"properties";return(0,e.str)`must have ${h} ${u} when property ${l} is present`},params:({params:{property:l,depsCount:c,deps:u,missingProperty:h}})=>(0,e._)`{property: ${l},
    missingProperty: ${h},
    depsCount: ${c},
    deps: ${u}}`};const o={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(l){const[c,u]=s(l);i(l,c),a(l,u)}};function s({schema:l}){const c={},u={};for(const h in l){if(h==="__proto__")continue;const p=Array.isArray(l[h])?c:u;p[h]=l[h]}return[c,u]}function i(l,c=l.schema){const{gen:u,data:h,it:p}=l;if(Object.keys(c).length===0)return;const m=u.let("missing");for(const w in c){const E=c[w];if(E.length===0)continue;const _=(0,r.propertyInData)(u,h,w,p.opts.ownProperties);l.setParams({property:w,depsCount:E.length,deps:E.join(", ")}),p.allErrors?u.if(_,()=>{for(const v of E)(0,r.checkReportMissingProp)(l,v)}):(u.if((0,e._)`${_} && (${(0,r.checkMissingProp)(l,E,m)})`),(0,r.reportMissingProp)(l,m),u.else())}}t.validatePropertyDeps=i;function a(l,c=l.schema){const{gen:u,data:h,keyword:p,it:m}=l,w=u.name("valid");for(const E in c)(0,n.alwaysValidSchema)(m,c[E])||(u.if((0,r.propertyInData)(u,h,E,m.opts.ownProperties),()=>{const _=l.subschema({keyword:p,schemaProp:E},w);l.mergeValidEvaluated(_,w)},()=>u.var(w,!0)),l.ok(w))}t.validateSchemaDeps=a,t.default=o})(Tl)),Tl}var Ys={},Dm;function ND(){if(Dm)return Ys;Dm=1,Object.defineProperty(Ys,"__esModule",{value:!0});const t=ve(),e=Re(),r={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:o})=>(0,t._)`{propertyName: ${o.propertyName}}`},code(o){const{gen:s,schema:i,data:a,it:l}=o;if((0,e.alwaysValidSchema)(l,i))return;const c=s.name("valid");s.forIn("key",a,u=>{o.setParams({propertyName:u}),o.subschema({keyword:"propertyNames",data:u,dataTypes:["string"],propertyName:u,compositeRule:!0},c),s.if((0,t.not)(c),()=>{o.error(!0),l.allErrors||s.break()})}),o.ok(c)}};return Ys.default=r,Ys}var Xs={},Om;function $v(){if(Om)return Xs;Om=1,Object.defineProperty(Xs,"__esModule",{value:!0});const t=Yt(),e=ve(),n=$n(),r=Re(),s={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:i})=>(0,e._)`{additionalProperty: ${i.additionalProperty}}`},code(i){const{gen:a,schema:l,parentSchema:c,data:u,errsCount:h,it:p}=i;if(!h)throw new Error("ajv implementation error");const{allErrors:m,opts:w}=p;if(p.props=!0,w.removeAdditional!=="all"&&(0,r.alwaysValidSchema)(p,l))return;const E=(0,t.allSchemaProperties)(c.properties),_=(0,t.allSchemaProperties)(c.patternProperties);v(),i.ok((0,e._)`${h} === ${n.default.errors}`);function v(){a.forIn("key",u,C=>{!E.length&&!_.length?b(C):a.if(g(C),()=>b(C))})}function g(C){let k;if(E.length>8){const P=(0,r.schemaRefOrVal)(p,c.properties,"properties");k=(0,t.isOwnProperty)(a,P,C)}else E.length?k=(0,e.or)(...E.map(P=>(0,e._)`${C} === ${P}`)):k=e.nil;return _.length&&(k=(0,e.or)(k,..._.map(P=>(0,e._)`${(0,t.usePattern)(i,P)}.test(${C})`))),(0,e.not)(k)}function S(C){a.code((0,e._)`delete ${u}[${C}]`)}function b(C){if(w.removeAdditional==="all"||w.removeAdditional&&l===!1){S(C);return}if(l===!1){i.setParams({additionalProperty:C}),i.error(),m||a.break();return}if(typeof l=="object"&&!(0,r.alwaysValidSchema)(p,l)){const k=a.name("valid");w.removeAdditional==="failing"?(y(C,k,!1),a.if((0,e.not)(k),()=>{i.reset(),S(C)})):(y(C,k),m||a.if((0,e.not)(k),()=>a.break()))}}function y(C,k,P){const M={keyword:"additionalProperties",dataProp:C,dataPropType:r.Type.Str};P===!1&&Object.assign(M,{compositeRule:!0,createErrors:!1,allErrors:!1}),i.subschema(M,k)}}};return Xs.default=s,Xs}var Qs={},Um;function MD(){if(Um)return Qs;Um=1,Object.defineProperty(Qs,"__esModule",{value:!0});const t=Oa(),e=Yt(),n=Re(),r=$v(),o={keyword:"properties",type:"object",schemaType:"object",code(s){const{gen:i,schema:a,parentSchema:l,data:c,it:u}=s;u.opts.removeAdditional==="all"&&l.additionalProperties===void 0&&r.default.code(new t.KeywordCxt(u,r.default,"additionalProperties"));const h=(0,e.allSchemaProperties)(a);for(const _ of h)u.definedProperties.add(_);u.opts.unevaluated&&h.length&&u.props!==!0&&(u.props=n.mergeEvaluated.props(i,(0,n.toHash)(h),u.props));const p=h.filter(_=>!(0,n.alwaysValidSchema)(u,a[_]));if(p.length===0)return;const m=i.name("valid");for(const _ of p)w(_)?E(_):(i.if((0,e.propertyInData)(i,c,_,u.opts.ownProperties)),E(_),u.allErrors||i.else().var(m,!0),i.endIf()),s.it.definedProperties.add(_),s.ok(m);function w(_){return u.opts.useDefaults&&!u.compositeRule&&a[_].default!==void 0}function E(_){s.subschema({keyword:"properties",schemaProp:_,dataProp:_},m)}}};return Qs.default=o,Qs}var js={},Lm;function xD(){if(Lm)return js;Lm=1,Object.defineProperty(js,"__esModule",{value:!0});const t=Yt(),e=ve(),n=Re(),r=Re(),o={keyword:"patternProperties",type:"object",schemaType:"object",code(s){const{gen:i,schema:a,data:l,parentSchema:c,it:u}=s,{opts:h}=u,p=(0,t.allSchemaProperties)(a),m=p.filter(b=>(0,n.alwaysValidSchema)(u,a[b]));if(p.length===0||m.length===p.length&&(!u.opts.unevaluated||u.props===!0))return;const w=h.strictSchema&&!h.allowMatchingProperties&&c.properties,E=i.name("valid");u.props!==!0&&!(u.props instanceof e.Name)&&(u.props=(0,r.evaluatedPropsToName)(i,u.props));const{props:_}=u;v();function v(){for(const b of p)w&&g(b),u.allErrors?S(b):(i.var(E,!0),S(b),i.if(E))}function g(b){for(const y in w)new RegExp(b).test(y)&&(0,n.checkStrictMode)(u,`property ${y} matches pattern ${b} (use allowMatchingProperties)`)}function S(b){i.forIn("key",l,y=>{i.if((0,e._)`${(0,t.usePattern)(s,b)}.test(${y})`,()=>{const C=m.includes(b);C||s.subschema({keyword:"patternProperties",schemaProp:b,dataProp:y,dataPropType:r.Type.Str},E),u.opts.unevaluated&&_!==!0?i.assign((0,e._)`${_}[${y}]`,!0):!C&&!u.allErrors&&i.if((0,e.not)(E),()=>i.break())})})}}};return js.default=o,js}var ei={},qm;function DD(){if(qm)return ei;qm=1,Object.defineProperty(ei,"__esModule",{value:!0});const t=Re(),e={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(n){const{gen:r,schema:o,it:s}=n;if((0,t.alwaysValidSchema)(s,o)){n.fail();return}const i=r.name("valid");n.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),n.failResult(i,()=>n.reset(),()=>n.error())},error:{message:"must NOT be valid"}};return ei.default=e,ei}var ti={},Fm;function OD(){if(Fm)return ti;Fm=1,Object.defineProperty(ti,"__esModule",{value:!0});const e={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Yt().validateUnion,error:{message:"must match a schema in anyOf"}};return ti.default=e,ti}var ni={},Vm;function UD(){if(Vm)return ni;Vm=1,Object.defineProperty(ni,"__esModule",{value:!0});const t=ve(),e=Re(),r={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:o})=>(0,t._)`{passingSchemas: ${o.passing}}`},code(o){const{gen:s,schema:i,parentSchema:a,it:l}=o;if(!Array.isArray(i))throw new Error("ajv implementation error");if(l.opts.discriminator&&a.discriminator)return;const c=i,u=s.let("valid",!1),h=s.let("passing",null),p=s.name("_valid");o.setParams({passing:h}),s.block(m),o.result(u,()=>o.reset(),()=>o.error(!0));function m(){c.forEach((w,E)=>{let _;(0,e.alwaysValidSchema)(l,w)?s.var(p,!0):_=o.subschema({keyword:"oneOf",schemaProp:E,compositeRule:!0},p),E>0&&s.if((0,t._)`${p} && ${u}`).assign(u,!1).assign(h,(0,t._)`[${h}, ${E}]`).else(),s.if(p,()=>{s.assign(u,!0),s.assign(h,E),_&&o.mergeEvaluated(_,t.Name)})})}}};return ni.default=r,ni}var ri={},zm;function LD(){if(zm)return ri;zm=1,Object.defineProperty(ri,"__esModule",{value:!0});const t=Re(),e={keyword:"allOf",schemaType:"array",code(n){const{gen:r,schema:o,it:s}=n;if(!Array.isArray(o))throw new Error("ajv implementation error");const i=r.name("valid");o.forEach((a,l)=>{if((0,t.alwaysValidSchema)(s,a))return;const c=n.subschema({keyword:"allOf",schemaProp:l},i);n.ok(i),n.mergeEvaluated(c)})}};return ri.default=e,ri}var oi={},Hm;function qD(){if(Hm)return oi;Hm=1,Object.defineProperty(oi,"__esModule",{value:!0});const t=ve(),e=Re(),r={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:s})=>(0,t.str)`must match "${s.ifClause}" schema`,params:({params:s})=>(0,t._)`{failingKeyword: ${s.ifClause}}`},code(s){const{gen:i,parentSchema:a,it:l}=s;a.then===void 0&&a.else===void 0&&(0,e.checkStrictMode)(l,'"if" without "then" and "else" is ignored');const c=o(l,"then"),u=o(l,"else");if(!c&&!u)return;const h=i.let("valid",!0),p=i.name("_valid");if(m(),s.reset(),c&&u){const E=i.let("ifClause");s.setParams({ifClause:E}),i.if(p,w("then",E),w("else",E))}else c?i.if(p,w("then")):i.if((0,t.not)(p),w("else"));s.pass(h,()=>s.error(!0));function m(){const E=s.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},p);s.mergeEvaluated(E)}function w(E,_){return()=>{const v=s.subschema({keyword:E},p);i.assign(h,p),s.mergeValidEvaluated(v,h),_?i.assign(_,(0,t._)`${E}`):s.setParams({ifClause:E})}}}};function o(s,i){const a=s.schema[i];return a!==void 0&&!(0,e.alwaysValidSchema)(s,a)}return oi.default=r,oi}var si={},Gm;function FD(){if(Gm)return si;Gm=1,Object.defineProperty(si,"__esModule",{value:!0});const t=Re(),e={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:n,parentSchema:r,it:o}){r.if===void 0&&(0,t.checkStrictMode)(o,`"${n}" without "if" is ignored`)}};return si.default=e,si}var Bm;function VD(){if(Bm)return Js;Bm=1,Object.defineProperty(Js,"__esModule",{value:!0});const t=Iv(),e=RD(),n=Rv(),r=$D(),o=AD(),s=PD(),i=ND(),a=$v(),l=MD(),c=xD(),u=DD(),h=OD(),p=UD(),m=LD(),w=qD(),E=FD();function _(v=!1){const g=[u.default,h.default,p.default,m.default,w.default,E.default,i.default,a.default,s.default,l.default,c.default];return v?g.push(e.default,r.default):g.push(t.default,n.default),g.push(o.default),g}return Js.default=_,Js}var ii={},ai={},Jm;function zD(){if(Jm)return ai;Jm=1,Object.defineProperty(ai,"__esModule",{value:!0});const t=ve(),n={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:r})=>(0,t.str)`must match format "${r}"`,params:({schemaCode:r})=>(0,t._)`{format: ${r}}`},code(r,o){const{gen:s,data:i,$data:a,schema:l,schemaCode:c,it:u}=r,{opts:h,errSchemaPath:p,schemaEnv:m,self:w}=u;if(!h.validateFormats)return;a?E():_();function E(){const v=s.scopeValue("formats",{ref:w.formats,code:h.code.formats}),g=s.const("fDef",(0,t._)`${v}[${c}]`),S=s.let("fType"),b=s.let("format");s.if((0,t._)`typeof ${g} == "object" && !(${g} instanceof RegExp)`,()=>s.assign(S,(0,t._)`${g}.type || "string"`).assign(b,(0,t._)`${g}.validate`),()=>s.assign(S,(0,t._)`"string"`).assign(b,g)),r.fail$data((0,t.or)(y(),C()));function y(){return h.strictSchema===!1?t.nil:(0,t._)`${c} && !${b}`}function C(){const k=m.$async?(0,t._)`(${g}.async ? await ${b}(${i}) : ${b}(${i}))`:(0,t._)`${b}(${i})`,P=(0,t._)`(typeof ${b} == "function" ? ${k} : ${b}.test(${i}))`;return(0,t._)`${b} && ${b} !== true && ${S} === ${o} && !${P}`}}function _(){const v=w.formats[l];if(!v){y();return}if(v===!0)return;const[g,S,b]=C(v);g===o&&r.pass(k());function y(){if(h.strictSchema===!1){w.logger.warn(P());return}throw new Error(P());function P(){return`unknown format "${l}" ignored in schema at path "${p}"`}}function C(P){const M=P instanceof RegExp?(0,t.regexpCode)(P):h.code.formats?(0,t._)`${h.code.formats}${(0,t.getProperty)(l)}`:void 0,q=s.scopeValue("formats",{key:l,ref:P,code:M});return typeof P=="object"&&!(P instanceof RegExp)?[P.type||"string",P.validate,(0,t._)`${q}.validate`]:["string",P,q]}function k(){if(typeof v=="object"&&!(v instanceof RegExp)&&v.async){if(!m.$async)throw new Error("async format in sync schema");return(0,t._)`await ${b}(${i})`}return typeof S=="function"?(0,t._)`${b}(${i})`:(0,t._)`${b}.test(${i})`}}}};return ai.default=n,ai}var Km;function HD(){if(Km)return ii;Km=1,Object.defineProperty(ii,"__esModule",{value:!0});const e=[zD().default];return ii.default=e,ii}var qn={},Wm;function GD(){return Wm||(Wm=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.contentVocabulary=qn.metadataVocabulary=void 0,qn.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],qn.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]),qn}var Zm;function BD(){if(Zm)return As;Zm=1,Object.defineProperty(As,"__esModule",{value:!0});const t=mD(),e=ID(),n=VD(),r=HD(),o=GD(),s=[t.default,e.default,(0,n.default)(),r.default,o.metadataVocabulary,o.contentVocabulary];return As.default=s,As}var li={},Hr={},Ym;function JD(){if(Ym)return Hr;Ym=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.DiscrError=void 0;var t;return(function(e){e.Tag="tag",e.Mapping="mapping"})(t||(Hr.DiscrError=t={})),Hr}var Xm;function KD(){if(Xm)return li;Xm=1,Object.defineProperty(li,"__esModule",{value:!0});const t=ve(),e=JD(),n=Mu(),r=Ua(),o=Re(),i={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:a,tagName:l}})=>a===e.DiscrError.Tag?`tag "${l}" must be string`:`value of tag "${l}" must be in oneOf`,params:({params:{discrError:a,tag:l,tagName:c}})=>(0,t._)`{error: ${a}, tag: ${c}, tagValue: ${l}}`},code(a){const{gen:l,data:c,schema:u,parentSchema:h,it:p}=a,{oneOf:m}=h;if(!p.opts.discriminator)throw new Error("discriminator: requires discriminator option");const w=u.propertyName;if(typeof w!="string")throw new Error("discriminator: requires propertyName");if(u.mapping)throw new Error("discriminator: mapping is not supported");if(!m)throw new Error("discriminator: requires oneOf keyword");const E=l.let("valid",!1),_=l.const("tag",(0,t._)`${c}${(0,t.getProperty)(w)}`);l.if((0,t._)`typeof ${_} == "string"`,()=>v(),()=>a.error(!1,{discrError:e.DiscrError.Tag,tag:_,tagName:w})),a.ok(E);function v(){const b=S();l.if(!1);for(const y in b)l.elseIf((0,t._)`${_} === ${y}`),l.assign(E,g(b[y]));l.else(),a.error(!1,{discrError:e.DiscrError.Mapping,tag:_,tagName:w}),l.endIf()}function g(b){const y=l.name("valid"),C=a.subschema({keyword:"oneOf",schemaProp:b},y);return a.mergeEvaluated(C,t.Name),y}function S(){var b;const y={},C=P(h);let k=!0;for(let D=0;D<m.length;D++){let G=m[D];if(G?.$ref&&!(0,o.schemaHasRulesButRef)(G,p.self.RULES)){const K=G.$ref;if(G=n.resolveRef.call(p.self,p.schemaEnv.root,p.baseId,K),G instanceof n.SchemaEnv&&(G=G.schema),G===void 0)throw new r.default(p.opts.uriResolver,p.baseId,K)}const B=(b=G?.properties)===null||b===void 0?void 0:b[w];if(typeof B!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${w}"`);k=k&&(C||P(G)),M(B,D)}if(!k)throw new Error(`discriminator: "${w}" must be required`);return y;function P({required:D}){return Array.isArray(D)&&D.includes(w)}function M(D,G){if(D.const)q(D.const,G);else if(D.enum)for(const B of D.enum)q(B,G);else throw new Error(`discriminator: "properties/${w}" must have "const" or "enum"`)}function q(D,G){if(typeof D!="string"||D in y)throw new Error(`discriminator: "${w}" values must be unique strings`);y[D]=G}}}};return li.default=i,li}const WD="http://json-schema.org/draft-07/schema#",ZD="http://json-schema.org/draft-07/schema#",YD="Core schema meta-schema",XD={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},QD=["object","boolean"],jD={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},eO={$schema:WD,$id:ZD,title:YD,definitions:XD,type:QD,properties:jD,default:!0};var Qm;function tO(){return Qm||(Qm=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=e.Ajv=void 0;const n=fD(),r=BD(),o=KD(),s=eO,i=["/properties"],a="http://json-schema.org/draft-07/schema";class l extends n.default{_addVocabularies(){super._addVocabularies(),r.default.forEach(w=>this.addVocabulary(w)),this.opts.discriminator&&this.addKeyword(o.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const w=this.opts.$data?this.$dataMetaSchema(s,i):s;this.addMetaSchema(w,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}e.Ajv=l,t.exports=e=l,t.exports.Ajv=l,Object.defineProperty(e,"__esModule",{value:!0}),e.default=l;var c=Oa();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var u=ve();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var h=Nu();Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return h.default}});var p=Ua();Object.defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return p.default}})})(Cs,Cs.exports)),Cs.exports}var jm;function nO(){return jm||(jm=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatLimitDefinition=void 0;const e=tO(),n=ve(),r=n.operators,o={formatMaximum:{okStr:"<=",ok:r.LTE,fail:r.GT},formatMinimum:{okStr:">=",ok:r.GTE,fail:r.LT},formatExclusiveMaximum:{okStr:"<",ok:r.LT,fail:r.GTE},formatExclusiveMinimum:{okStr:">",ok:r.GT,fail:r.LTE}},s={message:({keyword:a,schemaCode:l})=>(0,n.str)`should be ${o[a].okStr} ${l}`,params:({keyword:a,schemaCode:l})=>(0,n._)`{comparison: ${o[a].okStr}, limit: ${l}}`};t.formatLimitDefinition={keyword:Object.keys(o),type:"string",schemaType:"string",$data:!0,error:s,code(a){const{gen:l,data:c,schemaCode:u,keyword:h,it:p}=a,{opts:m,self:w}=p;if(!m.validateFormats)return;const E=new e.KeywordCxt(p,w.RULES.all.format.definition,"format");E.$data?_():v();function _(){const S=l.scopeValue("formats",{ref:w.formats,code:m.code.formats}),b=l.const("fmt",(0,n._)`${S}[${E.schemaCode}]`);a.fail$data((0,n.or)((0,n._)`typeof ${b} != "object"`,(0,n._)`${b} instanceof RegExp`,(0,n._)`typeof ${b}.compare != "function"`,g(b)))}function v(){const S=E.schema,b=w.formats[S];if(!b||b===!0)return;if(typeof b!="object"||b instanceof RegExp||typeof b.compare!="function")throw new Error(`"${h}": format "${S}" does not define "compare" function`);const y=l.scopeValue("formats",{key:S,ref:b,code:m.code.formats?(0,n._)`${m.code.formats}${(0,n.getProperty)(S)}`:void 0});a.fail$data(g(y))}function g(S){return(0,n._)`${S}.compare(${c}, ${u}) ${o[h].fail} 0`}},dependencies:["format"]};const i=a=>(a.addKeyword(t.formatLimitDefinition),a);t.default=i})(gl)),gl}var eg;function rO(){return eg||(eg=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});const n=Qx(),r=nO(),o=ve(),s=new o.Name("fullFormats"),i=new o.Name("fastFormats"),a=(c,u={keywords:!0})=>{if(Array.isArray(u))return l(c,u,n.fullFormats,s),c;const[h,p]=u.mode==="fast"?[n.fastFormats,i]:[n.fullFormats,s],m=u.formats||n.formatNames;return l(c,m,h,p),u.keywords&&(0,r.default)(c),c};a.get=(c,u="full")=>{const p=(u==="fast"?n.fastFormats:n.fullFormats)[c];if(!p)throw new Error(`Unknown format "${c}"`);return p};function l(c,u,h,p){var m,w;(m=(w=c.opts.code).formats)!==null&&m!==void 0||(w.formats=(0,o._)`require("ajv-formats/dist/formats").${p}`);for(const E of u)c.addFormat(E,h[E])}t.exports=e=a,Object.defineProperty(e,"__esModule",{value:!0}),e.default=a})(bs,bs.exports)),bs.exports}var oO=rO();const sO=_v(oO);function iO(){const t=new Xx({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return sO(t),t}class aO{constructor(e){this._ajv=e??iO()}getValidator(e){const n="$id"in e&&typeof e.$id=="string"?this._ajv.getSchema(e.$id)??this._ajv.compile(e):this._ajv.compile(e);return r=>n(r)?{valid:!0,data:r,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(n.errors)}}}class lO{constructor(e){this._client=e}async*callToolStream(e,n=Ra,r){const o=this._client,s={...r,task:r?.task??(o.isToolTask(e.name)?{}:void 0)},i=o.requestStream({method:"tools/call",params:e},n,s),a=o.getToolOutputValidator(e.name);for await(const l of i){if(l.type==="result"&&a){const c=l.result;if(!c.structuredContent&&!c.isError){yield{type:"error",error:new de(pe.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`)};return}if(c.structuredContent)try{const u=a(c.structuredContent);if(!u.valid){yield{type:"error",error:new de(pe.InvalidParams,`Structured content does not match the tool's output schema: ${u.errorMessage}`)};return}}catch(u){if(u instanceof de){yield{type:"error",error:u};return}yield{type:"error",error:new de(pe.InvalidParams,`Failed to validate structured content: ${u instanceof Error?u.message:String(u)}`)};return}}yield l}}async getTask(e,n){return this._client.getTask({taskId:e},n)}async getTaskResult(e,n,r){return this._client.getTaskResult({taskId:e},n,r)}async listTasks(e,n){return this._client.listTasks(e?{cursor:e}:void 0,n)}async cancelTask(e,n){return this._client.cancelTask({taskId:e},n)}requestStream(e,n,r){return this._client.requestStream(e,n,r)}}function cO(t,e,n){if(!t)throw new Error(`${n} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!t.tools?.call)throw new Error(`${n} does not support task creation for tools/call (required for ${e})`);break}}function uO(t,e,n){if(!t)throw new Error(`${n} does not support task creation (required for ${e})`);switch(e){case"sampling/createMessage":if(!t.sampling?.createMessage)throw new Error(`${n} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!t.elicitation?.create)throw new Error(`${n} does not support task creation for elicitation/create (required for ${e})`);break}}function Ti(t,e){if(!(!t||e===null||typeof e!="object")){if(t.type==="object"&&t.properties&&typeof t.properties=="object"){const n=e,r=t.properties;for(const o of Object.keys(r)){const s=r[o];n[o]===void 0&&Object.prototype.hasOwnProperty.call(s,"default")&&(n[o]=s.default),n[o]!==void 0&&Ti(s,n[o])}}if(Array.isArray(t.anyOf))for(const n of t.anyOf)typeof n!="boolean"&&Ti(n,e);if(Array.isArray(t.oneOf))for(const n of t.oneOf)typeof n!="boolean"&&Ti(n,e)}}function dO(t){if(!t)return{supportsFormMode:!1,supportsUrlMode:!1};const e=t.form!==void 0,n=t.url!==void 0;return{supportsFormMode:e||!e&&!n,supportsUrlMode:n}}class Av extends G1{constructor(e,n){super(n),this._clientInfo=e,this._cachedToolOutputValidators=new Map,this._cachedKnownTaskTools=new Set,this._cachedRequiredTaskTools=new Set,this._listChangedDebounceTimers=new Map,this._capabilities=n?.capabilities??{},this._jsonSchemaValidator=n?.jsonSchemaValidator??new aO,n?.listChanged&&(this._pendingListChangedConfig=n.listChanged)}_setupListChangedHandlers(e){e.tools&&this._serverCapabilities?.tools?.listChanged&&this._setupListChangedHandler("tools",cv,e.tools,async()=>(await this.listTools()).tools),e.prompts&&this._serverCapabilities?.prompts?.listChanged&&this._setupListChangedHandler("prompts",iv,e.prompts,async()=>(await this.listPrompts()).prompts),e.resources&&this._serverCapabilities?.resources?.listChanged&&this._setupListChangedHandler("resources",rv,e.resources,async()=>(await this.listResources()).resources)}get experimental(){return this._experimental||(this._experimental={tasks:new lO(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=B1(this._capabilities,e)}setRequestHandler(e,n){const o=Ay(e)?.method;if(!o)throw new Error("Schema is missing a method literal");let s;if(ba(o)){const a=o;s=a._zod?.def?.value??a.value}else{const a=o;s=a._def?.value??a.value}if(typeof s!="string")throw new Error("Schema method literal must be a string");const i=s;if(i==="elicitation/create"){const a=async(l,c)=>{const u=wn(pv,l);if(!u.success){const g=u.error instanceof Error?u.error.message:String(u.error);throw new de(pe.InvalidParams,`Invalid elicitation request: ${g}`)}const{params:h}=u.data;h.mode=h.mode??"form";const{supportsFormMode:p,supportsUrlMode:m}=dO(this._capabilities.elicitation);if(h.mode==="form"&&!p)throw new de(pe.InvalidParams,"Client does not support form-mode elicitation requests");if(h.mode==="url"&&!m)throw new de(pe.InvalidParams,"Client does not support URL-mode elicitation requests");const w=await Promise.resolve(n(l,c));if(h.task){const g=wn(yo,w);if(!g.success){const S=g.error instanceof Error?g.error.message:String(g.error);throw new de(pe.InvalidParams,`Invalid task creation result: ${S}`)}return g.data}const E=wn(mv,w);if(!E.success){const g=E.error instanceof Error?E.error.message:String(E.error);throw new de(pe.InvalidParams,`Invalid elicitation result: ${g}`)}const _=E.data,v=h.mode==="form"?h.requestedSchema:void 0;if(h.mode==="form"&&_.action==="accept"&&_.content&&v&&this._capabilities.elicitation?.form?.applyDefaults)try{Ti(v,_.content)}catch{}return _};return super.setRequestHandler(e,a)}if(i==="sampling/createMessage"){const a=async(l,c)=>{const u=wn(dv,l);if(!u.success){const _=u.error instanceof Error?u.error.message:String(u.error);throw new de(pe.InvalidParams,`Invalid sampling request: ${_}`)}const{params:h}=u.data,p=await Promise.resolve(n(l,c));if(h.task){const _=wn(yo,p);if(!_.success){const v=_.error instanceof Error?_.error.message:String(_.error);throw new de(pe.InvalidParams,`Invalid task creation result: ${v}`)}return _.data}const w=h.tools||h.toolChoice?hv:fv,E=wn(w,p);if(!E.success){const _=E.error instanceof Error?E.error.message:String(E.error);throw new de(pe.InvalidParams,`Invalid sampling result: ${_}`)}return E.data};return super.setRequestHandler(e,a)}return super.setRequestHandler(e,n)}assertCapability(e,n){if(!this._serverCapabilities?.[e])throw new Error(`Server does not support ${e} (required for ${n})`)}async connect(e,n){if(await super.connect(e),e.sessionId===void 0)try{const r=await this.request({method:"initialize",params:{protocolVersion:Ca,capabilities:this._capabilities,clientInfo:this._clientInfo}},Wy,n);if(r===void 0)throw new Error(`Server sent invalid initialize result: ${r}`);if(!dM.includes(r.protocolVersion))throw new Error(`Server's protocol version is not supported: ${r.protocolVersion}`);this._serverCapabilities=r.capabilities,this._serverVersion=r.serverInfo,e.setProtocolVersion&&e.setProtocolVersion(r.protocolVersion),this._instructions=r.instructions,await this.notification({method:"notifications/initialized"}),this._pendingListChangedConfig&&(this._setupListChangedHandlers(this._pendingListChangedConfig),this._pendingListChangedConfig=void 0)}catch(r){throw this.close(),r}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){switch(e){case"logging/setLevel":if(!this._serverCapabilities?.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._serverCapabilities?.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!this._serverCapabilities?.resources)throw new Error(`Server does not support resources (required for ${e})`);if(e==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._serverCapabilities?.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!this._serverCapabilities?.completions)throw new Error(`Server does not support completions (required for ${e})`);break}}assertNotificationCapability(e){switch(e){case"notifications/roots/list_changed":if(!this._capabilities.roots?.listChanged)throw new Error(`Client does not support roots list changed notifications (required for ${e})`);break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${e})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${e})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Client does not support tasks capability (required for ${e})`);break}}assertTaskCapability(e){cO(this._serverCapabilities?.tasks?.requests,e,"Server")}assertTaskHandlerCapability(e){this._capabilities&&uO(this._capabilities.tasks?.requests,e,"Client")}async ping(e){return this.request({method:"ping"},_r,e)}async complete(e,n){return this.request({method:"completion/complete",params:e},gv,n)}async setLoggingLevel(e,n){return this.request({method:"logging/setLevel",params:{level:e}},_r,n)}async getPrompt(e,n){return this.request({method:"prompts/get",params:e},sv,n)}async listPrompts(e,n){return this.request({method:"prompts/list",params:e},ov,n)}async listResources(e,n){return this.request({method:"resources/list",params:e},ev,n)}async listResourceTemplates(e,n){return this.request({method:"resources/templates/list",params:e},tv,n)}async readResource(e,n){return this.request({method:"resources/read",params:e},nv,n)}async subscribeResource(e,n){return this.request({method:"resources/subscribe",params:e},_r,n)}async unsubscribeResource(e,n){return this.request({method:"resources/unsubscribe",params:e},_r,n)}async callTool(e,n=Ra,r){if(this.isToolTaskRequired(e.name))throw new de(pe.InvalidRequest,`Tool "${e.name}" requires task-based execution. Use client.experimental.tasks.callToolStream() instead.`);const o=await this.request({method:"tools/call",params:e},n,r),s=this.getToolOutputValidator(e.name);if(s){if(!o.structuredContent&&!o.isError)throw new de(pe.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`);if(o.structuredContent)try{const i=s(o.structuredContent);if(!i.valid)throw new de(pe.InvalidParams,`Structured content does not match the tool's output schema: ${i.errorMessage}`)}catch(i){throw i instanceof de?i:new de(pe.InvalidParams,`Failed to validate structured content: ${i instanceof Error?i.message:String(i)}`)}}return o}isToolTask(e){return this._serverCapabilities?.tasks?.requests?.tools?.call?this._cachedKnownTaskTools.has(e):!1}isToolTaskRequired(e){return this._cachedRequiredTaskTools.has(e)}cacheToolMetadata(e){this._cachedToolOutputValidators.clear(),this._cachedKnownTaskTools.clear(),this._cachedRequiredTaskTools.clear();for(const n of e){if(n.outputSchema){const o=this._jsonSchemaValidator.getValidator(n.outputSchema);this._cachedToolOutputValidators.set(n.name,o)}const r=n.execution?.taskSupport;(r==="required"||r==="optional")&&this._cachedKnownTaskTools.add(n.name),r==="required"&&this._cachedRequiredTaskTools.add(n.name)}}getToolOutputValidator(e){return this._cachedToolOutputValidators.get(e)}async listTools(e,n){const r=await this.request({method:"tools/list",params:e},lv,n);return this.cacheToolMetadata(r.tools),r}_setupListChangedHandler(e,n,r,o){const s=s1.safeParse(r);if(!s.success)throw new Error(`Invalid ${e} listChanged options: ${s.error.message}`);if(typeof r.onChanged!="function")throw new Error(`Invalid ${e} listChanged options: onChanged must be a function`);const{autoRefresh:i,debounceMs:a}=s.data,{onChanged:l}=r,c=async()=>{if(!i){l(null,null);return}try{const h=await o();l(null,h)}catch(h){const p=h instanceof Error?h:new Error(String(h));l(p,null)}},u=()=>{if(a){const h=this._listChangedDebounceTimers.get(e);h&&clearTimeout(h);const p=setTimeout(c,a);this._listChangedDebounceTimers.set(e,p)}else c()};this.setNotificationHandler(n,u)}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}}function hc(t){return t?t instanceof Headers?Object.fromEntries(t.entries()):Array.isArray(t)?Object.fromEntries(t):{...t}:{}}function fO(t=fetch,e){return e?async(n,r)=>{const o={...e,...r,headers:r?.headers?{...hc(e.headers),...hc(r.headers)}:e.headers};return t(n,o)}:t}let Du;Du=globalThis.crypto;async function hO(t){return(await Du).getRandomValues(new Uint8Array(t))}async function pO(t){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~";let n="";const r=await hO(t);for(let o=0;o<t;o++){const s=r[o]%e.length;n+=e[s]}return n}async function mO(t){return await pO(t)}async function gO(t){const e=await(await Du).subtle.digest("SHA-256",new TextEncoder().encode(t));return btoa(String.fromCharCode(...new Uint8Array(e))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}async function _O(t){if(t||(t=43),t<43||t>128)throw`Expected a length between 43 and 128. Received ${t}.`;const e=await mO(t),n=await gO(e);return{code_verifier:e,code_challenge:n}}const lt=_N().superRefine((t,e)=>{if(!URL.canParse(t))return e.addIssue({code:cM.custom,message:"URL must be parseable",fatal:!0}),wR}).refine(t=>{const e=new URL(t);return e.protocol!=="javascript:"&&e.protocol!=="data:"&&e.protocol!=="vbscript:"},{message:"URL cannot use javascript:, data:, or vbscript: scheme"}),yO=ct({resource:F().url(),authorization_servers:j(lt).optional(),jwks_uri:F().url().optional(),scopes_supported:j(F()).optional(),bearer_methods_supported:j(F()).optional(),resource_signing_alg_values_supported:j(F()).optional(),resource_name:F().optional(),resource_documentation:F().optional(),resource_policy_uri:F().url().optional(),resource_tos_uri:F().url().optional(),tls_client_certificate_bound_access_tokens:qe().optional(),authorization_details_types_supported:j(F()).optional(),dpop_signing_alg_values_supported:j(F()).optional(),dpop_bound_access_tokens_required:qe().optional()}),Pv=ct({issuer:F(),authorization_endpoint:lt,token_endpoint:lt,registration_endpoint:lt.optional(),scopes_supported:j(F()).optional(),response_types_supported:j(F()),response_modes_supported:j(F()).optional(),grant_types_supported:j(F()).optional(),token_endpoint_auth_methods_supported:j(F()).optional(),token_endpoint_auth_signing_alg_values_supported:j(F()).optional(),service_documentation:lt.optional(),revocation_endpoint:lt.optional(),revocation_endpoint_auth_methods_supported:j(F()).optional(),revocation_endpoint_auth_signing_alg_values_supported:j(F()).optional(),introspection_endpoint:F().optional(),introspection_endpoint_auth_methods_supported:j(F()).optional(),introspection_endpoint_auth_signing_alg_values_supported:j(F()).optional(),code_challenge_methods_supported:j(F()).optional(),client_id_metadata_document_supported:qe().optional()}),vO=ct({issuer:F(),authorization_endpoint:lt,token_endpoint:lt,userinfo_endpoint:lt.optional(),jwks_uri:lt,registration_endpoint:lt.optional(),scopes_supported:j(F()).optional(),response_types_supported:j(F()),response_modes_supported:j(F()).optional(),grant_types_supported:j(F()).optional(),acr_values_supported:j(F()).optional(),subject_types_supported:j(F()),id_token_signing_alg_values_supported:j(F()),id_token_encryption_alg_values_supported:j(F()).optional(),id_token_encryption_enc_values_supported:j(F()).optional(),userinfo_signing_alg_values_supported:j(F()).optional(),userinfo_encryption_alg_values_supported:j(F()).optional(),userinfo_encryption_enc_values_supported:j(F()).optional(),request_object_signing_alg_values_supported:j(F()).optional(),request_object_encryption_alg_values_supported:j(F()).optional(),request_object_encryption_enc_values_supported:j(F()).optional(),token_endpoint_auth_methods_supported:j(F()).optional(),token_endpoint_auth_signing_alg_values_supported:j(F()).optional(),display_values_supported:j(F()).optional(),claim_types_supported:j(F()).optional(),claims_supported:j(F()).optional(),service_documentation:F().optional(),claims_locales_supported:j(F()).optional(),ui_locales_supported:j(F()).optional(),claims_parameter_supported:qe().optional(),request_parameter_supported:qe().optional(),request_uri_parameter_supported:qe().optional(),require_request_uri_registration:qe().optional(),op_policy_uri:lt.optional(),op_tos_uri:lt.optional(),client_id_metadata_document_supported:qe().optional()}),wO=te({...vO.shape,...Pv.pick({code_challenge_methods_supported:!0}).shape}),SO=te({access_token:F(),id_token:F().optional(),token_type:F(),expires_in:uM().optional(),scope:F().optional(),refresh_token:F().optional()}).strip(),EO=te({error:F(),error_description:F().optional(),error_uri:F().optional()}),tg=lt.optional().or(le("").transform(()=>{})),TO=te({redirect_uris:j(lt),token_endpoint_auth_method:F().optional(),grant_types:j(F()).optional(),response_types:j(F()).optional(),client_name:F().optional(),client_uri:lt.optional(),logo_uri:tg,scope:F().optional(),contacts:j(F()).optional(),tos_uri:tg,policy_uri:F().optional(),jwks_uri:lt.optional(),jwks:UN().optional(),software_id:F().optional(),software_version:F().optional(),software_statement:F().optional()}).strip(),bO=te({client_id:F(),client_secret:F().optional(),client_id_issued_at:Ne().optional(),client_secret_expires_at:Ne().optional()}).strip(),CO=TO.merge(bO);te({error:F(),error_description:F().optional()}).strip();te({token:F(),token_type_hint:F().optional()}).strip();function kO(t){const e=typeof t=="string"?new URL(t):new URL(t.href);return e.hash="",e}function IO({requestedResource:t,configuredResource:e}){const n=typeof t=="string"?new URL(t):new URL(t.href),r=typeof e=="string"?new URL(e):new URL(e.href);if(n.origin!==r.origin||n.pathname.length<r.pathname.length)return!1;const o=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",s=r.pathname.endsWith("/")?r.pathname:r.pathname+"/";return o.startsWith(s)}class rt extends Error{constructor(e,n){super(e),this.errorUri=n,this.name=this.constructor.name}toResponseObject(){const e={error:this.errorCode,error_description:this.message};return this.errorUri&&(e.error_uri=this.errorUri),e}get errorCode(){return this.constructor.errorCode}}class pc extends rt{}pc.errorCode="invalid_request";class Zi extends rt{}Zi.errorCode="invalid_client";class Yi extends rt{}Yi.errorCode="invalid_grant";class Xi extends rt{}Xi.errorCode="unauthorized_client";class mc extends rt{}mc.errorCode="unsupported_grant_type";class gc extends rt{}gc.errorCode="invalid_scope";class _c extends rt{}_c.errorCode="access_denied";class Ir extends rt{}Ir.errorCode="server_error";class yc extends rt{}yc.errorCode="temporarily_unavailable";class vc extends rt{}vc.errorCode="unsupported_response_type";class wc extends rt{}wc.errorCode="unsupported_token_type";class Sc extends rt{}Sc.errorCode="invalid_token";class Ec extends rt{}Ec.errorCode="method_not_allowed";class Tc extends rt{}Tc.errorCode="too_many_requests";class Qi extends rt{}Qi.errorCode="invalid_client_metadata";class bc extends rt{}bc.errorCode="insufficient_scope";class Cc extends rt{}Cc.errorCode="invalid_target";const RO={[pc.errorCode]:pc,[Zi.errorCode]:Zi,[Yi.errorCode]:Yi,[Xi.errorCode]:Xi,[mc.errorCode]:mc,[gc.errorCode]:gc,[_c.errorCode]:_c,[Ir.errorCode]:Ir,[yc.errorCode]:yc,[vc.errorCode]:vc,[wc.errorCode]:wc,[Sc.errorCode]:Sc,[Ec.errorCode]:Ec,[Tc.errorCode]:Tc,[Qi.errorCode]:Qi,[bc.errorCode]:bc,[Cc.errorCode]:Cc};class sr extends Error{constructor(e){super(e??"Unauthorized")}}function $O(t){return["client_secret_basic","client_secret_post","none"].includes(t)}const bl="code",Cl="S256";function AO(t,e){const n=t.client_secret!==void 0;return e.length===0?n?"client_secret_post":"none":"token_endpoint_auth_method"in t&&t.token_endpoint_auth_method&&$O(t.token_endpoint_auth_method)&&e.includes(t.token_endpoint_auth_method)?t.token_endpoint_auth_method:n&&e.includes("client_secret_basic")?"client_secret_basic":n&&e.includes("client_secret_post")?"client_secret_post":e.includes("none")?"none":n?"client_secret_post":"none"}function PO(t,e,n,r){const{client_id:o,client_secret:s}=e;switch(t){case"client_secret_basic":NO(o,s,n);return;case"client_secret_post":MO(o,s,r);return;case"none":xO(o,r);return;default:throw new Error(`Unsupported client authentication method: ${t}`)}}function NO(t,e,n){if(!e)throw new Error("client_secret_basic authentication requires a client_secret");const r=btoa(`${t}:${e}`);n.set("Authorization",`Basic ${r}`)}function MO(t,e,n){n.set("client_id",t),e&&n.set("client_secret",e)}function xO(t,e){e.set("client_id",t)}async function Nv(t){const e=t instanceof Response?t.status:void 0,n=t instanceof Response?await t.text():t;try{const r=EO.parse(JSON.parse(n)),{error:o,error_description:s,error_uri:i}=r,a=RO[o]||Ir;return new a(s||"",i)}catch(r){const o=`${e?`HTTP ${e}: `:""}Invalid OAuth error response: ${r}. Raw body: ${n}`;return new Ir(o)}}async function ci(t,e){try{return await kl(t,e)}catch(n){if(n instanceof Zi||n instanceof Xi)return await t.invalidateCredentials?.("all"),await kl(t,e);if(n instanceof Yi)return await t.invalidateCredentials?.("tokens"),await kl(t,e);throw n}}async function kl(t,{serverUrl:e,authorizationCode:n,scope:r,resourceMetadataUrl:o,fetchFn:s}){let i,a;try{i=await UO(e,{resourceMetadataUrl:o},s),i.authorization_servers&&i.authorization_servers.length>0&&(a=i.authorization_servers[0])}catch{}a||(a=new URL("/",e));const l=await OO(e,t,i),c=await zO(a,{fetchFn:s});let u=await Promise.resolve(t.clientInformation());if(!u){if(n!==void 0)throw new Error("Existing OAuth client information is required when exchanging an authorization code");const _=c?.client_id_metadata_document_supported===!0,v=t.clientMetadataUrl;if(v&&!DO(v))throw new Qi(`clientMetadataUrl must be a valid HTTPS URL with a non-root pathname, got: ${v}`);if(_&&v)u={client_id:v},await t.saveClientInformation?.(u);else{if(!t.saveClientInformation)throw new Error("OAuth client information must be saveable for dynamic registration");const S=await KO(a,{metadata:c,clientMetadata:t.clientMetadata,fetchFn:s});await t.saveClientInformation(S),u=S}}const h=!t.redirectUrl;if(n!==void 0||h){const _=await JO(t,a,{metadata:c,resource:l,authorizationCode:n,fetchFn:s});return await t.saveTokens(_),"AUTHORIZED"}const p=await t.tokens();if(p?.refresh_token)try{const _=await BO(a,{metadata:c,clientInformation:u,refreshToken:p.refresh_token,resource:l,addClientAuthentication:t.addClientAuthentication,fetchFn:s});return await t.saveTokens(_),"AUTHORIZED"}catch(_){if(!(!(_ instanceof rt)||_ instanceof Ir))throw _}const m=t.state?await t.state():void 0,{authorizationUrl:w,codeVerifier:E}=await HO(a,{metadata:c,clientInformation:u,state:m,redirectUrl:t.redirectUrl,scope:r||i?.scopes_supported?.join(" ")||t.clientMetadata.scope,resource:l});return await t.saveCodeVerifier(E),await t.redirectToAuthorization(w),"REDIRECT"}function DO(t){if(!t)return!1;try{const e=new URL(t);return e.protocol==="https:"&&e.pathname!=="/"}catch{return!1}}async function OO(t,e,n){const r=kO(t);if(e.validateResourceURL)return await e.validateResourceURL(r,n?.resource);if(n){if(!IO({requestedResource:r,configuredResource:n.resource}))throw new Error(`Protected resource ${n.resource} does not match expected ${r} (or origin)`);return new URL(n.resource)}}function ng(t){const e=t.headers.get("WWW-Authenticate");if(!e)return{};const[n,r]=e.split(" ");if(n.toLowerCase()!=="bearer"||!r)return{};const o=Il(t,"resource_metadata")||void 0;let s;if(o)try{s=new URL(o)}catch{}const i=Il(t,"scope")||void 0,a=Il(t,"error")||void 0;return{resourceMetadataUrl:s,scope:i,error:a}}function Il(t,e){const n=t.headers.get("WWW-Authenticate");if(!n)return null;const r=new RegExp(`${e}=(?:"([^"]+)"|([^\\s,]+))`),o=n.match(r);return o?o[1]||o[2]:null}async function UO(t,e,n=fetch){const r=await FO(t,"oauth-protected-resource",n,{protocolVersion:e?.protocolVersion,metadataUrl:e?.resourceMetadataUrl});if(!r||r.status===404)throw await r?.body?.cancel(),new Error("Resource server does not implement OAuth 2.0 Protected Resource Metadata.");if(!r.ok)throw await r.body?.cancel(),new Error(`HTTP ${r.status} trying to load well-known OAuth protected resource metadata.`);return yO.parse(await r.json())}async function Ou(t,e,n=fetch){try{return await n(t,{headers:e})}catch(r){if(r instanceof TypeError)return e?Ou(t,void 0,n):void 0;throw r}}function LO(t,e="",n={}){return e.endsWith("/")&&(e=e.slice(0,-1)),n.prependPathname?`${e}/.well-known/${t}`:`/.well-known/${t}${e}`}async function rg(t,e,n=fetch){return await Ou(t,{"MCP-Protocol-Version":e},n)}function qO(t,e){return!t||t.status>=400&&t.status<500&&e!=="/"}async function FO(t,e,n,r){const o=new URL(t),s=r?.protocolVersion??Ca;let i;if(r?.metadataUrl)i=new URL(r.metadataUrl);else{const l=LO(e,o.pathname);i=new URL(l,r?.metadataServerUrl??o),i.search=o.search}let a=await rg(i,s,n);if(!r?.metadataUrl&&qO(a,o.pathname)){const l=new URL(`/.well-known/${e}`,o);a=await rg(l,s,n)}return a}function VO(t){const e=typeof t=="string"?new URL(t):t,n=e.pathname!=="/",r=[];if(!n)return r.push({url:new URL("/.well-known/oauth-authorization-server",e.origin),type:"oauth"}),r.push({url:new URL("/.well-known/openid-configuration",e.origin),type:"oidc"}),r;let o=e.pathname;return o.endsWith("/")&&(o=o.slice(0,-1)),r.push({url:new URL(`/.well-known/oauth-authorization-server${o}`,e.origin),type:"oauth"}),r.push({url:new URL(`/.well-known/openid-configuration${o}`,e.origin),type:"oidc"}),r.push({url:new URL(`${o}/.well-known/openid-configuration`,e.origin),type:"oidc"}),r}async function zO(t,{fetchFn:e=fetch,protocolVersion:n=Ca}={}){const r={"MCP-Protocol-Version":n,Accept:"application/json"},o=VO(t);for(const{url:s,type:i}of o){const a=await Ou(s,r,e);if(a){if(!a.ok){if(await a.body?.cancel(),a.status>=400&&a.status<500)continue;throw new Error(`HTTP ${a.status} trying to load ${i==="oauth"?"OAuth":"OpenID provider"} metadata from ${s}`)}return i==="oauth"?Pv.parse(await a.json()):wO.parse(await a.json())}}}async function HO(t,{metadata:e,clientInformation:n,redirectUrl:r,scope:o,state:s,resource:i}){let a;if(e){if(a=new URL(e.authorization_endpoint),!e.response_types_supported.includes(bl))throw new Error(`Incompatible auth server: does not support response type ${bl}`);if(e.code_challenge_methods_supported&&!e.code_challenge_methods_supported.includes(Cl))throw new Error(`Incompatible auth server: does not support code challenge method ${Cl}`)}else a=new URL("/authorize",t);const l=await _O(),c=l.code_verifier,u=l.code_challenge;return a.searchParams.set("response_type",bl),a.searchParams.set("client_id",n.client_id),a.searchParams.set("code_challenge",u),a.searchParams.set("code_challenge_method",Cl),a.searchParams.set("redirect_uri",String(r)),s&&a.searchParams.set("state",s),o&&a.searchParams.set("scope",o),o?.includes("offline_access")&&a.searchParams.append("prompt","consent"),i&&a.searchParams.set("resource",i.href),{authorizationUrl:a,codeVerifier:c}}function GO(t,e,n){return new URLSearchParams({grant_type:"authorization_code",code:t,code_verifier:e,redirect_uri:String(n)})}async function Mv(t,{metadata:e,tokenRequestParams:n,clientInformation:r,addClientAuthentication:o,resource:s,fetchFn:i}){const a=e?.token_endpoint?new URL(e.token_endpoint):new URL("/token",t),l=new Headers({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"});if(s&&n.set("resource",s.href),o)await o(l,n,a,e);else if(r){const u=e?.token_endpoint_auth_methods_supported??[],h=AO(r,u);PO(h,r,l,n)}const c=await(i??fetch)(a,{method:"POST",headers:l,body:n});if(!c.ok)throw await Nv(c);return SO.parse(await c.json())}async function BO(t,{metadata:e,clientInformation:n,refreshToken:r,resource:o,addClientAuthentication:s,fetchFn:i}){const a=new URLSearchParams({grant_type:"refresh_token",refresh_token:r}),l=await Mv(t,{metadata:e,tokenRequestParams:a,clientInformation:n,addClientAuthentication:s,resource:o,fetchFn:i});return{refresh_token:r,...l}}async function JO(t,e,{metadata:n,resource:r,authorizationCode:o,fetchFn:s}={}){const i=t.clientMetadata.scope;let a;if(t.prepareTokenRequest&&(a=await t.prepareTokenRequest(i)),!a){if(!o)throw new Error("Either provider.prepareTokenRequest() or authorizationCode is required");if(!t.redirectUrl)throw new Error("redirectUrl is required for authorization_code flow");const c=await t.codeVerifier();a=GO(o,c,t.redirectUrl)}const l=await t.clientInformation();return Mv(e,{metadata:n,tokenRequestParams:a,clientInformation:l??void 0,addClientAuthentication:t.addClientAuthentication,resource:r,fetchFn:s})}async function KO(t,{metadata:e,clientMetadata:n,fetchFn:r}){let o;if(e){if(!e.registration_endpoint)throw new Error("Incompatible auth server: does not support dynamic client registration");o=new URL(e.registration_endpoint)}else o=new URL("/register",t);const s=await(r??fetch)(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!s.ok)throw await Nv(s);return CO.parse(await s.json())}class og extends Error{constructor(e,n){super(e),this.name="ParseError",this.type=n.type,this.field=n.field,this.value=n.value,this.line=n.line}}function Rl(t){}function WO(t){if(typeof t=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:e=Rl,onError:n=Rl,onRetry:r=Rl,onComment:o}=t;let s="",i=!0,a,l="",c="";function u(E){const _=i?E.replace(/^\xEF\xBB\xBF/,""):E,[v,g]=ZO(`${s}${_}`);for(const S of v)h(S);s=g,i=!1}function h(E){if(E===""){m();return}if(E.startsWith(":")){o&&o(E.slice(E.startsWith(": ")?2:1));return}const _=E.indexOf(":");if(_!==-1){const v=E.slice(0,_),g=E[_+1]===" "?2:1,S=E.slice(_+g);p(v,S,E);return}p(E,"",E)}function p(E,_,v){switch(E){case"event":c=_;break;case"data":l=`${l}${_}
`;break;case"id":a=_.includes("\0")?void 0:_;break;case"retry":/^\d+$/.test(_)?r(parseInt(_,10)):n(new og(`Invalid \`retry\` value: "${_}"`,{type:"invalid-retry",value:_,line:v}));break;default:n(new og(`Unknown field "${E.length>20?`${E.slice(0,20)}…`:E}"`,{type:"unknown-field",field:E,value:_,line:v}));break}}function m(){l.length>0&&e({id:a,event:c||void 0,data:l.endsWith(`
`)?l.slice(0,-1):l}),a=void 0,l="",c=""}function w(E={}){s&&E.consume&&h(s),i=!0,a=void 0,l="",c="",s=""}return{feed:u,reset:w}}function ZO(t){const e=[];let n="",r=0;for(;r<t.length;){const o=t.indexOf("\r",r),s=t.indexOf(`
`,r);let i=-1;if(o!==-1&&s!==-1?i=Math.min(o,s):o!==-1?o===t.length-1?i=-1:i=o:s!==-1&&(i=s),i===-1){n=t.slice(r);break}else{const a=t.slice(r,i);e.push(a),r=i+1,t[r-1]==="\r"&&t[r]===`
`&&r++}}return[e,n]}class YO extends TransformStream{constructor({onError:e,onRetry:n,onComment:r}={}){let o;super({start(s){o=WO({onEvent:i=>{s.enqueue(i)},onError(i){e==="terminate"?s.error(i):typeof e=="function"&&e(i)},onRetry:n,onComment:r})},transform(s){o.feed(s)}})}}const XO={initialReconnectionDelay:1e3,maxReconnectionDelay:3e4,reconnectionDelayGrowFactor:1.5,maxRetries:2};class ir extends Error{constructor(e,n){super(`Streamable HTTP error: ${n}`),this.code=e}}class xv{constructor(e,n){this._hasCompletedAuthFlow=!1,this._url=e,this._resourceMetadataUrl=void 0,this._scope=void 0,this._requestInit=n?.requestInit,this._authProvider=n?.authProvider,this._fetch=n?.fetch,this._fetchWithInit=fO(n?.fetch,n?.requestInit),this._sessionId=n?.sessionId,this._reconnectionOptions=n?.reconnectionOptions??XO}async _authThenStart(){if(!this._authProvider)throw new sr("No auth provider");let e;try{e=await ci(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})}catch(n){throw this.onerror?.(n),n}if(e!=="AUTHORIZED")throw new sr;return await this._startOrAuthSse({resumptionToken:void 0})}async _commonHeaders(){const e={};if(this._authProvider){const r=await this._authProvider.tokens();r&&(e.Authorization=`Bearer ${r.access_token}`)}this._sessionId&&(e["mcp-session-id"]=this._sessionId),this._protocolVersion&&(e["mcp-protocol-version"]=this._protocolVersion);const n=hc(this._requestInit?.headers);return new Headers({...e,...n})}async _startOrAuthSse(e){const{resumptionToken:n}=e;try{const r=await this._commonHeaders();r.set("Accept","text/event-stream"),n&&r.set("last-event-id",n);const o=await(this._fetch??fetch)(this._url,{method:"GET",headers:r,signal:this._abortController?.signal});if(!o.ok){if(await o.body?.cancel(),o.status===401&&this._authProvider)return await this._authThenStart();if(o.status===405)return;throw new ir(o.status,`Failed to open SSE stream: ${o.statusText}`)}this._handleSseStream(o.body,e,!0)}catch(r){throw this.onerror?.(r),r}}_getNextReconnectionDelay(e){if(this._serverRetryMs!==void 0)return this._serverRetryMs;const n=this._reconnectionOptions.initialReconnectionDelay,r=this._reconnectionOptions.reconnectionDelayGrowFactor,o=this._reconnectionOptions.maxReconnectionDelay;return Math.min(n*Math.pow(r,e),o)}_scheduleReconnection(e,n=0){const r=this._reconnectionOptions.maxRetries;if(n>=r){this.onerror?.(new Error(`Maximum reconnection attempts (${r}) exceeded.`));return}const o=this._getNextReconnectionDelay(n);this._reconnectionTimeout=setTimeout(()=>{this._startOrAuthSse(e).catch(s=>{this.onerror?.(new Error(`Failed to reconnect SSE stream: ${s instanceof Error?s.message:String(s)}`)),this._scheduleReconnection(e,n+1)})},o)}_handleSseStream(e,n,r){if(!e)return;const{onresumptiontoken:o,replayMessageId:s}=n;let i,a=!1,l=!1;(async()=>{try{const u=e.pipeThrough(new TextDecoderStream).pipeThrough(new YO({onRetry:m=>{this._serverRetryMs=m}})).getReader();for(;;){const{value:m,done:w}=await u.read();if(w)break;if(m.id&&(i=m.id,a=!0,o?.(m.id)),!!m.data&&(!m.event||m.event==="message"))try{const E=ol.parse(JSON.parse(m.data));Yr(E)&&(l=!0,s!==void 0&&(E.id=s)),this.onmessage?.(E)}catch(E){this.onerror?.(E)}}(r||a)&&!l&&this._abortController&&!this._abortController.signal.aborted&&this._scheduleReconnection({resumptionToken:i,onresumptiontoken:o,replayMessageId:s},0)}catch(u){if(this.onerror?.(new Error(`SSE stream disconnected: ${u}`)),(r||a)&&!l&&this._abortController&&!this._abortController.signal.aborted)try{this._scheduleReconnection({resumptionToken:i,onresumptiontoken:o,replayMessageId:s},0)}catch(m){this.onerror?.(new Error(`Failed to reconnect: ${m instanceof Error?m.message:String(m)}`))}}})()}async start(){if(this._abortController)throw new Error("StreamableHTTPClientTransport already started! If using Client class, note that connect() calls start() automatically.");this._abortController=new AbortController}async finishAuth(e){if(!this._authProvider)throw new sr("No auth provider");if(await ci(this._authProvider,{serverUrl:this._url,authorizationCode:e,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new sr("Failed to authorize")}async close(){this._reconnectionTimeout&&(clearTimeout(this._reconnectionTimeout),this._reconnectionTimeout=void 0),this._abortController?.abort(),this.onclose?.()}async send(e,n){try{const{resumptionToken:r,onresumptiontoken:o}=n||{};if(r){this._startOrAuthSse({resumptionToken:r,replayMessageId:fc(e)?e.id:void 0}).catch(p=>this.onerror?.(p));return}const s=await this._commonHeaders();s.set("content-type","application/json"),s.set("accept","application/json, text/event-stream");const i={...this._requestInit,method:"POST",headers:s,body:JSON.stringify(e),signal:this._abortController?.signal},a=await(this._fetch??fetch)(this._url,i),l=a.headers.get("mcp-session-id");if(l&&(this._sessionId=l),!a.ok){const p=await a.text().catch(()=>null);if(a.status===401&&this._authProvider){if(this._hasCompletedAuthFlow)throw new ir(401,"Server returned 401 after successful authentication");const{resourceMetadataUrl:m,scope:w}=ng(a);if(this._resourceMetadataUrl=m,this._scope=w,await ci(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new sr;return this._hasCompletedAuthFlow=!0,this.send(e)}if(a.status===403&&this._authProvider){const{resourceMetadataUrl:m,scope:w,error:E}=ng(a);if(E==="insufficient_scope"){const _=a.headers.get("WWW-Authenticate");if(this._lastUpscopingHeader===_)throw new ir(403,"Server returned 403 after trying upscoping");if(w&&(this._scope=w),m&&(this._resourceMetadataUrl=m),this._lastUpscopingHeader=_??void 0,await ci(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetch})!=="AUTHORIZED")throw new sr;return this.send(e)}}throw new ir(a.status,`Error POSTing to endpoint: ${p}`)}if(this._hasCompletedAuthFlow=!1,this._lastUpscopingHeader=void 0,a.status===202){await a.body?.cancel(),IM(e)&&this._startOrAuthSse({resumptionToken:void 0}).catch(p=>this.onerror?.(p));return}const u=(Array.isArray(e)?e:[e]).filter(p=>"method"in p&&"id"in p&&p.id!==void 0).length>0,h=a.headers.get("content-type");if(u)if(h?.includes("text/event-stream"))this._handleSseStream(a.body,{onresumptiontoken:o},!1);else if(h?.includes("application/json")){const p=await a.json(),m=Array.isArray(p)?p.map(w=>ol.parse(w)):[ol.parse(p)];for(const w of m)this.onmessage?.(w)}else throw await a.body?.cancel(),new ir(-1,`Unexpected content type: ${h}`);else await a.body?.cancel()}catch(r){throw this.onerror?.(r),r}}get sessionId(){return this._sessionId}async terminateSession(){if(this._sessionId)try{const e=await this._commonHeaders(),n={...this._requestInit,method:"DELETE",headers:e,signal:this._abortController?.signal},r=await(this._fetch??fetch)(this._url,n);if(await r.body?.cancel(),!r.ok&&r.status!==405)throw new ir(r.status,`Failed to terminate session: ${r.statusText}`);this._sessionId=void 0}catch(e){throw this.onerror?.(e),e}}setProtocolVersion(e){this._protocolVersion=e}get protocolVersion(){return this._protocolVersion}async resumeStream(e,n){await this._startOrAuthSse({resumptionToken:e,onresumptiontoken:n?.onresumptiontoken})}}const QO="producer-pal-chat-ui",jO="1.0.0";async function Uu(t){const e=new xv(new URL(t)),n=new Av({name:QO,version:jO});return await n.connect(e),n}function Dv(t,e){return e?t.filter(n=>e[n.name]!==!1):t}const eU="5173",tU="3350",sg=`http://localhost:${tU}/mcp`;function La(){if(typeof window>"u")return sg;const{hostname:t,port:e,protocol:n}=window.location;if(e===eU)return sg;const r=e?`:${e}`:"";return`${n}//${t}${r}/mcp`}function Ov(t){return!!t.functionCall}function nU(t){return!!t.isError}function ig(t,e){return{functionResponse:{name:e,response:{error:t instanceof Error?t.message:String(t),isError:!0}}}}async function rU(t,e){const n=t.functionCall;if(!e)return ig(new Error("MCP client not initialized"),n?.name);try{const r=await e.callTool({name:n?.name??"",arguments:n?.args});return{functionResponse:{name:n?.name,response:nU(r)?{error:r}:r}}}catch(r){return ig(r,n?.name)}}async function oU(t,e){const n=[];for(const r of t?.parts??[]){if(!Ov(r))continue;const o=await rU(r,e);n.push(o)}return n}function sU(t){return t?.role==="model"&&!!t.parts?.some(e=>Ov(e))}function iU(t,e){const n=e;return!!t.text&&!!n?.text&&!!t.thought==!!n?.thought&&!n?.thoughtSignature&&!t.thoughtSignature}function aU(t,e){const n=t.parts?.at(-1),r=e;if(iU(r,n)){const o=n;o.text&&r.text&&(o.text+=r.text)}else t.parts?.push(e)}const Lu=`You are an AI music composition assistant for Ableton Live.
Help users create, edit, and arrange music using the Producer Pal tools.
You can read and modify tracks, clips, scenes, and MIDI notes.
If the user hasn't asked to connect to Ableton Live, ask if they want to. If so, connect.
If the user says "ableton", connect to Ableton Live.
You are Producer Pal. You are creative and focus on the user's musical goals.`,lU=t=>{switch(t){case"gemini-2.5-pro":return"Gemini 2.5 Pro";case"gemini-2.5-flash":return"Gemini 2.5 Flash";case"gemini-2.5-flash-lite":return"Gemini 2.5 Flash-Lite";default:return t}},Uv=t=>{switch(t){case"Off":case"Minimal":return 0;case"Low":return 2048;case"Medium":return 4096;case"High":return 8192;case"Ultra":return 16384;case"Default":case"Auto":return-1;default:return-1}},cU={"ppal-connect":"Connect to Ableton","ppal-read-live-set":"Read Live Set","ppal-update-live-set":"Update Live Set","ppal-create-track":"Create Track","ppal-read-track":"Read Track","ppal-update-track":"Update Track","ppal-create-scene":"Create Scene","ppal-read-scene":"Read Scene","ppal-update-scene":"Update Scene","ppal-create-clip":"Create Clip","ppal-read-clip":"Read Clip","ppal-update-clip":"Update Clip","ppal-playback":"Playback Controls","ppal-delete":"Delete Track/Scene/Clip","ppal-duplicate":"Duplicate Track/Scene/Clip","ppal-memory":"Project Notes"};function uU(t,e){let n=e.temperature,r=e.thinkingConfig;if(t.temperature!==void 0&&(n=t.temperature),t.thinking!==void 0){const o=Uv(t.thinking);if(o===0)r=void 0;else{const s=t.showThoughts??e.thinkingConfig?.includeThoughts??!0;r={thinkingBudget:o,includeThoughts:s}}}else t.showThoughts!==void 0&&r&&(r={...r,includeThoughts:t.showThoughts});return{temperature:n,thinkingConfig:r}}class dU{ai;mcpUrl;config;chat;mcpClient;chatHistory;chatConfig;hadFunctionCallsInLastTurn;effectiveThinkingConfig;effectiveTemperature;constructor(e,n={}){this.ai=new vR({apiKey:e}),this.mcpUrl=n.mcpUrl??La(),this.config=n,this.chat=null,this.mcpClient=null,this.chatHistory=n.chatHistory??[],this.chatConfig=null,this.hadFunctionCallsInLastTurn=!1,this.effectiveThinkingConfig=n.thinkingConfig,this.effectiveTemperature=n.temperature}async initialize(){this.mcpClient=await Uu(this.mcpUrl);const e=await this.mcpClient.listTools(),n=this.config.enabledTools,r=n?e.tools.filter(i=>n[i.name]!==!1):e.tools,o=r.length>0?[{functionDeclarations:r.map(i=>({name:i.name,description:i.description,parametersJsonSchema:i.inputSchema}))}]:[],s=r.length>0?r.map(i=>i.name):void 0;this.chatConfig={...o.length>0?{tools:o}:{},...s&&s.length>0?{toolConfig:{functionCallingConfig:{mode:Jl.VALIDATED,allowedFunctionNames:s}}}:{},...this.config},this.chat=this.ai.chats.create({model:this.config.model??"gemini-2.5-flash-lite",config:this.chatConfig,history:this.chatHistory})}async*sendMessage(e,n,r){this.validateInitialized(),r&&this.applyOverrides(r);const o={role:"user",parts:[{text:e}]};this.chatHistory.push(o),yield this.chatHistory;let s=!0;const i=10;let a=0,l=!0;for(;s&&a<i;)a++,yield*this.processMessageTurn(e,l),s=await this.shouldContinueLoop(n),l=!1;this.warnIfMaxIterationsReached(a,i)}applyOverrides(e){const{temperature:n,thinkingConfig:r}=uU(e,this.config);this.effectiveTemperature=n,this.effectiveThinkingConfig=r,this.chatConfig&&(this.updateChatConfig(),this.recreateChatWithHistory())}updateChatConfig(){this.chatConfig&&(this.effectiveTemperature!==void 0&&(this.chatConfig.temperature=this.effectiveTemperature),this.effectiveThinkingConfig?this.chatConfig.thinkingConfig=this.effectiveThinkingConfig:delete this.chatConfig.thinkingConfig)}validateInitialized(){if(!this.chat||!this.mcpClient)throw new Error("Chat not initialized. Call initialize() first.")}async*processMessageTurn(e,n){if(!this.chat)return;const r=await this.chat.sendMessageStream({message:n?e:""});yield*this.processStreamChunks(r),yield*this.executePendingToolCalls()}async*processStreamChunks(e){let n=null;for await(const r of e){const s=r.candidates?.[0];if(!s?.content)continue;const i=s.content,a=i.role,l=i.parts??[];if(a)for(const c of l)(!n||n.role!==a)&&(n={role:a,parts:[]},this.chatHistory.push(n)),n.parts??=[],aU(n,c),yield this.chatHistory}}async*executePendingToolCalls(){const e=this.chatHistory.at(-1),n=sU(e);if(this.hadFunctionCallsInLastTurn=n,!n)return;const o={role:"user",parts:await oU(e,this.mcpClient)};this.chatHistory.push(o),yield this.chatHistory,this.recreateChatWithHistory()}async shouldContinueLoop(e){return e?.aborted?!1:this.hadFunctionCallsInLastTurn}warnIfMaxIterationsReached(e,n){e>=n&&console.warn("Gemini tool calling loop reached max iterations:",n)}recreateChatWithHistory(){this.chatConfig&&(this.chat=this.ai.chats.create({model:this.config.model??"gemini-2.5-flash-lite",config:this.chatConfig,history:this.chatHistory}))}}function Lv(t){const e=t.reduce((n,{role:r,parts:o=[]},s)=>{const i=n.at(-1);if(r==="error")return fU(n,i,o,s),n;const l=mU(n,i,r,s,o).parts;for(const c of o)gU(c,l);return n},[]);return SU(e),e}function fU(t,e,n,r){const o=hU(e)&&e?e:pU(t,r);for(const s of n)s.text&&o.parts.push({type:"error",content:s.text,isError:!0})}function hU(t){return t?.role==="model"}function pU(t,e){const n={role:"model",parts:[],rawHistoryIndex:e,timestamp:Date.now()};return t.push(n),n}function mU(t,e,n,r,o){const s=n;if(e&&(e.role===s||EU(o)))return e;const i={role:s,parts:[],rawHistoryIndex:r,timestamp:Date.now()};return t.push(i),i}function gU(t,e){const n=e.at(-1),{functionCall:r,functionResponse:o}=t;r?_U(r,e):o?yU(o,e):t.text&&vU(t,n,e)}function _U(t,e){t&&e.push({type:"tool",name:t.name??"",args:t.args??{},result:null})}function yU(t,e){const n=e.find(r=>r.type==="tool"&&r.name===t.name&&r.result===null);n?(n.result=TU(t),bU(t)&&(n.isError=!0)):console.error("Missing corresponding function call for function response",JSON.stringify({functionResponse:t,currentParts:e},null,2))}function vU(t,e,n){const r=t.text??"",o=t.thought??!1;e&&e.type!=="tool"&&e.type!=="error"&&wU(e,o)?e.content+=r:n.push({type:o?"thought":"text",content:r})}function wU(t,e){return t?t.type==="text"&&!e||t.type==="thought"&&e:!1}function SU(t){const e=t.at(-1)?.parts.at(-1);e?.type==="thought"&&(e.isOpen=!0)}function EU(t){return!!t[0]?.functionResponse}function TU(t){const e=t.response;return e?.content?.[0]?.text??e?.error?.content?.[0]?.text??""}function bU(t){return t.response?.error!=null}function ji(t){return t?.includes("openrouter.ai")??!1}function CU(t,e,n,r,o,s){const i=Uv(n),a={model:t,temperature:e,systemInstruction:Lu,enabledTools:o};return s&&(a.chatHistory=s),i!==0&&(a.thinkingConfig={thinkingBudget:i,includeThoughts:r}),a}function kU(t){return t?t==="https://api.openai.com/v1":!0}function qv(t){switch(t){case"Off":return"none";case"Minimal":return"minimal";case"Low":return"low";case"Medium":return"medium";case"High":return"high";case"Ultra":return"xhigh";default:return}}function Fv(t){const e=t.match(/^gpt-(\d+\.\d+)/);return e?.[1]?Number.parseFloat(e[1]):null}function IU(t){return t.startsWith("o1")||t.startsWith("o3")}function RU(t){const e=Fv(t);return!!(e!==null&&e>=5.2||t.startsWith("gpt-5.1-codex-max"))}function Vv(t,e){const n=Fv(e),r=IU(e);if(!(!r&&(n===null||n<5.1))){if(r)switch(t){case"Off":case"Minimal":return"low";case"Low":return"low";case"Medium":return"medium";case"High":case"Ultra":return"high";default:return}switch(t){case"Off":return"none";case"Minimal":return"minimal";case"Low":return"low";case"Medium":return"medium";case"High":return"high";case"Ultra":return RU(e)?"xhigh":"high";default:return}}}function $U(t,e,n,r,o,s,i){const a={model:t,temperature:e,systemInstruction:Lu,baseUrl:r,enabledTools:s};if(i&&(a.chatHistory=i),ji(r)){const l=qv(n);l&&(a.reasoningEffort=l,a.excludeReasoning=!o)}else if(kU(r)){const l=Vv(n,t);l&&(a.reasoningEffort=l)}return a}function AU(t){switch(t){case"Off":return;case"Minimal":case"Low":return"low";case"Medium":return"medium";case"High":case"Ultra":return"high";default:return}}function PU(t,e,n,r,o){const s={model:t,temperature:e,systemInstruction:Lu,enabledTools:r};o&&(s.conversation=o);const i=AU(n);return i&&(s.reasoningEffort=i),s}function zv(t){const e=t.at(-1);if(!e)return;const n=e.parts.at(-1);n?.type==="thought"&&(n.isOpen=!0)}function NU(t,e){if(!t||t.length===0)return;const n=t.filter(o=>o.type==="reasoning.text"&&o.text).map(o=>o.text).join("");if(!n)return;const r=e.at(-1);r?.type==="thought"?r.content+=n:e.push({type:"thought",content:n})}function MU(t,e,n){for(let r=n;r<t.length;r++){const o=t[r];if(o&&o.role==="tool"&&"tool_call_id"in o&&o.tool_call_id===e){const i=(typeof o.content=="string"?o.content:void 0)??"",a=i.includes('"error"')||i.includes('"isError":true');return{result:i,isError:a}}}return{result:null,isError:!1}}function xU(t,e){const n=t.at(-1);n?.type==="text"?n.content+=e:t.push({type:"text",content:e})}function DU(t,e,n,r){if(t.type!=="function")return;const o=t.function.arguments?JSON.parse(t.function.arguments):{},{result:s,isError:i}=MU(n,t.id,r+1);e.push({type:"tool",name:t.function.name,args:o,result:s,isError:i?!0:void 0})}function OU(t,e,n,r){if(!(t.role!=="assistant"||!("tool_calls"in t)||!t.tool_calls))for(const o of t.tool_calls)DU(o,e,n,r)}function UU(t,e,n,r){if(t.role!=="user"&&t.role!=="assistant")return;if(t.role==="assistant"&&"reasoning_details"in t){const s=t.reasoning_details;NU(s,e)}const o=typeof t.content=="string"?t.content:void 0;o&&xU(e,o),OU(t,e,n,r)}function Hv(t){const e=[];for(let n=0;n<t.length;n++){const r=t[n];if(!r||r.role==="system"||r.role==="tool")continue;const o=e.at(-1);let s;o?.role==="model"&&r.role==="assistant"?s=o:(s={role:r.role==="assistant"?"model":"user",parts:[],rawHistoryIndex:n,timestamp:Date.now()},e.push(s)),UU(r,s.parts,t,n)}return zv(e),e}function LU(){return{currentContent:"",currentReasoning:"",pendingFunctionCalls:new Map,toolResults:new Map,hasToolCalls:!1,outputItems:[],streamingItemIndex:null}}function Gv(t){return typeof t=="string"?t:t?.text}function Bv(t,e){if(t.streamingItemIndex!=null)return e[t.streamingItemIndex];const n={type:"message",role:"assistant",content:""};return t.streamingItemIndex=e.length,e.push(n),n}function qU(t,e,n){const r=Gv(t.delta);if(r){e.currentReasoning+=r;const o=Bv(e,n);o.content=e.currentReasoning}}function FU(t,e,n){const r=Gv(t.delta);if(r){e.currentContent+=r;const o=Bv(e,n);o.content=e.currentContent}}function VU(t,e){const n=t.item;n?.type==="function_call"&&n.name&&n.call_id&&(e.pendingFunctionCalls.set(n.id,{name:n.name,call_id:n.call_id}),e.hasToolCalls=!0)}async function zU(t,e,n){if(!t.item_id||!t.arguments)return;const r=e.pendingFunctionCalls.get(t.item_id);if(!r)return;const o=JSON.parse(t.arguments),s=await n.callTool({name:r.name,arguments:o}),i=JSON.stringify(s.content);e.toolResults.set(r.call_id,i)}function HU(t,e,n){e.streamingItemIndex!=null&&(n.splice(e.streamingItemIndex,1),e.streamingItemIndex=null),t.response?.output&&(e.outputItems=t.response.output,n.push(...t.response.output));for(const[r,o]of e.toolResults)n.push({type:"function_call_output",call_id:r,output:o})}function GU(t){if(t.type!=="reasoning")return"";const e=t.summary;return typeof e=="string"?e:Array.isArray(e)&&e.length>0?e.map(n=>n.text??"").filter(Boolean).join(`
`):t.text??""}async function BU(t,e,n,r){switch(t.type){case"response.reasoning.delta":qU(t,e,r);break;case"response.output_text.delta":FU(t,e,r);break;case"response.output_item.added":VU(t,e);break;case"response.function_call_arguments.done":await zU(t,e,n);break;case"response.completed":HU(t,e,r);break}}function JU(t,e,n){for(let r=n;r<t.length;r++){const o=t[r];if(!o||o.type!=="function_call_output"||o.call_id!==e)continue;const s=o.output,a=['"error"','"isError":true'].some(l=>s.includes(l));return{result:s,isError:a}}return{result:null,isError:!1}}function KU(t,e,n){const r=t.arguments?JSON.parse(t.arguments):{},{result:o,isError:s}=JU(e,t.call_id,n+1);return{type:"tool",name:t.name,args:r,result:o,isError:s?!0:void 0}}function WU(t){return typeof t=="string"?t:t.filter(e=>e.type==="output_text"||e.type==="input_text").map(e=>e.text??"").join("")}function ZU(t,e){if(!e)return;const n=t.at(-1);n?.type==="text"?n.content+=e:t.push({type:"text",content:e})}function Jv(t){return t.type==="reasoning"}function YU(t){return t.type==="function_call"||Jv(t)||t.type==="message"&&t.role==="assistant"}function XU(t,e,n,r){if(t.type==="message")ZU(e.parts,WU(t.content));else if(t.type==="function_call")e.parts.push(KU(t,n,r));else if(Jv(t)){const o=GU(t);o&&e.parts.push({type:"thought",content:o})}}function Kv(t){const e=[];for(let n=0;n<t.length;n++){const r=t[n];if(!r||r.type==="message"&&r.role==="system"||r.type==="function_call_output")continue;const o=e.at(-1),s=YU(r),a=o?.role==="model"&&s?o:QU(s,n,e);XU(r,a,t,n)}return zv(e),e}function QU(t,e,n){const r={role:t?"model":"user",parts:[],rawHistoryIndex:e,timestamp:Date.now()};return n.push(r),r}function qu(t){console.error(t);let e=String(t);return e.startsWith("Error")||(e=`Error: ${e}`),e}async function jU(t,e,n){try{for await(const r of t)n(e(r));return!0}catch(r){if(r instanceof Error&&r.name==="AbortError")return!1;throw r}}function eL(t,e){const r={role:"error",parts:[{text:qu(t)}]};return Lv([...e,r])}function tL(t,e){const n=qu(e),r=Hv(t),o={role:"model",parts:[{type:"error",content:n,isError:!0}],rawHistoryIndex:t.length,timestamp:Date.now()};return[...r,o]}async function nL(t,e,n){if(t==="error")throw await n(),new Error(`MCP connection failed: ${e}`)}function rL(t,e){const n=qu(e),r=Kv(t),o={role:"model",parts:[{type:"error",content:n,isError:!0}],rawHistoryIndex:t.length,timestamp:Date.now()};return[...r,o]}const oL={createClient(t,e){return new dU(t,e)},buildConfig(t,e,n,r,o,s){const i=!!s?.showThoughts;return CU(t,e,n,i,r,o)},formatMessages:Lv,createErrorMessage(t,e){return eL(t,e)},extractUserMessage(t){return t.parts?.find(e=>e.text)?.text?.trim()},createUserMessage(t){return{role:"user",parts:[{text:t}]}}};function sL(t,e,n,r){return t==="gemini"?e:t==="openai"?r:n}function iL({settingsProvider:t,geminiChat:e,openaiChat:n,responsesChat:r}){const[o,s]=Ae(null),a=sL(o??t,e,n,r),l=Et(async(u,h)=>{o||s(t),await a.handleSend(u,h)},[o,t,a]),c=Et(()=>{a.clearConversation(),s(null)},[a]);return{chat:a,wrappedHandleSend:l,wrappedClearConversation:c}}function fe(t,e,n,r,o){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function H(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}let Wv=function(){const{crypto:t}=globalThis;if(t?.randomUUID)return Wv=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};function kc(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const Ic=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class ue extends Error{}class dt extends ue{constructor(e,n,r,o){super(`${dt.makeMessage(e,n,r)}`),this.status=e,this.headers=o,this.requestID=o?.get("x-request-id"),this.error=n;const s=n;this.code=s?.code,this.param=s?.param,this.type=s?.type}static makeMessage(e,n,r){const o=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,n,r,o){if(!e||!o)return new qa({message:r,cause:Ic(n)});const s=n?.error;return e===400?new Zv(e,s,r,o):e===401?new Yv(e,s,r,o):e===403?new Xv(e,s,r,o):e===404?new Qv(e,s,r,o):e===409?new jv(e,s,r,o):e===422?new e0(e,s,r,o):e===429?new t0(e,s,r,o):e>=500?new n0(e,s,r,o):new dt(e,s,r,o)}}class Nt extends dt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class qa extends dt{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class Fu extends qa{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Zv extends dt{}class Yv extends dt{}class Xv extends dt{}class Qv extends dt{}class jv extends dt{}class e0 extends dt{}class t0 extends dt{}class n0 extends dt{}class r0 extends ue{constructor(){super("Could not parse response content as the length limit was reached")}}class o0 extends ue{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Xr extends Error{constructor(e){super(e)}}const aL=/^[a-z][a-z0-9+.-]*:/i,lL=t=>aL.test(t);let St=t=>(St=Array.isArray,St(t)),ag=St;function s0(t){return typeof t!="object"?{}:t??{}}function cL(t){if(!t)return!0;for(const e in t)return!1;return!0}function uL(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $l(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const dL=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ue(`${t} must be an integer`);if(e<0)throw new ue(`${t} must be a positive integer`);return e},fL=t=>{try{return JSON.parse(t)}catch{return}},ko=t=>new Promise(e=>setTimeout(e,t)),dr="6.17.0",hL=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function pL(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const mL=()=>{const t=pL();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":dr,"X-Stainless-OS":cg(Deno.build.os),"X-Stainless-Arch":lg(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":dr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":dr,"X-Stainless-OS":cg(globalThis.process.platform??"unknown"),"X-Stainless-Arch":lg(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=gL();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":dr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":dr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function gL(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const o=r[1]||0,s=r[2]||0,i=r[3]||0;return{browser:e,version:`${o}.${s}.${i}`}}}return null}const lg=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",cg=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let ug;const _L=()=>ug??(ug=mL());function yL(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function i0(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function a0(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return i0({start(){},async pull(n){const{done:r,value:o}=await e.next();r?n.close():n.enqueue(o)},async cancel(){await e.return?.()}})}function l0(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n?.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function vL(t){if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await t[Symbol.asyncIterator]().return?.();return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const wL=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),c0="RFC3986",u0=t=>String(t),dg={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:u0},SL="RFC1738";let Rc=(t,e)=>(Rc=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),Rc(t,e));const Xt=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),Al=1024,EL=(t,e,n,r,o)=>{if(t.length===0)return t;let s=t;if(typeof t=="symbol"?s=Symbol.prototype.toString.call(t):typeof t!="string"&&(s=String(t)),n==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(a){return"%26%23"+parseInt(a.slice(2),16)+"%3B"});let i="";for(let a=0;a<s.length;a+=Al){const l=s.length>=Al?s.slice(a,a+Al):s,c=[];for(let u=0;u<l.length;++u){let h=l.charCodeAt(u);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||o===SL&&(h===40||h===41)){c[c.length]=l.charAt(u);continue}if(h<128){c[c.length]=Xt[h];continue}if(h<2048){c[c.length]=Xt[192|h>>6]+Xt[128|h&63];continue}if(h<55296||h>=57344){c[c.length]=Xt[224|h>>12]+Xt[128|h>>6&63]+Xt[128|h&63];continue}u+=1,h=65536+((h&1023)<<10|l.charCodeAt(u)&1023),c[c.length]=Xt[240|h>>18]+Xt[128|h>>12&63]+Xt[128|h>>6&63]+Xt[128|h&63]}i+=c.join("")}return i};function TL(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function fg(t,e){if(St(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const d0={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},f0=function(t,e){Array.prototype.push.apply(t,St(e)?e:[e])};let hg;const et={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:EL,encodeValuesOnly:!1,format:c0,formatter:u0,indices:!1,serializeDate(t){return(hg??(hg=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function bL(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const Pl={};function h0(t,e,n,r,o,s,i,a,l,c,u,h,p,m,w,E,_,v){let g=t,S=v,b=0,y=!1;for(;(S=S.get(Pl))!==void 0&&!y;){const q=S.get(t);if(b+=1,typeof q<"u"){if(q===b)throw new RangeError("Cyclic object value");y=!0}typeof S.get(Pl)>"u"&&(b=0)}if(typeof c=="function"?g=c(e,g):g instanceof Date?g=p?.(g):n==="comma"&&St(g)&&(g=fg(g,function(q){return q instanceof Date?p?.(q):q})),g===null){if(s)return l&&!E?l(e,et.encoder,_,"key",m):e;g=""}if(bL(g)||TL(g)){if(l){const q=E?e:l(e,et.encoder,_,"key",m);return[w?.(q)+"="+w?.(l(g,et.encoder,_,"value",m))]}return[w?.(e)+"="+w?.(String(g))]}const C=[];if(typeof g>"u")return C;let k;if(n==="comma"&&St(g))E&&l&&(g=fg(g,l)),k=[{value:g.length>0?g.join(",")||null:void 0}];else if(St(c))k=c;else{const q=Object.keys(g);k=u?q.sort(u):q}const P=a?String(e).replace(/\./g,"%2E"):String(e),M=r&&St(g)&&g.length===1?P+"[]":P;if(o&&St(g)&&g.length===0)return M+"[]";for(let q=0;q<k.length;++q){const D=k[q],G=typeof D=="object"&&typeof D.value<"u"?D.value:g[D];if(i&&G===null)continue;const B=h&&a?D.replace(/\./g,"%2E"):D,K=St(g)?typeof n=="function"?n(M,B):M:M+(h?"."+B:"["+B+"]");v.set(t,b);const oe=new WeakMap;oe.set(Pl,v),f0(C,h0(G,K,n,r,o,s,i,a,n==="comma"&&E&&St(g)?null:l,c,u,h,p,m,w,E,_,oe))}return C}function CL(t=et){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||et.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=c0;if(typeof t.format<"u"){if(!Rc(dg,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=dg[n];let o=et.filter;(typeof t.filter=="function"||St(t.filter))&&(o=t.filter);let s;if(t.arrayFormat&&t.arrayFormat in d0?s=t.arrayFormat:"indices"in t?s=t.indices?"indices":"repeat":s=et.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:et.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:et.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:et.allowEmptyArrays,arrayFormat:s,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:et.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?et.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:et.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:et.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:et.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:et.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:et.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:et.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:et.strictNullHandling}}function kL(t,e={}){let n=t;const r=CL(e);let o,s;typeof r.filter=="function"?(s=r.filter,n=s("",n)):St(r.filter)&&(s=r.filter,o=s);const i=[];if(typeof n!="object"||n===null)return"";const a=d0[r.arrayFormat],l=a==="comma"&&r.commaRoundTrip;o||(o=Object.keys(n)),r.sort&&o.sort(r.sort);const c=new WeakMap;for(let p=0;p<o.length;++p){const m=o[p];r.skipNulls&&n[m]===null||f0(i,h0(n[m],m,a,l,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}const u=i.join(r.delimiter);let h=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),u.length>0?h+u:""}function IL(t){let e=0;for(const o of t)e+=o.length;const n=new Uint8Array(e);let r=0;for(const o of t)n.set(o,r),r+=o.length;return n}let pg;function Vu(t){let e;return(pg??(e=new globalThis.TextEncoder,pg=e.encode.bind(e)))(t)}let mg;function gg(t){let e;return(mg??(e=new globalThis.TextDecoder,mg=e.decode.bind(e)))(t)}var It,Rt;class Fa{constructor(){It.set(this,void 0),Rt.set(this,void 0),fe(this,It,new Uint8Array),fe(this,Rt,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Vu(e):e;fe(this,It,IL([H(this,It,"f"),n]));const r=[];let o;for(;(o=RL(H(this,It,"f"),H(this,Rt,"f")))!=null;){if(o.carriage&&H(this,Rt,"f")==null){fe(this,Rt,o.index);continue}if(H(this,Rt,"f")!=null&&(o.index!==H(this,Rt,"f")+1||o.carriage)){r.push(gg(H(this,It,"f").subarray(0,H(this,Rt,"f")-1))),fe(this,It,H(this,It,"f").subarray(H(this,Rt,"f"))),fe(this,Rt,null);continue}const s=H(this,Rt,"f")!==null?o.preceding-1:o.preceding,i=gg(H(this,It,"f").subarray(0,s));r.push(i),fe(this,It,H(this,It,"f").subarray(o.index)),fe(this,Rt,null)}return r}flush(){return H(this,It,"f").length?this.decode(`
`):[]}}It=new WeakMap,Rt=new WeakMap;Fa.NEWLINE_CHARS=new Set([`
`,"\r"]);Fa.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function RL(t,e){for(let o=e??0;o<t.length;o++){if(t[o]===10)return{preceding:o,index:o+1,carriage:!1};if(t[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function $L(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}const ea={off:0,error:200,warn:300,info:400,debug:500},_g=(t,e,n)=>{if(t){if(uL(ea,t))return t;it(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(ea))}`)}};function Qr(){}function ui(t,e,n){return!e||ea[t]>ea[n]?Qr:e[t].bind(e)}const AL={error:Qr,warn:Qr,info:Qr,debug:Qr};let yg=new WeakMap;function it(t){const e=t.logger,n=t.logLevel??"off";if(!e)return AL;const r=yg.get(e);if(r&&r[0]===n)return r[1];const o={error:ui("error",e,n),warn:ui("warn",e,n),info:ui("info",e,n),debug:ui("debug",e,n)};return yg.set(e,[n,o]),o}const Bn=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var Gr;class jt{constructor(e,n,r){this.iterator=e,Gr.set(this,void 0),this.controller=n,fe(this,Gr,r)}static fromSSEResponse(e,n,r){let o=!1;const s=r?it(r):console;async function*i(){if(o)throw new ue("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let a=!1;try{for await(const l of PL(e,n))if(!a){if(l.data.startsWith("[DONE]")){a=!0;continue}if(l.event===null||!l.event.startsWith("thread.")){let c;try{c=JSON.parse(l.data)}catch(u){throw s.error("Could not parse message into JSON:",l.data),s.error("From chunk:",l.raw),u}if(c&&c.error)throw new dt(void 0,c.error,void 0,e.headers);yield c}else{let c;try{c=JSON.parse(l.data)}catch(u){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),u}if(l.event=="error")throw new dt(void 0,c.error,c.message,void 0);yield{event:l.event,data:c}}}a=!0}catch(l){if(kc(l))return;throw l}finally{a||n.abort()}}return new jt(i,n,r)}static fromReadableStream(e,n,r){let o=!1;async function*s(){const a=new Fa,l=l0(e);for await(const c of l)for(const u of a.decode(c))yield u;for(const c of a.flush())yield c}async function*i(){if(o)throw new ue("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let a=!1;try{for await(const l of s())a||l&&(yield JSON.parse(l));a=!0}catch(l){if(kc(l))return;throw l}finally{a||n.abort()}}return new jt(i,n,r)}[(Gr=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),o=s=>({next:()=>{if(s.length===0){const i=r.next();e.push(i),n.push(i)}return s.shift()}});return[new jt(()=>o(e),this.controller,H(this,Gr,"f")),new jt(()=>o(n),this.controller,H(this,Gr,"f"))]}toReadableStream(){const e=this;let n;return i0({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:o,done:s}=await n.next();if(s)return r.close();const i=Vu(JSON.stringify(o)+`
`);r.enqueue(i)}catch(o){r.error(o)}},async cancel(){await n.return?.()}})}}async function*PL(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new ue("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new ue("Attempted to iterate over a response with no body");const n=new ML,r=new Fa,o=l0(t.body);for await(const s of NL(o))for(const i of r.decode(s)){const a=n.decode(i);a&&(yield a)}for(const s of r.flush()){const i=n.decode(s);i&&(yield i)}}async function*NL(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?Vu(n):n;let o=new Uint8Array(e.length+r.length);o.set(e),o.set(r,e.length),e=o;let s;for(;(s=$L(e))!==-1;)yield e.slice(0,s),e=e.slice(s)}e.length>0&&(yield e)}class ML{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,o]=xL(e,":");return o.startsWith(" ")&&(o=o.substring(1)),n==="event"?this.event=o:n==="data"&&this.data.push(o),null}}function xL(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function p0(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:o,startTime:s}=e,i=await(async()=>{if(e.options.stream)return it(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):jt.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const l=n.headers.get("content-type")?.split(";")[0]?.trim();if(l?.includes("application/json")||l?.endsWith("+json")){const h=await n.json();return m0(h,n)}return await n.text()})();return it(t).debug(`[${r}] response parsed`,Bn({retryOfRequestLogID:o,url:n.url,status:n.status,body:i,durationMs:Date.now()-s})),i}function m0(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var jr;class Va extends Promise{constructor(e,n,r=p0){super(o=>{o(null)}),this.responsePromise=n,this.parseResponse=r,jr.set(this,void 0),fe(this,jr,e)}_thenUnwrap(e){return new Va(H(this,jr,"f"),this.responsePromise,async(n,r)=>m0(e(await this.parseResponse(n,r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(H(this,jr,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}jr=new WeakMap;var di;class zu{constructor(e,n,r,o){di.set(this,void 0),fe(this,di,e),this.options=o,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new ue("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await H(this,di,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(di=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class DL extends Va{constructor(e,n,r){super(e,n,async(o,s)=>new r(o,s.response,await p0(o,s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class za extends zu{constructor(e,n,r,o){super(e,n,r,o),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class Qe extends zu{constructor(e,n,r,o){super(e,n,r,o),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.getPaginatedItems(),n=e[e.length-1]?.id;return n?{...this.options,query:{...s0(this.options.query),after:n}}:null}}class ta extends zu{constructor(e,n,r,o){super(e,n,r,o),this.data=r.data||[],this.has_more=r.has_more||!1,this.last_id=r.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...s0(this.options.query),after:e}}:null}}const g0=()=>{if(typeof File>"u"){const{process:t}=globalThis,e=typeof t?.versions?.node=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function ao(t,e,n){return g0(),new File(t,e??"unknown_file",n)}function bi(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const Hu=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",vg=async(t,e)=>$c(t.body)?{...t,body:await _0(t.body,e)}:t,Yn=async(t,e)=>({...t,body:await _0(t.body,e)}),wg=new WeakMap;function OL(t){const e=typeof t=="function"?t:t.fetch,n=wg.get(e);if(n)return n;const r=(async()=>{try{const o="Response"in e?e.Response:(await e("data:,")).constructor,s=new FormData;return s.toString()!==await new o(s).text()}catch{return!0}})();return wg.set(e,r),r}const _0=async(t,e)=>{if(!await OL(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([r,o])=>Ac(n,r,o))),n},y0=t=>t instanceof Blob&&"name"in t,UL=t=>typeof t=="object"&&t!==null&&(t instanceof Response||Hu(t)||y0(t)),$c=t=>{if(UL(t))return!0;if(Array.isArray(t))return t.some($c);if(t&&typeof t=="object"){for(const e in t)if($c(t[e]))return!0}return!1},Ac=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,ao([await n.blob()],bi(n)));else if(Hu(n))t.append(e,ao([await new Response(a0(n)).blob()],bi(n)));else if(y0(n))t.append(e,n,bi(n));else if(Array.isArray(n))await Promise.all(n.map(r=>Ac(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,o])=>Ac(t,`${e}[${r}]`,o)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},v0=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",LL=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&v0(t),qL=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function FL(t,e,n){if(g0(),t=await t,LL(t))return t instanceof File?t:ao([await t.arrayBuffer()],t.name);if(qL(t)){const o=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),ao(await Pc(o),e,n)}const r=await Pc(t);if(e||(e=bi(t)),!n?.type){const o=r.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof o=="string"&&(n={...n,type:o})}return ao(r,e,n)}async function Pc(t){let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(v0(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(Hu(t))for await(const n of t)e.push(...await Pc(n));else{const n=t?.constructor?.name;throw new Error(`Unexpected data type: ${typeof t}${n?`; constructor: ${n}`:""}${VL(t)}`)}return e}function VL(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class ce{constructor(e){this._client=e}}function w0(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Sg=Object.freeze(Object.create(null)),zL=(t=w0)=>function(n,...r){if(n.length===1)return n[0];let o=!1;const s=[],i=n.reduce((u,h,p)=>{/[?#]/.test(h)&&(o=!0);const m=r[p];let w=(o?encodeURIComponent:t)(""+m);return p!==r.length&&(m==null||typeof m=="object"&&m.toString===Object.getPrototypeOf(Object.getPrototypeOf(m.hasOwnProperty??Sg)??Sg)?.toString)&&(w=m+"",s.push({start:u.length+h.length,length:w.length,error:`Value of type ${Object.prototype.toString.call(m).slice(8,-1)} is not a valid path parameter`})),u+h+(p===r.length?"":w)},""),a=i.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=l.exec(a))!==null;)s.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(s.sort((u,h)=>u.start-h.start),s.length>0){let u=0;const h=s.reduce((p,m)=>{const w=" ".repeat(m.start-u),E="^".repeat(m.length);return u=m.start+m.length,p+w+E},"");throw new ue(`Path parameters result in path with invalid segments:
${s.map(p=>p.error).join(`
`)}
${i}
${h}`)}return i},X=zL(w0);let S0=class extends ce{list(e,n={},r){return this._client.getAPIList(X`/chat/completions/${e}/messages`,Qe,{query:n,...r})}};function na(t){return t!==void 0&&"function"in t&&t.function!==void 0}function Gu(t){return t?.$brand==="auto-parseable-response-format"}function Io(t){return t?.$brand==="auto-parseable-tool"}function HL(t,e){return!e||!E0(e)?{...t,choices:t.choices.map(n=>(T0(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:Bu(t,e)}function Bu(t,e){const n=t.choices.map(r=>{if(r.finish_reason==="length")throw new r0;if(r.finish_reason==="content_filter")throw new o0;return T0(r.message.tool_calls),{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:r.message.tool_calls?.map(o=>BL(e,o))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?GL(e,r.message.content):null}}});return{...t,choices:n}}function GL(t,e){return t.response_format?.type!=="json_schema"?null:t.response_format?.type==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function BL(t,e){const n=t.tools?.find(r=>na(r)&&r.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:Io(n)?n.$parseRaw(e.function.arguments):n?.function.strict?JSON.parse(e.function.arguments):null}}}function JL(t,e){if(!t||!("tools"in t)||!t.tools)return!1;const n=t.tools?.find(r=>na(r)&&r.function?.name===e.function.name);return na(n)&&(Io(n)||n?.function.strict||!1)}function E0(t){return Gu(t.response_format)?!0:t.tools?.some(e=>Io(e)||e.type==="function"&&e.function.strict===!0)??!1}function T0(t){for(const e of t||[])if(e.type!=="function")throw new ue(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function KL(t){for(const e of t??[]){if(e.type!=="function")throw new ue(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new ue(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const ra=t=>t?.role==="assistant",b0=t=>t?.role==="tool";var Nc,Ci,ki,eo,to,Ii,no,cn,ro,oa,sa,fr,C0;class Ju{constructor(){Nc.add(this),this.controller=new AbortController,Ci.set(this,void 0),ki.set(this,()=>{}),eo.set(this,()=>{}),to.set(this,void 0),Ii.set(this,()=>{}),no.set(this,()=>{}),cn.set(this,{}),ro.set(this,!1),oa.set(this,!1),sa.set(this,!1),fr.set(this,!1),fe(this,Ci,new Promise((e,n)=>{fe(this,ki,e,"f"),fe(this,eo,n,"f")})),fe(this,to,new Promise((e,n)=>{fe(this,Ii,e,"f"),fe(this,no,n,"f")})),H(this,Ci,"f").catch(()=>{}),H(this,to,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},H(this,Nc,"m",C0).bind(this))},0)}_connected(){this.ended||(H(this,ki,"f").call(this),this._emit("connect"))}get ended(){return H(this,ro,"f")}get errored(){return H(this,oa,"f")}get aborted(){return H(this,sa,"f")}abort(){this.controller.abort()}on(e,n){return(H(this,cn,"f")[e]||(H(this,cn,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=H(this,cn,"f")[e];if(!r)return this;const o=r.findIndex(s=>s.listener===n);return o>=0&&r.splice(o,1),this}once(e,n){return(H(this,cn,"f")[e]||(H(this,cn,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{fe(this,fr,!0),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){fe(this,fr,!0),await H(this,to,"f")}_emit(e,...n){if(H(this,ro,"f"))return;e==="end"&&(fe(this,ro,!0),H(this,Ii,"f").call(this));const r=H(this,cn,"f")[e];if(r&&(H(this,cn,"f")[e]=r.filter(o=>!o.once),r.forEach(({listener:o})=>o(...n))),e==="abort"){const o=n[0];!H(this,fr,"f")&&!r?.length&&Promise.reject(o),H(this,eo,"f").call(this,o),H(this,no,"f").call(this,o),this._emit("end");return}if(e==="error"){const o=n[0];!H(this,fr,"f")&&!r?.length&&Promise.reject(o),H(this,eo,"f").call(this,o),H(this,no,"f").call(this,o),this._emit("end")}}_emitFinal(){}}Ci=new WeakMap,ki=new WeakMap,eo=new WeakMap,to=new WeakMap,Ii=new WeakMap,no=new WeakMap,cn=new WeakMap,ro=new WeakMap,oa=new WeakMap,sa=new WeakMap,fr=new WeakMap,Nc=new WeakSet,C0=function(e){if(fe(this,oa,!0),e instanceof Error&&e.name==="AbortError"&&(e=new Nt),e instanceof Nt)return fe(this,sa,!0),this._emit("abort",e);if(e instanceof ue)return this._emit("error",e);if(e instanceof Error){const n=new ue(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new ue(String(e)))};function WL(t){return typeof t.parse=="function"}var yt,Mc,ia,xc,Dc,Oc,k0,I0;const ZL=10;class R0 extends Ju{constructor(){super(...arguments),yt.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=e.choices[0]?.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),b0(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(ra(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionToolCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new ue("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),H(this,yt,"m",Mc).call(this)}async finalMessage(){return await this.done(),H(this,yt,"m",ia).call(this)}async finalFunctionToolCall(){return await this.done(),H(this,yt,"m",xc).call(this)}async finalFunctionToolCallResult(){return await this.done(),H(this,yt,"m",Dc).call(this)}async totalUsage(){return await this.done(),H(this,yt,"m",Oc).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=H(this,yt,"m",ia).call(this);n&&this._emit("finalMessage",n);const r=H(this,yt,"m",Mc).call(this);r&&this._emit("finalContent",r);const o=H(this,yt,"m",xc).call(this);o&&this._emit("finalFunctionToolCall",o);const s=H(this,yt,"m",Dc).call(this);s!=null&&this._emit("finalFunctionToolCallResult",s),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",H(this,yt,"m",Oc).call(this))}async _createChatCompletion(e,n,r){const o=r?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),H(this,yt,"m",k0).call(this,n);const s=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Bu(s,n))}async _runChatCompletion(e,n,r){for(const o of n.messages)this._addMessage(o,!1);return await this._createChatCompletion(e,n,r)}async _runTools(e,n,r){const o="tool",{tool_choice:s="auto",stream:i,...a}=n,l=typeof s!="string"&&s.type==="function"&&s?.function?.name,{maxChatCompletions:c=ZL}=r||{},u=n.tools.map(m=>{if(Io(m)){if(!m.$callback)throw new ue("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:m.$callback,name:m.function.name,description:m.function.description||"",parameters:m.function.parameters,parse:m.$parseRaw,strict:!0}}}return m}),h={};for(const m of u)m.type==="function"&&(h[m.function.name||m.function.function.name]=m.function);const p="tools"in n?u.map(m=>m.type==="function"?{type:"function",function:{name:m.function.name||m.function.function.name,parameters:m.function.parameters,description:m.function.description,strict:m.function.strict}}:m):void 0;for(const m of n.messages)this._addMessage(m,!1);for(let m=0;m<c;++m){const E=(await this._createChatCompletion(e,{...a,tool_choice:s,tools:p,messages:[...this.messages]},r)).choices[0]?.message;if(!E)throw new ue("missing message in ChatCompletion response");if(!E.tool_calls?.length)return;for(const _ of E.tool_calls){if(_.type!=="function")continue;const v=_.id,{name:g,arguments:S}=_.function,b=h[g];if(b){if(l&&l!==g){const P=`Invalid tool_call: ${JSON.stringify(g)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:o,tool_call_id:v,content:P});continue}}else{const P=`Invalid tool_call: ${JSON.stringify(g)}. Available options are: ${Object.keys(h).map(M=>JSON.stringify(M)).join(", ")}. Please try again`;this._addMessage({role:o,tool_call_id:v,content:P});continue}let y;try{y=WL(b)?await b.parse(S):S}catch(P){const M=P instanceof Error?P.message:String(P);this._addMessage({role:o,tool_call_id:v,content:M});continue}const C=await b.function(y,this),k=H(this,yt,"m",I0).call(this,C);if(this._addMessage({role:o,tool_call_id:v,content:k}),l)return}}}}yt=new WeakSet,Mc=function(){return H(this,yt,"m",ia).call(this).content??null},ia=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(ra(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new ue("stream ended without producing a ChatCompletionMessage with role=assistant")},xc=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(ra(n)&&n?.tool_calls?.length)return n.tool_calls.filter(r=>r.type==="function").at(-1)?.function}},Dc=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(b0(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>r.role==="assistant"&&r.tool_calls?.some(o=>o.type==="function"&&o.id===n.tool_call_id)))return n.content}},Oc=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},k0=function(e){if(e.n!=null&&e.n>1)throw new ue("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},I0=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Ku extends R0{static runTools(e,n,r){const o=new Ku,s={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return o._run(()=>o._runTools(e,n,s)),o}_addMessage(e,n=!0){super._addMessage(e,n),ra(e)&&e.content&&this._emit("content",e.content)}}const $0=1,A0=2,P0=4,N0=8,M0=16,x0=32,D0=64,O0=128,U0=256,L0=O0|U0,q0=M0|x0|L0|D0,F0=$0|A0|q0,V0=P0|N0,YL=F0|V0,tt={STR:$0,NUM:A0,ARR:P0,OBJ:N0,NULL:M0,BOOL:x0,NAN:D0,INFINITY:O0,MINUS_INFINITY:U0,INF:L0,SPECIAL:q0,ATOM:F0,COLLECTION:V0,ALL:YL};class XL extends Error{}class QL extends Error{}function jL(t,e=tt.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return eq(t.trim(),e)}const eq=(t,e)=>{const n=t.length;let r=0;const o=p=>{throw new XL(`${p} at position ${r}`)},s=p=>{throw new QL(`${p} at position ${r}`)},i=()=>(h(),r>=n&&o("Unexpected end of input"),t[r]==='"'?a():t[r]==="{"?l():t[r]==="["?c():t.substring(r,r+4)==="null"||tt.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||tt.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||tt.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||tt.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||tt.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||tt.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):u()),a=()=>{const p=r;let m=!1;for(r++;r<n&&(t[r]!=='"'||m&&t[r-1]==="\\");)m=t[r]==="\\"?!m:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(p,++r-Number(m)))}catch(w){s(String(w))}else if(tt.STR&e)try{return JSON.parse(t.substring(p,r-Number(m))+'"')}catch{return JSON.parse(t.substring(p,t.lastIndexOf("\\"))+'"')}o("Unterminated string literal")},l=()=>{r++,h();const p={};try{for(;t[r]!=="}";){if(h(),r>=n&&tt.OBJ&e)return p;const m=a();h(),r++;try{const w=i();Object.defineProperty(p,m,{value:w,writable:!0,enumerable:!0,configurable:!0})}catch(w){if(tt.OBJ&e)return p;throw w}h(),t[r]===","&&r++}}catch{if(tt.OBJ&e)return p;o("Expected '}' at end of object")}return r++,p},c=()=>{r++;const p=[];try{for(;t[r]!=="]";)p.push(i()),h(),t[r]===","&&r++}catch{if(tt.ARR&e)return p;o("Expected ']' at end of array")}return r++,p},u=()=>{if(r===0){t==="-"&&tt.NUM&e&&o("Not sure what '-' is");try{return JSON.parse(t)}catch(m){if(tt.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}s(String(m))}}const p=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(tt.NUM&e)&&o("Unterminated number literal");try{return JSON.parse(t.substring(p,r))}catch{t.substring(p,r)==="-"&&tt.NUM&e&&o("Not sure what '-' is");try{return JSON.parse(t.substring(p,t.lastIndexOf("e")))}catch(w){s(String(w))}}},h=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return i()},Eg=t=>jL(t,tt.ALL^tt.NUM);var je,ln,ar,yn,Nl,fi,Ml,xl,Dl,hi,Ol,Tg;class vo extends R0{constructor(e){super(),je.add(this),ln.set(this,void 0),ar.set(this,void 0),yn.set(this,void 0),fe(this,ln,e),fe(this,ar,[])}get currentChatCompletionSnapshot(){return H(this,yn,"f")}static fromReadableStream(e){const n=new vo(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const o=new vo(n);return o._run(()=>o._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createChatCompletion(e,n,r){super._createChatCompletion;const o=r?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),H(this,je,"m",Nl).call(this);const s=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const i of s)H(this,je,"m",Ml).call(this,i);if(s.controller.signal?.aborted)throw new Nt;return this._addChatCompletion(H(this,je,"m",hi).call(this))}async _fromReadableStream(e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),H(this,je,"m",Nl).call(this),this._connected();const o=jt.fromReadableStream(e,this.controller);let s;for await(const i of o)s&&s!==i.id&&this._addChatCompletion(H(this,je,"m",hi).call(this)),H(this,je,"m",Ml).call(this,i),s=i.id;if(o.controller.signal?.aborted)throw new Nt;return this._addChatCompletion(H(this,je,"m",hi).call(this))}[(ln=new WeakMap,ar=new WeakMap,yn=new WeakMap,je=new WeakSet,Nl=function(){this.ended||fe(this,yn,void 0)},fi=function(n){let r=H(this,ar,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},H(this,ar,"f")[n.index]=r,r)},Ml=function(n){if(this.ended)return;const r=H(this,je,"m",Tg).call(this,n);this._emit("chunk",n,r);for(const o of n.choices){const s=r.choices[o.index];o.delta.content!=null&&s.message?.role==="assistant"&&s.message?.content&&(this._emit("content",o.delta.content,s.message.content),this._emit("content.delta",{delta:o.delta.content,snapshot:s.message.content,parsed:s.message.parsed})),o.delta.refusal!=null&&s.message?.role==="assistant"&&s.message?.refusal&&this._emit("refusal.delta",{delta:o.delta.refusal,snapshot:s.message.refusal}),o.logprobs?.content!=null&&s.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:o.logprobs?.content,snapshot:s.logprobs?.content??[]}),o.logprobs?.refusal!=null&&s.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:o.logprobs?.refusal,snapshot:s.logprobs?.refusal??[]});const i=H(this,je,"m",fi).call(this,s);s.finish_reason&&(H(this,je,"m",Dl).call(this,s),i.current_tool_call_index!=null&&H(this,je,"m",xl).call(this,s,i.current_tool_call_index));for(const a of o.delta.tool_calls??[])i.current_tool_call_index!==a.index&&(H(this,je,"m",Dl).call(this,s),i.current_tool_call_index!=null&&H(this,je,"m",xl).call(this,s,i.current_tool_call_index)),i.current_tool_call_index=a.index;for(const a of o.delta.tool_calls??[]){const l=s.message.tool_calls?.[a.index];l?.type&&(l?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:l.function?.name,index:a.index,arguments:l.function.arguments,parsed_arguments:l.function.parsed_arguments,arguments_delta:a.function?.arguments??""}):(l?.type,void 0))}}},xl=function(n,r){if(H(this,je,"m",fi).call(this,n).done_tool_calls.has(r))return;const s=n.message.tool_calls?.[r];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if(s.type==="function"){const i=H(this,ln,"f")?.tools?.find(a=>na(a)&&a.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:r,arguments:s.function.arguments,parsed_arguments:Io(i)?i.$parseRaw(s.function.arguments):i?.function.strict?JSON.parse(s.function.arguments):null})}else s.type},Dl=function(n){const r=H(this,je,"m",fi).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const o=H(this,je,"m",Ol).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),n.logprobs?.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),n.logprobs?.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},hi=function(){if(this.ended)throw new ue("stream has ended, this shouldn't happen");const n=H(this,yn,"f");if(!n)throw new ue("request ended without sending any chunks");return fe(this,yn,void 0),fe(this,ar,[]),tq(n,H(this,ln,"f"))},Ol=function(){const n=H(this,ln,"f")?.response_format;return Gu(n)?n:null},Tg=function(n){var r,o,s,i;let a=H(this,yn,"f");const{choices:l,...c}=n;a?Object.assign(a,c):a=fe(this,yn,{...c,choices:[]});for(const{delta:u,finish_reason:h,index:p,logprobs:m=null,...w}of n.choices){let E=a.choices[p];if(E||(E=a.choices[p]={finish_reason:h,index:p,message:{},logprobs:m,...w}),m)if(!E.logprobs)E.logprobs=Object.assign({},m);else{const{content:C,refusal:k,...P}=m;Object.assign(E.logprobs,P),C&&((r=E.logprobs).content??(r.content=[]),E.logprobs.content.push(...C)),k&&((o=E.logprobs).refusal??(o.refusal=[]),E.logprobs.refusal.push(...k))}if(h&&(E.finish_reason=h,H(this,ln,"f")&&E0(H(this,ln,"f")))){if(h==="length")throw new r0;if(h==="content_filter")throw new o0}if(Object.assign(E,w),!u)continue;const{content:_,refusal:v,function_call:g,role:S,tool_calls:b,...y}=u;if(Object.assign(E.message,y),v&&(E.message.refusal=(E.message.refusal||"")+v),S&&(E.message.role=S),g&&(E.message.function_call?(g.name&&(E.message.function_call.name=g.name),g.arguments&&((s=E.message.function_call).arguments??(s.arguments=""),E.message.function_call.arguments+=g.arguments)):E.message.function_call=g),_&&(E.message.content=(E.message.content||"")+_,!E.message.refusal&&H(this,je,"m",Ol).call(this)&&(E.message.parsed=Eg(E.message.content))),b){E.message.tool_calls||(E.message.tool_calls=[]);for(const{index:C,id:k,type:P,function:M,...q}of b){const D=(i=E.message.tool_calls)[C]??(i[C]={});Object.assign(D,q),k&&(D.id=k),P&&(D.type=P),M&&(D.function??(D.function={name:M.name??"",arguments:""})),M?.name&&(D.function.name=M.name),M?.arguments&&(D.function.arguments+=M.arguments,JL(H(this,ln,"f"),D)&&(D.function.parsed_arguments=Eg(D.function.arguments)))}}}return a},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",o=>{const s=n.shift();s?s.resolve(o):e.push(o)}),this.on("end",()=>{r=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{r=!0;for(const s of n)s.reject(o);n.length=0}),this.on("error",o=>{r=!0;for(const s of n)s.reject(o);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,i)=>n.push({resolve:s,reject:i})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new jt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function tq(t,e){const{id:n,choices:r,created:o,model:s,system_fingerprint:i,...a}=t,l={...a,id:n,choices:r.map(({message:c,finish_reason:u,index:h,logprobs:p,...m})=>{if(!u)throw new ue(`missing finish_reason for choice ${h}`);const{content:w=null,function_call:E,tool_calls:_,...v}=c,g=c.role;if(!g)throw new ue(`missing role for choice ${h}`);if(E){const{arguments:S,name:b}=E;if(S==null)throw new ue(`missing function_call.arguments for choice ${h}`);if(!b)throw new ue(`missing function_call.name for choice ${h}`);return{...m,message:{content:w,function_call:{arguments:S,name:b},role:g,refusal:c.refusal??null},finish_reason:u,index:h,logprobs:p}}return _?{...m,index:h,finish_reason:u,logprobs:p,message:{...v,role:g,content:w,refusal:c.refusal??null,tool_calls:_.map((S,b)=>{const{function:y,type:C,id:k,...P}=S,{arguments:M,name:q,...D}=y||{};if(k==null)throw new ue(`missing choices[${h}].tool_calls[${b}].id
${pi(t)}`);if(C==null)throw new ue(`missing choices[${h}].tool_calls[${b}].type
${pi(t)}`);if(q==null)throw new ue(`missing choices[${h}].tool_calls[${b}].function.name
${pi(t)}`);if(M==null)throw new ue(`missing choices[${h}].tool_calls[${b}].function.arguments
${pi(t)}`);return{...P,id:k,type:C,function:{...D,name:q,arguments:M}}})}}:{...m,message:{...v,content:w,role:g,refusal:c.refusal??null},finish_reason:u,index:h,logprobs:p}}),created:o,model:s,object:"chat.completion",...i?{system_fingerprint:i}:{}};return HL(l,e)}function pi(t){return JSON.stringify(t)}class aa extends vo{static fromReadableStream(e){const n=new aa(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,r){const o=new aa(n),s={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return o._run(()=>o._runTools(e,n,s)),o}}let Wu=class extends ce{constructor(){super(...arguments),this.messages=new S0(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(X`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(X`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return this._client.getAPIList("/chat/completions",Qe,{query:e,...n})}delete(e,n){return this._client.delete(X`/chat/completions/${e}`,n)}parse(e,n){return KL(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(r=>Bu(r,e))}runTools(e,n){return e.stream?aa.runTools(this._client,e,n):Ku.runTools(this._client,e,n)}stream(e,n){return vo.createChatCompletion(this._client,e,n)}};Wu.Messages=S0;class Zu extends ce{constructor(){super(...arguments),this.completions=new Wu(this._client)}}Zu.Completions=Wu;const z0=Symbol("brand.privateNullableHeaders");function*nq(t){if(!t)return;if(z0 in t){const{values:r,nulls:o}=t;yield*r.entries();for(const s of o)yield[s,null];return}let e=!1,n;t instanceof Headers?n=t.entries():ag(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const o=r[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const s=ag(r[1])?r[1]:[r[1]];let i=!1;for(const a of s)a!==void 0&&(e&&!i&&(i=!0,yield[o,null]),yield[o,a])}}const ie=t=>{const e=new Headers,n=new Set;for(const r of t){const o=new Set;for(const[s,i]of nq(r)){const a=s.toLowerCase();o.has(a)||(e.delete(s),o.add(a)),i===null?(e.delete(s),n.add(a)):(e.append(s,i),n.delete(a))}}return{[z0]:!0,values:e,nulls:n}};class H0 extends ce{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:ie([{Accept:"application/octet-stream"},n?.headers]),__binaryResponse:!0})}}class G0 extends ce{create(e,n){return this._client.post("/audio/transcriptions",Yn({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class B0 extends ce{create(e,n){return this._client.post("/audio/translations",Yn({body:e,...n,__metadata:{model:e.model}},this._client))}}class Ro extends ce{constructor(){super(...arguments),this.transcriptions=new G0(this._client),this.translations=new B0(this._client),this.speech=new H0(this._client)}}Ro.Transcriptions=G0;Ro.Translations=B0;Ro.Speech=H0;class J0 extends ce{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(X`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",Qe,{query:e,...n})}cancel(e,n){return this._client.post(X`/batches/${e}/cancel`,n)}}class K0 extends ce{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(X`/assistants/${e}`,{...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,r){return this._client.post(X`/assistants/${e}`,{body:n,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e={},n){return this._client.getAPIList("/assistants",Qe,{query:e,...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,n){return this._client.delete(X`/assistants/${e}`,{...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}let W0=class extends ce{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}};class Z0 extends ce{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}let Ha=class extends ce{constructor(){super(...arguments),this.sessions=new W0(this._client),this.transcriptionSessions=new Z0(this._client)}};Ha.Sessions=W0;Ha.TranscriptionSessions=Z0;class Y0 extends ce{create(e,n){return this._client.post("/chatkit/sessions",{body:e,...n,headers:ie([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}cancel(e,n){return this._client.post(X`/chatkit/sessions/${e}/cancel`,{...n,headers:ie([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}}let X0=class extends ce{retrieve(e,n){return this._client.get(X`/chatkit/threads/${e}`,{...n,headers:ie([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}list(e={},n){return this._client.getAPIList("/chatkit/threads",ta,{query:e,...n,headers:ie([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}delete(e,n){return this._client.delete(X`/chatkit/threads/${e}`,{...n,headers:ie([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}listItems(e,n={},r){return this._client.getAPIList(X`/chatkit/threads/${e}/items`,ta,{query:n,...r,headers:ie([{"OpenAI-Beta":"chatkit_beta=v1"},r?.headers])})}};class Ga extends ce{constructor(){super(...arguments),this.sessions=new Y0(this._client),this.threads=new X0(this._client)}}Ga.Sessions=Y0;Ga.Threads=X0;class Q0 extends ce{create(e,n,r){return this._client.post(X`/threads/${e}/messages`,{body:n,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,n,r){const{thread_id:o}=n;return this._client.get(X`/threads/${o}/messages/${e}`,{...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,n,r){const{thread_id:o,...s}=n;return this._client.post(X`/threads/${o}/messages/${e}`,{body:s,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,n={},r){return this._client.getAPIList(X`/threads/${e}/messages`,Qe,{query:n,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,n,r){const{thread_id:o}=n;return this._client.delete(X`/threads/${o}/messages/${e}`,{...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}class j0 extends ce{retrieve(e,n,r){const{thread_id:o,run_id:s,...i}=n;return this._client.get(X`/threads/${o}/runs/${s}/steps/${e}`,{query:i,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,n,r){const{thread_id:o,...s}=n;return this._client.getAPIList(X`/threads/${o}/runs/${e}/steps`,Qe,{query:s,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}const rq=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let o=0;o<n;o++)r[o]=e.charCodeAt(o);return Array.from(new Float32Array(r.buffer))}};var oq={};const lr=t=>{if(typeof globalThis.process<"u")return oq?.[t]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(t)?.trim()};var at,Wn,Uc,Qt,Ri,zt,Zn,yr,Kn,la,$t,$i,Ai,lo,oo,so,bg,Cg,kg,Ig,Rg,$g,Ag;class co extends Ju{constructor(){super(...arguments),at.add(this),Uc.set(this,[]),Qt.set(this,{}),Ri.set(this,{}),zt.set(this,void 0),Zn.set(this,void 0),yr.set(this,void 0),Kn.set(this,void 0),la.set(this,void 0),$t.set(this,void 0),$i.set(this,void 0),Ai.set(this,void 0),lo.set(this,void 0)}[(Uc=new WeakMap,Qt=new WeakMap,Ri=new WeakMap,zt=new WeakMap,Zn=new WeakMap,yr=new WeakMap,Kn=new WeakMap,la=new WeakMap,$t=new WeakMap,$i=new WeakMap,Ai=new WeakMap,lo=new WeakMap,at=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",o=>{const s=n.shift();s?s.resolve(o):e.push(o)}),this.on("end",()=>{r=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{r=!0;for(const s of n)s.reject(o);n.length=0}),this.on("error",o=>{r=!0;for(const s of n)s.reject(o);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,i)=>n.push({resolve:s,reject:i})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new Wn;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const o=jt.fromReadableStream(e,this.controller);for await(const s of o)H(this,at,"m",oo).call(this,s);if(o.controller.signal?.aborted)throw new Nt;return this._addRun(H(this,at,"m",so).call(this))}toReadableStream(){return new jt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,o){const s=new Wn;return s._run(()=>s._runToolAssistantStream(e,n,r,{...o,headers:{...o?.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createToolAssistantStream(e,n,r,o){const s=o?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},a=await e.submitToolOutputs(n,i,{...o,signal:this.controller.signal});this._connected();for await(const l of a)H(this,at,"m",oo).call(this,l);if(a.controller.signal?.aborted)throw new Nt;return this._addRun(H(this,at,"m",so).call(this))}static createThreadAssistantStream(e,n,r){const o=new Wn;return o._run(()=>o._threadAssistantStream(e,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),o}static createAssistantStream(e,n,r,o){const s=new Wn;return s._run(()=>s._runAssistantStream(e,n,r,{...o,headers:{...o?.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return H(this,$i,"f")}currentRun(){return H(this,Ai,"f")}currentMessageSnapshot(){return H(this,zt,"f")}currentRunStepSnapshot(){return H(this,lo,"f")}async finalRunSteps(){return await this.done(),Object.values(H(this,Qt,"f"))}async finalMessages(){return await this.done(),Object.values(H(this,Ri,"f"))}async finalRun(){if(await this.done(),!H(this,Zn,"f"))throw Error("Final run was not received.");return H(this,Zn,"f")}async _createThreadAssistantStream(e,n,r){const o=r?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const s={...n,stream:!0},i=await e.createAndRun(s,{...r,signal:this.controller.signal});this._connected();for await(const a of i)H(this,at,"m",oo).call(this,a);if(i.controller.signal?.aborted)throw new Nt;return this._addRun(H(this,at,"m",so).call(this))}async _createAssistantStream(e,n,r,o){const s=o?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},a=await e.create(n,i,{...o,signal:this.controller.signal});this._connected();for await(const l of a)H(this,at,"m",oo).call(this,l);if(a.controller.signal?.aborted)throw new Nt;return this._addRun(H(this,at,"m",so).call(this))}static accumulateDelta(e,n){for(const[r,o]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=o;continue}let s=e[r];if(s==null){e[r]=o;continue}if(r==="index"||r==="type"){e[r]=o;continue}if(typeof s=="string"&&typeof o=="string")s+=o;else if(typeof s=="number"&&typeof o=="number")s+=o;else if($l(s)&&$l(o))s=this.accumulateDelta(s,o);else if(Array.isArray(s)&&Array.isArray(o)){if(s.every(i=>typeof i=="string"||typeof i=="number")){s.push(...o);continue}for(const i of o){if(!$l(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const a=i.index;if(a==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof a!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${a}`);const l=s[a];l==null?s.push(i):s[a]=this.accumulateDelta(l,i)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${o}, accValue: ${s}`);e[r]=s}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,o){return await this._createAssistantStream(n,e,r,o)}async _runToolAssistantStream(e,n,r,o){return await this._createToolAssistantStream(n,e,r,o)}}Wn=co,oo=function(e){if(!this.ended)switch(fe(this,$i,e),H(this,at,"m",kg).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":H(this,at,"m",Ag).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":H(this,at,"m",Cg).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":H(this,at,"m",bg).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},so=function(){if(this.ended)throw new ue("stream has ended, this shouldn't happen");if(!H(this,Zn,"f"))throw Error("Final run has not been received");return H(this,Zn,"f")},bg=function(e){const[n,r]=H(this,at,"m",Rg).call(this,e,H(this,zt,"f"));fe(this,zt,n),H(this,Ri,"f")[n.id]=n;for(const o of r){const s=n.content[o.index];s?.type=="text"&&this._emit("textCreated",s.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const o of e.data.delta.content){if(o.type=="text"&&o.text){let s=o.text,i=n.content[o.index];if(i&&i.type=="text")this._emit("textDelta",s,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(o.index!=H(this,yr,"f")){if(H(this,Kn,"f"))switch(H(this,Kn,"f").type){case"text":this._emit("textDone",H(this,Kn,"f").text,H(this,zt,"f"));break;case"image_file":this._emit("imageFileDone",H(this,Kn,"f").image_file,H(this,zt,"f"));break}fe(this,yr,o.index)}fe(this,Kn,n.content[o.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(H(this,yr,"f")!==void 0){const o=e.data.content[H(this,yr,"f")];if(o)switch(o.type){case"image_file":this._emit("imageFileDone",o.image_file,H(this,zt,"f"));break;case"text":this._emit("textDone",o.text,H(this,zt,"f"));break}}H(this,zt,"f")&&this._emit("messageDone",e.data),fe(this,zt,void 0)}},Cg=function(e){const n=H(this,at,"m",Ig).call(this,e);switch(fe(this,lo,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const s of r.step_details.tool_calls)s.index==H(this,la,"f")?this._emit("toolCallDelta",s,n.step_details.tool_calls[s.index]):(H(this,$t,"f")&&this._emit("toolCallDone",H(this,$t,"f")),fe(this,la,s.index),fe(this,$t,n.step_details.tool_calls[s.index]),H(this,$t,"f")&&this._emit("toolCallCreated",H(this,$t,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":fe(this,lo,void 0),e.data.step_details.type=="tool_calls"&&H(this,$t,"f")&&(this._emit("toolCallDone",H(this,$t,"f")),fe(this,$t,void 0)),this._emit("runStepDone",e.data,n);break}},kg=function(e){H(this,Uc,"f").push(e),this._emit("event",e)},Ig=function(e){switch(e.event){case"thread.run.step.created":return H(this,Qt,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=H(this,Qt,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const o=Wn.accumulateDelta(n,r.delta);H(this,Qt,"f")[e.data.id]=o}return H(this,Qt,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":H(this,Qt,"f")[e.data.id]=e.data;break}if(H(this,Qt,"f")[e.data.id])return H(this,Qt,"f")[e.data.id];throw new Error("No snapshot available")},Rg=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let o=e.data;if(o.delta.content)for(const s of o.delta.content)if(s.index in n.content){let i=n.content[s.index];n.content[s.index]=H(this,at,"m",$g).call(this,s,i)}else n.content[s.index]=s,r.push(s);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},$g=function(e,n){return Wn.accumulateDelta(n,e)},Ag=function(e){switch(fe(this,Ai,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":fe(this,Zn,e.data),H(this,$t,"f")&&(this._emit("toolCallDone",H(this,$t,"f")),fe(this,$t,void 0));break}};let Yu=class extends ce{constructor(){super(...arguments),this.steps=new j0(this._client)}create(e,n,r){const{include:o,...s}=n;return this._client.post(X`/threads/${e}/runs`,{query:{include:o},body:s,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers]),stream:n.stream??!1})}retrieve(e,n,r){const{thread_id:o}=n;return this._client.get(X`/threads/${o}/runs/${e}`,{...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,n,r){const{thread_id:o,...s}=n;return this._client.post(X`/threads/${o}/runs/${e}`,{body:s,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,n={},r){return this._client.getAPIList(X`/threads/${e}/runs`,Qe,{query:n,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}cancel(e,n,r){const{thread_id:o}=n;return this._client.post(X`/threads/${o}/runs/${e}/cancel`,{...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,n,r){const o=await this.create(e,n,r);return await this.poll(o.id,{thread_id:e},r)}createAndStream(e,n,r){return co.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const o=ie([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:s,response:i}=await this.retrieve(e,n,{...r,headers:{...r?.headers,...o}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let a=5e3;if(r?.pollIntervalMs)a=r.pollIntervalMs;else{const l=i.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(a=c)}}await ko(a);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,n,r){return co.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r){const{thread_id:o,...s}=n;return this._client.post(X`/threads/${o}/runs/${e}/submit_tool_outputs`,{body:s,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,r){const o=await this.submitToolOutputs(e,n,r);return await this.poll(o.id,n,r)}submitToolOutputsStream(e,n,r){return co.createToolAssistantStream(e,this._client.beta.threads.runs,n,r)}};Yu.Steps=j0;class Ba extends ce{constructor(){super(...arguments),this.runs=new Yu(this._client),this.messages=new Q0(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(X`/threads/${e}`,{...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,r){return this._client.post(X`/threads/${e}`,{body:n,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,n){return this._client.delete(X`/threads/${e}`,{...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.id,{thread_id:r.thread_id},n)}createAndRunStream(e,n){return co.createThreadAssistantStream(e,this._client.beta.threads,n)}}Ba.Runs=Yu;Ba.Messages=Q0;class Mr extends ce{constructor(){super(...arguments),this.realtime=new Ha(this._client),this.chatkit=new Ga(this._client),this.assistants=new K0(this._client),this.threads=new Ba(this._client)}}Mr.Realtime=Ha;Mr.ChatKit=Ga;Mr.Assistants=K0;Mr.Threads=Ba;class ew extends ce{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}class tw extends ce{retrieve(e,n,r){const{container_id:o}=n;return this._client.get(X`/containers/${o}/files/${e}/content`,{...r,headers:ie([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0})}}let Xu=class extends ce{constructor(){super(...arguments),this.content=new tw(this._client)}create(e,n,r){return this._client.post(X`/containers/${e}/files`,Yn({body:n,...r},this._client))}retrieve(e,n,r){const{container_id:o}=n;return this._client.get(X`/containers/${o}/files/${e}`,r)}list(e,n={},r){return this._client.getAPIList(X`/containers/${e}/files`,Qe,{query:n,...r})}delete(e,n,r){const{container_id:o}=n;return this._client.delete(X`/containers/${o}/files/${e}`,{...r,headers:ie([{Accept:"*/*"},r?.headers])})}};Xu.Content=tw;class Qu extends ce{constructor(){super(...arguments),this.files=new Xu(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(X`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",Qe,{query:e,...n})}delete(e,n){return this._client.delete(X`/containers/${e}`,{...n,headers:ie([{Accept:"*/*"},n?.headers])})}}Qu.Files=Xu;class nw extends ce{create(e,n,r){const{include:o,...s}=n;return this._client.post(X`/conversations/${e}/items`,{query:{include:o},body:s,...r})}retrieve(e,n,r){const{conversation_id:o,...s}=n;return this._client.get(X`/conversations/${o}/items/${e}`,{query:s,...r})}list(e,n={},r){return this._client.getAPIList(X`/conversations/${e}/items`,ta,{query:n,...r})}delete(e,n,r){const{conversation_id:o}=n;return this._client.delete(X`/conversations/${o}/items/${e}`,r)}}class ju extends ce{constructor(){super(...arguments),this.items=new nw(this._client)}create(e={},n){return this._client.post("/conversations",{body:e,...n})}retrieve(e,n){return this._client.get(X`/conversations/${e}`,n)}update(e,n,r){return this._client.post(X`/conversations/${e}`,{body:n,...r})}delete(e,n){return this._client.delete(X`/conversations/${e}`,n)}}ju.Items=nw;class rw extends ce{create(e,n){const r=!!e.encoding_format;let o=r?e.encoding_format:"base64";r&&it(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const s=this._client.post("/embeddings",{body:{...e,encoding_format:o},...n});return r?s:(it(this._client).debug("embeddings/decoding base64 embeddings from base64"),s._thenUnwrap(i=>(i&&i.data&&i.data.forEach(a=>{const l=a.embedding;a.embedding=rq(l)}),i)))}}class ow extends ce{retrieve(e,n,r){const{eval_id:o,run_id:s}=n;return this._client.get(X`/evals/${o}/runs/${s}/output_items/${e}`,r)}list(e,n,r){const{eval_id:o,...s}=n;return this._client.getAPIList(X`/evals/${o}/runs/${e}/output_items`,Qe,{query:s,...r})}}class ed extends ce{constructor(){super(...arguments),this.outputItems=new ow(this._client)}create(e,n,r){return this._client.post(X`/evals/${e}/runs`,{body:n,...r})}retrieve(e,n,r){const{eval_id:o}=n;return this._client.get(X`/evals/${o}/runs/${e}`,r)}list(e,n={},r){return this._client.getAPIList(X`/evals/${e}/runs`,Qe,{query:n,...r})}delete(e,n,r){const{eval_id:o}=n;return this._client.delete(X`/evals/${o}/runs/${e}`,r)}cancel(e,n,r){const{eval_id:o}=n;return this._client.post(X`/evals/${o}/runs/${e}`,r)}}ed.OutputItems=ow;class td extends ce{constructor(){super(...arguments),this.runs=new ed(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(X`/evals/${e}`,n)}update(e,n,r){return this._client.post(X`/evals/${e}`,{body:n,...r})}list(e={},n){return this._client.getAPIList("/evals",Qe,{query:e,...n})}delete(e,n){return this._client.delete(X`/evals/${e}`,n)}}td.Runs=ed;let sw=class extends ce{create(e,n){return this._client.post("/files",Yn({body:e,...n},this._client))}retrieve(e,n){return this._client.get(X`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",Qe,{query:e,...n})}delete(e,n){return this._client.delete(X`/files/${e}`,n)}content(e,n){return this._client.get(X`/files/${e}/content`,{...n,headers:ie([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=1800*1e3}={}){const o=new Set(["processed","error","deleted"]),s=Date.now();let i=await this.retrieve(e);for(;!i.status||!o.has(i.status);)if(await ko(n),i=await this.retrieve(e),Date.now()-s>r)throw new Fu({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return i}};class iw extends ce{}let aw=class extends ce{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class nd extends ce{constructor(){super(...arguments),this.graders=new aw(this._client)}}nd.Graders=aw;class lw extends ce{create(e,n,r){return this._client.getAPIList(X`/fine_tuning/checkpoints/${e}/permissions`,za,{body:n,method:"post",...r})}retrieve(e,n={},r){return this._client.get(X`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...r})}delete(e,n,r){const{fine_tuned_model_checkpoint:o}=n;return this._client.delete(X`/fine_tuning/checkpoints/${o}/permissions/${e}`,r)}}let rd=class extends ce{constructor(){super(...arguments),this.permissions=new lw(this._client)}};rd.Permissions=lw;class cw extends ce{list(e,n={},r){return this._client.getAPIList(X`/fine_tuning/jobs/${e}/checkpoints`,Qe,{query:n,...r})}}class od extends ce{constructor(){super(...arguments),this.checkpoints=new cw(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(X`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",Qe,{query:e,...n})}cancel(e,n){return this._client.post(X`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return this._client.getAPIList(X`/fine_tuning/jobs/${e}/events`,Qe,{query:n,...r})}pause(e,n){return this._client.post(X`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(X`/fine_tuning/jobs/${e}/resume`,n)}}od.Checkpoints=cw;class xr extends ce{constructor(){super(...arguments),this.methods=new iw(this._client),this.jobs=new od(this._client),this.checkpoints=new rd(this._client),this.alpha=new nd(this._client)}}xr.Methods=iw;xr.Jobs=od;xr.Checkpoints=rd;xr.Alpha=nd;class uw extends ce{}class sd extends ce{constructor(){super(...arguments),this.graderModels=new uw(this._client)}}sd.GraderModels=uw;class dw extends ce{createVariation(e,n){return this._client.post("/images/variations",Yn({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",Yn({body:e,...n,stream:e.stream??!1},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n,stream:e.stream??!1})}}class fw extends ce{retrieve(e,n){return this._client.get(X`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",za,e)}delete(e,n){return this._client.delete(X`/models/${e}`,n)}}class hw extends ce{create(e,n){return this._client.post("/moderations",{body:e,...n})}}class pw extends ce{accept(e,n,r){return this._client.post(X`/realtime/calls/${e}/accept`,{body:n,...r,headers:ie([{Accept:"*/*"},r?.headers])})}hangup(e,n){return this._client.post(X`/realtime/calls/${e}/hangup`,{...n,headers:ie([{Accept:"*/*"},n?.headers])})}refer(e,n,r){return this._client.post(X`/realtime/calls/${e}/refer`,{body:n,...r,headers:ie([{Accept:"*/*"},r?.headers])})}reject(e,n={},r){return this._client.post(X`/realtime/calls/${e}/reject`,{body:n,...r,headers:ie([{Accept:"*/*"},r?.headers])})}}class mw extends ce{create(e,n){return this._client.post("/realtime/client_secrets",{body:e,...n})}}class Ja extends ce{constructor(){super(...arguments),this.clientSecrets=new mw(this._client),this.calls=new pw(this._client)}}Ja.ClientSecrets=mw;Ja.Calls=pw;function sq(t,e){return!e||!aq(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:gw(t,e)}function gw(t,e){const n=t.output.map(o=>{if(o.type==="function_call")return{...o,parsed_arguments:uq(e,o)};if(o.type==="message"){const s=o.content.map(i=>i.type==="output_text"?{...i,parsed:iq(e,i.text)}:i);return{...o,content:s}}return o}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||Lc(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const o of r.output)if(o.type==="message"){for(const s of o.content)if(s.type==="output_text"&&s.parsed!==null)return s.parsed}return null}}),r}function iq(t,e){return t.text?.format?.type!=="json_schema"?null:"$parseRaw"in t.text?.format?(t.text?.format).$parseRaw(e):JSON.parse(e)}function aq(t){return!!Gu(t.text?.format)}function lq(t){return t?.$brand==="auto-parseable-tool"}function cq(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function uq(t,e){const n=cq(t.tools??[],e.name);return{...e,...e,parsed_arguments:lq(n)?n.$parseRaw(e.arguments):n?.strict?JSON.parse(e.arguments):null}}function Lc(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}var cr,mi,vn,gi,Pg,Ng,Mg,xg;class id extends Ju{constructor(e){super(),cr.add(this),mi.set(this,void 0),vn.set(this,void 0),gi.set(this,void 0),fe(this,mi,e)}static createResponse(e,n,r){const o=new id(n);return o._run(()=>o._createOrRetrieveResponse(e,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createOrRetrieveResponse(e,n,r){const o=r?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),H(this,cr,"m",Pg).call(this);let s,i=null;"response_id"in n?(s=await e.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),i=n.starting_after??null):s=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const a of s)H(this,cr,"m",Ng).call(this,a,i);if(s.controller.signal?.aborted)throw new Nt;return H(this,cr,"m",Mg).call(this)}[(mi=new WeakMap,vn=new WeakMap,gi=new WeakMap,cr=new WeakSet,Pg=function(){this.ended||fe(this,vn,void 0)},Ng=function(n,r){if(this.ended)return;const o=(i,a)=>{(r==null||a.sequence_number>r)&&this._emit(i,a)},s=H(this,cr,"m",xg).call(this,n);switch(o("event",n),n.type){case"response.output_text.delta":{const i=s.output[n.output_index];if(!i)throw new ue(`missing output at index ${n.output_index}`);if(i.type==="message"){const a=i.content[n.content_index];if(!a)throw new ue(`missing content at index ${n.content_index}`);if(a.type!=="output_text")throw new ue(`expected content to be 'output_text', got ${a.type}`);o("response.output_text.delta",{...n,snapshot:a.text})}break}case"response.function_call_arguments.delta":{const i=s.output[n.output_index];if(!i)throw new ue(`missing output at index ${n.output_index}`);i.type==="function_call"&&o("response.function_call_arguments.delta",{...n,snapshot:i.arguments});break}default:o(n.type,n);break}},Mg=function(){if(this.ended)throw new ue("stream has ended, this shouldn't happen");const n=H(this,vn,"f");if(!n)throw new ue("request ended without sending any events");fe(this,vn,void 0);const r=dq(n,H(this,mi,"f"));return fe(this,gi,r),r},xg=function(n){let r=H(this,vn,"f");if(!r){if(n.type!=="response.created")throw new ue(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=fe(this,vn,n.response),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const o=r.output[n.output_index];if(!o)throw new ue(`missing output at index ${n.output_index}`);const s=o.type,i=n.part;s==="message"&&i.type!=="reasoning_text"?o.content.push(i):s==="reasoning"&&i.type==="reasoning_text"&&(o.content||(o.content=[]),o.content.push(i));break}case"response.output_text.delta":{const o=r.output[n.output_index];if(!o)throw new ue(`missing output at index ${n.output_index}`);if(o.type==="message"){const s=o.content[n.content_index];if(!s)throw new ue(`missing content at index ${n.content_index}`);if(s.type!=="output_text")throw new ue(`expected content to be 'output_text', got ${s.type}`);s.text+=n.delta}break}case"response.function_call_arguments.delta":{const o=r.output[n.output_index];if(!o)throw new ue(`missing output at index ${n.output_index}`);o.type==="function_call"&&(o.arguments+=n.delta);break}case"response.reasoning_text.delta":{const o=r.output[n.output_index];if(!o)throw new ue(`missing output at index ${n.output_index}`);if(o.type==="reasoning"){const s=o.content?.[n.content_index];if(!s)throw new ue(`missing content at index ${n.content_index}`);if(s.type!=="reasoning_text")throw new ue(`expected content to be 'reasoning_text', got ${s.type}`);s.text+=n.delta}break}case"response.completed":{fe(this,vn,n.response);break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",o=>{const s=n.shift();s?s.resolve(o):e.push(o)}),this.on("end",()=>{r=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{r=!0;for(const s of n)s.reject(o);n.length=0}),this.on("error",o=>{r=!0;for(const s of n)s.reject(o);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,i)=>n.push({resolve:s,reject:i})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=H(this,gi,"f");if(!e)throw new ue("stream ended without producing a ChatCompletion");return e}}function dq(t,e){return sq(t,e)}class _w extends ce{list(e,n={},r){return this._client.getAPIList(X`/responses/${e}/input_items`,Qe,{query:n,...r})}}class yw extends ce{count(e={},n){return this._client.post("/responses/input_tokens",{body:e,...n})}}class Ka extends ce{constructor(){super(...arguments),this.inputItems=new _w(this._client),this.inputTokens=new yw(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&Lc(r),r))}retrieve(e,n={},r){return this._client.get(X`/responses/${e}`,{query:n,...r,stream:n?.stream??!1})._thenUnwrap(o=>("object"in o&&o.object==="response"&&Lc(o),o))}delete(e,n){return this._client.delete(X`/responses/${e}`,{...n,headers:ie([{Accept:"*/*"},n?.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>gw(r,e))}stream(e,n){return id.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(X`/responses/${e}/cancel`,n)}compact(e,n){return this._client.post("/responses/compact",{body:e,...n})}}Ka.InputItems=_w;Ka.InputTokens=yw;class vw extends ce{create(e,n,r){return this._client.post(X`/uploads/${e}/parts`,Yn({body:n,...r},this._client))}}class ad extends ce{constructor(){super(...arguments),this.parts=new vw(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(X`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(X`/uploads/${e}/complete`,{body:n,...r})}}ad.Parts=vw;const fq=async t=>{const e=await Promise.allSettled(t),n=e.filter(o=>o.status==="rejected");if(n.length){for(const o of n)console.error(o.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const o of e)o.status==="fulfilled"&&r.push(o.value);return r};class ww extends ce{create(e,n,r){return this._client.post(X`/vector_stores/${e}/file_batches`,{body:n,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,n,r){const{vector_store_id:o}=n;return this._client.get(X`/vector_stores/${o}/file_batches/${e}`,{...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}cancel(e,n,r){const{vector_store_id:o}=n;return this._client.post(X`/vector_stores/${o}/file_batches/${e}/cancel`,{...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,n,r){const o=await this.create(e,n);return await this.poll(e,o.id,r)}listFiles(e,n,r){const{vector_store_id:o,...s}=n;return this._client.getAPIList(X`/vector_stores/${o}/file_batches/${e}/files`,Qe,{query:s,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async poll(e,n,r){const o=ie([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:s,response:i}=await this.retrieve(n,{vector_store_id:e},{...r,headers:o}).withResponse();switch(s.status){case"in_progress":let a=5e3;if(r?.pollIntervalMs)a=r.pollIntervalMs;else{const l=i.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(a=c)}}await ko(a);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},o){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=o?.maxConcurrency??5,i=Math.min(s,n.length),a=this._client,l=n.values(),c=[...r];async function u(p){for(let m of p){const w=await a.files.create({file:m,purpose:"assistants"},o);c.push(w.id)}}const h=Array(i).fill(l).map(u);return await fq(h),await this.createAndPoll(e,{file_ids:c})}}class Sw extends ce{create(e,n,r){return this._client.post(X`/vector_stores/${e}/files`,{body:n,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,n,r){const{vector_store_id:o}=n;return this._client.get(X`/vector_stores/${o}/files/${e}`,{...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,n,r){const{vector_store_id:o,...s}=n;return this._client.post(X`/vector_stores/${o}/files/${e}`,{body:s,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,n={},r){return this._client.getAPIList(X`/vector_stores/${e}/files`,Qe,{query:n,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,n,r){const{vector_store_id:o}=n;return this._client.delete(X`/vector_stores/${o}/files/${e}`,{...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,n,r){const o=await this.create(e,n,r);return await this.poll(e,o.id,r)}async poll(e,n,r){const o=ie([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){const s=await this.retrieve(n,{vector_store_id:e},{...r,headers:o}).withResponse(),i=s.data;switch(i.status){case"in_progress":let a=5e3;if(r?.pollIntervalMs)a=r.pollIntervalMs;else{const l=s.response.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(a=c)}}await ko(a);break;case"failed":case"completed":return i}}}async upload(e,n,r){const o=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:o.id},r)}async uploadAndPoll(e,n,r){const o=await this.upload(e,n,r);return await this.poll(e,o.id,r)}content(e,n,r){const{vector_store_id:o}=n;return this._client.getAPIList(X`/vector_stores/${o}/files/${e}/content`,za,{...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}class Wa extends ce{constructor(){super(...arguments),this.files=new Sw(this._client),this.fileBatches=new ww(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(X`/vector_stores/${e}`,{...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,r){return this._client.post(X`/vector_stores/${e}`,{body:n,...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",Qe,{query:e,...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,n){return this._client.delete(X`/vector_stores/${e}`,{...n,headers:ie([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}search(e,n,r){return this._client.getAPIList(X`/vector_stores/${e}/search`,za,{body:n,method:"post",...r,headers:ie([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}Wa.Files=Sw;Wa.FileBatches=ww;class Ew extends ce{create(e,n){return this._client.post("/videos",vg({body:e,...n},this._client))}retrieve(e,n){return this._client.get(X`/videos/${e}`,n)}list(e={},n){return this._client.getAPIList("/videos",ta,{query:e,...n})}delete(e,n){return this._client.delete(X`/videos/${e}`,n)}downloadContent(e,n={},r){return this._client.get(X`/videos/${e}/content`,{query:n,...r,headers:ie([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0})}remix(e,n,r){return this._client.post(X`/videos/${e}/remix`,vg({body:n,...r},this._client))}}var hr,Tw,Pi;class bw extends ce{constructor(){super(...arguments),hr.add(this)}async unwrap(e,n,r=this._client.webhookSecret,o=300){return await this.verifySignature(e,n,r,o),JSON.parse(e)}async verifySignature(e,n,r=this._client.webhookSecret,o=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");H(this,hr,"m",Tw).call(this,r);const s=ie([n]).values,i=H(this,hr,"m",Pi).call(this,s,"webhook-signature"),a=H(this,hr,"m",Pi).call(this,s,"webhook-timestamp"),l=H(this,hr,"m",Pi).call(this,s,"webhook-id"),c=parseInt(a,10);if(isNaN(c))throw new Xr("Invalid webhook timestamp format");const u=Math.floor(Date.now()/1e3);if(u-c>o)throw new Xr("Webhook timestamp is too old");if(c>u+o)throw new Xr("Webhook timestamp is too new");const h=i.split(" ").map(E=>E.startsWith("v1,")?E.substring(3):E),p=r.startsWith("whsec_")?Buffer.from(r.replace("whsec_",""),"base64"):Buffer.from(r,"utf-8"),m=l?`${l}.${a}.${e}`:`${a}.${e}`,w=await crypto.subtle.importKey("raw",p,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const E of h)try{const _=Buffer.from(E,"base64");if(await crypto.subtle.verify("HMAC",w,_,new TextEncoder().encode(m)))return}catch{continue}throw new Xr("The given webhook signature does not match the expected signature")}}hr=new WeakSet,Tw=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},Pi=function(e,n){if(!e)throw new Error("Headers are required");const r=e.get(n);if(r==null)throw new Error(`Missing required header: ${n}`);return r};var qc,ld,Ni,Cw;class me{constructor({baseURL:e=lr("OPENAI_BASE_URL"),apiKey:n=lr("OPENAI_API_KEY"),organization:r=lr("OPENAI_ORG_ID")??null,project:o=lr("OPENAI_PROJECT_ID")??null,webhookSecret:s=lr("OPENAI_WEBHOOK_SECRET")??null,...i}={}){if(qc.add(this),Ni.set(this,void 0),this.completions=new ew(this),this.chat=new Zu(this),this.embeddings=new rw(this),this.files=new sw(this),this.images=new dw(this),this.audio=new Ro(this),this.moderations=new hw(this),this.models=new fw(this),this.fineTuning=new xr(this),this.graders=new sd(this),this.vectorStores=new Wa(this),this.webhooks=new bw(this),this.beta=new Mr(this),this.batches=new J0(this),this.uploads=new ad(this),this.responses=new Ka(this),this.realtime=new Ja(this),this.conversations=new ju(this),this.evals=new td(this),this.containers=new Qu(this),this.videos=new Ew(this),n===void 0)throw new ue("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const a={apiKey:n,organization:r,project:o,webhookSecret:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&hL())throw new ue(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=a.baseURL,this.timeout=a.timeout??ld.DEFAULT_TIMEOUT,this.logger=a.logger??console;const l="warn";this.logLevel=l,this.logLevel=_g(a.logLevel,"ClientOptions.logLevel",this)??_g(lr("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??l,this.fetchOptions=a.fetchOptions,this.maxRetries=a.maxRetries??2,this.fetch=a.fetch??yL(),fe(this,Ni,wL),this._options=a,this.apiKey=typeof n=="string"?n:"Missing Key",this.organization=r,this.project=o,this.webhookSecret=s}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}async authHeaders(e){return ie([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return kL(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${dr}`}defaultIdempotencyKey(){return`stainless-node-retry-${Wv()}`}makeStatusError(e,n,r,o){return dt.generate(e,n,r,o)}async _callApiKey(){const e=this._options.apiKey;if(typeof e!="function")return!1;let n;try{n=await e()}catch(r){throw r instanceof ue?r:new ue(`Failed to get token from 'apiKey' function: ${r.message}`,{cause:r})}if(typeof n!="string"||!n)throw new ue(`Expected 'apiKey' function argument to return a string but it returned ${n}`);return this.apiKey=n,!0}buildURL(e,n,r){const o=!H(this,qc,"m",Cw).call(this)&&r||this.baseURL,s=lL(e)?new URL(e):new URL(o+(o.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return cL(i)||(n={...i,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(s.search=this.stringifyQuery(n)),s.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(o=>({method:e,path:n,...o})))}request(e,n=null){return new Va(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){const o=await e,s=o.maxRetries??this.maxRetries;n==null&&(n=s),await this.prepareOptions(o);const{req:i,url:a,timeout:l}=await this.buildRequest(o,{retryCount:s-n});await this.prepareRequest(i,{url:a,options:o});const c="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),u=r===void 0?"":`, retryOf: ${r}`,h=Date.now();if(it(this).debug(`[${c}] sending request`,Bn({retryOfRequestLogID:r,method:o.method,url:a,options:o,headers:i.headers})),o.signal?.aborted)throw new Nt;const p=new AbortController,m=await this.fetchWithTimeout(a,i,l,p).catch(Ic),w=Date.now();if(m instanceof globalThis.Error){const v=`retrying, ${n} attempts remaining`;if(o.signal?.aborted)throw new Nt;const g=kc(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(n)return it(this).info(`[${c}] connection ${g?"timed out":"failed"} - ${v}`),it(this).debug(`[${c}] connection ${g?"timed out":"failed"} (${v})`,Bn({retryOfRequestLogID:r,url:a,durationMs:w-h,message:m.message})),this.retryRequest(o,n,r??c);throw it(this).info(`[${c}] connection ${g?"timed out":"failed"} - error; no more retries left`),it(this).debug(`[${c}] connection ${g?"timed out":"failed"} (error; no more retries left)`,Bn({retryOfRequestLogID:r,url:a,durationMs:w-h,message:m.message})),g?new Fu:new qa({cause:m})}const E=[...m.headers.entries()].filter(([v])=>v==="x-request-id").map(([v,g])=>", "+v+": "+JSON.stringify(g)).join(""),_=`[${c}${u}${E}] ${i.method} ${a} ${m.ok?"succeeded":"failed"} with status ${m.status} in ${w-h}ms`;if(!m.ok){const v=await this.shouldRetry(m);if(n&&v){const k=`retrying, ${n} attempts remaining`;return await vL(m.body),it(this).info(`${_} - ${k}`),it(this).debug(`[${c}] response error (${k})`,Bn({retryOfRequestLogID:r,url:m.url,status:m.status,headers:m.headers,durationMs:w-h})),this.retryRequest(o,n,r??c,m.headers)}const g=v?"error; no more retries left":"error; not retryable";it(this).info(`${_} - ${g}`);const S=await m.text().catch(k=>Ic(k).message),b=fL(S),y=b?void 0:S;throw it(this).debug(`[${c}] response error (${g})`,Bn({retryOfRequestLogID:r,url:m.url,status:m.status,headers:m.headers,message:y,durationMs:Date.now()-h})),this.makeStatusError(m.status,b,y,m.headers)}return it(this).info(_),it(this).debug(`[${c}] response start`,Bn({retryOfRequestLogID:r,url:m.url,status:m.status,headers:m.headers,durationMs:w-h})),{response:m,options:o,controller:p,requestLogID:c,retryOfRequestLogID:r,startTime:h}}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}requestAPIList(e,n){const r=this.makeRequest(n,null,void 0);return new DL(this,r,e)}async fetchWithTimeout(e,n,r,o){const{signal:s,method:i,...a}=n||{};s&&s.addEventListener("abort",()=>o.abort());const l=setTimeout(()=>o.abort(),r),c=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||typeof a.body=="object"&&a.body!==null&&Symbol.asyncIterator in a.body,u={signal:o.signal,...c?{duplex:"half"}:{},method:"GET",...a};i&&(u.method=i.toUpperCase());try{return await this.fetch.call(void 0,e,u)}finally{clearTimeout(l)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,o){let s;const i=o?.get("retry-after-ms");if(i){const l=parseFloat(i);Number.isNaN(l)||(s=l)}const a=o?.get("retry-after");if(a&&!s){const l=parseFloat(a);Number.isNaN(l)?s=Date.parse(a)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){const l=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,l)}return await ko(s),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const s=n-e,i=Math.min(.5*Math.pow(2,s),8),a=1-Math.random()*.25;return i*a*1e3}async buildRequest(e,{retryCount:n=0}={}){const r={...e},{method:o,path:s,query:i,defaultBaseURL:a}=r,l=this.buildURL(s,i,a);"timeout"in r&&dL("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const{bodyHeaders:c,body:u}=this.buildBody({options:r}),h=await this.buildHeaders({options:e,method:o,bodyHeaders:c,retryCount:n});return{req:{method:o,headers:h,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&u instanceof globalThis.ReadableStream&&{duplex:"half"},...u&&{body:u},...this.fetchOptions??{},...r.fetchOptions??{}},url:l,timeout:r.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:o}){let s={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);const i=ie([s,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},..._L(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=ie([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:a0(e)}:H(this,Ni,"f").call(this,{body:e,headers:r})}}ld=me,Ni=new WeakMap,qc=new WeakSet,Cw=function(){return this.baseURL!=="https://api.openai.com/v1"};me.OpenAI=ld;me.DEFAULT_TIMEOUT=6e5;me.OpenAIError=ue;me.APIError=dt;me.APIConnectionError=qa;me.APIConnectionTimeoutError=Fu;me.APIUserAbortError=Nt;me.NotFoundError=Qv;me.ConflictError=jv;me.RateLimitError=t0;me.BadRequestError=Zv;me.AuthenticationError=Yv;me.InternalServerError=n0;me.PermissionDeniedError=Xv;me.UnprocessableEntityError=e0;me.InvalidWebhookSignatureError=Xr;me.toFile=FL;me.Completions=ew;me.Chat=Zu;me.Embeddings=rw;me.Files=sw;me.Images=dw;me.Audio=Ro;me.Moderations=hw;me.Models=fw;me.FineTuning=xr;me.Graders=sd;me.VectorStores=Wa;me.Webhooks=bw;me.Beta=Mr;me.Batches=J0;me.Uploads=ad;me.Responses=Ka;me.Realtime=Ja;me.Conversations=ju;me.Evals=td;me.Containers=Qu;me.Videos=Ew;function hq(t,e){if(!t)return{temperature:e.temperature,reasoningEffort:e.reasoningEffort,excludeReasoning:e.excludeReasoning};const n=t.temperature??e.temperature;let r=e.reasoningEffort,o=e.excludeReasoning;return t.thinking!==void 0&&(ji(e.baseUrl)?(r=qv(t.thinking),o=r==="none"):r=Vv(t.thinking,e.model)),t.showThoughts!==void 0&&ji(e.baseUrl)&&(o=!t.showThoughts),{temperature:n,reasoningEffort:r,excludeReasoning:o}}function pq(t,e){const n=t.reasoning_details;if(n)for(const r of n){const o=r.index??0,s=`${r.type}-${o}`,i=e.get(s);if(i){r.text&&(i.text=(i.text??"")+r.text);for(const a of Object.keys(r)){if(a==="text"||a==="index")continue;const l=i[a],c=r[a];(l===void 0||l===""&&c)&&(i[a]=c)}}else e.set(s,{...r})}}const Ul="MCP client not initialized. Call initialize() first.";class mq{ai;mcpUrl;config;mcpClient;chatHistory;constructor(e,n){const r=n.baseUrl&&n.baseUrl!=="https://api.openai.com/v1";this.ai=new me({apiKey:e,baseURL:n.baseUrl??"https://api.openai.com/v1",dangerouslyAllowBrowser:!0,...r&&{defaultHeaders:{"X-Stainless-Lang":null,"X-Stainless-Package-Version":null,"X-Stainless-OS":null,"X-Stainless-Arch":null,"X-Stainless-Runtime":null,"X-Stainless-Runtime-Version":null,"X-Stainless-Retry-Count":null,"X-Stainless-Timeout":null}}}),this.mcpUrl=n.mcpUrl??La(),this.config=n,this.mcpClient=null,this.chatHistory=n.chatHistory??[],n.systemInstruction&&this.chatHistory.length===0&&!this.chatHistory.find(o=>o.role==="system")&&this.chatHistory.push({role:"system",content:n.systemInstruction})}async initialize(){this.mcpClient=await Uu(this.mcpUrl)}async*sendMessage(e,n,r){if(!this.mcpClient)throw new Error(Ul);const o={role:"user",content:e};this.chatHistory.push(o),yield this.chatHistory;const s=await this.getFilteredTools(),i=hq(r,this.config);let a=!0;const l=10;let c=0;for(;a&&c<l;){c++,yield*this.processStreamAndUpdateHistory(s,i);const u=this.getToolCallsFromLastMessage();u?(yield*this.executeToolCalls(u),n?.aborted&&(a=!1)):a=!1}c>=l&&console.warn("OpenAI tool calling loop reached max iterations:",l)}async getFilteredTools(){const e=await this.mcpClient?.listTools();if(!e)throw new Error(Ul);return Dv(e.tools,this.config.enabledTools).map(r=>({type:"function",function:{name:r.name,description:r.description,parameters:r.inputSchema}}))}async*processStreamAndUpdateHistory(e,n){const r=await this.ai.chat.completions.create({model:this.config.model,messages:this.chatHistory,tools:e.length>0?e:void 0,temperature:n.temperature,...n.reasoningEffort?ji(this.config.baseUrl)?{reasoning:{effort:n.reasoningEffort,...(n.reasoningEffort==="none"||n.excludeReasoning)&&{exclude:!0}}}:{reasoning_effort:n.reasoningEffort}:{},stream:!0}),o={role:"assistant",content:""},s=new Map,i=new Map;let a=!1;for await(const l of r){const c=l.choices[0];if(!c)continue;const u=c.delta;this.processContentDelta(u,o),pq(u,i),this.processToolCallDeltas(u,s),a||=c.finish_reason==="tool_calls";const h=this.buildStreamMessage(o,s,i,a?"tool_calls":c.finish_reason);this.updateChatHistoryWithMessage(h),yield this.chatHistory}}processContentDelta(e,n){e.content&&(n.content+=e.content)}processToolCallDeltas(e,n){if(e.tool_calls)for(const r of e.tool_calls)this.accumulateToolCall(r,n)}accumulateToolCall(e,n){n.has(e.index)||n.set(e.index,{id:e.id??"",type:"function",function:{name:"",arguments:""}});const r=n.get(e.index);r?.type==="function"&&(e.id&&(r.id=e.id),e.function?.name&&(r.function.name=e.function.name),e.function?.arguments&&(r.function.arguments+=e.function.arguments))}buildStreamMessage(e,n,r,o){const s={...e,tool_calls:o==="tool_calls"&&n.size>0?Array.from(n.values()):void 0};return r.size>0&&(s.reasoning_details=Array.from(r.values()).sort((i,a)=>(i.index??0)-(a.index??0))),s}updateChatHistoryWithMessage(e){this.chatHistory.at(-1)?.role==="assistant"?this.chatHistory[this.chatHistory.length-1]=e:this.chatHistory.push(e)}getToolCallsFromLastMessage(){const e=this.chatHistory.at(-1);return e?.role==="assistant"&&e.tool_calls?e.tool_calls:null}async*executeToolCalls(e){for(const n of e)if(n.type==="function")try{const r=await this.executeSingleToolCall(n),o={role:"tool",tool_call_id:n.id,content:JSON.stringify(r)};this.chatHistory.push(o),yield this.chatHistory}catch(r){this.addErrorToolMessage(n,r),yield this.chatHistory}}async executeSingleToolCall(e){if(e.type!=="function")throw new Error("Invalid tool call type");const n=JSON.parse(e.function.arguments||"{}"),r=await this.mcpClient?.callTool({name:e.function.name,arguments:n});if(!r)throw new Error(Ul);return r.content}addErrorToolMessage(e,n){const r={role:"tool",tool_call_id:e.id,content:JSON.stringify({error:n instanceof Error?n.message:String(n),isError:!0})};this.chatHistory.push(r)}}const gq={createClient(t,e){return new mq(t,e)},buildConfig(t,e,n,r,o,s){const i=s?.baseUrl,a=!!s?.showThoughts;return $U(t,e,n,i,a,r,o)},formatMessages:Hv,createErrorMessage(t,e){return tL(e,t)},extractUserMessage(t){return t.role==="user"&&typeof t.content=="string"?t.content.trim():void 0},createUserMessage(t){return{role:"user",content:t}}},Ll="MCP client not initialized. Call initialize() first.";class _q{ai;mcpUrl;config;mcpClient;conversation;lastResponseHadToolCalls=!1;get chatHistory(){return this.conversation}constructor(e,n){this.ai=new me({apiKey:e,dangerouslyAllowBrowser:!0}),this.mcpUrl=n.mcpUrl??La(),this.config=n,this.mcpClient=null,this.conversation=n.conversation??[]}async initialize(){this.mcpClient=await Uu(this.mcpUrl)}async*sendMessage(e,n,r){if(!this.mcpClient)throw new Error(Ll);this.conversation.push({type:"message",role:"user",content:e}),yield this.conversation;const o=await this.getFilteredTools(),s=this.calculateEffectiveSettings(r);let i=!0;const a=10;let l=0;for(;i&&l<a;)l++,yield*this.processStreamAndUpdateConversation(o,s,n),i=this.lastResponseHadToolCalls&&!n?.aborted;l>=a&&console.warn("Responses API tool calling loop reached max iterations:",a)}calculateEffectiveSettings(e){return{temperature:e?.temperature??this.config.temperature,reasoningEffort:e?.reasoningEffort??this.config.reasoningEffort}}async getFilteredTools(){const e=await this.mcpClient?.listTools();if(!e)throw new Error(Ll);return Dv(e.tools,this.config.enabledTools).map(r=>({type:"function",name:r.name,description:r.description??"",parameters:r.inputSchema}))}buildRequestBody(e,n){const r={model:this.config.model,input:this.conversation,tools:e};return n.reasoningEffort&&(r.reasoning={effort:n.reasoningEffort,summary:this.config.reasoningSummary??"auto"}),n.temperature!=null&&(r.temperature=n.temperature),this.config.systemInstruction&&(r.instructions=this.config.systemInstruction),r}async*processStreamAndUpdateConversation(e,n,r){const o=this.buildRequestBody(e,n),s=await this.ai.responses.create({...o,stream:!0}),i=LU(),a={callTool:async l=>{const c=await this.mcpClient?.callTool(l);if(!c)throw new Error(Ll);return{content:c.content}}};for await(const l of s){if(r?.aborted)break;await BU(l,i,a,this.conversation),yield this.conversation}this.lastResponseHadToolCalls=i.hasToolCalls}}const yq={createClient(t,e){return new _q(t,e)},buildConfig(t,e,n,r,o,s){return PU(t,e,n,r,o)},formatMessages:Kv,createErrorMessage(t,e){return rL(e,t)},extractUserMessage(t){if(t.type!=="message"||t.role!=="user")return;const e=t.content;return typeof e=="string"?e.trim():e.map(n=>n.text).filter(Boolean).join("").trim()},createUserMessage(t){return{type:"message",role:"user",content:t}}},vq=[2e3,4e3,8e3,16e3,32e3],kw=5,wq=[/resource.*exhausted/i,/rate.*limit/i,/quota.*exceeded/i,/exceeded.*quota/i,/too.*many.*requests/i,/429/];function Sq(t){const e=Iw(t),r=Tq(t)===429||wq.some(o=>o.test(e));return{isRateLimited:r,retryAfterMs:r?bq(t):null,message:r?Cq(e):e}}function Eq(t,e=null){if(e!=null&&e>0)return Math.min(e,6e4);const n=vq[t]??32e3,r=Math.random()*1e3;return n+r}function Dg(t){return t<kw}function Iw(t){if(t instanceof Error)return t.message;if(typeof t=="object"&&t!=null){const e=t;if(typeof e.error=="object"&&e.error!=null){const n=e.error;if(typeof n.message=="string")return n.message}if(typeof e.message=="string")return e.message}return String(t)}function Tq(t){if(typeof t!="object"||t==null)return null;const e=t;if(typeof e.status=="number")return e.status;if(typeof e.error=="object"&&e.error!=null){const o=e.error;if(typeof o.code=="number")return o.code}const n=Iw(t),r=/\b(429|503)\b/.exec(n);return r?.[1]?Number.parseInt(r[1]):null}function bq(t){if(typeof t!="object"||t==null)return null;const e=t,n=e.retryAfter??e.headers?.["retry-after"];if(typeof n=="number")return n<1e3?n*1e3:n;if(typeof n=="string"){const r=Number.parseInt(n);if(!Number.isNaN(r))return r*1e3}return null}function Cq(t){return/quota/i.test(t)?"API quota exceeded. The request will be retried automatically.":/rate.*limit/i.test(t)?"Rate limit reached. The request will be retried automatically.":"Too many requests. The request will be retried automatically."}function ql({provider:t,apiKey:e,model:n,thinking:r,temperature:o,enabledTools:s,mcpStatus:i,mcpError:a,checkMcpConnection:l,adapter:c,extraParams:u}){const[h,p]=Ae([]),[m,w]=Ae(!1),[E,_]=Ae(null),[v,g]=Ae(null),[S,b]=Ae(null),[y,C]=Ae(null),[k,P]=Ae(null),M=En(null),q=En(null),D=En(null),G=Et(()=>{p([]),M.current=null,_(null),g(null),b(null),C(null),P(null),D.current?.abort()},[]),B=Et(()=>{q.current?.abort(),D.current?.abort(),w(!1),P(null)},[]),K=Et(async(ee,ge)=>{await nL(i,a,l);const V=ge?.thinking??r,$=ge?.temperature??o,O=c.buildConfig(n,$,V,s,ee,u);M.current=c.createClient(e,O),await M.current.initialize(),_(n),g(t),b(V),C($)},[i,a,l,n,t,o,r,s,e,c,u]),oe=Et(async(ee,ge,V)=>{let $=0;const O={hasReceived:!1};D.current=new AbortController;const A=T=>{O.hasReceived=!0,p(T)};for(;Dg($);)try{const T=O.hasReceived?"continue":V,I=ee(T);await jU(I,c.formatMessages,A),P(null);return}catch(T){if(D.current.signal.aborted)return;const I=Sq(T);if(!I.isRateLimited||!Dg($+1)){p(c.createErrorMessage(T,ge())),P(null);return}const x=Eq($,I.retryAfterMs);P({isRetrying:!0,attempt:$,maxAttempts:kw,delayMs:x}),await new Promise((W,Z)=>{const se=setTimeout(W,x);D.current?.signal.addEventListener("abort",()=>{clearTimeout(se),Z(new Error("Retry cancelled"))})}),$++}},[c]),Se=Et(async(ee,ge)=>{const V=ee.trim();if(V){if(!e){const $=c.createUserMessage(V);p(c.createErrorMessage(new Error("No API key configured. Please add your API key in Settings."),[$]));return}w(!0);try{M.current||await K(void 0,ge);const $=M.current;if(!$)throw new Error("Failed to initialize chat client");const O=new AbortController;q.current=O,await oe(A=>$.sendMessage(A,O.signal,ge),()=>$.chatHistory,V)}catch($){p(c.createErrorMessage($,M.current?.chatHistory??[]))}finally{q.current=null,w(!1),P(null)}}},[e,K,c,oe]),be=Et(async ee=>{if(!e)return;const ge=h[ee];if(ge?.role!=="user"||!M.current)return;const V=ge.rawHistoryIndex,$=M.current.chatHistory[V];if(!$)return;const O=c.extractUserMessage($);if(O){w(!0);try{const A=M.current.chatHistory.slice(0,V);await K(A);const T=M.current,I=new AbortController;q.current=I,await oe(x=>T.sendMessage(x,I.signal),()=>T.chatHistory,O)}catch(A){p(c.createErrorMessage(A,M.current.chatHistory))}finally{q.current=null,w(!1),P(null)}}},[e,h,K,c,oe]);return{messages:h,isAssistantResponding:m,activeModel:E,activeProvider:v,activeThinking:S,activeTemperature:y,rateLimitState:k,handleSend:Se,handleRetry:be,clearConversation:G,stopResponse:B}}function kq(){const[t,e]=Ae("connecting"),[n,r]=Ae(null),o=Et(async()=>{e("connecting"),r(null);try{const s=new xv(new URL(La())),i=new Av({name:"producer-pal-chat-ui-test",version:"1.0.0"});await i.connect(s),await i.close(),e("connected")}catch(s){e("error"),r(s instanceof Error?s.message:"Unknown error")}},[]);return fn(()=>{o()},[o]),{mcpStatus:t,mcpError:n,checkMcpConnection:o}}const Rw=[{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"},{value:"gemini-3-pro-preview",label:"Gemini 3 Pro"},{value:"gemini-3-flash-preview",label:"Gemini 3 Flash"},{value:"gemini-2.5-pro",label:"Gemini 2.5 Pro"},{value:"gemini-2.5-flash-lite",label:"Gemini 2.5 Flash-Lite"},{value:"OTHER",label:"Other..."}],$w=[{value:"gpt-5.2-2025-12-11",label:"GPT-5.2"},{value:"gpt-5.2-codex",label:"GPT-5.2 Codex"},{value:"gpt-5-2025-08-07",label:"GPT-5"},{value:"gpt-5-mini-2025-08-07",label:"GPT-5 Mini"},{value:"gpt-4o-2024-08-06",label:"GPT-4o"},{value:"OTHER",label:"Other..."}],Aw=[{value:"devstral-latest",label:"Devstral"},{value:"mistral-large-latest",label:"Mistral Large"},{value:"mistral-medium-latest",label:"Mistral Medium"},{value:"mistral-small-latest",label:"Mistral Small"},{value:"magistral-medium-2509",label:"Magistral Medium"},{value:"magistral-small-2509",label:"Magistral Small"},{value:"OTHER",label:"Other..."}],Pw=[{value:"z-ai/glm-4.5-air:free",label:"[Free] Z.AI GLM 4.5 Air"},{value:"qwen/qwen3-coder:free",label:"[Free] Qwen3 Coder 480B"},{value:"mistralai/devstral-2512:free",label:"[Free] Mistral Devstral 2"},{value:"nvidia/nemotron-3-nano-30b-a3b:free",label:"[Free] Nvidia Nemotron 3 Nano"},{value:"google/gemini-3-flash-preview",label:"[Paid] Google Gemini 3 Flash"},{value:"google/gemini-3-pro-preview",label:"[Paid] Google Gemini 3 Pro"},{value:"anthropic/claude-sonnet-4.5",label:"[Paid] Anthropic Claude Sonnet 4.5"},{value:"anthropic/claude-opus-4.5",label:"[Paid] Anthropic Claude Opus 4.5"},{value:"openai/gpt-5.2",label:"[Paid] OpenAI GPT-5.2"},{value:"openai/gpt-5.2-codex",label:"[Paid] OpenAI GPT-5.2 Codex"},{value:"x-ai/grok-4.1-fast",label:"[Paid] xAI Grok 4.1 Fast"},{value:"mistralai/mistral-large-2512",label:"[Paid] Mistral Large"},{value:"qwen/qwen3-max",label:"[Paid] Qwen3 Max"},{value:"minimax/minimax-m2.1",label:"[Paid] MiniMax M2.1"},{value:"OTHER",label:"Other..."}],Nw=[{value:"devstral-small-2",label:"Devstral Small 2"},{value:"ministral-3",label:"Ministral 3"},{value:"mistral",label:"Mistral"},{value:"gpt-oss",label:"GPT-OSS"},{value:"qwen3",label:"Qwen3"},{value:"qwen3-coder",label:"Qwen3 Coder"},{value:"OTHER",label:"Other..."}],Fn={gemini:Rw[0]?.value??"",openai:$w[0]?.value??"",mistral:Aw[0]?.value??"",openrouter:Pw[0]?.value??"",ollama:Nw[0]?.value??"",lmstudio:"",custom:""},$o=[{id:"ppal-connect",name:"Connect to Ableton Live"},{id:"ppal-memory",name:"Project Notes"},{id:"ppal-read-live-set",name:"Read Live Set"},{id:"ppal-update-live-set",name:"Update Live Set"},{id:"ppal-create-track",name:"Create Track"},{id:"ppal-read-track",name:"Read Track"},{id:"ppal-update-track",name:"Update Track"},{id:"ppal-create-scene",name:"Create Scene"},{id:"ppal-read-scene",name:"Read Scene"},{id:"ppal-update-scene",name:"Update Scene"},{id:"ppal-create-clip",name:"Create Clip"},{id:"ppal-read-clip",name:"Read Clip"},{id:"ppal-update-clip",name:"Update Clip"},{id:"ppal-create-device",name:"Create Device"},{id:"ppal-read-device",name:"Read Device"},{id:"ppal-update-device",name:"Update Device"},{id:"ppal-playback",name:"Control Playback"},{id:"ppal-select",name:"Select/View Control"},{id:"ppal-delete",name:"Delete Objects"},{id:"ppal-duplicate",name:"Duplicate Objects"},{id:"ppal-transform-clips",name:"Transform Clips"},{id:"ppal-read-samples",name:"Read Samples"},{id:"ppal-raw-live-api",name:"Raw Live API",requiresEnvVar:!0}],Fl=$o.reduce((t,e)=>(t[e.id]=!0,t),{}),Ht={gemini:{apiKey:"",model:Fn.gemini,thinking:"Default",temperature:1,showThoughts:!0},openai:{apiKey:"",model:Fn.openai,thinking:"Default",temperature:1,showThoughts:!0},mistral:{apiKey:"",model:Fn.mistral,thinking:"Default",temperature:1,showThoughts:!0},openrouter:{apiKey:"",model:Fn.openrouter,thinking:"Default",temperature:1,showThoughts:!0},lmstudio:{apiKey:"",model:Fn.lmstudio,port:1234,thinking:"Default",temperature:1,showThoughts:!0},ollama:{apiKey:"",model:Fn.ollama,port:11434,thinking:"Default",temperature:1,showThoughts:!0},custom:{apiKey:"",model:Fn.custom,baseUrl:"",thinking:"Default",temperature:1,showThoughts:!0}};function Vn(t){const e=`producer_pal_provider_${t}`,n=localStorage.getItem(e);if(n)try{const r=JSON.parse(n);return{...Ht[t],...r}}catch{}if(t==="gemini"){const r={},o=localStorage.getItem("gemini_api_key");o&&(r.apiKey=o);const s=localStorage.getItem("gemini_model")??localStorage.getItem("model");s&&(r.model=s);const i=localStorage.getItem("thinking")??localStorage.getItem("gemini_thinking");i&&(r.thinking=i);const a=localStorage.getItem("temperature")??localStorage.getItem("gemini_temperature");a!=null&&(r.temperature=Number.parseFloat(a));const l=localStorage.getItem("showThoughts")??localStorage.getItem("gemini_showThoughts");return l!=null&&(r.showThoughts=l==="true"),{...Ht.gemini,...r}}return Ht[t]}function zn(t,e){const n=`producer_pal_provider_${t}`;localStorage.setItem(n,JSON.stringify(e))}function Iq(t){if(t==="lmstudio"||t==="ollama")return!!localStorage.getItem(`producer_pal_provider_${t}`);const e=localStorage.getItem(`producer_pal_provider_${t}`);if(e)try{return!!JSON.parse(e).apiKey}catch{return!1}return t==="gemini"?!!localStorage.getItem("gemini_api_key"):!1}function Og(){return{gemini:Vn("gemini"),openai:Vn("openai"),mistral:Vn("mistral"),openrouter:Vn("openrouter"),lmstudio:Vn("lmstudio"),ollama:Vn("ollama"),custom:Vn("custom")}}function Rq(t){zn("gemini",t.gemini),zn("openai",t.openai),zn("mistral",t.mistral),zn("openrouter",t.openrouter),zn("lmstudio",t.lmstudio),zn("ollama",t.ollama),zn("custom",t.custom)}function Ug(){return localStorage.getItem("producer_pal_current_provider")??localStorage.getItem("provider")??"gemini"}function Lg(){const t=localStorage.getItem("producer_pal_enabled_tools");if(t)try{return{...Fl,...JSON.parse(t)}}catch{return Fl}return Fl}function $q(){return $o.reduce((t,e)=>(t[e.id]=!0,t),{})}function Aq(){return $o.reduce((t,e)=>(t[e.id]=!1,t),{})}function Pq(t,e,n){localStorage.setItem("producer_pal_current_provider",t),localStorage.setItem("producer_pal_settings_configured","true"),localStorage.setItem("producer_pal_enabled_tools",JSON.stringify(e)),Rq(n)}function Nq(t,e,n,r,o,s,i){return{gemini:t,openai:e,mistral:n,openrouter:r,lmstudio:o,ollama:s,custom:i}}function Mq(t,e,n){return r=>{e[t](o=>({...o,[n]:r}))}}function xq(){const[t,e]=Ae(Ug),[n,r]=Ae(()=>localStorage.getItem("producer_pal_settings_configured")==="true"),[o,s]=Ae(Lg),[i,a]=Ae(Ht.gemini),[l,c]=Ae(Ht.openai),[u,h]=Ae(Ht.mistral),[p,m]=Ae(Ht.openrouter),[w,E]=Ae(Ht.lmstudio),[_,v]=Ae(Ht.ollama),[g,S]=Ae(Ht.custom),b=vr(()=>({gemini:a,openai:c,mistral:h,openrouter:m,lmstudio:E,ollama:v,custom:S}),[]),y={gemini:i,openai:l,mistral:u,openrouter:p,lmstudio:w,ollama:_,custom:g}[t],C=Et(A=>{a(A.gemini),c(A.openai),h(A.mistral),m(A.openrouter),E(A.lmstudio),v(A.ollama),S(A.custom)},[]);fn(()=>{C(Og())},[C]);const k=Et(()=>{const A=Nq(i,l,u,p,w,_,g);Pq(t,o,A),r(!0)},[t,o,i,l,u,p,w,_,g]),P=Et(()=>{e(Ug()),s(Lg()),C(Og())},[C]),M=vr(()=>{const A=T=>I=>Mq(t,b,T)(I);return{setApiKey:A("apiKey"),setModel:A("model"),setBaseUrl:t==="custom"?A("baseUrl"):T=>{},setPort:t==="lmstudio"||t==="ollama"?A("port"):T=>{},setThinking:A("thinking"),setTemperature:A("temperature"),setShowThoughts:A("showThoughts")}},[t,b]),{setApiKey:q,setModel:D,setBaseUrl:G,setPort:B,setThinking:K,setTemperature:oe,setShowThoughts:Se}=M,be=Et(A=>{e(A)},[]),ee=Iq(t),ge=vr(()=>({enableAll:()=>s($q()),disableAll:()=>s(Aq()),isEnabled:A=>o[A]??!0}),[o]),V=Et(()=>{oe(1),K(Ht[t].thinking),Se(!0)},[t,oe,K,Se]),$=t==="custom",O=t==="lmstudio"||t==="ollama";return{provider:t,setProvider:be,apiKey:y.apiKey,setApiKey:q,baseUrl:$?y.baseUrl:void 0,setBaseUrl:$?G:void 0,port:O?y.port:void 0,setPort:O?B:void 0,model:y.model,setModel:D,thinking:y.thinking,setThinking:K,temperature:y.temperature,setTemperature:oe,showThoughts:y.showThoughts,setShowThoughts:Se,saveSettings:k,cancelSettings:P,hasApiKey:ee,settingsConfigured:n,enabledTools:o,setEnabledTools:s,enableAllTools:ge.enableAll,disableAllTools:ge.disableAll,resetBehaviorToDefaults:V,isToolEnabled:ge.isEnabled}}function Dq(){const[t,e]=Ae("system");return fn(()=>{const n=localStorage.getItem("theme");n&&e(n)},[]),fn(()=>{const n=document.documentElement,r=window.matchMedia("(prefers-color-scheme: dark)"),o=()=>{t==="system"?n.classList.toggle("dark",r.matches):n.classList.toggle("dark",t==="dark")};if(o(),localStorage.setItem("theme",t),t==="system")return r.addEventListener("change",o),()=>r.removeEventListener("change",o)},[t]),{theme:t,setTheme:e}}function Oq({mcpStatus:t,mcpError:e,checkMcpConnection:n,handleSend:r,overrides:o}){return U("div",{className:"h-full items-center justify-center flex flex-col gap-8",children:[t==="connected"&&U(en,{children:[U("p",{className:"text-gray-500 dark:text-gray-400",children:"Start a conversation with Producer Pal"}),U("button",{onClick:()=>{r("Connect to Ableton.",o)},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Quick Connect"})]}),t==="error"&&U(en,{children:[U("h1",{className:"font-bold text-red-600 dark:text-red-400",children:"Producer Pal Not Found"}),U("p",{className:"text-sm text-red-600 dark:text-red-400",children:e}),U("button",{onClick:()=>{n()},className:"mt-2 px-2 py-0.5 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600",children:"Retry"})]})]})}const Uq="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20width='100%25'%20height='100%25'%20viewBox='0%200%20500%20500'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20xml:space='preserve'%20xmlns:serif='http://www.serif.com/'%20style='fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;'%3e%3cg%20transform='matrix(0.842627,0,0,1.32775,4.47817,59.9172)'%3e%3crect%20x='66.686'%20y='60.333'%20width='176.012'%20height='90.541'%20style='fill:white;stroke:white;stroke-width:0.9px;'/%3e%3c/g%3e%3cg%20transform='matrix(0.842627,0,0,1.32775,225.603,55.9177)'%3e%3crect%20x='66.686'%20y='60.333'%20width='176.012'%20height='90.541'%20style='fill:white;stroke:white;stroke-width:0.9px;'/%3e%3c/g%3e%3cg%20transform='matrix(1.54355,0,0,1.54355,-236.357,-173.377)'%3e%3cpath%20d='M306.222,384C306.222,384%20305.449,351.224%20304.431,311.737C302.9,252.333%20291.904,177.855%20334.136,177.844C361.374,177.836%20373.019,177.844%20373.019,177.844C398.331,177.844%20414.831,178.875%20422.519,180.938C434.331,184.031%20444.222,190.758%20452.19,201.117C460.159,211.477%20464.144,224.859%20464.144,241.266C464.144,253.922%20461.847,264.563%20457.253,273.188C452.659,281.813%20446.823,288.586%20439.745,293.508C432.667,298.43%20425.472,301.688%20418.159,303.281C408.222,305.25%20393.831,306.234%20374.987,306.234L347.847,306.234C347.847,306.234%20343.22,354.692%20336.283,367.653C329.735,379.886%20306.222,384%20306.222,384ZM421.253,212.719L401.144,212.719C386.144,212.719%20376.159,213.188%20371.19,214.125C364.44,215.344%20358.862,218.391%20354.456,223.266C350.05,228.141%20347.847,234.328%20347.847,241.828C347.847,247.922%20349.417,253.266%20352.558,257.859C355.698,262.453%20360.034,265.828%20365.565,267.984C371.097,270.141%20382.065,271.219%20398.472,271.219L421.253,271.219L421.253,212.719Z'%20style='stroke:white;stroke-width:5.51px;stroke-linecap:butt;stroke-miterlimit:2;'/%3e%3c/g%3e%3cg%20transform='matrix(1.54355,0,0,1.54355,-190.001,-132.702)'%3e%3cpath%20d='M143.922,336.333C134.777,319.997%20132.926,189.348%20143.392,171.905C154.849,152.812%20201.68,151.492%20201.68,151.492C226.992,151.492%20243.492,152.523%20251.18,154.586C262.992,157.679%20272.883,164.406%20280.852,174.765C288.82,185.125%20292.805,198.508%20292.805,214.914C292.805,227.57%20290.508,238.211%20285.914,246.836C281.32,255.461%20275.484,262.234%20268.406,267.156C261.328,272.078%20254.133,275.336%20246.82,276.929C236.883,278.898%20222.492,279.883%20203.648,279.883L176.508,279.883L176.508,357.648C176.508,357.648%20150.997,348.972%20143.922,336.333ZM176.508,186.367L176.508,244.867L199.289,244.867C215.695,244.867%20226.664,243.789%20232.195,241.633C237.727,239.476%20242.062,236.101%20245.203,231.508C248.344,226.914%20249.914,221.57%20249.914,215.476C249.914,207.976%20247.711,201.789%20243.305,196.914C238.898,192.039%20233.32,188.992%20226.57,187.773C221.602,186.836%20211.617,186.367%20196.617,186.367L176.508,186.367Z'%20style='fill-rule:nonzero;stroke:white;stroke-width:5.18px;stroke-linecap:butt;stroke-miterlimit:2;'/%3e%3c/g%3e%3cg%20transform='matrix(0.928279,0,0,1.4205,-49.905,24.9033)'%3e%3cpath%20d='M203.878,117.764L203.878,127.469C203.878,130.147%20200.551,132.321%20196.453,132.321L178.898,132.321C174.8,132.321%20171.473,130.147%20171.473,127.469L171.473,117.764C171.473,115.086%20174.8,112.912%20178.898,112.912L196.453,112.912C200.551,112.912%20203.878,115.086%20203.878,117.764Z'/%3e%3c/g%3e%3cg%20transform='matrix(0.928279,0,0,1.4205,153.545,24.9033)'%3e%3cpath%20d='M203.878,117.764L203.878,127.469C203.878,130.147%20200.551,132.321%20196.453,132.321L178.898,132.321C174.8,132.321%20171.473,130.147%20171.473,127.469L171.473,117.764C171.473,115.086%20174.8,112.912%20178.898,112.912L196.453,112.912C200.551,112.912%20203.878,115.086%20203.878,117.764Z'/%3e%3c/g%3e%3cg%20transform='matrix(0.928279,0,0,1.4205,-4.51372,24.9033)'%3e%3cpath%20d='M203.878,117.764L203.878,127.469C203.878,130.147%20200.551,132.321%20196.453,132.321L178.898,132.321C174.8,132.321%20171.473,130.147%20171.473,127.469L171.473,117.764C171.473,115.086%20174.8,112.912%20178.898,112.912L196.453,112.912C200.551,112.912%20203.878,115.086%20203.878,117.764Z'/%3e%3c/g%3e%3cg%20transform='matrix(0.928279,0,0,1.4205,198.937,24.9033)'%3e%3cpath%20d='M203.878,117.764L203.878,127.469C203.878,130.147%20200.551,132.321%20196.453,132.321L178.898,132.321C174.8,132.321%20171.473,130.147%20171.473,127.469L171.473,117.764C171.473,115.086%20174.8,112.912%20178.898,112.912L196.453,112.912C200.551,112.912%20203.878,115.086%20203.878,117.764Z'/%3e%3c/g%3e%3c/svg%3e";function Lq(t){switch(t){case"gemini":return"Google";case"openai":return"OpenAI";case"mistral":return"Mistral";case"openrouter":return"OpenRouter";case"lmstudio":return"LM Studio";case"ollama":return"Ollama";case"custom":return"Custom"}}function qq({mcpStatus:t,activeModel:e,activeProvider:n,model:r,provider:o,enabledToolsCount:s,totalToolsCount:i,hasMessages:a,onOpenSettings:l,onClearConversation:c}){return U("header",{className:"bg-gray-100 dark:bg-gray-800 px-4 py-2 border-b border-gray-300 dark:border-gray-700 flex items-baseline",children:[U("img",{src:Uq,alt:"Producer Pal",className:"absolute h-5 translate-y-1 scale-200"}),U("h1",{className:"pl-9 text-lg font-semibold",children:"Producer Pal Chat"}),U("div",{className:"ml-2 flex gap-1 text-xs",children:[t==="connected"&&U("span",{className:"text-green-600 dark:text-green-400",children:"✓ Ready"}),t==="connecting"&&U("span",{className:"text-gray-500 dark:text-gray-400",children:"👀 Looking for Producer Pal..."}),t==="error"&&U("span",{className:"text-red-600 dark:text-red-400",children:"✗ Error"})]}),a&&U("div",{className:"flex-1"}),a&&U("button",{onClick:()=>{window.confirm("Clear all messages and restart conversation?")&&c()},className:"text-xs px-2 py-1 border border-red-500 text-red-500 bg-transparent hover:bg-red-500 hover:text-white rounded transition-colors",children:"Restart"}),a&&U("div",{className:"flex-1"}),U("div",{className:a?"flex gap-3 items-baseline":"ml-auto flex gap-3 items-baseline",children:[U("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Lq(n??o)," |"," ",lU(e??r)]}),U("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s,"/",i," tools"]}),U("button",{onClick:l,className:"text-xs px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600",children:"Settings"})]})]})}function Fq(t){return t==="o1"||t==="o3-mini"}function Vq({thinking:t,temperature:e,showThoughts:n,showSimplifiedOptions:r,showShowThoughtsCheckbox:o,isUsingDefaults:s,randomnessPercent:i,onThinkingChange:a,onTemperatureChange:l,onShowThoughtsChange:c,onResetToDefaults:u}){return U("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 flex flex-col gap-3",children:[U("div",{className:"flex gap-4 items-center",children:[U("div",{className:"flex-1",children:[U("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Thinking"}),U("select",{value:t,onChange:h=>a(h.target.value),className:"w-full px-2 py-1 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded",children:[!r&&U("option",{value:"Default",children:"Default"}),!r&&U("option",{value:"Off",children:"Off"}),!r&&U("option",{value:"Minimal",children:"Minimal"}),U("option",{value:"Low",children:"Low"}),U("option",{value:"Medium",children:"Medium"}),U("option",{value:"High",children:"High"}),!r&&U("option",{value:"Ultra",children:"Ultra"})]})]}),U("div",{className:"flex-1",children:[U("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:["Randomness: ",i,"%"]}),U("input",{type:"range",min:"0",max:"2",step:"0.1",value:e,onInput:h=>l(Number.parseFloat(h.target.value)),className:"w-full"})]}),U("div",{className:"flex items-end",children:U("button",{onClick:u,disabled:s,className:"px-3 py-1 text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900 rounded disabled:opacity-50 disabled:cursor-not-allowed",type:"button",children:"↺ Use defaults"})})]}),o&&U("div",{className:"flex items-center gap-2",children:[U("input",{type:"checkbox",id:"messageShowThoughts",checked:n,onChange:h=>c(h.target.checked)}),U("label",{htmlFor:"messageShowThoughts",className:"text-sm text-gray-600 dark:text-gray-400",children:"Show thinking process"})]}),U("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"These settings apply only to your next message. Change defaults in Settings → Behavior."})]})}function zq({provider:t,model:e,defaultThinking:n,defaultTemperature:r,defaultShowThoughts:o,thinking:s,temperature:i,showThoughts:a,onThinkingChange:l,onTemperatureChange:c,onShowThoughtsChange:u,onResetToDefaults:h}){const[p,m]=Ae(!1),E=t==="openai"&&Fq(e),v=(t==="gemini"||t==="openrouter")&&s!=="Off",g=Math.round(i/2*100),S=s===n&&i===r&&a===o;return U("div",{className:"border-b border-gray-300 dark:border-gray-700",children:[U("button",{onClick:()=>m(!p),className:"w-full px-4 py-2 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",type:"button",children:[U("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[p?"▼":"▶"," Message settings",!S&&" (customized)"]}),U("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:["Thinking: ",s," • ",g,"% random"]})]}),p&&U(Vq,{thinking:s,temperature:i,showThoughts:a,showSimplifiedOptions:E,showShowThoughtsCheckbox:v,isUsingDefaults:S,randomnessPercent:g,onThinkingChange:l,onTemperatureChange:c,onShowThoughtsChange:u,onResetToDefaults:h})]})}function Hq({handleSend:t,isAssistantResponding:e,onStop:n,provider:r,model:o,defaultThinking:s,defaultTemperature:i,defaultShowThoughts:a,thinking:l,temperature:c,showThoughts:u,onThinkingChange:h,onTemperatureChange:p,onShowThoughtsChange:m,onResetToDefaults:w}){const[E,_]=Ae("");return U("div",{className:"border-t border-gray-300 dark:border-gray-700",children:[U(zq,{provider:r,model:o,defaultThinking:s,defaultTemperature:i,defaultShowThoughts:a,thinking:l,temperature:c,showThoughts:u,onThinkingChange:h,onTemperatureChange:p,onShowThoughtsChange:m,onResetToDefaults:w}),U("div",{className:"p-4",children:U("div",{className:"flex gap-3",children:[U("textarea",{value:E,onInput:S=>_(S.target.value),onKeyDown:S=>{S.key==="Enter"&&!S.shiftKey&&(S.preventDefault(),!e&&E.trim()&&(t(E,{thinking:l,temperature:c,showThoughts:u}),_("")))},placeholder:"Type a message... (Shift+Enter for new line)",className:"flex-1 px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded resize-none placeholder:dark:text-gray-400 placeholder:text-gray-500",rows:2}),U("div",{className:"flex flex-col gap-2",children:[U("button",{onClick:n,disabled:!e,className:`px-4 py-1 rounded text-sm ${e?"bg-orange-600 text-white hover:bg-orange-700":"invisible"}`,children:"Stop"}),U("button",{onClick:()=>{t(E,{thinking:l,temperature:c,showThoughts:u}),_("")},disabled:e||!E.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded disabled:opacity-50 hover:bg-blue-700",children:e?"...":"Send"})]})]})})]})}function Gq({retryAttempt:t,maxAttempts:e,retryDelayMs:n,onCancel:r}){const[o,s]=Ae(n);fn(()=>{s(n);const l=setInterval(()=>{s(c=>Math.max(0,c-100))},100);return()=>clearInterval(l)},[n,t]);const i=Math.ceil(o/1e3),a=1-o/n;return U("div",{className:"flex flex-col items-center py-4 px-6",children:[U("div",{className:"flex items-center gap-3 text-amber-600 dark:text-amber-400 mb-2",children:[U(Bq,{}),U("span",{className:"font-medium",children:"Rate limit reached"})]}),U("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:["Retry attempt ",t+1," of ",e]}),U("div",{className:"w-48 mb-3",children:U("div",{className:"h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:U("div",{className:"h-full bg-amber-500 dark:bg-amber-400 transition-all duration-100 ease-linear",style:{width:`${a*100}%`}})})}),U("div",{className:"text-lg font-mono text-gray-700 dark:text-gray-300 mb-3",children:["Retrying in ",i,"s"]}),r&&U("button",{onClick:r,className:"text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 px-3 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 cursor-pointer",children:"Cancel"})]})}function Bq(){return U("svg",{className:"w-5 h-5 animate-spin",style:{animationDuration:"2s"},fill:"none",viewBox:"0 0 24 24",children:U("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2",d:"M4 12a8 8 0 018-8V2.5M4 12a8 8 0 008 8v1.5M12 4.5l2-2-2-2M12 21.5l-2 2 2 2"})})}function Jq(t){return new Date(t).toLocaleString()}function Kq({content:t}){return U("div",{className:"p-3 bg-red-100 dark:bg-red-900 text-red-900 dark:text-red-100 rounded border-l-4 border-red-600 dark:border-red-400",children:[U("div",{className:"font-semibold text-sm mb-1",children:"Error"}),U("div",{className:"text-sm whitespace-pre-wrap",children:t})]})}function cd(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var er=cd();function Mw(t){er=t}var uo={exec:()=>null};function $e(t,e=""){let n=typeof t=="string"?t:t.source,r={replace:(o,s)=>{let i=typeof s=="string"?s:s.source;return i=i.replace(wt.caret,"$1"),n=n.replace(o,i),r},getRegex:()=>new RegExp(n,e)};return r}var Wq=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),wt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},Zq=/^(?:[ \t]*(?:\n|$))+/,Yq=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Xq=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Ao=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Qq=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,ud=/(?:[*+-]|\d{1,9}[.)])/,xw=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Dw=$e(xw).replace(/bull/g,ud).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),jq=$e(xw).replace(/bull/g,ud).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),dd=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,e2=/^[^\n]+/,fd=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,t2=$e(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",fd).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),n2=$e(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,ud).getRegex(),Za="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",hd=/\x3C!--(?:-?>|[\s\S]*?(?:-->|$))/,r2=$e("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",hd).replace("tag",Za).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ow=$e(dd).replace("hr",Ao).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Za).getRegex(),o2=$e(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Ow).getRegex(),pd={blockquote:o2,code:Yq,def:t2,fences:Xq,heading:Qq,hr:Ao,html:r2,lheading:Dw,list:n2,newline:Zq,paragraph:Ow,table:uo,text:e2},qg=$e("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ao).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Za).getRegex(),s2={...pd,lheading:jq,table:qg,paragraph:$e(dd).replace("hr",Ao).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",qg).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Za).getRegex()},i2={...pd,html:$e(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",hd).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:uo,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:$e(dd).replace("hr",Ao).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Dw).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},a2=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,l2=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Uw=/^( {2,}|\\)\n(?!\s*$)/,c2=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ya=/[\p{P}\p{S}]/u,md=/[\s\p{P}\p{S}]/u,Lw=/[^\s\p{P}\p{S}]/u,u2=$e(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,md).getRegex(),qw=/(?!~)[\p{P}\p{S}]/u,d2=/(?!~)[\s\p{P}\p{S}]/u,f2=/(?:[^\s\p{P}\p{S}]|~)/u,h2=$e(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Wq?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Fw=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,p2=$e(Fw,"u").replace(/punct/g,Ya).getRegex(),m2=$e(Fw,"u").replace(/punct/g,qw).getRegex(),Vw="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",g2=$e(Vw,"gu").replace(/notPunctSpace/g,Lw).replace(/punctSpace/g,md).replace(/punct/g,Ya).getRegex(),_2=$e(Vw,"gu").replace(/notPunctSpace/g,f2).replace(/punctSpace/g,d2).replace(/punct/g,qw).getRegex(),y2=$e("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Lw).replace(/punctSpace/g,md).replace(/punct/g,Ya).getRegex(),v2=$e(/\\(punct)/,"gu").replace(/punct/g,Ya).getRegex(),w2=$e(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),S2=$e(hd).replace("(?:-->|$)","-->").getRegex(),E2=$e("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",S2).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ca=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,T2=$e(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ca).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),zw=$e(/^!?\[(label)\]\[(ref)\]/).replace("label",ca).replace("ref",fd).getRegex(),Hw=$e(/^!?\[(ref)\](?:\[\])?/).replace("ref",fd).getRegex(),b2=$e("reflink|nolink(?!\\()","g").replace("reflink",zw).replace("nolink",Hw).getRegex(),Fg=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,gd={_backpedal:uo,anyPunctuation:v2,autolink:w2,blockSkip:h2,br:Uw,code:l2,del:uo,emStrongLDelim:p2,emStrongRDelimAst:g2,emStrongRDelimUnd:y2,escape:a2,link:T2,nolink:Hw,punctuation:u2,reflink:zw,reflinkSearch:b2,tag:E2,text:c2,url:uo},C2={...gd,link:$e(/^!?\[(label)\]\((.*?)\)/).replace("label",ca).getRegex(),reflink:$e(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ca).getRegex()},Fc={...gd,emStrongRDelimAst:_2,emStrongLDelim:m2,url:$e(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Fg).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:$e(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Fg).getRegex()},k2={...Fc,br:$e(Uw).replace("{2,}","*").getRegex(),text:$e(Fc.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},_i={normal:pd,gfm:s2,pedantic:i2},Br={normal:gd,gfm:Fc,breaks:k2,pedantic:C2},I2={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Vg=t=>I2[t];function un(t,e){if(e){if(wt.escapeTest.test(t))return t.replace(wt.escapeReplace,Vg)}else if(wt.escapeTestNoEncode.test(t))return t.replace(wt.escapeReplaceNoEncode,Vg);return t}function zg(t){try{t=encodeURI(t).replace(wt.percentDecode,"%")}catch{return null}return t}function Hg(t,e){let n=t.replace(wt.findPipe,(s,i,a)=>{let l=!1,c=i;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),r=n.split(wt.splitPipe),o=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;o<r.length;o++)r[o]=r[o].trim().replace(wt.slashPipe,"|");return r}function Jr(t,e,n){let r=t.length;if(r===0)return"";let o=0;for(;o<r&&t.charAt(r-o-1)===e;)o++;return t.slice(0,r-o)}function R2(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&(n--,n<0))return r;return n>0?-2:-1}function Gg(t,e,n,r,o){let s=e.href,i=e.title||null,a=t[1].replace(o.other.outputLinkReplace,"$1");r.state.inLink=!0;let l={type:t[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:i,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,l}function $2(t,e,n){let r=t.match(n.other.indentCodeCompensation);if(r===null)return e;let o=r[1];return e.split(`
`).map(s=>{let i=s.match(n.other.beginningSpace);if(i===null)return s;let[a]=i;return a.length>=o.length?s.slice(o.length):s}).join(`
`)}var ua=class{options;rules;lexer;constructor(t){this.options=t||er}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Jr(n,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let n=e[0],r=$2(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){let r=Jr(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Jr(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let n=Jr(e[0],`
`).split(`
`),r="",o="",s=[];for(;n.length>0;){let i=!1,a=[],l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))a.push(n[l]),i=!0;else if(!i)a.push(n[l]);else break;n=n.slice(l);let c=a.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,o=o?`${o}
${u}`:u;let h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,s,!0),this.lexer.state.top=h,n.length===0)break;let p=s.at(-1);if(p?.type==="code")break;if(p?.type==="blockquote"){let m=p,w=m.raw+`
`+n.join(`
`),E=this.blockquote(w);s[s.length-1]=E,r=r.substring(0,r.length-m.raw.length)+E.raw,o=o.substring(0,o.length-m.text.length)+E.text;break}else if(p?.type==="list"){let m=p,w=m.raw+`
`+n.join(`
`),E=this.list(w);s[s.length-1]=E,r=r.substring(0,r.length-p.raw.length)+E.raw,o=o.substring(0,o.length-m.raw.length)+E.raw,n=w.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:s,text:o}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n=e[1].trim(),r=n.length>1,o={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let s=this.rules.other.listItemRegex(n),i=!1;for(;t;){let l=!1,c="",u="";if(!(e=s.exec(t))||this.rules.block.hr.test(t))break;c=e[0],t=t.substring(c.length);let h=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,E=>" ".repeat(3*E.length)),p=t.split(`
`,1)[0],m=!h.trim(),w=0;if(this.options.pedantic?(w=2,u=h.trimStart()):m?w=e[1].length+1:(w=e[2].search(this.rules.other.nonSpaceChar),w=w>4?1:w,u=h.slice(w),w+=e[1].length),m&&this.rules.other.blankLine.test(p)&&(c+=p+`
`,t=t.substring(p.length+1),l=!0),!l){let E=this.rules.other.nextBulletRegex(w),_=this.rules.other.hrRegex(w),v=this.rules.other.fencesBeginRegex(w),g=this.rules.other.headingBeginRegex(w),S=this.rules.other.htmlBeginRegex(w);for(;t;){let b=t.split(`
`,1)[0],y;if(p=b,this.options.pedantic?(p=p.replace(this.rules.other.listReplaceNesting,"  "),y=p):y=p.replace(this.rules.other.tabCharGlobal,"    "),v.test(p)||g.test(p)||S.test(p)||E.test(p)||_.test(p))break;if(y.search(this.rules.other.nonSpaceChar)>=w||!p.trim())u+=`
`+y.slice(w);else{if(m||h.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||v.test(h)||g.test(h)||_.test(h))break;u+=`
`+p}!m&&!p.trim()&&(m=!0),c+=b+`
`,t=t.substring(b.length+1),h=y.slice(w)}}o.loose||(i?o.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(i=!0)),o.items.push({type:"list_item",raw:c,task:!!this.options.gfm&&this.rules.other.listIsTask.test(u),loose:!1,text:u,tokens:[]}),o.raw+=c}let a=o.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;o.raw=o.raw.trimEnd();for(let l of o.items){if(this.lexer.state.top=!1,l.tokens=this.lexer.blockTokens(l.text,[]),l.task){if(l.text=l.text.replace(this.rules.other.listReplaceTask,""),l.tokens[0]?.type==="text"||l.tokens[0]?.type==="paragraph"){l.tokens[0].raw=l.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),l.tokens[0].text=l.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let u=this.lexer.inlineQueue.length-1;u>=0;u--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[u].src)){this.lexer.inlineQueue[u].src=this.lexer.inlineQueue[u].src.replace(this.rules.other.listReplaceTask,"");break}}let c=this.rules.other.listTaskCheckbox.exec(l.raw);if(c){let u={type:"checkbox",raw:c[0]+" ",checked:c[0]!=="[ ]"};l.checked=u.checked,o.loose?l.tokens[0]&&["paragraph","text"].includes(l.tokens[0].type)&&"tokens"in l.tokens[0]&&l.tokens[0].tokens?(l.tokens[0].raw=u.raw+l.tokens[0].raw,l.tokens[0].text=u.raw+l.tokens[0].text,l.tokens[0].tokens.unshift(u)):l.tokens.unshift({type:"paragraph",raw:u.raw,text:u.raw,tokens:[u]}):l.tokens.unshift(u)}}if(!o.loose){let c=l.tokens.filter(h=>h.type==="space"),u=c.length>0&&c.some(h=>this.rules.other.anyLine.test(h.raw));o.loose=u}}if(o.loose)for(let l of o.items){l.loose=!0;for(let c of l.tokens)c.type==="text"&&(c.type="paragraph")}return o}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:r,title:o}}}table(t){let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let n=Hg(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let i of r)this.rules.other.tableAlignRight.test(i)?s.align.push("right"):this.rules.other.tableAlignCenter.test(i)?s.align.push("center"):this.rules.other.tableAlignLeft.test(i)?s.align.push("left"):s.align.push(null);for(let i=0;i<n.length;i++)s.header.push({text:n[i],tokens:this.lexer.inline(n[i]),header:!0,align:s.align[i]});for(let i of o)s.rows.push(Hg(i,s.header.length).map((a,l)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:s.align[l]})));return s}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let s=Jr(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{let s=R2(e[2],"()");if(s===-2)return;if(s>-1){let i=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,i).trim(),e[3]=""}}let r=e[2],o="";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(r);s&&(r=s[1],o=s[3])}else o=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),Gg(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),o=e[r.toLowerCase()];if(!o){let s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return Gg(n,o,n[0],this.lexer,this.rules)}}emStrong(t,e,n=""){let r=this.rules.inline.emStrongLDelim.exec(t);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let o=[...r[0]].length-1,s,i,a=o,l=0,c=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,e=e.slice(-1*t.length+o);(r=c.exec(e))!=null;){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s)continue;if(i=[...s].length,r[3]||r[4]){a+=i;continue}else if((r[5]||r[6])&&o%3&&!((o+i)%3)){l+=i;continue}if(a-=i,a>0)continue;i=Math.min(i,i+a+l);let u=[...r[0]][0].length,h=t.slice(0,o+r.index+u+i);if(Math.min(o,i)%2){let m=h.slice(1,-1);return{type:"em",raw:h,text:m,tokens:this.lexer.inlineTokens(m)}}let p=h.slice(2,-2);return{type:"strong",raw:h,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),o=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&o&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){let e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let n,r;return e[2]==="@"?(n=e[1],r="mailto:"+n):(n=e[1],r=n),{type:"link",raw:e[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(t){let e;if(e=this.rules.inline.url.exec(t)){let n,r;if(e[2]==="@")n=e[0],r="mailto:"+n;else{let o;do o=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(o!==e[0]);n=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},Gt=class Vc{tokens;options;state;inlineQueue;tokenizer;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||er,this.options.tokenizer=this.options.tokenizer||new ua,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:wt,block:_i.normal,inline:Br.normal};this.options.pedantic?(n.block=_i.pedantic,n.inline=Br.pedantic):this.options.gfm&&(n.block=_i.gfm,this.options.breaks?n.inline=Br.breaks:n.inline=Br.gfm),this.tokenizer.rules=n}static get rules(){return{block:_i,inline:Br}}static lex(e,n){return new Vc(n).lex(e)}static lexInline(e,n){return new Vc(n).inlineTokens(e)}lex(e){e=e.replace(wt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],r=!1){for(this.options.pedantic&&(e=e.replace(wt.tabCharGlobal,"    ").replace(wt.spaceLine,""));e;){let o;if(this.options.extensions?.block?.some(i=>(o=i.call({lexer:this},e,n))?(e=e.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(e)){e=e.substring(o.raw.length);let i=n.at(-1);o.raw.length===1&&i!==void 0?i.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(e)){e=e.substring(o.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+o.raw,i.text+=`
`+o.text,this.inlineQueue.at(-1).src=i.text):n.push(o);continue}if(o=this.tokenizer.fences(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(e)){e=e.substring(o.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+o.raw,i.text+=`
`+o.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title},n.push(o));continue}if(o=this.tokenizer.table(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(e)){e=e.substring(o.raw.length),n.push(o);continue}let s=e;if(this.options.extensions?.startBlock){let i=1/0,a=e.slice(1),l;this.options.extensions.startBlock.forEach(c=>{l=c.call({lexer:this},a),typeof l=="number"&&l>=0&&(i=Math.min(i,l))}),i<1/0&&i>=0&&(s=e.substring(0,i+1))}if(this.state.top&&(o=this.tokenizer.paragraph(s))){let i=n.at(-1);r&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+o.raw,i.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(o),r=s.length!==e.length,e=e.substring(o.raw.length);continue}if(o=this.tokenizer.text(e)){e=e.substring(o.raw.length);let i=n.at(-1);i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+o.raw,i.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(o);continue}if(e){let i="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){let r=e,o=null;if(this.tokens.links){let l=Object.keys(this.tokens.links);if(l.length>0)for(;(o=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)l.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(o=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,o.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let s;for(;(o=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)s=o[2]?o[2].length:0,r=r.slice(0,o.index+s)+"["+"a".repeat(o[0].length-s-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let i=!1,a="";for(;e;){i||(a=""),i=!1;let l;if(this.options.extensions?.inline?.some(u=>(l=u.call({lexer:this},e,n))?(e=e.substring(l.raw.length),n.push(l),!0):!1))continue;if(l=this.tokenizer.escape(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.tag(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.link(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(l.raw.length);let u=n.at(-1);l.type==="text"&&u?.type==="text"?(u.raw+=l.raw,u.text+=l.text):n.push(l);continue}if(l=this.tokenizer.emStrong(e,r,a)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.codespan(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.br(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.del(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.autolink(e)){e=e.substring(l.raw.length),n.push(l);continue}if(!this.state.inLink&&(l=this.tokenizer.url(e))){e=e.substring(l.raw.length),n.push(l);continue}let c=e;if(this.options.extensions?.startInline){let u=1/0,h=e.slice(1),p;this.options.extensions.startInline.forEach(m=>{p=m.call({lexer:this},h),typeof p=="number"&&p>=0&&(u=Math.min(u,p))}),u<1/0&&u>=0&&(c=e.substring(0,u+1))}if(l=this.tokenizer.inlineText(c)){e=e.substring(l.raw.length),l.raw.slice(-1)!=="_"&&(a=l.raw.slice(-1)),i=!0;let u=n.at(-1);u?.type==="text"?(u.raw+=l.raw,u.text+=l.text):n.push(l);continue}if(e){let u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return n}},da=class{options;parser;constructor(t){this.options=t||er}space(t){return""}code({text:t,lang:e,escaped:n}){let r=(e||"").match(wt.notSpaceStart)?.[0],o=t.replace(wt.endingNewline,"")+`
`;return r?'<pre><code class="language-'+un(r)+'">'+(n?o:un(o,!0))+`</code></pre>
`:"<pre><code>"+(n?o:un(o,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,n=t.start,r="";for(let i=0;i<t.items.length;i++){let a=t.items[i];r+=this.listitem(a)}let o=e?"ol":"ul",s=e&&n!==1?' start="'+n+'"':"";return"<"+o+s+`>
`+r+"</"+o+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",n="";for(let o=0;o<t.header.length;o++)n+=this.tablecell(t.header[o]);e+=this.tablerow({text:n});let r="";for(let o=0;o<t.rows.length;o++){let s=t.rows[o];n="";for(let i=0;i<s.length;i++)n+=this.tablecell(s[i]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${un(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:n}){let r=this.parser.parseInline(n),o=zg(t);if(o===null)return r;t=o;let s='<a href="'+t+'"';return e&&(s+=' title="'+un(e)+'"'),s+=">"+r+"</a>",s}image({href:t,title:e,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let o=zg(t);if(o===null)return un(n);t=o;let s=`<img src="${t}" alt="${n}"`;return e&&(s+=` title="${un(e)}"`),s+=">",s}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:un(t.text)}},_d=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Bt=class zc{options;renderer;textRenderer;constructor(e){this.options=e||er,this.options.renderer=this.options.renderer||new da,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new _d}static parse(e,n){return new zc(n).parse(e)}static parseInline(e,n){return new zc(n).parseInline(e)}parse(e){let n="";for(let r=0;r<e.length;r++){let o=e[r];if(this.options.extensions?.renderers?.[o.type]){let i=o,a=this.options.extensions.renderers[i.type].call({parser:this},i);if(a!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(i.type)){n+=a||"";continue}}let s=o;switch(s.type){case"space":{n+=this.renderer.space(s);break}case"hr":{n+=this.renderer.hr(s);break}case"heading":{n+=this.renderer.heading(s);break}case"code":{n+=this.renderer.code(s);break}case"table":{n+=this.renderer.table(s);break}case"blockquote":{n+=this.renderer.blockquote(s);break}case"list":{n+=this.renderer.list(s);break}case"checkbox":{n+=this.renderer.checkbox(s);break}case"html":{n+=this.renderer.html(s);break}case"def":{n+=this.renderer.def(s);break}case"paragraph":{n+=this.renderer.paragraph(s);break}case"text":{n+=this.renderer.text(s);break}default:{let i='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return n}parseInline(e,n=this.renderer){let r="";for(let o=0;o<e.length;o++){let s=e[o];if(this.options.extensions?.renderers?.[s.type]){let a=this.options.extensions.renderers[s.type].call({parser:this},s);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=a||"";continue}}let i=s;switch(i.type){case"escape":{r+=n.text(i);break}case"html":{r+=n.html(i);break}case"link":{r+=n.link(i);break}case"image":{r+=n.image(i);break}case"checkbox":{r+=n.checkbox(i);break}case"strong":{r+=n.strong(i);break}case"em":{r+=n.em(i);break}case"codespan":{r+=n.codespan(i);break}case"br":{r+=n.br(i);break}case"del":{r+=n.del(i);break}case"text":{r+=n.text(i);break}default:{let a='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}},io=class{options;block;constructor(t){this.options=t||er}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Gt.lex:Gt.lexInline}provideParser(){return this.block?Bt.parse:Bt.parseInline}},A2=class{defaults=cd();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Bt;Renderer=da;TextRenderer=_d;Lexer=Gt;Tokenizer=ua;Hooks=io;constructor(...t){this.use(...t)}walkTokens(t,e){let n=[];for(let r of t)switch(n=n.concat(e.call(this,r)),r.type){case"table":{let o=r;for(let s of o.header)n=n.concat(this.walkTokens(s.tokens,e));for(let s of o.rows)for(let i of s)n=n.concat(this.walkTokens(i.tokens,e));break}case"list":{let o=r;n=n.concat(this.walkTokens(o.items,e));break}default:{let o=r;this.defaults.extensions?.childTokens?.[o.type]?this.defaults.extensions.childTokens[o.type].forEach(s=>{let i=o[s].flat(1/0);n=n.concat(this.walkTokens(i,e))}):o.tokens&&(n=n.concat(this.walkTokens(o.tokens,e)))}}return n}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){let s=e.renderers[o.name];s?e.renderers[o.name]=function(...i){let a=o.renderer.apply(this,i);return a===!1&&(a=s.apply(this,i)),a}:e.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=e[o.level];s?s.unshift(o.tokenizer):e[o.level]=[o.tokenizer],o.start&&(o.level==="block"?e.startBlock?e.startBlock.push(o.start):e.startBlock=[o.start]:o.level==="inline"&&(e.startInline?e.startInline.push(o.start):e.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(e.childTokens[o.name]=o.childTokens)}),r.extensions=e),n.renderer){let o=this.defaults.renderer||new da(this.defaults);for(let s in n.renderer){if(!(s in o))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;let i=s,a=n.renderer[i],l=o[i];o[i]=(...c)=>{let u=a.apply(o,c);return u===!1&&(u=l.apply(o,c)),u||""}}r.renderer=o}if(n.tokenizer){let o=this.defaults.tokenizer||new ua(this.defaults);for(let s in n.tokenizer){if(!(s in o))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;let i=s,a=n.tokenizer[i],l=o[i];o[i]=(...c)=>{let u=a.apply(o,c);return u===!1&&(u=l.apply(o,c)),u}}r.tokenizer=o}if(n.hooks){let o=this.defaults.hooks||new io;for(let s in n.hooks){if(!(s in o))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;let i=s,a=n.hooks[i],l=o[i];io.passThroughHooks.has(s)?o[i]=c=>{if(this.defaults.async&&io.passThroughHooksRespectAsync.has(s))return(async()=>{let h=await a.call(o,c);return l.call(o,h)})();let u=a.call(o,c);return l.call(o,u)}:o[i]=(...c)=>{if(this.defaults.async)return(async()=>{let h=await a.apply(o,c);return h===!1&&(h=await l.apply(o,c)),h})();let u=a.apply(o,c);return u===!1&&(u=l.apply(o,c)),u}}r.hooks=o}if(n.walkTokens){let o=this.defaults.walkTokens,s=n.walkTokens;r.walkTokens=function(i){let a=[];return a.push(s.call(this,i)),o&&(a=a.concat(o.call(this,i))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Gt.lex(t,e??this.defaults)}parser(t,e){return Bt.parse(t,e??this.defaults)}parseMarkdown(t){return(e,n)=>{let r={...n},o={...this.defaults,...r},s=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&r.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(o.hooks&&(o.hooks.options=o,o.hooks.block=t),o.async)return(async()=>{let i=o.hooks?await o.hooks.preprocess(e):e,a=await(o.hooks?await o.hooks.provideLexer():t?Gt.lex:Gt.lexInline)(i,o),l=o.hooks?await o.hooks.processAllTokens(a):a;o.walkTokens&&await Promise.all(this.walkTokens(l,o.walkTokens));let c=await(o.hooks?await o.hooks.provideParser():t?Bt.parse:Bt.parseInline)(l,o);return o.hooks?await o.hooks.postprocess(c):c})().catch(s);try{o.hooks&&(e=o.hooks.preprocess(e));let i=(o.hooks?o.hooks.provideLexer():t?Gt.lex:Gt.lexInline)(e,o);o.hooks&&(i=o.hooks.processAllTokens(i)),o.walkTokens&&this.walkTokens(i,o.walkTokens);let a=(o.hooks?o.hooks.provideParser():t?Bt.parse:Bt.parseInline)(i,o);return o.hooks&&(a=o.hooks.postprocess(a)),a}catch(i){return s(i)}}}onError(t,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let r="<p>An error occurred:</p><pre>"+un(n.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(n);throw n}}},Xn=new A2;function Ce(t,e){return Xn.parse(t,e)}Ce.options=Ce.setOptions=function(t){return Xn.setOptions(t),Ce.defaults=Xn.defaults,Mw(Ce.defaults),Ce};Ce.getDefaults=cd;Ce.defaults=er;Ce.use=function(...t){return Xn.use(...t),Ce.defaults=Xn.defaults,Mw(Ce.defaults),Ce};Ce.walkTokens=function(t,e){return Xn.walkTokens(t,e)};Ce.parseInline=Xn.parseInline;Ce.Parser=Bt;Ce.parser=Bt.parse;Ce.Renderer=da;Ce.TextRenderer=_d;Ce.Lexer=Gt;Ce.lexer=Gt.lex;Ce.Tokenizer=ua;Ce.Hooks=io;Ce.parse=Ce;Ce.options;Ce.setOptions;Ce.use;Ce.walkTokens;Ce.parseInline;Bt.parse;Gt.lex;function P2({content:t}){return U("div",{className:"prose dark:prose-invert prose-sm max-w-none",dangerouslySetInnerHTML:{__html:Ce(t)}})}function N2({content:t,isOpen:e,isResponding:n}){return U("details",{className:`p-2 text-xs bg-gray-200 dark:bg-gray-700 rounded border-l-3 border-green-500 ${e&&n?"animate-pulse":""}`,open:e,children:[U("summary",{className:"font-semibold truncate",dangerouslySetInnerHTML:{__html:e?"💭 Thinking...":Ce.parseInline(`💭 Thought about: ${t.trim().split(`
`)[0]}`)}}),U("div",{className:"pt-2 text-xs prose dark:prose-invert prose-sm max-w-none",dangerouslySetInnerHTML:{__html:Ce(e?t.trim():t.trim().split(`
`).slice(1).join(`
`))}})]})}function M2(t,e,n="…"){if(t==null||t.length<=e)return t;const r=Math.max(0,e-n.length);return t.slice(0,r)+n}function x2({name:t,args:e,result:n,isError:r}){return U("details",{className:`text-xs p-2 font-mono bg-gray-200 dark:bg-gray-900 rounded ${n?"":"animate-pulse"} ${r?"border-l-3 border-red-500":""}`,children:[U("summary",{children:[" 🔧"," ",n?r?"tool failed: ":"used tool: ":"using tool: ",cU[t]??t]}),U("div",{className:"mt-1 p-1 break-all text-gray-500 dark:text-gray-500",children:[t,"(",JSON.stringify(e,null,0),")"]}),n&&U("details",{children:[U("summary",{className:`px-2 my-1 truncate ${r?"text-red-700 dark:text-red-400":"text-gray-600 dark:text-gray-400"}`,children:[" ↳ ",M2(n,300)]}),U("div",{className:"mt-1 p-1 break-all text-gray-500 dark:text-gray-500",children:U(D2,{result:n})})]})]})}function D2({result:t}){const e=`${t}`;let n=null;if(e.startsWith("{"))try{const r=JSON.parse(e);n=JSON.stringify(r,null,2).replaceAll("\\n",`
`)}catch{}return n?U("pre",{className:"whitespace-pre-wrap",children:n}):U(en,{children:e})}function O2({parts:t,isResponding:e}){return U("div",{className:"flex flex-col gap-3 py-2",children:t.map((n,r)=>n.type==="thought"?U(N2,{content:n.content,isOpen:n.isOpen,isResponding:e},r):n.type==="tool"?U(x2,{name:n.name,args:n.args,result:n.result,isError:n.isError},r):n.type==="text"?U(P2,{content:n.content},r):U(Kq,{content:n.content},r))})}function U2(){return U("div",{className:"flex justify-center py-2",children:U(L2,{})})}function L2(){const a=Bg(400,7,5,200),l=Bg(400,8,4,200);return U("svg",{width:400,height:40,viewBox:"0 0 400 40",style:"overflow: visible;",children:[U("defs",{children:[U("filter",{id:"blur",children:U("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1",children:U("animate",{attributeName:"stdDeviation",values:"0;1.5;0",dur:"2.9s",repeatCount:"indefinite"})})}),U("style",{children:`
            @keyframes pulse1 {
              0%, 100% { transform: scaleY(1.3); }
              50% { transform: scaleY(0.5); }
            }

            @keyframes pulse2 {
              0%, 100% { transform: scaleY(1.4); }
              50% { transform: scaleY(0.4); }
            }

            @keyframes colorShift1 {
              0%, 100% { stroke: rgb(56, 189, 248); } /* sky-400 */
              50% { stroke: rgb(34, 197, 94); } /* green-500 */
            }

            @keyframes colorShift2 {
              0%, 100% { stroke: rgb(234, 179, 8); } /* yellow-600 */
              50% { stroke: rgb(249, 115, 22); } /* orange-500 */
            }

            .wave-path-1 {
              fill: none;
              stroke-width: 2.5;
              stroke-linecap: round;
              transform-origin: top left;
              animation:
                pulse1 3.72s ease-in-out infinite,
                colorShift1 4.19s ease-in-out infinite;
            }

            .wave-path-2 {
              fill: none;
              stroke-width: 2.5;
              stroke-linecap: round;
              transform-origin: top left;
              animation:
                pulse2 2.63s ease-in-out infinite,
                colorShift2 3.52s ease-in-out infinite;
            }
          `})]}),U("g",{transform:`translate(0, ${40/2})`,filter:"url(#blur)",children:[U("path",{d:a,className:"wave-path-1"}),U("path",{d:l,className:"wave-path-2"}),U("circle",{cx:"0",cy:"0",r:"2",className:"wave-path-1"}),U("circle",{cx:400,cy:"0",r:"2",className:"wave-path-2"})]})]})}function Bg(t,e,n,r){const o=t/r;let s="";for(let i=0;i<=r;i++){const a=i*o,l=e*Math.sin(i/r*n*2*Math.PI);s+=`${i===0?"M":"L"} ${a},${l} `}return s.trim()}function q2({onClick:t}){return U("button",{onClick:t,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 text-sm px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 cursor-pointer",title:"Retry from your last message",children:"↻"})}function F2({messages:t,isAssistantResponding:e,handleRetry:n}){const r=En(null);fn(()=>{r.current?.scrollIntoView({behavior:"smooth"})},[t]);const o=s=>{for(let i=s-1;i>=0;i--)if(t[i]?.role==="user")return i;return-1};return U("div",{className:"p-4 space-y-4","data-testid":"message-list",children:[t.map((s,i)=>{if(!V2(s))return null;const a=s.role==="model"&&!e,l=a?o(i):-1;return U("div",{className:s.role==="model"?"flex items-end gap-2":"",children:[U("div",{className:`${s.role==="user"?"ml-auto text-black bg-blue-100 dark:text-white dark:bg-blue-900":"bg-gray-100 dark:bg-gray-800"} ${s.role==="model"?"flex-1":""} rounded-lg py-0.5 px-3 max-w-[90%]`,title:Jq(s.timestamp),"data-testid":s.role==="model"?"assistant-message-bubble":void 0,children:[s.role==="model"&&U(O2,{parts:s.parts,isResponding:e}),s.role==="user"&&U("div",{className:"prose dark:prose-invert prose-sm",children:z2(s)})]}),a&&l>=0&&U(q2,{onClick:()=>{n(l)}})]},i)}),e&&U(U2,{}),U("div",{ref:r})]})}function V2(t){return t.parts.length>0}function z2(t){return t.parts.map(e=>"content"in e?e.content:"").join("")}function H2({messages:t,isAssistantResponding:e,rateLimitState:n,handleSend:r,handleRetry:o,activeModel:s,activeProvider:i,provider:a,model:l,defaultThinking:c,defaultTemperature:u,defaultShowThoughts:h,enabledToolsCount:p,totalToolsCount:m,mcpStatus:w,mcpError:E,checkMcpConnection:_,onOpenSettings:v,onClearConversation:g,onStop:S}){const[b,y]=Ae(c),[C,k]=Ae(u),[P,M]=Ae(h),q=()=>{y(c),k(u),M(h)},D={thinking:b,temperature:C,showThoughts:P};return U("div",{className:"flex flex-col h-screen",children:[U(qq,{mcpStatus:w,activeModel:s,activeProvider:i,model:l,provider:a,enabledToolsCount:p,totalToolsCount:m,hasMessages:t.length>0,onOpenSettings:v,onClearConversation:g}),U("div",{class:"flex-1 overflow-y-auto",children:t.length===0?U(Oq,{mcpStatus:w,mcpError:E,checkMcpConnection:_,handleSend:r,overrides:D}):U(F2,{messages:t,isAssistantResponding:e,handleRetry:o})}),n?.isRetrying&&U(Gq,{retryAttempt:n.attempt,maxAttempts:n.maxAttempts,retryDelayMs:n.delayMs,onCancel:S}),U(Hq,{handleSend:r,isAssistantResponding:e,onStop:S,provider:a,model:l,defaultThinking:c,defaultTemperature:u,defaultShowThoughts:h,thinking:b,temperature:C,showThoughts:P,onThinkingChange:y,onTemperatureChange:k,onShowThoughtsChange:M,onResetToDefaults:q})]})}function G2({theme:t,setTheme:e}){return U("div",{children:[U("label",{htmlFor:"theme-select",className:"block text-sm mb-2",children:"Theme"}),U("select",{id:"theme-select",value:t,onChange:n=>e(n.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded",children:[U("option",{value:"system",children:"System"}),U("option",{value:"light",children:"Light"}),U("option",{value:"dark",children:"Dark"})]})]})}function B2({temperature:t,setTemperature:e}){return U("div",{children:[U("label",{className:"block text-sm mb-2",children:["Randomness: ",Math.round(t/2*100),"%"]}),U("input",{type:"range",min:"0",max:"2",step:"0.1",value:t,onInput:n=>e(Number.parseFloat(n.target.value)),className:"w-full"})]})}function J2({provider:t,model:e,thinking:n,setThinking:r,showThoughts:o,setShowThoughts:s}){return t!=="gemini"&&t!=="openai"&&t!=="openrouter"?null:U(en,{children:[U("div",{children:[U("label",{className:"block text-sm mb-2",children:"Thinking"}),U("select",{value:n,onChange:a=>r(a.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded",children:[U("option",{value:"Default",children:"Default"}),U("option",{value:"Off",children:"Off"}),U("option",{value:"Minimal",children:"Minimal"}),U("option",{value:"Low",children:"Low"}),U("option",{value:"Medium",children:"Medium"}),U("option",{value:"High",children:"High"}),U("option",{value:"Ultra",children:"Ultra"})]})]}),(t==="gemini"||t==="openrouter")&&n!=="Off"&&U("div",{className:"flex items-center gap-2",children:[U("input",{type:"checkbox",id:"showThoughts",checked:o,onChange:a=>s(a.target.checked)}),U("label",{htmlFor:"showThoughts",className:"text-sm",children:"Show thinking process"})]})]})}function K2({provider:t,model:e,thinking:n,setThinking:r,temperature:o,setTemperature:s,showThoughts:i,setShowThoughts:a,resetBehaviorToDefaults:l}){return U("div",{children:[U("div",{className:"flex justify-end",children:U("button",{type:"button",onClick:l,className:"px-3 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-700",children:"Reset to defaults"})}),U("div",{className:"space-y-4",children:[U(J2,{provider:t,model:e,thinking:n,setThinking:r,showThoughts:i,setShowThoughts:a}),U("div",{className:"mt-8",children:U(B2,{temperature:o,setTemperature:s})}),U("p",{className:"text-xs text-gray-500 dark:text-gray-400 pt-2 border-t border-gray-300 dark:border-gray-600",children:"These are default values for new conversations. You can adjust thinking and randomness for individual messages during chat."})]})]})}function W2({provider:t,model:e,setModel:n}){const r=vr(()=>t==="gemini"?Rw:t==="openai"?$w:t==="mistral"?Aw:t==="openrouter"?Pw:t==="ollama"?Nw:[],[t]),[o,s]=Ae(()=>t==="custom"||r.length===0?!1:!r.some(u=>u.value===e&&u.value!=="OTHER")),i=En(null),a=En(o);if(fn(()=>{if(t==="custom"||r.length===0){s(!1);return}const u=!r.some(h=>h.value===e&&h.value!=="OTHER");s(u)},[e,t,r]),fn(()=>{o&&!a.current&&i.current&&i.current.focus(),a.current=o},[o]),t==="custom"||t==="lmstudio")return U("div",{children:[U("label",{className:"block text-sm mb-2",children:"Model"}),U("input",{type:"text",value:e,onChange:h=>n(h.target.value),placeholder:t==="lmstudio"?"e.g., llama-3.1-70b, qwen-2.5-72b":"e.g., gpt-4, llama-3.1-70b",className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded"})]});const l=o?"OTHER":e,c=u=>{u==="OTHER"?s(!0):(s(!1),n(u))};return U("div",{children:[U("label",{className:"block text-sm mb-2",children:"Model"}),U("select",{value:l,onChange:u=>c(u.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded","data-testid":"model-select",children:r.map(({value:u,label:h})=>U("option",{value:u,children:h},u))}),o&&U("input",{ref:i,type:"text",value:e,onChange:u=>n(u.target.value),placeholder:"e.g., gpt-4, claude-3-opus",className:"w-full px-3 py-2 mt-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded"})]})}function Z2({provider:t,setProvider:e}){return U("div",{children:[U("label",{className:"block text-sm mb-2",children:"Provider"}),U("select",{value:t,onChange:n=>e(n.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded","data-testid":"provider-select",children:[U("option",{value:"gemini",children:"Google"}),U("option",{value:"openai",children:"OpenAI"}),U("option",{value:"mistral",children:"Mistral"}),U("option",{value:"openrouter",children:"OpenRouter"}),U("option",{value:"lmstudio",children:"LM Studio (local)"}),U("option",{value:"ollama",children:"Ollama (local)"}),U("option",{value:"custom",children:"Custom (OpenAI-compatible)"})]})]})}const Jg={gemini:"https://aistudio.google.com/apikey",openai:"https://platform.openai.com/api-keys",mistral:"https://console.mistral.ai/home?workspace_dialog=apiKeys",openrouter:"https://openrouter.ai/settings/keys"},Kg={gemini:"https://ai.google.dev/gemini-api/docs/models",openai:"https://platform.openai.com/docs/models",mistral:"https://docs.mistral.ai/getting-started/models",openrouter:"https://openrouter.ai/models",lmstudio:"https://lmstudio.ai/models",ollama:"https://ollama.com/search"};function Y2({provider:t,setProvider:e,apiKey:n,setApiKey:r,baseUrl:o,setBaseUrl:s,port:i,setPort:a,model:l,setModel:c,providerLabel:u}){return U(en,{children:[U(Z2,{provider:t,setProvider:e}),t!=="lmstudio"&&t!=="ollama"&&U("div",{children:[U("label",{className:"block text-sm mb-2",children:[u," API Key"]}),U("input",{type:"password",value:n,onChange:h=>r(h.target.value),placeholder:`Enter your ${u} API key`,className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded","data-testid":"api-key-input"}),Jg[t]&&U("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:U("a",{href:Jg[t],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:[u," API keys"]})})]}),(t==="lmstudio"||t==="ollama")&&a&&U("div",{children:[U("label",{className:"block text-sm mb-2",children:"Port"}),U("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:i?.toString()??"",onChange:h=>{const p=h.target.value,m=Number.parseInt(p);Number.isNaN(m)||a(m)},placeholder:t==="lmstudio"?"1234":"11434",className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded"}),U("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Base URL: http://localhost:",i??(t==="lmstudio"?1234:11434),"/v1"]})]}),t==="custom"&&s&&U("div",{children:[U("label",{className:"block text-sm mb-2",children:"Base URL"}),U("input",{type:"text",value:o??"",onChange:h=>s(h.target.value),placeholder:"https://api.example.com/v1",className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded"}),U("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"OpenAI-compatible API endpoint"})]}),U(W2,{provider:t,model:l,setModel:c}),Kg[t]&&U("p",{className:"text-xs text-gray-500 dark:text-gray-400 -mt-2",children:U("a",{href:Kg[t],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:[u," models"]})})]})}function X2({enabledTools:t,setEnabledTools:e,enableAllTools:n,disableAllTools:r}){const o=i=>{e({...t,[i]:!t[i]})},s=$o.filter(i=>(i.requiresEnvVar,!0));return U("div",{children:[U("div",{className:"flex items-center justify-between mb-3",children:[U("label",{className:"block text-sm font-medium",children:"Available Tools"}),U("div",{className:"flex gap-2",children:[U("button",{type:"button",onClick:n,className:"px-3 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700",children:"Enable all"}),U("button",{type:"button",onClick:r,className:"px-3 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-700",children:"Disable all"})]})]}),U("div",{className:"grid grid-cols-2 gap-2",children:s.map(i=>U("div",{className:"flex items-center gap-2",children:[U("input",{type:"checkbox",id:`tool-${i.id}`,checked:t[i.id]??!0,onChange:()=>o(i.id)}),U("label",{htmlFor:`tool-${i.id}`,className:"text-sm",children:i.name})]},i.id))})]})}function Q2({settingsConfigured:t,saveSettings:e,cancelSettings:n}){return U(en,{children:[!t&&U("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-6",children:"Settings will be stored in this web browser."}),U("div",{className:"flex gap-2 mt-4",children:[U("button",{onClick:e,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded disabled:opacity-50",children:"Save"}),t&&U("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded",children:"Cancel"})]})]})}const j2=[{id:"connection",label:"Connection"},{id:"behavior",label:"Behavior"},{id:"tools",label:"Tools"},{id:"appearance",label:"Appearance"}];function eF({children:t}){const[e,n]=Ae("connection");return U("div",{children:[U("div",{className:"flex border-b border-gray-300 dark:border-gray-600 mb-6",children:j2.map(r=>U("button",{onClick:()=>n(r.id),className:`px-4 py-2 font-medium text-sm transition-colors ${e===r.id?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"}`,children:r.label},r.id))}),U("div",{children:t(e)})]})}function tF(t){switch(t){case"gemini":return"Gemini";case"openai":return"OpenAI";case"mistral":return"Mistral";case"openrouter":return"OpenRouter";case"lmstudio":return"LM Studio";case"ollama":return"Ollama";default:return"Custom"}}function nF({provider:t,setProvider:e,apiKey:n,setApiKey:r,baseUrl:o,setBaseUrl:s,port:i,setPort:a,model:l,setModel:c,thinking:u,setThinking:h,temperature:p,setTemperature:m,showThoughts:w,setShowThoughts:E,theme:_,setTheme:v,enabledTools:g,setEnabledTools:S,enableAllTools:b,disableAllTools:y,resetBehaviorToDefaults:C,saveSettings:k,cancelSettings:P,settingsConfigured:M}){const q=tF(t);return U("div",{className:"flex justify-center min-h-screen p-4 pt-20",children:U("div",{className:"max-w-md w-full bg-gray-100 dark:bg-gray-800 rounded-lg p-6 self-start",children:[U("h2",{className:"text-xl font-semibold mb-4",children:"Producer Pal Chat Settings"}),U(eF,{children:D=>U("div",{className:"space-y-4",children:[D==="connection"&&U(Y2,{provider:t,setProvider:e,apiKey:n,setApiKey:r,baseUrl:o,setBaseUrl:s,port:i,setPort:a,model:l,setModel:c,providerLabel:q}),D==="behavior"&&U(K2,{provider:t,model:l,thinking:u,setThinking:h,temperature:p,setTemperature:m,showThoughts:w,setShowThoughts:E,resetBehaviorToDefaults:C}),D==="tools"&&U(X2,{enabledTools:g,setEnabledTools:S,enableAllTools:b,disableAllTools:y}),D==="appearance"&&U(G2,{theme:_,setTheme:v})]})}),U(Q2,{settingsConfigured:M,saveSettings:k,cancelSettings:P})]})})}const rF={openai:"https://api.openai.com/v1",mistral:"https://api.mistral.ai/v1",openrouter:"https://openrouter.ai/api/v1"},Gw=$o.filter(t=>!t.requiresEnvVar||!0);function oF(t){return Gw.filter(e=>t[e.id]!==!1).length}function sF(t,e,n){if(t==="custom")return e;if(t!=="gemini")return t==="lmstudio"?`http://localhost:${n??1234}/v1`:t==="ollama"?`http://localhost:${n??11434}/v1`:rF[t]}function iF(){const t=xq(),{theme:e,setTheme:n}=Dq(),{mcpStatus:r,mcpError:o,checkMcpConnection:s}=kq(),i=sF(t.provider,t.baseUrl,t.port),a=ql({provider:t.provider,apiKey:t.apiKey,model:t.model,thinking:t.thinking,temperature:t.temperature,enabledTools:t.enabledTools,mcpStatus:r,mcpError:o,checkMcpConnection:s,adapter:oL,extraParams:{showThoughts:t.showThoughts}}),l=ql({provider:t.provider,apiKey:t.provider==="lmstudio"||t.provider==="ollama"?t.apiKey||"not-needed":t.apiKey,model:t.model,thinking:t.thinking,temperature:t.temperature,enabledTools:t.enabledTools,mcpStatus:r,mcpError:o,checkMcpConnection:s,adapter:gq,extraParams:{baseUrl:i,showThoughts:t.showThoughts}}),c=ql({provider:t.provider,apiKey:t.apiKey,model:t.model,thinking:t.thinking,temperature:t.temperature,enabledTools:t.enabledTools,mcpStatus:r,mcpError:o,checkMcpConnection:s,adapter:yq,extraParams:{showThoughts:t.showThoughts}}),{chat:u,wrappedHandleSend:h,wrappedClearConversation:p}=iL({settingsProvider:t.provider,geminiChat:a,openaiChat:l,responsesChat:c}),m=oF(t.enabledTools),[w,E]=Ae(!t.settingsConfigured),_=En(e),v=En(w);fn(()=>{w&&!v.current&&(_.current=e),v.current=w},[w,e]);const g=()=>{t.saveSettings(),E(!1)},S=()=>{t.cancelSettings(),n(_.current),E(!1)};return w?U(nF,{provider:t.provider,setProvider:t.setProvider,apiKey:t.apiKey,setApiKey:t.setApiKey,baseUrl:t.baseUrl,setBaseUrl:t.setBaseUrl,port:t.port,setPort:t.setPort,model:t.model,setModel:t.setModel,thinking:t.thinking,setThinking:t.setThinking,temperature:t.temperature,setTemperature:t.setTemperature,showThoughts:t.showThoughts,setShowThoughts:t.setShowThoughts,theme:e,setTheme:n,enabledTools:t.enabledTools,setEnabledTools:t.setEnabledTools,enableAllTools:t.enableAllTools,disableAllTools:t.disableAllTools,resetBehaviorToDefaults:t.resetBehaviorToDefaults,saveSettings:g,cancelSettings:S,settingsConfigured:t.settingsConfigured}):U(H2,{messages:u.messages,isAssistantResponding:u.isAssistantResponding,rateLimitState:u.rateLimitState,handleSend:h,handleRetry:u.handleRetry,activeModel:u.activeModel,activeProvider:u.activeProvider,provider:t.provider,model:t.model,defaultThinking:t.thinking,defaultTemperature:t.temperature,defaultShowThoughts:t.showThoughts,enabledToolsCount:m,totalToolsCount:Gw.length,mcpStatus:r,mcpError:o,checkMcpConnection:s,onOpenSettings:()=>E(!0),onClearConversation:p,onStop:u.stopResponse})}const Bw=document.getElementById("app");if(!Bw)throw new Error("Could not find #app element");Qw(U(iF,{}),Bw);</script>
    <style rel="stylesheet" crossorigin>@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,:before,:after,::backdrop{--tw-translate-x:0;--tw-translate-y:0;--tw-translate-z:0;--tw-scale-x:1;--tw-scale-y:1;--tw-scale-z:1;--tw-rotate-x:initial;--tw-rotate-y:initial;--tw-rotate-z:initial;--tw-skew-x:initial;--tw-skew-y:initial;--tw-space-y-reverse:0;--tw-border-style:solid;--tw-font-weight:initial;--tw-blur:initial;--tw-brightness:initial;--tw-contrast:initial;--tw-grayscale:initial;--tw-hue-rotate:initial;--tw-invert:initial;--tw-opacity:initial;--tw-saturate:initial;--tw-sepia:initial;--tw-drop-shadow:initial;--tw-drop-shadow-color:initial;--tw-drop-shadow-alpha:100%;--tw-drop-shadow-size:initial;--tw-duration:initial;--tw-ease:initial}}}@layer theme{:root,:host{--font-sans:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--color-red-100:oklch(93.6% .032 17.717);--color-red-400:oklch(70.4% .191 22.216);--color-red-500:oklch(63.7% .237 25.331);--color-red-600:oklch(57.7% .245 27.325);--color-red-700:oklch(50.5% .213 27.518);--color-red-900:oklch(39.6% .141 25.723);--color-orange-600:oklch(64.6% .222 41.116);--color-orange-700:oklch(55.3% .195 38.402);--color-amber-400:oklch(82.8% .189 84.429);--color-amber-500:oklch(76.9% .188 70.08);--color-amber-600:oklch(66.6% .179 58.318);--color-yellow-50:oklch(98.7% .026 102.212);--color-green-400:oklch(79.2% .209 151.711);--color-green-500:oklch(72.3% .219 149.579);--color-green-600:oklch(62.7% .194 149.214);--color-green-700:oklch(52.7% .154 150.069);--color-blue-50:oklch(97% .014 254.604);--color-blue-100:oklch(93.2% .032 255.585);--color-blue-400:oklch(70.7% .165 254.624);--color-blue-600:oklch(54.6% .245 262.881);--color-blue-700:oklch(48.8% .243 264.376);--color-blue-900:oklch(37.9% .146 265.522);--color-gray-50:oklch(98.5% .002 247.839);--color-gray-100:oklch(96.7% .003 264.542);--color-gray-200:oklch(92.8% .006 264.531);--color-gray-300:oklch(87.2% .01 258.338);--color-gray-400:oklch(70.7% .022 261.325);--color-gray-500:oklch(55.1% .027 264.364);--color-gray-600:oklch(44.6% .03 256.802);--color-gray-700:oklch(37.3% .034 259.733);--color-gray-800:oklch(27.8% .033 256.848);--color-gray-900:oklch(21% .034 264.665);--color-black:#000;--color-white:#fff;--spacing:.25rem;--container-md:28rem;--text-xs:.75rem;--text-xs--line-height:calc(1/.75);--text-sm:.875rem;--text-sm--line-height:calc(1.25/.875);--text-lg:1.125rem;--text-lg--line-height:calc(1.75/1.125);--text-xl:1.25rem;--text-xl--line-height:calc(1.75/1.25);--font-weight-medium:500;--font-weight-semibold:600;--font-weight-bold:700;--radius-lg:.5rem;--ease-in-out:cubic-bezier(.4,0,.2,1);--animate-spin:spin 1s linear infinite;--animate-pulse:pulse 2s cubic-bezier(.4,0,.6,1)infinite;--default-transition-duration:.15s;--default-transition-timing-function:cubic-bezier(.4,0,.2,1);--default-font-family:var(--font-sans);--default-mono-font-family:var(--font-mono)}}@layer base{*,:after,:before,::backdrop{box-sizing:border-box;border:0 solid;margin:0;padding:0}::file-selector-button{box-sizing:border-box;border:0 solid;margin:0;padding:0}html,:host{-webkit-text-size-adjust:100%;tab-size:4;line-height:1.5;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:var(--default-font-feature-settings,normal);font-variation-settings:var(--default-font-variation-settings,normal);-webkit-tap-highlight-color:transparent}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:var(--default-mono-font-feature-settings,normal);font-variation-settings:var(--default-mono-font-variation-settings,normal);font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}ol,ul,menu{list-style:none}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}button,input,select,optgroup,textarea{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}::file-selector-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::file-selector-button{margin-inline-end:4px}::placeholder{opacity:1}@supports (not ((-webkit-appearance:-apple-pay-button))) or (contain-intrinsic-size:1px){::placeholder{color:currentColor}@supports (color:color-mix(in lab,red,red)){::placeholder{color:color-mix(in oklab,currentcolor 50%,transparent)}}}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit{padding-block:0}::-webkit-datetime-edit-year-field{padding-block:0}::-webkit-datetime-edit-month-field{padding-block:0}::-webkit-datetime-edit-day-field{padding-block:0}::-webkit-datetime-edit-hour-field{padding-block:0}::-webkit-datetime-edit-minute-field{padding-block:0}::-webkit-datetime-edit-second-field{padding-block:0}::-webkit-datetime-edit-millisecond-field{padding-block:0}::-webkit-datetime-edit-meridiem-field{padding-block:0}::-webkit-calendar-picker-indicator{line-height:1}:-moz-ui-invalid{box-shadow:none}button,input:where([type=button],[type=reset],[type=submit]){appearance:button}::file-selector-button{appearance:button}::-webkit-inner-spin-button{height:auto}::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}}@layer components;@layer utilities{.invisible{visibility:hidden}.visible{visibility:visible}.absolute{position:absolute}.relative{position:relative}.static{position:static}.container{width:100%}@media(min-width:40rem){.container{max-width:40rem}}@media(min-width:48rem){.container{max-width:48rem}}@media(min-width:64rem){.container{max-width:64rem}}@media(min-width:80rem){.container{max-width:80rem}}@media(min-width:96rem){.container{max-width:96rem}}.my-1{margin-block:calc(var(--spacing)*1)}.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where([class~=lead]):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-lead);margin-top:1.2em;margin-bottom:1.2em;font-size:1.25em;line-height:1.6}.prose :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-links);font-weight:500;text-decoration:underline}.prose :where(strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-bold);font-weight:600}.prose :where(a strong):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(blockquote strong):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(thead th strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em;padding-inline-start:1.625em;list-style-type:decimal}.prose :where(ol[type=A]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=A s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=I]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=I s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type="1"]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em;padding-inline-start:1.625em;list-style-type:disc}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-counters);font-weight:400}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(dt):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:1.25em;font-weight:600}.prose :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){border-color:var(--tw-prose-hr);border-top-width:1px;margin-top:3em;margin-bottom:3em}.prose :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-quotes);border-inline-start-width:.25rem;border-inline-start-color:var(--tw-prose-quote-borders);quotes:"“""”""‘""’";margin-top:1.6em;margin-bottom:1.6em;padding-inline-start:1em;font-style:italic;font-weight:500}.prose :where(blockquote p:first-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:open-quote}.prose :where(blockquote p:last-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:close-quote}.prose :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:0;margin-bottom:.888889em;font-size:2.25em;font-weight:800;line-height:1.11111}.prose :where(h1 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:900}.prose :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:2em;margin-bottom:1em;font-size:1.5em;font-weight:700;line-height:1.33333}.prose :where(h2 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:800}.prose :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:1.6em;margin-bottom:.6em;font-size:1.25em;font-weight:600;line-height:1.6}.prose :where(h3 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:700}.prose :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:1.5em;margin-bottom:.5em;font-weight:600;line-height:1.5}.prose :where(h4 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:700}.prose :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(picture):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em;display:block}.prose :where(video):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(kbd):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-kbd);box-shadow:0 0 0 1px var(--tw-prose-kbd-shadows),0 3px 0 var(--tw-prose-kbd-shadows);padding-top:.1875em;padding-inline-end:.375em;padding-bottom:.1875em;border-radius:.3125rem;padding-inline-start:.375em;font-family:inherit;font-size:.875em;font-weight:500}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-code);font-size:.875em;font-weight:600}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):before,.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:"`"}.prose :where(a code):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(h1 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h2 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.875em}.prose :where(h3 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.9em}.prose :where(h4 code):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(blockquote code):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(thead th code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-pre-code);background-color:var(--tw-prose-pre-bg);padding-top:.857143em;padding-inline-end:1.14286em;padding-bottom:.857143em;border-radius:.375rem;margin-top:1.71429em;margin-bottom:1.71429em;padding-inline-start:1.14286em;font-size:.875em;font-weight:400;line-height:1.71429;overflow-x:auto}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:inherit;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit;background-color:#0000;border-width:0;border-radius:0;padding:0}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):before,.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:none}.prose :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){table-layout:auto;width:100%;margin-top:2em;margin-bottom:2em;font-size:.875em;line-height:1.71429}.prose :where(thead):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-th-borders)}.prose :where(thead th):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);vertical-align:bottom;padding-inline-end:.571429em;padding-bottom:.571429em;padding-inline-start:.571429em;font-weight:600}.prose :where(tbody tr):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-td-borders)}.prose :where(tbody tr:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:0}.prose :where(tbody td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:baseline}.prose :where(tfoot):not(:where([class~=not-prose],[class~=not-prose] *)){border-top-width:1px;border-top-color:var(--tw-prose-th-borders)}.prose :where(tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:top}.prose :where(th,td):not(:where([class~=not-prose],[class~=not-prose] *)){text-align:start}.prose :where(figure>*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-captions);margin-top:.857143em;font-size:.875em;line-height:1.42857}.prose{--tw-prose-body:oklch(37.3% .034 259.733);--tw-prose-headings:oklch(21% .034 264.665);--tw-prose-lead:oklch(44.6% .03 256.802);--tw-prose-links:oklch(21% .034 264.665);--tw-prose-bold:oklch(21% .034 264.665);--tw-prose-counters:oklch(55.1% .027 264.364);--tw-prose-bullets:oklch(87.2% .01 258.338);--tw-prose-hr:oklch(92.8% .006 264.531);--tw-prose-quotes:oklch(21% .034 264.665);--tw-prose-quote-borders:oklch(92.8% .006 264.531);--tw-prose-captions:oklch(55.1% .027 264.364);--tw-prose-kbd:oklch(21% .034 264.665);--tw-prose-kbd-shadows:oklab(21% -.00316127 -.0338527/.1);--tw-prose-code:oklch(21% .034 264.665);--tw-prose-pre-code:oklch(92.8% .006 264.531);--tw-prose-pre-bg:oklch(27.8% .033 256.848);--tw-prose-th-borders:oklch(87.2% .01 258.338);--tw-prose-td-borders:oklch(92.8% .006 264.531);--tw-prose-invert-body:oklch(87.2% .01 258.338);--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:oklch(70.7% .022 261.325);--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:oklch(70.7% .022 261.325);--tw-prose-invert-bullets:oklch(44.6% .03 256.802);--tw-prose-invert-hr:oklch(37.3% .034 259.733);--tw-prose-invert-quotes:oklch(96.7% .003 264.542);--tw-prose-invert-quote-borders:oklch(37.3% .034 259.733);--tw-prose-invert-captions:oklch(70.7% .022 261.325);--tw-prose-invert-kbd:#fff;--tw-prose-invert-kbd-shadows:#ffffff1a;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:oklch(87.2% .01 258.338);--tw-prose-invert-pre-bg:#00000080;--tw-prose-invert-th-borders:oklch(44.6% .03 256.802);--tw-prose-invert-td-borders:oklch(37.3% .034 259.733);font-size:1rem;line-height:1.75}.prose :where(picture>img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;margin-bottom:.5em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.375em}.prose :where(.prose>ul>li p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(.prose>ul>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ul>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(.prose>ol>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ol>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(dl):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where(dd):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;padding-inline-start:1.625em}.prose :where(hr+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(thead th:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(thead th:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(tbody td,tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){padding-top:.571429em;padding-inline-end:.571429em;padding-bottom:.571429em;padding-inline-start:.571429em}.prose :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(figure):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(.prose>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(.prose>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}.prose-sm{font-size:.875rem;line-height:1.71429}.prose-sm :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.14286em;margin-bottom:1.14286em}.prose-sm :where([class~=lead]):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.888889em;margin-bottom:.888889em;font-size:1.28571em;line-height:1.55556}.prose-sm :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.33333em;margin-bottom:1.33333em;padding-inline-start:1.11111em}.prose-sm :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:.8em;font-size:2.14286em;line-height:1.2}.prose-sm :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.6em;margin-bottom:.8em;font-size:1.42857em;line-height:1.4}.prose-sm :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.55556em;margin-bottom:.444444em;font-size:1.28571em;line-height:1.55556}.prose-sm :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.42857em;margin-bottom:.571429em;line-height:1.42857}.prose-sm :where(img):not(:where([class~=not-prose],[class~=not-prose] *)),.prose-sm :where(picture):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.71429em;margin-bottom:1.71429em}.prose-sm :where(picture>img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose-sm :where(video):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.71429em;margin-bottom:1.71429em}.prose-sm :where(kbd):not(:where([class~=not-prose],[class~=not-prose] *)){padding-top:.142857em;padding-inline-end:.357143em;padding-bottom:.142857em;border-radius:.3125rem;padding-inline-start:.357143em;font-size:.857143em}.prose-sm :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.857143em}.prose-sm :where(h2 code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.9em}.prose-sm :where(h3 code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.888889em}.prose-sm :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){padding-top:.666667em;padding-inline-end:1em;padding-bottom:.666667em;border-radius:.25rem;margin-top:1.66667em;margin-bottom:1.66667em;padding-inline-start:1em;font-size:.857143em;line-height:1.66667}.prose-sm :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)),.prose-sm :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.14286em;margin-bottom:1.14286em;padding-inline-start:1.57143em}.prose-sm :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.285714em;margin-bottom:.285714em}.prose-sm :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)),.prose-sm :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.428571em}.prose-sm :where(.prose-sm>ul>li p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.571429em;margin-bottom:.571429em}.prose-sm :where(.prose-sm>ul>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.14286em}.prose-sm :where(.prose-sm>ul>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.14286em}.prose-sm :where(.prose-sm>ol>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.14286em}.prose-sm :where(.prose-sm>ol>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.14286em}.prose-sm :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.571429em;margin-bottom:.571429em}.prose-sm :where(dl):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.14286em;margin-bottom:1.14286em}.prose-sm :where(dt):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.14286em}.prose-sm :where(dd):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.285714em;padding-inline-start:1.57143em}.prose-sm :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2.85714em;margin-bottom:2.85714em}.prose-sm :where(hr+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose-sm :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose-sm :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose-sm :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose-sm :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.857143em;line-height:1.5}.prose-sm :where(thead th):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:1em;padding-bottom:.666667em;padding-inline-start:1em}.prose-sm :where(thead th:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose-sm :where(thead th:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose-sm :where(tbody td,tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){padding-top:.666667em;padding-inline-end:1em;padding-bottom:.666667em;padding-inline-start:1em}.prose-sm :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose-sm :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose-sm :where(figure):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.71429em;margin-bottom:1.71429em}.prose-sm :where(figure>*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose-sm :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.666667em;font-size:.857143em;line-height:1.33333}.prose-sm :where(.prose-sm>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose-sm :where(.prose-sm>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}.-mt-2{margin-top:calc(var(--spacing)*-2)}.mt-1{margin-top:calc(var(--spacing)*1)}.mt-2{margin-top:calc(var(--spacing)*2)}.mt-4{margin-top:calc(var(--spacing)*4)}.mt-6{margin-top:calc(var(--spacing)*6)}.mt-8{margin-top:calc(var(--spacing)*8)}.mb-1{margin-bottom:calc(var(--spacing)*1)}.mb-2{margin-bottom:calc(var(--spacing)*2)}.mb-3{margin-bottom:calc(var(--spacing)*3)}.mb-4{margin-bottom:calc(var(--spacing)*4)}.mb-6{margin-bottom:calc(var(--spacing)*6)}.ml-2{margin-left:calc(var(--spacing)*2)}.ml-auto{margin-left:auto}.block{display:block}.flex{display:flex}.grid{display:grid}.inline{display:inline}.h-1\.5{height:calc(var(--spacing)*1.5)}.h-5{height:calc(var(--spacing)*5)}.h-full{height:100%}.h-screen{height:100vh}.min-h-screen{min-height:100vh}.w-5{width:calc(var(--spacing)*5)}.w-48{width:calc(var(--spacing)*48)}.w-full{width:100%}.max-w-\[90\%\]{max-width:90%}.max-w-md{max-width:var(--container-md)}.max-w-none{max-width:none}.flex-1{flex:1}.translate-y-1{--tw-translate-y:calc(var(--spacing)*1);translate:var(--tw-translate-x)var(--tw-translate-y)}.scale-200{--tw-scale-x:200%;--tw-scale-y:200%;--tw-scale-z:200%;scale:var(--tw-scale-x)var(--tw-scale-y)}.transform{transform:var(--tw-rotate-x,)var(--tw-rotate-y,)var(--tw-rotate-z,)var(--tw-skew-x,)var(--tw-skew-y,)}.animate-pulse{animation:var(--animate-pulse)}.animate-spin{animation:var(--animate-spin)}.cursor-pointer{cursor:pointer}.resize-none{resize:none}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.flex-col{flex-direction:column}.items-baseline{align-items:baseline}.items-center{align-items:center}.items-end{align-items:flex-end}.justify-between{justify-content:space-between}.justify-center{justify-content:center}.justify-end{justify-content:flex-end}.gap-1{gap:calc(var(--spacing)*1)}.gap-2{gap:calc(var(--spacing)*2)}.gap-3{gap:calc(var(--spacing)*3)}.gap-4{gap:calc(var(--spacing)*4)}.gap-8{gap:calc(var(--spacing)*8)}:where(.space-y-4>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*4)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*4)*calc(1 - var(--tw-space-y-reverse)))}.self-start{align-self:flex-start}.truncate{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.rounded{border-radius:.25rem}.rounded-full{border-radius:3.40282e38px}.rounded-lg{border-radius:var(--radius-lg)}.border{border-style:var(--tw-border-style);border-width:1px}.border-t{border-top-style:var(--tw-border-style);border-top-width:1px}.border-b{border-bottom-style:var(--tw-border-style);border-bottom-width:1px}.border-b-2{border-bottom-style:var(--tw-border-style);border-bottom-width:2px}.border-l-3{border-left-style:var(--tw-border-style);border-left-width:3px}.border-l-4{border-left-style:var(--tw-border-style);border-left-width:4px}.border-blue-600{border-color:var(--color-blue-600)}.border-gray-300{border-color:var(--color-gray-300)}.border-green-500{border-color:var(--color-green-500)}.border-red-500{border-color:var(--color-red-500)}.border-red-600{border-color:var(--color-red-600)}.bg-amber-500{background-color:var(--color-amber-500)}.bg-blue-100{background-color:var(--color-blue-100)}.bg-blue-600{background-color:var(--color-blue-600)}.bg-gray-50{background-color:var(--color-gray-50)}.bg-gray-100{background-color:var(--color-gray-100)}.bg-gray-200{background-color:var(--color-gray-200)}.bg-gray-600{background-color:var(--color-gray-600)}.bg-green-600{background-color:var(--color-green-600)}.bg-orange-600{background-color:var(--color-orange-600)}.bg-red-100{background-color:var(--color-red-100)}.bg-transparent{background-color:#0000}.bg-white{background-color:var(--color-white)}.bg-yellow-50{background-color:var(--color-yellow-50)}.p-1{padding:calc(var(--spacing)*1)}.p-2{padding:calc(var(--spacing)*2)}.p-3{padding:calc(var(--spacing)*3)}.p-4{padding:calc(var(--spacing)*4)}.p-6{padding:calc(var(--spacing)*6)}.px-2{padding-inline:calc(var(--spacing)*2)}.px-3{padding-inline:calc(var(--spacing)*3)}.px-4{padding-inline:calc(var(--spacing)*4)}.px-6{padding-inline:calc(var(--spacing)*6)}.py-0\.5{padding-block:calc(var(--spacing)*.5)}.py-1{padding-block:calc(var(--spacing)*1)}.py-2{padding-block:calc(var(--spacing)*2)}.py-3{padding-block:calc(var(--spacing)*3)}.py-4{padding-block:calc(var(--spacing)*4)}.pt-2{padding-top:calc(var(--spacing)*2)}.pt-20{padding-top:calc(var(--spacing)*20)}.pl-9{padding-left:calc(var(--spacing)*9)}.font-mono{font-family:var(--font-mono)}.text-lg{font-size:var(--text-lg);line-height:var(--tw-leading,var(--text-lg--line-height))}.text-sm{font-size:var(--text-sm);line-height:var(--tw-leading,var(--text-sm--line-height))}.text-xl{font-size:var(--text-xl);line-height:var(--tw-leading,var(--text-xl--line-height))}.text-xs{font-size:var(--text-xs);line-height:var(--tw-leading,var(--text-xs--line-height))}.font-bold{--tw-font-weight:var(--font-weight-bold);font-weight:var(--font-weight-bold)}.font-medium{--tw-font-weight:var(--font-weight-medium);font-weight:var(--font-weight-medium)}.font-semibold{--tw-font-weight:var(--font-weight-semibold);font-weight:var(--font-weight-semibold)}.break-all{word-break:break-all}.whitespace-pre-wrap{white-space:pre-wrap}.text-amber-600{color:var(--color-amber-600)}.text-black{color:var(--color-black)}.text-blue-600{color:var(--color-blue-600)}.text-gray-500{color:var(--color-gray-500)}.text-gray-600{color:var(--color-gray-600)}.text-gray-700{color:var(--color-gray-700)}.text-gray-900{color:var(--color-gray-900)}.text-green-600{color:var(--color-green-600)}.text-red-500{color:var(--color-red-500)}.text-red-600{color:var(--color-red-600)}.text-red-700{color:var(--color-red-700)}.text-red-900{color:var(--color-red-900)}.text-white{color:var(--color-white)}.italic{font-style:italic}.blur{--tw-blur:blur(8px);filter:var(--tw-blur,)var(--tw-brightness,)var(--tw-contrast,)var(--tw-grayscale,)var(--tw-hue-rotate,)var(--tw-invert,)var(--tw-saturate,)var(--tw-sepia,)var(--tw-drop-shadow,)}.filter{filter:var(--tw-blur,)var(--tw-brightness,)var(--tw-contrast,)var(--tw-grayscale,)var(--tw-hue-rotate,)var(--tw-invert,)var(--tw-saturate,)var(--tw-sepia,)var(--tw-drop-shadow,)}.transition-all{transition-property:all;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.transition-colors{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.duration-100{--tw-duration:.1s;transition-duration:.1s}.ease-in-out{--tw-ease:var(--ease-in-out);transition-timing-function:var(--ease-in-out)}.ease-linear{--tw-ease:linear;transition-timing-function:linear}.placeholder\:text-gray-500::placeholder{color:var(--color-gray-500)}@media(hover:hover){.hover\:bg-blue-50:hover{background-color:var(--color-blue-50)}.hover\:bg-blue-700:hover{background-color:var(--color-blue-700)}.hover\:bg-gray-50:hover{background-color:var(--color-gray-50)}.hover\:bg-gray-200:hover{background-color:var(--color-gray-200)}.hover\:bg-gray-300:hover{background-color:var(--color-gray-300)}.hover\:bg-gray-700:hover{background-color:var(--color-gray-700)}.hover\:bg-green-700:hover{background-color:var(--color-green-700)}.hover\:bg-orange-700:hover{background-color:var(--color-orange-700)}.hover\:bg-red-500:hover{background-color:var(--color-red-500)}.hover\:text-gray-700:hover{color:var(--color-gray-700)}.hover\:text-gray-800:hover{color:var(--color-gray-800)}.hover\:text-white:hover{color:var(--color-white)}.hover\:underline:hover{text-decoration-line:underline}}.disabled\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\:opacity-50:disabled{opacity:.5}.dark\:border-blue-400:where(.dark,.dark *){border-color:var(--color-blue-400)}.dark\:border-gray-600:where(.dark,.dark *){border-color:var(--color-gray-600)}.dark\:border-gray-700:where(.dark,.dark *){border-color:var(--color-gray-700)}.dark\:border-red-400:where(.dark,.dark *){border-color:var(--color-red-400)}.dark\:bg-amber-400:where(.dark,.dark *){background-color:var(--color-amber-400)}.dark\:bg-blue-900:where(.dark,.dark *){background-color:var(--color-blue-900)}.dark\:bg-gray-700:where(.dark,.dark *){background-color:var(--color-gray-700)}.dark\:bg-gray-800:where(.dark,.dark *){background-color:var(--color-gray-800)}.dark\:bg-gray-900:where(.dark,.dark *){background-color:var(--color-gray-900)}.dark\:bg-red-900:where(.dark,.dark *){background-color:var(--color-red-900)}.dark\:text-amber-400:where(.dark,.dark *){color:var(--color-amber-400)}.dark\:text-blue-400:where(.dark,.dark *){color:var(--color-blue-400)}.dark\:text-gray-300:where(.dark,.dark *){color:var(--color-gray-300)}.dark\:text-gray-400:where(.dark,.dark *){color:var(--color-gray-400)}.dark\:text-gray-500:where(.dark,.dark *){color:var(--color-gray-500)}.dark\:text-green-400:where(.dark,.dark *){color:var(--color-green-400)}.dark\:text-red-100:where(.dark,.dark *){color:var(--color-red-100)}.dark\:text-red-400:where(.dark,.dark *){color:var(--color-red-400)}.dark\:text-white:where(.dark,.dark *){color:var(--color-white)}.dark\:prose-invert:where(.dark,.dark *){--tw-prose-body:var(--tw-prose-invert-body);--tw-prose-headings:var(--tw-prose-invert-headings);--tw-prose-lead:var(--tw-prose-invert-lead);--tw-prose-links:var(--tw-prose-invert-links);--tw-prose-bold:var(--tw-prose-invert-bold);--tw-prose-counters:var(--tw-prose-invert-counters);--tw-prose-bullets:var(--tw-prose-invert-bullets);--tw-prose-hr:var(--tw-prose-invert-hr);--tw-prose-quotes:var(--tw-prose-invert-quotes);--tw-prose-quote-borders:var(--tw-prose-invert-quote-borders);--tw-prose-captions:var(--tw-prose-invert-captions);--tw-prose-kbd:var(--tw-prose-invert-kbd);--tw-prose-kbd-shadows:var(--tw-prose-invert-kbd-shadows);--tw-prose-code:var(--tw-prose-invert-code);--tw-prose-pre-code:var(--tw-prose-invert-pre-code);--tw-prose-pre-bg:var(--tw-prose-invert-pre-bg);--tw-prose-th-borders:var(--tw-prose-invert-th-borders);--tw-prose-td-borders:var(--tw-prose-invert-td-borders)}@media(hover:hover){.dark\:hover\:bg-blue-900:where(.dark,.dark *):hover{background-color:var(--color-blue-900)}.dark\:hover\:bg-gray-600:where(.dark,.dark *):hover{background-color:var(--color-gray-600)}.dark\:hover\:bg-gray-700:where(.dark,.dark *):hover{background-color:var(--color-gray-700)}.dark\:hover\:bg-gray-800:where(.dark,.dark *):hover{background-color:var(--color-gray-800)}.dark\:hover\:text-gray-200:where(.dark,.dark *):hover{color:var(--color-gray-200)}}}@property --tw-translate-x{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-y{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-z{syntax:"*";inherits:false;initial-value:0}@property --tw-scale-x{syntax:"*";inherits:false;initial-value:1}@property --tw-scale-y{syntax:"*";inherits:false;initial-value:1}@property --tw-scale-z{syntax:"*";inherits:false;initial-value:1}@property --tw-rotate-x{syntax:"*";inherits:false}@property --tw-rotate-y{syntax:"*";inherits:false}@property --tw-rotate-z{syntax:"*";inherits:false}@property --tw-skew-x{syntax:"*";inherits:false}@property --tw-skew-y{syntax:"*";inherits:false}@property --tw-space-y-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-font-weight{syntax:"*";inherits:false}@property --tw-blur{syntax:"*";inherits:false}@property --tw-brightness{syntax:"*";inherits:false}@property --tw-contrast{syntax:"*";inherits:false}@property --tw-grayscale{syntax:"*";inherits:false}@property --tw-hue-rotate{syntax:"*";inherits:false}@property --tw-invert{syntax:"*";inherits:false}@property --tw-opacity{syntax:"*";inherits:false}@property --tw-saturate{syntax:"*";inherits:false}@property --tw-sepia{syntax:"*";inherits:false}@property --tw-drop-shadow{syntax:"*";inherits:false}@property --tw-drop-shadow-color{syntax:"*";inherits:false}@property --tw-drop-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-drop-shadow-size{syntax:"*";inherits:false}@property --tw-duration{syntax:"*";inherits:false}@property --tw-ease{syntax:"*";inherits:false}@keyframes spin{to{transform:rotate(360deg)}}@keyframes pulse{50%{opacity:.5}}</style>
  </head>
  <body
    class="h-full bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-300"
  >
    <div id="app"></div>
  </body>
</html>
